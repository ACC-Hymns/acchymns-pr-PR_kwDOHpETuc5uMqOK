var mr=Object.defineProperty;var gr=(r,e,t)=>e in r?mr(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var rt=(r,e,t)=>(gr(r,typeof e!="symbol"?e+"":e,t),t),jt=(r,e,t)=>{if(!e.has(r))throw TypeError("Cannot "+t)};var E=(r,e,t)=>(jt(r,e,"read from private field"),t?t.call(r):e.get(r)),se=(r,e,t)=>{if(e.has(r))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(r):e.set(r,t)},Se=(r,e,t,n)=>(jt(r,e,"write to private field"),n?n.call(r,t):e.set(r,t),t);var xt=(r,e,t,n)=>({set _(s){Se(r,e,s,t)},get _(){return E(r,e,n)}}),le=(r,e,t)=>(jt(r,e,"access private method"),t);import{_ as _imports_0$1}from"./chevron-back-outline-421b5681.js";import{_ as _imports_2$1}from"./bookmark-97606ac0.js";import{N as getDefaultExportFromCjs,O as getAugmentedNamespace,P as commonjsGlobal,d as defineComponent,r as ref,c as onMounted,Q as Capacitor,j as createElementBlock,v as openBlock,S as useMediaQuery,b as useLocalStorage,L as computed,g as getAllBookMetaData,T as onUpdated,l as unref,m as createBlock,U as isRef,z as normalizeClass,p as createCommentVNode,E as pushScopeId,G as popScopeId,k as createBaseVNode,K as _export_sfc,V as registerPlugin,W as __vitePreload,u as useRouter,X as useSwipe,e as getSongMetaData,Y as Network,Z as onUnmounted,t as toDisplayString,F as Fragment,I as _imports_2$2,y as normalizeStyle,q as renderList,s as createVNode}from"./index-e0bdf4b5.js";import{_ as _imports_3}from"./chevron-forward-outline-f6241473.js";import{_ as _imports_5}from"./close-d0f54bcc.js";import{_ as _imports_0}from"./wifi_off-0d2e8605.js";import{_ as __awaiter,a as __decorate,v as validate_token,s as set,r as request_client}from"./broadcast-177dc9a6.js";import{T as Toast}from"./index-0984ecc2.js";import{u as useCapacitorPreferences}from"./preferences-a700b486.js";const _imports_1="/acchymns-pr-PR_kwDOHpETuc5zAJ8i/assets/musical-notes-outline.svg",_imports_2="/acchymns-pr-PR_kwDOHpETuc5zAJ8i/assets/musical-notes.svg",_imports_7="/acchymns-pr-PR_kwDOHpETuc5zAJ8i/assets/radio-outline.svg";var wheel$1={exports:{}};wheel$1.exports=addWheelListener;wheel$1.exports.addWheelListener=addWheelListener;wheel$1.exports.removeWheelListener=removeWheelListener;function addWheelListener(r,e,t){r.addEventListener("wheel",e,t)}function removeWheelListener(r,e,t){r.removeEventListener("wheel",e,t)}var wheelExports=wheel$1.exports,amator={exports:{}},NEWTON_ITERATIONS=4,NEWTON_MIN_SLOPE=.001,SUBDIVISION_PRECISION=1e-7,SUBDIVISION_MAX_ITERATIONS=10,kSplineTableSize=11,kSampleStepSize=1/(kSplineTableSize-1),float32ArraySupported=typeof Float32Array=="function";function A(r,e){return 1-3*e+3*r}function B(r,e){return 3*e-6*r}function C(r){return 3*r}function calcBezier(r,e,t){return((A(e,t)*r+B(e,t))*r+C(e))*r}function getSlope(r,e,t){return 3*A(e,t)*r*r+2*B(e,t)*r+C(e)}function binarySubdivide(r,e,t,n,s){var i,a,o=0;do a=e+(t-e)/2,i=calcBezier(a,n,s)-r,i>0?t=a:e=a;while(Math.abs(i)>SUBDIVISION_PRECISION&&++o<SUBDIVISION_MAX_ITERATIONS);return a}function newtonRaphsonIterate(r,e,t,n){for(var s=0;s<NEWTON_ITERATIONS;++s){var i=getSlope(e,t,n);if(i===0)return e;var a=calcBezier(e,t,n)-r;e-=a/i}return e}function LinearEasing(r){return r}var src=function(e,t,n,s){if(!(0<=e&&e<=1&&0<=n&&n<=1))throw new Error("bezier x values must be in [0, 1] range");if(e===t&&n===s)return LinearEasing;for(var i=float32ArraySupported?new Float32Array(kSplineTableSize):new Array(kSplineTableSize),a=0;a<kSplineTableSize;++a)i[a]=calcBezier(a*kSampleStepSize,e,n);function o(c){for(var l=0,u=1,d=kSplineTableSize-1;u!==d&&i[u]<=c;++u)l+=kSampleStepSize;--u;var m=(c-i[u])/(i[u+1]-i[u]),y=l+m*kSampleStepSize,h=getSlope(y,e,n);return h>=NEWTON_MIN_SLOPE?newtonRaphsonIterate(c,y,e,n):h===0?y:binarySubdivide(c,l,l+kSampleStepSize,e,n)}return function(l){return l===0?0:l===1?1:calcBezier(o(l),t,s)}},BezierEasing=src,animations={ease:BezierEasing(.25,.1,.25,1),easeIn:BezierEasing(.42,0,1,1),easeOut:BezierEasing(0,0,.58,1),easeInOut:BezierEasing(.42,0,.58,1),linear:BezierEasing(0,0,1,1)};amator.exports=animate$2;amator.exports.makeAggregateRaf=makeAggregateRaf;amator.exports.sharedScheduler=makeAggregateRaf();function animate$2(r,e,t){var n=Object.create(null),s=Object.create(null);t=t||{};var i=typeof t.easing=="function"?t.easing:animations[t.easing];i||(t.easing&&console.warn("Unknown easing function in amator: "+t.easing),i=animations.ease);var a=typeof t.step=="function"?t.step:noop$2,o=typeof t.done=="function"?t.done:noop$2,c=getScheduler(t.scheduler),l=Object.keys(e);l.forEach(function(v){n[v]=r[v],s[v]=e[v]-r[v]});var u=typeof t.duration=="number"?t.duration:400,d=Math.max(1,u*.06),m,y=0;return m=c.next(p),{cancel:h};function h(){c.cancel(m),m=0}function p(){var v=i(y/d);y+=1,f(v),y<=d?(m=c.next(p),a(r)):(m=0,setTimeout(function(){o(r)},0))}function f(v){l.forEach(function(_){r[_]=s[_]*v+n[_]})}}function noop$2(){}function getScheduler(r){if(!r){var e=typeof window<"u"&&window.requestAnimationFrame;return e?rafScheduler():timeoutScheduler()}if(typeof r.next!="function")throw new Error("Scheduler is supposed to have next(cb) function");if(typeof r.cancel!="function")throw new Error("Scheduler is supposed to have cancel(handle) function");return r}function rafScheduler(){return{next:window.requestAnimationFrame.bind(window),cancel:window.cancelAnimationFrame.bind(window)}}function timeoutScheduler(){return{next:function(r){return setTimeout(r,1e3/60)},cancel:function(r){return clearTimeout(r)}}}function makeAggregateRaf(){var r=new Set,e=new Set,t=0;return{next:s,cancel:s,clearAll:n};function n(){r.clear(),e.clear(),cancelAnimationFrame(t),t=0}function s(o){e.add(o),i()}function i(){t||(t=requestAnimationFrame(a))}function a(){t=0;var o=e;e=r,r=o,r.forEach(function(c){c()}),r.clear()}}var amatorExports=amator.exports,ngraph_events=function(e){validateSubject(e);var t=createEventsStorage(e);return e.on=t.on,e.off=t.off,e.fire=t.fire,e};function createEventsStorage(r){var e=Object.create(null);return{on:function(t,n,s){if(typeof n!="function")throw new Error("callback is expected to be a function");var i=e[t];return i||(i=e[t]=[]),i.push({callback:n,ctx:s}),r},off:function(t,n){var s=typeof t>"u";if(s)return e=Object.create(null),r;if(e[t]){var i=typeof n!="function";if(i)delete e[t];else for(var a=e[t],o=0;o<a.length;++o)a[o].callback===n&&a.splice(o,1)}return r},fire:function(t){var n=e[t];if(!n)return r;var s;arguments.length>1&&(s=Array.prototype.splice.call(arguments,1));for(var i=0;i<n.length;++i){var a=n[i];a.callback.apply(a.ctx,s)}return r}}}function validateSubject(r){if(!r)throw new Error("Eventify cannot use falsy object as events subject");for(var e=["on","fire","off"],t=0;t<e.length;++t)if(r.hasOwnProperty(e[t]))throw new Error("Subject cannot be eventified, since it already has property '"+e[t]+"'")}var kinetic_1=kinetic$1;function kinetic$1(r,e,t){typeof t!="object"&&(t={});var n=typeof t.minVelocity=="number"?t.minVelocity:5,s=typeof t.amplitude=="number"?t.amplitude:.25,i=typeof t.cancelAnimationFrame=="function"?t.cancelAnimationFrame:getCancelAnimationFrame(),a=typeof t.requestAnimationFrame=="function"?t.requestAnimationFrame:getRequestAnimationFrame(),o,c,l=342,u,d,m,y,h,p,f,v;return{start:O,stop:g,cancel:_};function _(){i(u),i(v)}function O(){o=r(),y=f=d=h=0,c=new Date,i(u),i(v),u=a(k)}function k(){var N=Date.now(),S=N-c;c=N;var T=r(),M=T.x-o.x,P=T.y-o.y;o=T;var $=1e3/(1+S);d=.8*M*$+.2*d,h=.8*P*$+.2*h,u=a(k)}function g(){i(u),i(v);var N=r();m=N.x,p=N.y,c=Date.now(),(d<-n||d>n)&&(y=s*d,m+=y),(h<-n||h>n)&&(f=s*h,p+=f),v=a(b)}function b(){var N=Date.now()-c,S=!1,T=0,M=0;y&&(T=-y*Math.exp(-N/l),T>.5||T<-.5?S=!0:T=y=0),f&&(M=-f*Math.exp(-N/l),M>.5||M<-.5?S=!0:M=f=0),S&&(e(m+T,p+M),v=a(b))}}function getCancelAnimationFrame(){return typeof cancelAnimationFrame=="function"?cancelAnimationFrame:clearTimeout}function getRequestAnimationFrame(){return typeof requestAnimationFrame=="function"?requestAnimationFrame:function(r){return setTimeout(r,16)}}var createTextSelectionInterceptor_1=createTextSelectionInterceptor$1;function createTextSelectionInterceptor$1(r){if(r)return{capture:noop$1,release:noop$1};var e,t,n,s=!1;return{capture:i,release:a};function i(o){s=!0,t=window.document.onselectstart,n=window.document.ondragstart,window.document.onselectstart=disabled,e=o,e.ondragstart=disabled}function a(){s&&(s=!1,window.document.onselectstart=t,e&&(e.ondragstart=n))}}function disabled(r){return r.stopPropagation(),!1}function noop$1(){}var transform,hasRequiredTransform;function requireTransform(){if(hasRequiredTransform)return transform;hasRequiredTransform=1,transform=r;function r(){this.x=0,this.y=0,this.scale=1}return transform}var svgController={exports:{}},hasRequiredSvgController;function requireSvgController(){if(hasRequiredSvgController)return svgController.exports;hasRequiredSvgController=1,svgController.exports=r,svgController.exports.canAttach=e;function r(t,n){if(!e(t))throw new Error("svg element is required for svg.panzoom to work");var s=t.ownerSVGElement;if(!s)throw new Error("Do not apply panzoom to the root <svg> element. Use its child instead (e.g. <g></g>). As of March 2016 only FireFox supported transform on the root element");n.disableKeyboardInteraction||s.setAttribute("tabindex",0);var i={getBBox:o,getScreenCTM:c,getOwner:a,applyTransform:u,initTransform:l};return i;function a(){return s}function o(){var d=t.getBBox();return{left:d.x,top:d.y,width:d.width,height:d.height}}function c(){var d=s.getCTM();return d||s.getScreenCTM()}function l(d){var m=t.getCTM();m===null&&(m=document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGMatrix()),d.x=m.e,d.y=m.f,d.scale=m.a,s.removeAttributeNS(null,"viewBox")}function u(d){t.setAttribute("transform","matrix("+d.scale+" 0 0 "+d.scale+" "+d.x+" "+d.y+")")}}function e(t){return t&&t.ownerSVGElement&&t.getCTM}return svgController.exports}var domController={exports:{}},hasRequiredDomController;function requireDomController(){if(hasRequiredDomController)return domController.exports;hasRequiredDomController=1,domController.exports=r,domController.exports.canAttach=e;function r(t,n){var s=e(t);if(!s)throw new Error("panzoom requires DOM element to be attached to the DOM tree");var i=t.parentElement;t.scrollTop=0,n.disableKeyboardInteraction||i.setAttribute("tabindex",0);var a={getBBox:c,getOwner:o,applyTransform:l};return a;function o(){return i}function c(){return{left:0,top:0,width:t.clientWidth,height:t.clientHeight}}function l(u){t.style.transformOrigin="0 0 0",t.style.transform="matrix("+u.scale+", 0, 0, "+u.scale+", "+u.x+", "+u.y+")"}}function e(t){return t&&t.parentElement&&t.style}return domController.exports}var wheel=wheelExports,animate$1=amatorExports,eventify=ngraph_events,kinetic=kinetic_1,createTextSelectionInterceptor=createTextSelectionInterceptor_1,domTextSelectionInterceptor=createTextSelectionInterceptor(),fakeTextSelectorInterceptor=createTextSelectionInterceptor(!0),Transform=requireTransform(),makeSvgController=requireSvgController(),makeDomController=requireDomController(),defaultZoomSpeed=1,defaultDoubleTapZoomSpeed=1.75,doubleTapSpeedInMS=300,clickEventTimeInMS=200,panzoom=createPanZoom,initialWidth=0,initialHeight=0;function createPanZoom(r,e){initialWidth=r.offsetWidth,initialHeight=r.offsetHeight,e=e||{};var t=e.controller;if(t||(makeSvgController.canAttach(r)?t=makeSvgController(r,e):makeDomController.canAttach(r)&&(t=makeDomController(r,e))),!t)throw new Error("Cannot create panzoom for the current type of dom element");var n=t.getOwner(),s={x:0,y:0},i=!1,a=new Transform;t.initTransform&&t.initTransform(a);var o=typeof e.filterKey=="function"?e.filterKey:noop,c=typeof e.pinchSpeed=="number"?e.pinchSpeed:1,l=e.bounds,u=typeof e.maxZoom=="number"?e.maxZoom:Number.POSITIVE_INFINITY,d=typeof e.minZoom=="number"?e.minZoom:0,m=typeof e.boundsPadding=="number"?e.boundsPadding:.05,y=typeof e.zoomDoubleClickSpeed=="number"?e.zoomDoubleClickSpeed:defaultDoubleTapZoomSpeed,h=e.beforeWheel||noop,p=e.beforeMouseDown||noop,f=typeof e.zoomSpeed=="number"?e.zoomSpeed:defaultZoomSpeed,v=parseTransformOrigin(e.transformOrigin),_=e.enableTextSelection?fakeTextSelectorInterceptor:domTextSelectionInterceptor;validateBounds(l),e.autocenter&&xe();var O,k=0,g=0,b=0,N=null,S=new Date,T,M=!1,P=!0,$=!0,K=!1,L,j,q,te,F,z;"smoothScroll"in e&&!e.smoothScroll?z=rigidScroll():z=kinetic(Ge,nt,e.smoothScroll);var Q,ne,de,U=!1;re();var w={dispose:ve,moveBy:$e,moveTo:Re,smoothMoveTo:ze,centerOn:ae,zoomTo:yt,zoomAbs:ue,smoothZoom:lt,smoothZoomAbs:ht,showRectangle:ie,pause:W,resume:ee,isPaused:Ae,getTransform:Ve,getMinZoom:We,setMinZoom:Pe,getMaxZoom:He,setMaxZoom:Me,setVerticalPan:he,setHorizontalPan:me,getInitWidth:Y,getInitHeight:D,getTransformOrigin:be,setTransformOrigin:fe,getZoomSpeed:Ee,setZoomSpeed:Be};eventify(w);var x=typeof e.initialX=="number"?e.initialX:a.x,R=typeof e.initialY=="number"?e.initialY:a.y,V=typeof e.initialZoom=="number"?e.initialZoom:a.scale;return(x!=a.x||R!=a.y||V!=a.scale)&&ue(x,R,V),w;function D(){return initialHeight}function Y(){return initialWidth}function W(){_e(),U=!0}function ee(){U&&(re(),U=!1)}function me(Ne){P=Ne}function he(Ne){$=Ne}function Ae(){return U}function ie(Ne){var Xe=n.getBoundingClientRect(),je=ye(Xe.width,Xe.height),Qe=Ne.right-Ne.left,st=Ne.bottom-Ne.top;if(!Number.isFinite(Qe)||!Number.isFinite(st))throw new Error("Invalid rectangle");var at=je.x/Qe,ot=je.y/st,ut=Math.min(at,ot);a.x=-(Ne.left+Qe/2)*ut+je.x/2,a.y=-(Ne.top+st/2)*ut+je.y/2,a.scale=ut}function ye(Ne,Xe){if(t.getScreenCTM){var je=t.getScreenCTM(),Qe=je.a,st=je.d,at=je.e,ot=je.f;s.x=Ne*Qe-at,s.y=Xe*st-ot}else s.x=Ne,s.y=Xe;return s}function xe(){var Ne,Xe,je=0,Qe=0,st=ge();if(st)je=st.left,Qe=st.top,Ne=st.right-st.left,Xe=st.bottom-st.top;else{var at=n.getBoundingClientRect();Ne=at.width,Xe=at.height}var ot=t.getBBox();if(!(ot.width===0||ot.height===0)){var ut=Xe/ot.height,bt=Ne/ot.width,gt=Math.min(bt,ut);a.x=-(ot.left+ot.width/2)*gt+Ne/2+je,a.y=-(ot.top+ot.height/2)*gt+Xe/2+Qe,a.scale=gt}}function Ve(){return a}function We(){return d}function Pe(Ne){d=Ne}function He(){return u}function Me(Ne){u=Ne}function be(){return v}function fe(Ne){v=parseTransformOrigin(Ne)}function Ee(){return f}function Be(Ne){if(!Number.isFinite(Ne))throw new Error("Zoom speed should be a number");f=Ne}function Ge(){return{x:a.x,y:a.y}}function Re(Ne,Xe){a.x=Ne,a.y=Xe,Ie(),At("pan"),qe()}function Ce(Ne,Xe){Re(P?a.x+Ne:a.x,$?a.y+Xe:a.y)}function Ie(){var Ne=ge();if(Ne){var Xe=!1,je=Ze(),Qe=Ne.left-je.right;return Qe>0&&(a.x+=Qe,Xe=!0),Qe=Ne.right-je.left,Qe<0&&(a.x+=Qe,Xe=!0),$&&(Qe=Ne.top-je.bottom,Qe>0&&(a.y+=Qe,Xe=!0),Qe=Ne.bottom-je.top,Qe<0&&(a.y+=Qe,Xe=!0)),Xe}}function ge(){if(l){if(typeof l=="boolean"){var Ne=n.getBoundingClientRect(),Xe=Ne.width,je=Ne.height;return{left:Xe*m,top:je*m,right:Xe*(1-m),bottom:je*(1-m)}}return l}}function Ze(){var Ne=t.getBBox(),Xe=Ke(Ne.left,Ne.top);return{left:Xe.x,top:Xe.y,right:Ne.width*a.scale+Xe.x,bottom:Ne.height*a.scale+Xe.y}}function Ke(Ne,Xe){return{x:Ne*a.scale+a.x,y:Xe*a.scale+a.y}}function qe(){i=!0,O=window.requestAnimationFrame(Le)}function we(Ne,Xe,je){if(isNaN$1(Ne)||isNaN$1(Xe)||isNaN$1(je))throw new Error("zoom requires valid numbers");var Qe=a.scale*je;if(Qe<d){if(a.scale===d)return;je=d/a.scale}if(Qe>u){if(a.scale===u)return;je=u/a.scale}var st=ye(Ne,Xe);if(a.x=st.x-je*(st.x-a.x),a.y=st.y-je*(st.y-a.y),l&&m===1&&d===1)a.scale*=je,Ie();else{var at=Ie();at||(a.scale*=je)}At("zoom"),qe()}function ue(Ne,Xe,je){var Qe=je/a.scale;we(Ne,Xe,Qe)}function ae(Ne){var Xe=Ne.ownerSVGElement;if(!Xe)throw new Error("ui element is required to be within the scene");var je=Ne.getBoundingClientRect(),Qe=je.left+je.width/2,st=je.top+je.height/2,at=Xe.getBoundingClientRect(),ot=at.width/2-Qe,ut=at.height/2-st;$e(ot,ut,!0)}function ze(Ne,Xe){$e(Ne-a.x,Xe-a.y,!0)}function $e(Ne,Xe,je){if(!je)return Ce(Ne,Xe);Q&&Q.cancel();var Qe={x:0,y:0},st={x:Ne,y:Xe},at=0,ot=0;Q=animate$1(Qe,st,{step:function(ut){Ce(ut.x-at,ut.y-ot),at=ut.x,ot=ut.y}})}function nt(Ne,Xe){mt(),Re(Ne,Xe)}function ve(){_e()}function re(){n.addEventListener("mousedown",Ue,{passive:!1}),n.addEventListener("dblclick",Fe,{passive:!1}),n.addEventListener("touchstart",Z,{passive:!1}),n.addEventListener("keydown",G,{passive:!1}),wheel.addWheelListener(n,tt,{passive:!1}),qe()}function _e(){wheel.removeWheelListener(n,tt),n.removeEventListener("mousedown",Ue),n.removeEventListener("keydown",G),n.removeEventListener("dblclick",Fe),n.removeEventListener("touchstart",Z),O&&(window.cancelAnimationFrame(O),O=0),z.cancel(),et(),it(),_.release(),Yt()}function Le(){i&&Te()}function Te(){i=!1,t.applyTransform(a),At("transform"),O=0}function G(Ne){var Xe=0,je=0,Qe=0;if(Ne.keyCode===38?je=1:Ne.keyCode===40?je=-1:Ne.keyCode===37?Xe=1:Ne.keyCode===39?Xe=-1:Ne.keyCode===189||Ne.keyCode===109?Qe=1:(Ne.keyCode===187||Ne.keyCode===107)&&(Qe=-1),!o(Ne,Xe,je,Qe)){if(Xe||je){Ne.preventDefault(),Ne.stopPropagation();var st=n.getBoundingClientRect(),at=Math.min(st.width,st.height),ot=.05,ut=at*ot*Xe,bt=at*ot*je;$e(ut,bt)}if(Qe){var gt=wt(Qe*100),at=v?dt():I();yt(at.x,at.y,gt)}}}function I(){var Ne=n.getBoundingClientRect();return{x:Ne.width/2,y:Ne.height/2}}function Z(Ne){if(H(Ne),oe(),Ne.touches.length===1)return ce(Ne,Ne.touches[0]);Ne.touches.length===2&&(F=Oe(Ne.touches[0],Ne.touches[1]),de=!0,ke())}function H(Ne){e.onTouch&&!e.onTouch(Ne)||(Ne.stopPropagation(),Ne.preventDefault())}function J(Ne){oe(),!(e.onDoubleClick&&!e.onDoubleClick(Ne))&&(Ne.preventDefault(),Ne.stopPropagation())}function ce(Ne){g=new Date;var Xe=Ne.touches[0],je=ct(Xe);T=je;var Qe=ye(je.x,je.y);L=Qe.x,j=Qe.y,q=L,te=j,z.cancel(),ke()}function ke(){M||(M=!0,document.addEventListener("touchmove",X),document.addEventListener("touchend",De),document.addEventListener("touchcancel",De))}function X(Ne){if(Ne.touches.length===1){Ne.stopPropagation();var Xe=Ne.touches[0],je=ct(Xe),Qe=ye(je.x,je.y),st=Qe.x-L,at=Qe.y-j;st!==0&&at!==0&&wn(),L=Qe.x,j=Qe.y,$e(st,at)}else if(Ne.touches.length===2){de=!0;var ot=Ne.touches[0],ut=Ne.touches[1],bt=Oe(ot,ut),gt=1+(bt/F-1)*c,xn=ct(ot),Nn=ct(ut);if(L=(xn.x+Nn.x)/2,j=(xn.y+Nn.y)/2,v){var je=dt();L=je.x,j=je.y}yt(L,j,gt),F=bt,Ne.stopPropagation(),Ne.preventDefault()}}function oe(){b&&(clearTimeout(b),b=0)}function pe(Ne){if(e.onClick){oe();var Xe=L-q,je=j-te,Qe=Math.sqrt(Xe*Xe+je*je);Qe>5||(b=setTimeout(function(){b=0,e.onClick(Ne)},doubleTapSpeedInMS))}}function De(Ne){if(oe(),Ne.touches.length>0){var Xe=ct(Ne.touches[0]),je=ye(Xe.x,Xe.y);L=je.x,j=je.y}else{var Qe=new Date;if(Qe-k<doubleTapSpeedInMS)if(v){var Xe=dt();lt(Xe.x,Xe.y,y)}else lt(T.x,T.y,y);else Qe-g<clickEventTimeInMS&&pe(Ne);k=Qe,Yt(),it()}}function Oe(Ne,Xe){var je=Ne.clientX-Xe.clientX,Qe=Ne.clientY-Xe.clientY;return Math.sqrt(je*je+Qe*Qe)}function Fe(Ne){J(Ne);var Xe=ct(Ne);v&&(Xe=dt()),lt(Xe.x,Xe.y,y)}function Ue(Ne){if(oe(),!p(Ne)){if(N=Ne,S=new Date,M)return Ne.stopPropagation(),!1;var Xe=Ne.button===1&&window.event!==null||Ne.button===0;if(Xe){z.cancel();var je=ct(Ne),Qe=ye(je.x,je.y);return q=L=Qe.x,te=j=Qe.y,document.addEventListener("mousemove",Ye),document.addEventListener("mouseup",Je),_.capture(Ne.target||Ne.srcElement),!1}}}function Ye(Ne){if(!M){wn();var Xe=ct(Ne),je=ye(Xe.x,Xe.y),Qe=je.x-L,st=je.y-j;L=je.x,j=je.y,$e(Qe,st)}}function Je(){var Ne=new Date;Ne-S<clickEventTimeInMS&&pe(N),_.release(),Yt(),et()}function et(){document.removeEventListener("mousemove",Ye),document.removeEventListener("mouseup",Je),K=!1}function it(){document.removeEventListener("touchmove",X),document.removeEventListener("touchend",De),document.removeEventListener("touchcancel",De),K=!1,de=!1,M=!1}function tt(Ne){if(!h(Ne)){z.cancel();var Xe=Ne.deltaY;Ne.deltaMode>0&&(Xe*=100);var je=wt(Xe);if(je!==1){var Qe=v?dt():ct(Ne);yt(Qe.x,Qe.y,je),Ne.preventDefault()}}}function ct(Ne){var Xe,je,Qe=n.getBoundingClientRect();return Xe=Ne.clientX-Qe.left,je=Ne.clientY-Qe.top,{x:Xe,y:je}}function lt(Ne,Xe,je){var Qe=a.scale,st={scale:Qe},at={scale:je*Qe};z.cancel(),mt(),ne=animate$1(st,at,{step:function(ot){ue(Ne,Xe,ot.scale)},done:pr})}function ht(Ne,Xe,je){var Qe=a.scale,st={scale:Qe},at={scale:je};z.cancel(),mt(),ne=animate$1(st,at,{step:function(ot){ue(Ne,Xe,ot.scale)}})}function dt(){var Ne=n.getBoundingClientRect();return{x:Ne.width*v.x,y:Ne.height*v.y}}function yt(Ne,Xe,je){return z.cancel(),mt(),we(Ne,Xe,je)}function mt(){ne&&(ne.cancel(),ne=null)}function wt(Ne){var Xe=Math.sign(Ne),je=Math.min(.25,Math.abs(f*Ne/128));return 1-Xe*je}function wn(){K||(At("panstart"),K=!0,z.start())}function Yt(){K&&(de||z.stop(),At("panend"))}function pr(){At("zoomend")}function At(Ne){w.fire(Ne,w)}}function parseTransformOrigin(r){if(r){if(typeof r=="object")return(!isNumber$1(r.x)||!isNumber$1(r.y))&&failTransformOrigin(r),r;failTransformOrigin()}}function failTransformOrigin(r){throw console.error(r),new Error(["Cannot parse transform origin.","Some good examples:",'  "center center" can be achieved with {x: 0.5, y: 0.5}','  "top center" can be achieved with {x: 0.5, y: 0}','  "bottom right" can be achieved with {x: 1, y: 1}'].join(`
`))}function noop(){}function validateBounds(r){var e=typeof r;if(!(e==="undefined"||e==="boolean")){var t=isNumber$1(r.left)&&isNumber$1(r.top)&&isNumber$1(r.bottom)&&isNumber$1(r.right);if(!t)throw new Error("Bounds object is not valid. It can be: undefined, boolean (true|false) or an object {left, top, right, bottom}")}}function isNumber$1(r){return Number.isFinite(r)}function isNaN$1(r){return Number.isNaN?Number.isNaN(r):r!==r}function rigidScroll(){return{start:noop,stop:noop,cancel:noop}}function autoRun(){if(typeof document>"u")return;var r=document.getElementsByTagName("script");if(!r)return;for(var e,t=0;t<r.length;++t){var n=r[t];if(n.src&&n.src.match(/\bpanzoom(\.min)?\.js/)){e=n;break}}if(!e)return;var s=e.getAttribute("query");if(!s)return;var i=e.getAttribute("name")||"pz",a=Date.now();o();function o(){var u=document.querySelector(s);if(!u){var d=Date.now(),m=d-a;if(m<2e3){setTimeout(o,100);return}console.error("Cannot find the panzoom element",i);return}var y=c(e);console.log(y),window[i]=createPanZoom(u,y)}function c(u){for(var d=u.attributes,m={},y=0;y<d.length;++y){var h=d[y],p=l(h);p&&(m[p.name]=p.value)}return m}function l(u){if(u.name){var d=u.name[0]==="p"&&u.name[1]==="z"&&u.name[2]==="-";if(d){var m=u.name.substr(3),y=JSON.parse(u.value);return{name:m,value:y}}}}}autoRun();const createPanZoom$1=getDefaultExportFromCjs(panzoom);function commonjsRequire(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$6=getAugmentedNamespace(__viteBrowserExternal$1);var path2dPolyfill_esm={},hasRequiredPath2dPolyfill_esm;function requirePath2dPolyfill_esm(){if(hasRequiredPath2dPolyfill_esm)return path2dPolyfill_esm;hasRequiredPath2dPolyfill_esm=1;function r(h,p,f){if(f||arguments.length===2)for(var v=0,_=p.length,O;v<_;v++)(O||!(v in p))&&(O||(O=Array.prototype.slice.call(p,0,v)),O[v]=p[v]);return h.concat(O||Array.prototype.slice.call(p))}var e={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},t=/([astvzqmhlc])([^astvzqmhlc]*)/gi,n=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/gi;function s(h){var p=h.match(n);return p?p.map(Number):[]}function i(h){var p=[],f=String(h).trim();return f[0]!=="M"&&f[0]!=="m"||f.replace(t,function(v,_,O){var k=s(O),g=_.toLowerCase(),b=_;if(g==="m"&&k.length>2&&(p.push(r([b],k.splice(0,2),!0)),g="l",b=b==="m"?"l":"L"),k.length<e[g])return"";for(p.push(r([b],k.splice(0,e[g]),!0));k.length>=e[g]&&k.length&&e[g];)p.push(r([b],k.splice(0,e[g]),!0));return""}),p}function a(h,p){var f=h.x*Math.cos(p)-h.y*Math.sin(p),v=h.y*Math.cos(p)+h.x*Math.sin(p);h.x=f,h.y=v}function o(h,p,f){h.x+=p,h.y+=f}function c(h,p){h.x*=p,h.y*=p}var l=function(){function h(p){var f;this.commands=[],p&&p instanceof h?(f=this.commands).push.apply(f,p.commands):p&&(this.commands=i(p))}return h.prototype.addPath=function(p){var f;p&&p instanceof h&&(f=this.commands).push.apply(f,p.commands)},h.prototype.moveTo=function(p,f){this.commands.push(["M",p,f])},h.prototype.lineTo=function(p,f){this.commands.push(["L",p,f])},h.prototype.arc=function(p,f,v,_,O,k){this.commands.push(["AC",p,f,v,_,O,!!k])},h.prototype.arcTo=function(p,f,v,_,O){this.commands.push(["AT",p,f,v,_,O])},h.prototype.ellipse=function(p,f,v,_,O,k,g,b){this.commands.push(["E",p,f,v,_,O,k,g,!!b])},h.prototype.closePath=function(){this.commands.push(["Z"])},h.prototype.bezierCurveTo=function(p,f,v,_,O,k){this.commands.push(["C",p,f,v,_,O,k])},h.prototype.quadraticCurveTo=function(p,f,v,_){this.commands.push(["Q",p,f,v,_])},h.prototype.rect=function(p,f,v,_){this.commands.push(["R",p,f,v,_])},h.prototype.roundRect=function(p,f,v,_,O){typeof O>"u"?this.commands.push(["RR",p,f,v,_,0]):this.commands.push(["RR",p,f,v,_,O])},h}();function u(h,p){var f=0,v=0,_,O,k,g,b,N,S,T,M,P,$,K,L,j,q,te,F,z,Q,ne,de,U=null,w=null,x=null,R=null,V=null,D=null;h.beginPath();for(var Y=0;Y<p.length;++Y){z=p[Y][0],z!=="S"&&z!=="s"&&z!=="C"&&z!=="c"&&(U=null,w=null),z!=="T"&&z!=="t"&&z!=="Q"&&z!=="q"&&(x=null,R=null);var W=void 0;switch(z){case"m":case"M":W=p[Y],z==="m"?(f+=W[1],v+=W[2]):(f=W[1],v=W[2]),(z==="M"||!V)&&(V={x:f,y:v}),h.moveTo(f,v);break;case"l":W=p[Y],f+=W[1],v+=W[2],h.lineTo(f,v);break;case"L":W=p[Y],f=W[1],v=W[2],h.lineTo(f,v);break;case"H":W=p[Y],f=W[1],h.lineTo(f,v);break;case"h":W=p[Y],f+=W[1],h.lineTo(f,v);break;case"V":W=p[Y],v=W[1],h.lineTo(f,v);break;case"v":W=p[Y],v+=W[1],h.lineTo(f,v);break;case"a":case"A":if(W=p[Y],D===null)throw new Error("This should never happen");z==="a"?(f+=W[6],v+=W[7]):(f=W[6],v=W[7]),j=W[1],q=W[2],S=W[3]*Math.PI/180,k=!!W[4],g=!!W[5],b={x:f,y:v},N={x:(D.x-b.x)/2,y:(D.y-b.y)/2},a(N,-S),T=N.x*N.x/(j*j)+N.y*N.y/(q*q),T>1&&(T=Math.sqrt(T),j*=T,q*=T),Q={x:j*N.y/q,y:-(q*N.x)/j},M=j*j*q*q,P=j*j*N.y*N.y+q*q*N.x*N.x,g!==k?c(Q,Math.sqrt((M-P)/P)||0):c(Q,-Math.sqrt((M-P)/P)||0),O=Math.atan2((N.y-Q.y)/q,(N.x-Q.x)/j),_=Math.atan2(-(N.y+Q.y)/q,-(N.x+Q.x)/j),a(Q,S),o(Q,(b.x+D.x)/2,(b.y+D.y)/2),h.save(),h.translate(Q.x,Q.y),h.rotate(S),h.scale(j,q),h.arc(0,0,1,O,_,!g),h.restore();break;case"C":W=p[Y],U=W[3],w=W[4],f=W[5],v=W[6],h.bezierCurveTo(W[1],W[2],U,w,f,v);break;case"c":W=p[Y],h.bezierCurveTo(W[1]+f,W[2]+v,W[3]+f,W[4]+v,W[5]+f,W[6]+v),U=W[3]+f,w=W[4]+v,f+=W[5],v+=W[6];break;case"S":W=p[Y],(U===null||w===null)&&(U=f,w=v),h.bezierCurveTo(2*f-U,2*v-w,W[1],W[2],W[3],W[4]),U=W[1],w=W[2],f=W[3],v=W[4];break;case"s":W=p[Y],(U===null||w===null)&&(U=f,w=v),h.bezierCurveTo(2*f-U,2*v-w,W[1]+f,W[2]+v,W[3]+f,W[4]+v),U=W[1]+f,w=W[2]+v,f+=W[3],v+=W[4];break;case"Q":W=p[Y],x=W[1],R=W[2],f=W[3],v=W[4],h.quadraticCurveTo(x,R,f,v);break;case"q":W=p[Y],x=W[1]+f,R=W[2]+v,f+=W[3],v+=W[4],h.quadraticCurveTo(x,R,f,v);break;case"T":W=p[Y],(x===null||R===null)&&(x=f,R=v),x=2*f-x,R=2*v-R,f=W[1],v=W[2],h.quadraticCurveTo(x,R,f,v);break;case"t":W=p[Y],(x===null||R===null)&&(x=f,R=v),x=2*f-x,R=2*v-R,f+=W[1],v+=W[2],h.quadraticCurveTo(x,R,f,v);break;case"z":case"Z":V&&(f=V.x,v=V.y),V=null,h.closePath();break;case"AC":W=p[Y],f=W[1],v=W[2],L=W[3],O=W[4],_=W[5],ne=W[6],h.arc(f,v,L,O,_,ne);break;case"AT":W=p[Y],$=W[1],K=W[2],f=W[3],v=W[4],L=W[5],h.arcTo($,K,f,v,L);break;case"E":W=p[Y],f=W[1],v=W[2],j=W[3],q=W[4],S=W[5],O=W[6],_=W[7],ne=W[8],h.save(),h.translate(f,v),h.rotate(S),h.scale(j,q),h.arc(0,0,1,O,_,ne),h.restore();break;case"R":W=p[Y],f=W[1],v=W[2],te=W[3],F=W[4],V={x:f,y:v},h.rect(f,v,te,F);break;case"RR":W=p[Y],f=W[1],v=W[2],te=W[3],F=W[4],de=W[5],V={x:f,y:v},h.roundRect(f,v,te,F,de);break}D?(D.x=f,D.y=v):D={x:f,y:v}}}function d(h){if(!(!h||!h.CanvasRenderingContext2D||h.Path2D)){var p=h.CanvasRenderingContext2D,f=p.prototype.fill,v=p.prototype.stroke,_=p.prototype.isPointInPath;p.prototype.fill=function(){for(var k=[],g=0;g<arguments.length;g++)k[g]=arguments[g];if(k[0]instanceof l){var b=k[0],N=k[1]||"nonzero";u(this,b.commands),f.apply(this,[N])}else{var N=k[0]||"nonzero";return f.apply(this,[N])}},p.prototype.stroke=function(k){k&&u(this,k.commands),v.apply(this)},p.prototype.isPointInPath=function(){for(var k=[],g=0;g<arguments.length;g++)k[g]=arguments[g];if(k[0]instanceof l){var b=k[0],N=k[1],S=k[2],T=k[3]||"nonzero";return u(this,b.commands),_.apply(this,[N,S,T])}else return _.apply(this,k)},h.Path2D=l}}function m(h,p,f,v,_){var O=this;if(_===void 0&&(_=0),typeof _=="number"&&(_=[_]),Array.isArray(_)){if(_.length===0||_.length>4)throw new RangeError("Failed to execute 'roundRect' on '".concat(this.constructor.name,"': ").concat(_.length," radii provided. Between one and four radii are necessary."));_.forEach(function(T){if(T<0)throw new RangeError("Failed to execute 'roundRect' on '".concat(O.constructor.name,"': Radius value ").concat(T," is negative."))})}else return;if(_.length===1&&_[0]===0)return this.rect(h,p,f,v);var k=Math.min(f,v)/2,g,b,N,S=g=b=N=Math.min(k,_[0]);_.length===2&&(g=N=Math.min(k,_[1])),_.length===3&&(g=N=Math.min(k,_[1]),b=Math.min(k,_[2])),_.length===4&&(g=Math.min(k,_[1]),b=Math.min(k,_[2]),N=Math.min(k,_[3])),this.moveTo(h,p+v-N),this.arcTo(h,p,h+S,p,S),this.arcTo(h+f,p,h+f,p+g,g),this.arcTo(h+f,p+v,h+f-b,p+v,b),this.arcTo(h,p+v,h,p+v-N,N),this.moveTo(h,p)}function y(h){if(!(!h||!h.CanvasRenderingContext2D)){var p=h.CanvasRenderingContext2D,f=h.Path2D;p&&!p.prototype.roundRect&&(p.prototype.roundRect=m),f&&!f.prototype.roundRect&&(f.prototype.roundRect=m)}}return d(window),y(window),path2dPolyfill_esm}(function(module,exports){(function(e,t){module.exports=e.pdfjsLib=t()})(globalThis,()=>(()=>{var __webpack_modules__=[,(r,e,t)=>{var qe;Object.defineProperty(e,"__esModule",{value:!0}),e.VerbosityLevel=e.Util=e.UnknownErrorException=e.UnexpectedResponseException=e.TextRenderingMode=e.RenderingIntentFlag=e.PromiseCapability=e.PermissionFlag=e.PasswordResponses=e.PasswordException=e.PageActionEventType=e.OPS=e.MissingPDFException=e.MAX_IMAGE_SIZE_TO_CACHE=e.LINE_FACTOR=e.LINE_DESCENT_FACTOR=e.InvalidPDFException=e.ImageKind=e.IDENTITY_MATRIX=e.FormatError=e.FeatureTest=e.FONT_IDENTITY_MATRIX=e.DocumentActionEventType=e.CMapCompressionType=e.BaseException=e.BASELINE_FACTOR=e.AnnotationType=e.AnnotationReplyType=e.AnnotationMode=e.AnnotationFlag=e.AnnotationFieldFlag=e.AnnotationEditorType=e.AnnotationEditorPrefix=e.AnnotationEditorParamsType=e.AnnotationBorderStyleType=e.AnnotationActionEventType=e.AbortException=void 0,e.assert=Q,e.bytesToString=me,e.createValidAbsoluteUrl=de,e.getModificationDate=Re,e.getUuid=Ke,e.getVerbosityLevel=q,e.info=te,e.isArrayBuffer=Be,e.isArrayEqual=Ge,e.isNodeJS=void 0,e.normalizeUnicode=Ze,e.objectFromMap=ye,e.objectSize=ie,e.setVerbosityLevel=j,e.shadow=U,e.string32=Ae,e.stringToBytes=he,e.stringToPDFString=be,e.stringToUTF8String=fe,e.unreachable=z,e.utf8StringToString=Ee,e.warn=F,t(2),t(84),t(86),t(87),t(89),t(93),t(101),t(102),t(105),t(107),t(109),t(113),t(116),t(123);const n=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");e.isNodeJS=n;const s=[1,0,0,1,0,0];e.IDENTITY_MATRIX=s;const i=[.001,0,0,.001,0,0];e.FONT_IDENTITY_MATRIX=i;const a=1e7;e.MAX_IMAGE_SIZE_TO_CACHE=a;const o=1.35;e.LINE_FACTOR=o;const c=.35;e.LINE_DESCENT_FACTOR=c;const l=c/o;e.BASELINE_FACTOR=l;const u={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};e.RenderingIntentFlag=u;const d={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};e.AnnotationMode=d;const m="pdfjs_internal_editor_";e.AnnotationEditorPrefix=m;const y={DISABLE:-1,NONE:0,FREETEXT:3,STAMP:13,INK:15};e.AnnotationEditorType=y;const h={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23};e.AnnotationEditorParamsType=h;const p={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};e.PermissionFlag=p;const f={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};e.TextRenderingMode=f;const v={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};e.ImageKind=v;const _={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};e.AnnotationType=_;const O={GROUP:"Group",REPLY:"R"};e.AnnotationReplyType=O;const k={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};e.AnnotationFlag=k;const g={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};e.AnnotationFieldFlag=g;const b={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};e.AnnotationBorderStyleType=b;const N={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};e.AnnotationActionEventType=N;const S={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};e.DocumentActionEventType=S;const T={O:"PageOpen",C:"PageClose"};e.PageActionEventType=T;const M={ERRORS:0,WARNINGS:1,INFOS:5};e.VerbosityLevel=M;const P={NONE:0,BINARY:1};e.CMapCompressionType=P;const $={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};e.OPS=$;const K={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};e.PasswordResponses=K;let L=M.WARNINGS;function j(we){Number.isInteger(we)&&(L=we)}function q(){return L}function te(we){L>=M.INFOS&&console.log(`Info: ${we}`)}function F(we){L>=M.WARNINGS&&console.log(`Warning: ${we}`)}function z(we){throw new Error(we)}function Q(we,ue){we||z(ue)}function ne(we){switch(we==null?void 0:we.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function de(we){let ue=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,ae=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(!we)return null;try{if(ae&&typeof we=="string"){if(ae.addDefaultProtocol&&we.startsWith("www.")){const $e=we.match(/\./g);($e==null?void 0:$e.length)>=2&&(we=`http://${we}`)}if(ae.tryConvertEncoding)try{we=fe(we)}catch{}}const ze=ue?new URL(we,ue):new URL(we);if(ne(ze))return ze}catch{}return null}function U(we,ue,ae){let ze=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;return Object.defineProperty(we,ue,{value:ae,enumerable:!ze,configurable:!0,writable:!1}),ae}const w=function(){function ue(ae,ze){this.constructor===ue&&z("Cannot initialize BaseException."),this.message=ae,this.name=ze}return ue.prototype=new Error,ue.constructor=ue,ue}();e.BaseException=w;class x extends w{constructor(ue,ae){super(ue,"PasswordException"),this.code=ae}}e.PasswordException=x;class R extends w{constructor(ue,ae){super(ue,"UnknownErrorException"),this.details=ae}}e.UnknownErrorException=R;class V extends w{constructor(ue){super(ue,"InvalidPDFException")}}e.InvalidPDFException=V;class D extends w{constructor(ue){super(ue,"MissingPDFException")}}e.MissingPDFException=D;class Y extends w{constructor(ue,ae){super(ue,"UnexpectedResponseException"),this.status=ae}}e.UnexpectedResponseException=Y;class W extends w{constructor(ue){super(ue,"FormatError")}}e.FormatError=W;class ee extends w{constructor(ue){super(ue,"AbortException")}}e.AbortException=ee;function me(we){(typeof we!="object"||(we==null?void 0:we.length)===void 0)&&z("Invalid argument for bytesToString");const ue=we.length,ae=8192;if(ue<ae)return String.fromCharCode.apply(null,we);const ze=[];for(let $e=0;$e<ue;$e+=ae){const nt=Math.min($e+ae,ue),ve=we.subarray($e,nt);ze.push(String.fromCharCode.apply(null,ve))}return ze.join("")}function he(we){typeof we!="string"&&z("Invalid argument for stringToBytes");const ue=we.length,ae=new Uint8Array(ue);for(let ze=0;ze<ue;++ze)ae[ze]=we.charCodeAt(ze)&255;return ae}function Ae(we){return String.fromCharCode(we>>24&255,we>>16&255,we>>8&255,we&255)}function ie(we){return Object.keys(we).length}function ye(we){const ue=Object.create(null);for(const[ae,ze]of we)ue[ae]=ze;return ue}function xe(){const we=new Uint8Array(4);return we[0]=1,new Uint32Array(we.buffer,0,1)[0]===1}function Ve(){try{return new Function(""),!0}catch{return!1}}class We{static get isLittleEndian(){return U(this,"isLittleEndian",xe())}static get isEvalSupported(){return U(this,"isEvalSupported",Ve())}static get isOffscreenCanvasSupported(){return U(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?U(this,"platform",{isWin:!1,isMac:!1}):U(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}static get isCSSRoundSupported(){var ue,ae;return U(this,"isCSSRoundSupported",(ae=(ue=globalThis.CSS)==null?void 0:ue.supports)==null?void 0:ae.call(ue,"width: round(1.5px, 1px)"))}}e.FeatureTest=We;const Pe=[...Array(256).keys()].map(we=>we.toString(16).padStart(2,"0"));class He{static makeHexColor(ue,ae,ze){return`#${Pe[ue]}${Pe[ae]}${Pe[ze]}`}static scaleMinMax(ue,ae){let ze;ue[0]?(ue[0]<0&&(ze=ae[0],ae[0]=ae[1],ae[1]=ze),ae[0]*=ue[0],ae[1]*=ue[0],ue[3]<0&&(ze=ae[2],ae[2]=ae[3],ae[3]=ze),ae[2]*=ue[3],ae[3]*=ue[3]):(ze=ae[0],ae[0]=ae[2],ae[2]=ze,ze=ae[1],ae[1]=ae[3],ae[3]=ze,ue[1]<0&&(ze=ae[2],ae[2]=ae[3],ae[3]=ze),ae[2]*=ue[1],ae[3]*=ue[1],ue[2]<0&&(ze=ae[0],ae[0]=ae[1],ae[1]=ze),ae[0]*=ue[2],ae[1]*=ue[2]),ae[0]+=ue[4],ae[1]+=ue[4],ae[2]+=ue[5],ae[3]+=ue[5]}static transform(ue,ae){return[ue[0]*ae[0]+ue[2]*ae[1],ue[1]*ae[0]+ue[3]*ae[1],ue[0]*ae[2]+ue[2]*ae[3],ue[1]*ae[2]+ue[3]*ae[3],ue[0]*ae[4]+ue[2]*ae[5]+ue[4],ue[1]*ae[4]+ue[3]*ae[5]+ue[5]]}static applyTransform(ue,ae){const ze=ue[0]*ae[0]+ue[1]*ae[2]+ae[4],$e=ue[0]*ae[1]+ue[1]*ae[3]+ae[5];return[ze,$e]}static applyInverseTransform(ue,ae){const ze=ae[0]*ae[3]-ae[1]*ae[2],$e=(ue[0]*ae[3]-ue[1]*ae[2]+ae[2]*ae[5]-ae[4]*ae[3])/ze,nt=(-ue[0]*ae[1]+ue[1]*ae[0]+ae[4]*ae[1]-ae[5]*ae[0])/ze;return[$e,nt]}static getAxialAlignedBoundingBox(ue,ae){const ze=this.applyTransform(ue,ae),$e=this.applyTransform(ue.slice(2,4),ae),nt=this.applyTransform([ue[0],ue[3]],ae),ve=this.applyTransform([ue[2],ue[1]],ae);return[Math.min(ze[0],$e[0],nt[0],ve[0]),Math.min(ze[1],$e[1],nt[1],ve[1]),Math.max(ze[0],$e[0],nt[0],ve[0]),Math.max(ze[1],$e[1],nt[1],ve[1])]}static inverseTransform(ue){const ae=ue[0]*ue[3]-ue[1]*ue[2];return[ue[3]/ae,-ue[1]/ae,-ue[2]/ae,ue[0]/ae,(ue[2]*ue[5]-ue[4]*ue[3])/ae,(ue[4]*ue[1]-ue[5]*ue[0])/ae]}static singularValueDecompose2dScale(ue){const ae=[ue[0],ue[2],ue[1],ue[3]],ze=ue[0]*ae[0]+ue[1]*ae[2],$e=ue[0]*ae[1]+ue[1]*ae[3],nt=ue[2]*ae[0]+ue[3]*ae[2],ve=ue[2]*ae[1]+ue[3]*ae[3],re=(ze+ve)/2,_e=Math.sqrt((ze+ve)**2-4*(ze*ve-nt*$e))/2,Le=re+_e||1,Te=re-_e||1;return[Math.sqrt(Le),Math.sqrt(Te)]}static normalizeRect(ue){const ae=ue.slice(0);return ue[0]>ue[2]&&(ae[0]=ue[2],ae[2]=ue[0]),ue[1]>ue[3]&&(ae[1]=ue[3],ae[3]=ue[1]),ae}static intersect(ue,ae){const ze=Math.max(Math.min(ue[0],ue[2]),Math.min(ae[0],ae[2])),$e=Math.min(Math.max(ue[0],ue[2]),Math.max(ae[0],ae[2]));if(ze>$e)return null;const nt=Math.max(Math.min(ue[1],ue[3]),Math.min(ae[1],ae[3])),ve=Math.min(Math.max(ue[1],ue[3]),Math.max(ae[1],ae[3]));return nt>ve?null:[ze,nt,$e,ve]}static bezierBoundingBox(ue,ae,ze,$e,nt,ve,re,_e){const Le=[],Te=[[],[]];let G,I,Z,H,J,ce,ke,X;for(let Oe=0;Oe<2;++Oe){if(Oe===0?(I=6*ue-12*ze+6*nt,G=-3*ue+9*ze-9*nt+3*re,Z=3*ze-3*ue):(I=6*ae-12*$e+6*ve,G=-3*ae+9*$e-9*ve+3*_e,Z=3*$e-3*ae),Math.abs(G)<1e-12){if(Math.abs(I)<1e-12)continue;H=-Z/I,0<H&&H<1&&Le.push(H);continue}ke=I*I-4*Z*G,X=Math.sqrt(ke),!(ke<0)&&(J=(-I+X)/(2*G),0<J&&J<1&&Le.push(J),ce=(-I-X)/(2*G),0<ce&&ce<1&&Le.push(ce))}let oe=Le.length,pe;const De=oe;for(;oe--;)H=Le[oe],pe=1-H,Te[0][oe]=pe*pe*pe*ue+3*pe*pe*H*ze+3*pe*H*H*nt+H*H*H*re,Te[1][oe]=pe*pe*pe*ae+3*pe*pe*H*$e+3*pe*H*H*ve+H*H*H*_e;return Te[0][De]=ue,Te[1][De]=ae,Te[0][De+1]=re,Te[1][De+1]=_e,Te[0].length=Te[1].length=De+2,[Math.min(...Te[0]),Math.min(...Te[1]),Math.max(...Te[0]),Math.max(...Te[1])]}}e.Util=He;const Me=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function be(we){if(we[0]>="ï"){let ae;if(we[0]==="þ"&&we[1]==="ÿ"?ae="utf-16be":we[0]==="ÿ"&&we[1]==="þ"?ae="utf-16le":we[0]==="ï"&&we[1]==="»"&&we[2]==="¿"&&(ae="utf-8"),ae)try{const ze=new TextDecoder(ae,{fatal:!0}),$e=he(we);return ze.decode($e)}catch(ze){F(`stringToPDFString: "${ze}".`)}}const ue=[];for(let ae=0,ze=we.length;ae<ze;ae++){const $e=Me[we.charCodeAt(ae)];ue.push($e?String.fromCharCode($e):we.charAt(ae))}return ue.join("")}function fe(we){return decodeURIComponent(escape(we))}function Ee(we){return unescape(encodeURIComponent(we))}function Be(we){return typeof we=="object"&&(we==null?void 0:we.byteLength)!==void 0}function Ge(we,ue){if(we.length!==ue.length)return!1;for(let ae=0,ze=we.length;ae<ze;ae++)if(we[ae]!==ue[ae])return!1;return!0}function Re(){let we=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new Date;return[we.getUTCFullYear().toString(),(we.getUTCMonth()+1).toString().padStart(2,"0"),we.getUTCDate().toString().padStart(2,"0"),we.getUTCHours().toString().padStart(2,"0"),we.getUTCMinutes().toString().padStart(2,"0"),we.getUTCSeconds().toString().padStart(2,"0")].join("")}class Ce{constructor(){se(this,qe,!1);this.promise=new Promise((ue,ae)=>{this.resolve=ze=>{Se(this,qe,!0),ue(ze)},this.reject=ze=>{Se(this,qe,!0),ae(ze)}})}get settled(){return E(this,qe)}}qe=new WeakMap,e.PromiseCapability=Ce;let Ie=null,ge=null;function Ze(we){return Ie||(Ie=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,ge=new Map([["ﬅ","ſt"]])),we.replaceAll(Ie,(ue,ae,ze)=>ae?ae.normalize("NFKC"):ge.get(ze))}function Ke(){if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const we=new Uint8Array(32);if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(we);else for(let ue=0;ue<32;ue++)we[ue]=Math.floor(Math.random()*255);return me(we)}},(r,e,t)=>{var n=t(3),s=t(4),i=t(69),a=t(70),o="WebAssembly",c=s[o],l=Error("e",{cause:7}).cause!==7,u=function(m,y){var h={};h[m]=a(m,y,l),n({global:!0,constructor:!0,arity:1,forced:l},h)},d=function(m,y){if(c&&c[m]){var h={};h[m]=a(o+"."+m,y,l),n({target:o,stat:!0,constructor:!0,arity:1,forced:l},h)}};u("Error",function(m){return function(h){return i(m,this,arguments)}}),u("EvalError",function(m){return function(h){return i(m,this,arguments)}}),u("RangeError",function(m){return function(h){return i(m,this,arguments)}}),u("ReferenceError",function(m){return function(h){return i(m,this,arguments)}}),u("SyntaxError",function(m){return function(h){return i(m,this,arguments)}}),u("TypeError",function(m){return function(h){return i(m,this,arguments)}}),u("URIError",function(m){return function(h){return i(m,this,arguments)}}),d("CompileError",function(m){return function(h){return i(m,this,arguments)}}),d("LinkError",function(m){return function(h){return i(m,this,arguments)}}),d("RuntimeError",function(m){return function(h){return i(m,this,arguments)}})},(r,e,t)=>{var n=t(4),s=t(5).f,i=t(44),a=t(48),o=t(38),c=t(56),l=t(68);r.exports=function(u,d){var m=u.target,y=u.global,h=u.stat,p,f,v,_,O,k;if(y?f=n:h?f=n[m]||o(m,{}):f=(n[m]||{}).prototype,f)for(v in d){if(O=d[v],u.dontCallGetSet?(k=s(f,v),_=k&&k.value):_=f[v],p=l(y?v:m+(h?".":"#")+v,u.forced),!p&&_!==void 0){if(typeof O==typeof _)continue;c(O,_)}(u.sham||_&&_.sham)&&i(O,"sham",!0),a(f,v,O,u)}}},function(r){var e=function(t){return t&&t.Math===Math&&t};r.exports=e(typeof globalThis=="object"&&globalThis)||e(typeof window=="object"&&window)||e(typeof self=="object"&&self)||e(typeof commonjsGlobal=="object"&&commonjsGlobal)||function(){return this}()||this||Function("return this")()},(r,e,t)=>{var n=t(6),s=t(8),i=t(10),a=t(11),o=t(12),c=t(18),l=t(39),u=t(42),d=Object.getOwnPropertyDescriptor;e.f=n?d:function(y,h){if(y=o(y),h=c(h),u)try{return d(y,h)}catch{}if(l(y,h))return a(!s(i.f,y,h),y[h])}},(r,e,t)=>{var n=t(7);r.exports=!n(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7})},r=>{r.exports=function(e){try{return!!e()}catch{return!0}}},(r,e,t)=>{var n=t(9),s=Function.prototype.call;r.exports=n?s.bind(s):function(){return s.apply(s,arguments)}},(r,e,t)=>{var n=t(7);r.exports=!n(function(){var s=(function(){}).bind();return typeof s!="function"||s.hasOwnProperty("prototype")})},(r,e)=>{var t={}.propertyIsEnumerable,n=Object.getOwnPropertyDescriptor,s=n&&!t.call({1:2},1);e.f=s?function(a){var o=n(this,a);return!!o&&o.enumerable}:t},r=>{r.exports=function(e,t){return{enumerable:!(e&1),configurable:!(e&2),writable:!(e&4),value:t}}},(r,e,t)=>{var n=t(13),s=t(16);r.exports=function(i){return n(s(i))}},(r,e,t)=>{var n=t(14),s=t(7),i=t(15),a=Object,o=n("".split);r.exports=s(function(){return!a("z").propertyIsEnumerable(0)})?function(c){return i(c)==="String"?o(c,""):a(c)}:a},(r,e,t)=>{var n=t(9),s=Function.prototype,i=s.call,a=n&&s.bind.bind(i,i);r.exports=n?a:function(o){return function(){return i.apply(o,arguments)}}},(r,e,t)=>{var n=t(14),s=n({}.toString),i=n("".slice);r.exports=function(a){return i(s(a),8,-1)}},(r,e,t)=>{var n=t(17),s=TypeError;r.exports=function(i){if(n(i))throw s("Can't call method on "+i);return i}},r=>{r.exports=function(e){return e==null}},(r,e,t)=>{var n=t(19),s=t(23);r.exports=function(i){var a=n(i,"string");return s(a)?a:a+""}},(r,e,t)=>{var n=t(8),s=t(20),i=t(23),a=t(30),o=t(33),c=t(34),l=TypeError,u=c("toPrimitive");r.exports=function(d,m){if(!s(d)||i(d))return d;var y=a(d,u),h;if(y){if(m===void 0&&(m="default"),h=n(y,d,m),!s(h)||i(h))return h;throw l("Can't convert object to primitive value")}return m===void 0&&(m="number"),o(d,m)}},(r,e,t)=>{var n=t(21),s=t(22),i=s.all;r.exports=s.IS_HTMLDDA?function(a){return typeof a=="object"?a!==null:n(a)||a===i}:function(a){return typeof a=="object"?a!==null:n(a)}},(r,e,t)=>{var n=t(22),s=n.all;r.exports=n.IS_HTMLDDA?function(i){return typeof i=="function"||i===s}:function(i){return typeof i=="function"}},r=>{var e=typeof document=="object"&&document.all,t=typeof e>"u"&&e!==void 0;r.exports={all:e,IS_HTMLDDA:t}},(r,e,t)=>{var n=t(24),s=t(21),i=t(25),a=t(26),o=Object;r.exports=a?function(c){return typeof c=="symbol"}:function(c){var l=n("Symbol");return s(l)&&i(l.prototype,o(c))}},(r,e,t)=>{var n=t(4),s=t(21),i=function(a){return s(a)?a:void 0};r.exports=function(a,o){return arguments.length<2?i(n[a]):n[a]&&n[a][o]}},(r,e,t)=>{var n=t(14);r.exports=n({}.isPrototypeOf)},(r,e,t)=>{var n=t(27);r.exports=n&&!Symbol.sham&&typeof Symbol.iterator=="symbol"},(r,e,t)=>{var n=t(28),s=t(7),i=t(4),a=i.String;r.exports=!!Object.getOwnPropertySymbols&&!s(function(){var o=Symbol("symbol detection");return!a(o)||!(Object(o)instanceof Symbol)||!Symbol.sham&&n&&n<41})},(r,e,t)=>{var n=t(4),s=t(29),i=n.process,a=n.Deno,o=i&&i.versions||a&&a.version,c=o&&o.v8,l,u;c&&(l=c.split("."),u=l[0]>0&&l[0]<4?1:+(l[0]+l[1])),!u&&s&&(l=s.match(/Edge\/(\d+)/),(!l||l[1]>=74)&&(l=s.match(/Chrome\/(\d+)/),l&&(u=+l[1]))),r.exports=u},r=>{r.exports=typeof navigator<"u"&&String(navigator.userAgent)||""},(r,e,t)=>{var n=t(31),s=t(17);r.exports=function(i,a){var o=i[a];return s(o)?void 0:n(o)}},(r,e,t)=>{var n=t(21),s=t(32),i=TypeError;r.exports=function(a){if(n(a))return a;throw i(s(a)+" is not a function")}},r=>{var e=String;r.exports=function(t){try{return e(t)}catch{return"Object"}}},(r,e,t)=>{var n=t(8),s=t(21),i=t(20),a=TypeError;r.exports=function(o,c){var l,u;if(c==="string"&&s(l=o.toString)&&!i(u=n(l,o))||s(l=o.valueOf)&&!i(u=n(l,o))||c!=="string"&&s(l=o.toString)&&!i(u=n(l,o)))return u;throw a("Can't convert object to primitive value")}},(r,e,t)=>{var n=t(4),s=t(35),i=t(39),a=t(41),o=t(27),c=t(26),l=n.Symbol,u=s("wks"),d=c?l.for||l:l&&l.withoutSetter||a;r.exports=function(m){return i(u,m)||(u[m]=o&&i(l,m)?l[m]:d("Symbol."+m)),u[m]}},(r,e,t)=>{var n=t(36),s=t(37);(r.exports=function(i,a){return s[i]||(s[i]=a!==void 0?a:{})})("versions",[]).push({version:"3.32.1",mode:n?"pure":"global",copyright:"© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.32.1/LICENSE",source:"https://github.com/zloirock/core-js"})},r=>{r.exports=!1},(r,e,t)=>{var n=t(4),s=t(38),i="__core-js_shared__",a=n[i]||s(i,{});r.exports=a},(r,e,t)=>{var n=t(4),s=Object.defineProperty;r.exports=function(i,a){try{s(n,i,{value:a,configurable:!0,writable:!0})}catch{n[i]=a}return a}},(r,e,t)=>{var n=t(14),s=t(40),i=n({}.hasOwnProperty);r.exports=Object.hasOwn||function(o,c){return i(s(o),c)}},(r,e,t)=>{var n=t(16),s=Object;r.exports=function(i){return s(n(i))}},(r,e,t)=>{var n=t(14),s=0,i=Math.random(),a=n(1 .toString);r.exports=function(o){return"Symbol("+(o===void 0?"":o)+")_"+a(++s+i,36)}},(r,e,t)=>{var n=t(6),s=t(7),i=t(43);r.exports=!n&&!s(function(){return Object.defineProperty(i("div"),"a",{get:function(){return 7}}).a!==7})},(r,e,t)=>{var n=t(4),s=t(20),i=n.document,a=s(i)&&s(i.createElement);r.exports=function(o){return a?i.createElement(o):{}}},(r,e,t)=>{var n=t(6),s=t(45),i=t(11);r.exports=n?function(a,o,c){return s.f(a,o,i(1,c))}:function(a,o,c){return a[o]=c,a}},(r,e,t)=>{var n=t(6),s=t(42),i=t(46),a=t(47),o=t(18),c=TypeError,l=Object.defineProperty,u=Object.getOwnPropertyDescriptor,d="enumerable",m="configurable",y="writable";e.f=n?i?function(p,f,v){if(a(p),f=o(f),a(v),typeof p=="function"&&f==="prototype"&&"value"in v&&y in v&&!v[y]){var _=u(p,f);_&&_[y]&&(p[f]=v.value,v={configurable:m in v?v[m]:_[m],enumerable:d in v?v[d]:_[d],writable:!1})}return l(p,f,v)}:l:function(p,f,v){if(a(p),f=o(f),a(v),s)try{return l(p,f,v)}catch{}if("get"in v||"set"in v)throw c("Accessors not supported");return"value"in v&&(p[f]=v.value),p}},(r,e,t)=>{var n=t(6),s=t(7);r.exports=n&&s(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42})},(r,e,t)=>{var n=t(20),s=String,i=TypeError;r.exports=function(a){if(n(a))return a;throw i(s(a)+" is not an object")}},(r,e,t)=>{var n=t(21),s=t(45),i=t(49),a=t(38);r.exports=function(o,c,l,u){u||(u={});var d=u.enumerable,m=u.name!==void 0?u.name:c;if(n(l)&&i(l,m,u),u.global)d?o[c]=l:a(c,l);else{try{u.unsafe?o[c]&&(d=!0):delete o[c]}catch{}d?o[c]=l:s.f(o,c,{value:l,enumerable:!1,configurable:!u.nonConfigurable,writable:!u.nonWritable})}return o}},(r,e,t)=>{var n=t(14),s=t(7),i=t(21),a=t(39),o=t(6),c=t(50).CONFIGURABLE,l=t(51),u=t(52),d=u.enforce,m=u.get,y=String,h=Object.defineProperty,p=n("".slice),f=n("".replace),v=n([].join),_=o&&!s(function(){return h(function(){},"length",{value:8}).length!==8}),O=String(String).split("String"),k=r.exports=function(g,b,N){p(y(b),0,7)==="Symbol("&&(b="["+f(y(b),/^Symbol\(([^)]*)\)/,"$1")+"]"),N&&N.getter&&(b="get "+b),N&&N.setter&&(b="set "+b),(!a(g,"name")||c&&g.name!==b)&&(o?h(g,"name",{value:b,configurable:!0}):g.name=b),_&&N&&a(N,"arity")&&g.length!==N.arity&&h(g,"length",{value:N.arity});try{N&&a(N,"constructor")&&N.constructor?o&&h(g,"prototype",{writable:!1}):g.prototype&&(g.prototype=void 0)}catch{}var S=d(g);return a(S,"source")||(S.source=v(O,typeof b=="string"?b:"")),g};Function.prototype.toString=k(function(){return i(this)&&m(this).source||l(this)},"toString")},(r,e,t)=>{var n=t(6),s=t(39),i=Function.prototype,a=n&&Object.getOwnPropertyDescriptor,o=s(i,"name"),c=o&&(function(){}).name==="something",l=o&&(!n||n&&a(i,"name").configurable);r.exports={EXISTS:o,PROPER:c,CONFIGURABLE:l}},(r,e,t)=>{var n=t(14),s=t(21),i=t(37),a=n(Function.toString);s(i.inspectSource)||(i.inspectSource=function(o){return a(o)}),r.exports=i.inspectSource},(r,e,t)=>{var n=t(53),s=t(4),i=t(20),a=t(44),o=t(39),c=t(37),l=t(54),u=t(55),d="Object already initialized",m=s.TypeError,y=s.WeakMap,h,p,f,v=function(g){return f(g)?p(g):h(g,{})},_=function(g){return function(b){var N;if(!i(b)||(N=p(b)).type!==g)throw m("Incompatible receiver, "+g+" required");return N}};if(n||c.state){var O=c.state||(c.state=new y);O.get=O.get,O.has=O.has,O.set=O.set,h=function(g,b){if(O.has(g))throw m(d);return b.facade=g,O.set(g,b),b},p=function(g){return O.get(g)||{}},f=function(g){return O.has(g)}}else{var k=l("state");u[k]=!0,h=function(g,b){if(o(g,k))throw m(d);return b.facade=g,a(g,k,b),b},p=function(g){return o(g,k)?g[k]:{}},f=function(g){return o(g,k)}}r.exports={set:h,get:p,has:f,enforce:v,getterFor:_}},(r,e,t)=>{var n=t(4),s=t(21),i=n.WeakMap;r.exports=s(i)&&/native code/.test(String(i))},(r,e,t)=>{var n=t(35),s=t(41),i=n("keys");r.exports=function(a){return i[a]||(i[a]=s(a))}},r=>{r.exports={}},(r,e,t)=>{var n=t(39),s=t(57),i=t(5),a=t(45);r.exports=function(o,c,l){for(var u=s(c),d=a.f,m=i.f,y=0;y<u.length;y++){var h=u[y];!n(o,h)&&!(l&&n(l,h))&&d(o,h,m(c,h))}}},(r,e,t)=>{var n=t(24),s=t(14),i=t(58),a=t(67),o=t(47),c=s([].concat);r.exports=n("Reflect","ownKeys")||function(u){var d=i.f(o(u)),m=a.f;return m?c(d,m(u)):d}},(r,e,t)=>{var n=t(59),s=t(66),i=s.concat("length","prototype");e.f=Object.getOwnPropertyNames||function(o){return n(o,i)}},(r,e,t)=>{var n=t(14),s=t(39),i=t(12),a=t(60).indexOf,o=t(55),c=n([].push);r.exports=function(l,u){var d=i(l),m=0,y=[],h;for(h in d)!s(o,h)&&s(d,h)&&c(y,h);for(;u.length>m;)s(d,h=u[m++])&&(~a(y,h)||c(y,h));return y}},(r,e,t)=>{var n=t(12),s=t(61),i=t(64),a=function(o){return function(c,l,u){var d=n(c),m=i(d),y=s(u,m),h;if(o&&l!==l){for(;m>y;)if(h=d[y++],h!==h)return!0}else for(;m>y;y++)if((o||y in d)&&d[y]===l)return o||y||0;return!o&&-1}};r.exports={includes:a(!0),indexOf:a(!1)}},(r,e,t)=>{var n=t(62),s=Math.max,i=Math.min;r.exports=function(a,o){var c=n(a);return c<0?s(c+o,0):i(c,o)}},(r,e,t)=>{var n=t(63);r.exports=function(s){var i=+s;return i!==i||i===0?0:n(i)}},r=>{var e=Math.ceil,t=Math.floor;r.exports=Math.trunc||function(s){var i=+s;return(i>0?t:e)(i)}},(r,e,t)=>{var n=t(65);r.exports=function(s){return n(s.length)}},(r,e,t)=>{var n=t(62),s=Math.min;r.exports=function(i){return i>0?s(n(i),9007199254740991):0}},r=>{r.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},(r,e)=>{e.f=Object.getOwnPropertySymbols},(r,e,t)=>{var n=t(7),s=t(21),i=/#|\.prototype\./,a=function(d,m){var y=c[o(d)];return y===u?!0:y===l?!1:s(m)?n(m):!!m},o=a.normalize=function(d){return String(d).replace(i,".").toLowerCase()},c=a.data={},l=a.NATIVE="N",u=a.POLYFILL="P";r.exports=a},(r,e,t)=>{var n=t(9),s=Function.prototype,i=s.apply,a=s.call;r.exports=typeof Reflect=="object"&&Reflect.apply||(n?a.bind(i):function(){return a.apply(i,arguments)})},(r,e,t)=>{var n=t(24),s=t(39),i=t(44),a=t(25),o=t(71),c=t(56),l=t(74),u=t(75),d=t(76),m=t(80),y=t(81),h=t(6),p=t(36);r.exports=function(f,v,_,O){var k="stackTraceLimit",g=O?2:1,b=f.split("."),N=b[b.length-1],S=n.apply(null,b);if(S){var T=S.prototype;if(!p&&s(T,"cause")&&delete T.cause,!_)return S;var M=n("Error"),P=v(function($,K){var L=d(O?K:$,void 0),j=O?new S($):new S;return L!==void 0&&i(j,"message",L),y(j,P,j.stack,2),this&&a(T,this)&&u(j,this,P),arguments.length>g&&m(j,arguments[g]),j});if(P.prototype=T,N!=="Error"?o?o(P,M):c(P,M,{name:!0}):h&&k in S&&(l(P,S,k),l(P,S,"prepareStackTrace")),c(P,S),!p)try{T.name!==N&&i(T,"name",N),T.constructor=P}catch{}return P}}},(r,e,t)=>{var n=t(72),s=t(47),i=t(73);r.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var a=!1,o={},c;try{c=n(Object.prototype,"__proto__","set"),c(o,[]),a=o instanceof Array}catch{}return function(u,d){return s(u),i(d),a?c(u,d):u.__proto__=d,u}}():void 0)},(r,e,t)=>{var n=t(14),s=t(31);r.exports=function(i,a,o){try{return n(s(Object.getOwnPropertyDescriptor(i,a)[o]))}catch{}}},(r,e,t)=>{var n=t(21),s=String,i=TypeError;r.exports=function(a){if(typeof a=="object"||n(a))return a;throw i("Can't set "+s(a)+" as a prototype")}},(r,e,t)=>{var n=t(45).f;r.exports=function(s,i,a){a in s||n(s,a,{configurable:!0,get:function(){return i[a]},set:function(o){i[a]=o}})}},(r,e,t)=>{var n=t(21),s=t(20),i=t(71);r.exports=function(a,o,c){var l,u;return i&&n(l=o.constructor)&&l!==c&&s(u=l.prototype)&&u!==c.prototype&&i(a,u),a}},(r,e,t)=>{var n=t(77);r.exports=function(s,i){return s===void 0?arguments.length<2?"":i:n(s)}},(r,e,t)=>{var n=t(78),s=String;r.exports=function(i){if(n(i)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return s(i)}},(r,e,t)=>{var n=t(79),s=t(21),i=t(15),a=t(34),o=a("toStringTag"),c=Object,l=i(function(){return arguments}())==="Arguments",u=function(d,m){try{return d[m]}catch{}};r.exports=n?i:function(d){var m,y,h;return d===void 0?"Undefined":d===null?"Null":typeof(y=u(m=c(d),o))=="string"?y:l?i(m):(h=i(m))==="Object"&&s(m.callee)?"Arguments":h}},(r,e,t)=>{var n=t(34),s=n("toStringTag"),i={};i[s]="z",r.exports=String(i)==="[object z]"},(r,e,t)=>{var n=t(20),s=t(44);r.exports=function(i,a){n(a)&&"cause"in a&&s(i,"cause",a.cause)}},(r,e,t)=>{var n=t(44),s=t(82),i=t(83),a=Error.captureStackTrace;r.exports=function(o,c,l,u){i&&(a?a(o,c):n(o,"stack",s(l,u)))}},(r,e,t)=>{var n=t(14),s=Error,i=n("".replace),a=function(l){return String(s(l).stack)}("zxcasd"),o=/\n\s*at [^:]*:[^\n]*/,c=o.test(a);r.exports=function(l,u){if(c&&typeof l=="string"&&!s.prepareStackTrace)for(;u--;)l=i(l,o,"");return l}},(r,e,t)=>{var n=t(7),s=t(11);r.exports=!n(function(){var i=Error("a");return"stack"in i?(Object.defineProperty(i,"stack",s(1,7)),i.stack!==7):!0})},(r,e,t)=>{var n=t(48),s=t(14),i=t(77),a=t(85),o=URLSearchParams,c=o.prototype,l=s(c.append),u=s(c.delete),d=s(c.forEach),m=s([].push),y=new o("a=1&a=2&b=3");y.delete("a",1),y.delete("b",void 0),y+""!="a=2"&&n(c,"delete",function(h){var p=arguments.length,f=p<2?void 0:arguments[1];if(p&&f===void 0)return u(this,h);var v=[];d(this,function(T,M){m(v,{key:M,value:T})}),a(p,1);for(var _=i(h),O=i(f),k=0,g=0,b=!1,N=v.length,S;k<N;)S=v[k++],b||S.key===_?(b=!0,u(this,S.key)):g++;for(;g<N;)S=v[g++],S.key===_&&S.value===O||l(this,S.key,S.value)},{enumerable:!0,unsafe:!0})},r=>{var e=TypeError;r.exports=function(t,n){if(t<n)throw e("Not enough arguments");return t}},(r,e,t)=>{var n=t(48),s=t(14),i=t(77),a=t(85),o=URLSearchParams,c=o.prototype,l=s(c.getAll),u=s(c.has),d=new o("a=1");(d.has("a",2)||!d.has("a",void 0))&&n(c,"has",function(y){var h=arguments.length,p=h<2?void 0:arguments[1];if(h&&p===void 0)return u(this,y);var f=l(this,y);a(h,1);for(var v=i(p),_=0;_<f.length;)if(f[_++]===v)return!0;return!1},{enumerable:!0,unsafe:!0})},(r,e,t)=>{var n=t(6),s=t(14),i=t(88),a=URLSearchParams.prototype,o=s(a.forEach);n&&!("size"in a)&&i(a,"size",{get:function(){var l=0;return o(this,function(){l++}),l},configurable:!0,enumerable:!0})},(r,e,t)=>{var n=t(49),s=t(45);r.exports=function(i,a,o){return o.get&&n(o.get,a,{getter:!0}),o.set&&n(o.set,a,{setter:!0}),s.f(i,a,o)}},(r,e,t)=>{var n=t(3),s=t(40),i=t(64),a=t(90),o=t(92),c=t(7),l=c(function(){return[].push.call({length:4294967296},1)!==4294967297}),u=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(m){return m instanceof TypeError}},d=l||!u();n({target:"Array",proto:!0,arity:1,forced:d},{push:function(y){var h=s(this),p=i(h),f=arguments.length;o(p+f);for(var v=0;v<f;v++)h[p]=arguments[v],p++;return a(h,p),p}})},(r,e,t)=>{var n=t(6),s=t(91),i=TypeError,a=Object.getOwnPropertyDescriptor,o=n&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(c){return c instanceof TypeError}}();r.exports=o?function(c,l){if(s(c)&&!a(c,"length").writable)throw i("Cannot set read only .length");return c.length=l}:function(c,l){return c.length=l}},(r,e,t)=>{var n=t(15);r.exports=Array.isArray||function(i){return n(i)==="Array"}},r=>{var e=TypeError,t=9007199254740991;r.exports=function(n){if(n>t)throw e("Maximum allowed index exceeded");return n}},(r,e,t)=>{var n=t(94),s=t(98).findLast,i=n.aTypedArray,a=n.exportTypedArrayMethod;a("findLast",function(c){return s(i(this),c,arguments.length>1?arguments[1]:void 0)})},(r,e,t)=>{var n=t(95),s=t(6),i=t(4),a=t(21),o=t(20),c=t(39),l=t(78),u=t(32),d=t(44),m=t(48),y=t(88),h=t(25),p=t(96),f=t(71),v=t(34),_=t(41),O=t(52),k=O.enforce,g=O.get,b=i.Int8Array,N=b&&b.prototype,S=i.Uint8ClampedArray,T=S&&S.prototype,M=b&&p(b),P=N&&p(N),$=Object.prototype,K=i.TypeError,L=v("toStringTag"),j=_("TYPED_ARRAY_TAG"),q="TypedArrayConstructor",te=n&&!!f&&l(i.opera)!=="Opera",F=!1,z,Q,ne,de={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},U={BigInt64Array:8,BigUint64Array:8},w=function(me){if(!o(me))return!1;var he=l(me);return he==="DataView"||c(de,he)||c(U,he)},x=function(ee){var me=p(ee);if(o(me)){var he=g(me);return he&&c(he,q)?he[q]:x(me)}},R=function(ee){if(!o(ee))return!1;var me=l(ee);return c(de,me)||c(U,me)},V=function(ee){if(R(ee))return ee;throw K("Target is not a typed array")},D=function(ee){if(a(ee)&&(!f||h(M,ee)))return ee;throw K(u(ee)+" is not a typed array constructor")},Y=function(ee,me,he,Ae){if(s){if(he)for(var ie in de){var ye=i[ie];if(ye&&c(ye.prototype,ee))try{delete ye.prototype[ee]}catch{try{ye.prototype[ee]=me}catch{}}}(!P[ee]||he)&&m(P,ee,he?me:te&&N[ee]||me,Ae)}},W=function(ee,me,he){var Ae,ie;if(s){if(f){if(he){for(Ae in de)if(ie=i[Ae],ie&&c(ie,ee))try{delete ie[ee]}catch{}}if(!M[ee]||he)try{return m(M,ee,he?me:te&&M[ee]||me)}catch{}else return}for(Ae in de)ie=i[Ae],ie&&(!ie[ee]||he)&&m(ie,ee,me)}};for(z in de)Q=i[z],ne=Q&&Q.prototype,ne?k(ne)[q]=Q:te=!1;for(z in U)Q=i[z],ne=Q&&Q.prototype,ne&&(k(ne)[q]=Q);if((!te||!a(M)||M===Function.prototype)&&(M=function(){throw K("Incorrect invocation")},te))for(z in de)i[z]&&f(i[z],M);if((!te||!P||P===$)&&(P=M.prototype,te))for(z in de)i[z]&&f(i[z].prototype,P);if(te&&p(T)!==P&&f(T,P),s&&!c(P,L)){F=!0,y(P,L,{configurable:!0,get:function(){return o(this)?this[j]:void 0}});for(z in de)i[z]&&d(i[z],j,z)}r.exports={NATIVE_ARRAY_BUFFER_VIEWS:te,TYPED_ARRAY_TAG:F&&j,aTypedArray:V,aTypedArrayConstructor:D,exportTypedArrayMethod:Y,exportTypedArrayStaticMethod:W,getTypedArrayConstructor:x,isView:w,isTypedArray:R,TypedArray:M,TypedArrayPrototype:P}},r=>{r.exports=typeof ArrayBuffer<"u"&&typeof DataView<"u"},(r,e,t)=>{var n=t(39),s=t(21),i=t(40),a=t(54),o=t(97),c=a("IE_PROTO"),l=Object,u=l.prototype;r.exports=o?l.getPrototypeOf:function(d){var m=i(d);if(n(m,c))return m[c];var y=m.constructor;return s(y)&&m instanceof y?y.prototype:m instanceof l?u:null}},(r,e,t)=>{var n=t(7);r.exports=!n(function(){function s(){}return s.prototype.constructor=null,Object.getPrototypeOf(new s)!==s.prototype})},(r,e,t)=>{var n=t(99),s=t(13),i=t(40),a=t(64),o=function(c){var l=c===1;return function(u,d,m){for(var y=i(u),h=s(y),p=n(d,m),f=a(h),v,_;f-- >0;)if(v=h[f],_=p(v,f,y),_)switch(c){case 0:return v;case 1:return f}return l?-1:void 0}};r.exports={findLast:o(0),findLastIndex:o(1)}},(r,e,t)=>{var n=t(100),s=t(31),i=t(9),a=n(n.bind);r.exports=function(o,c){return s(o),c===void 0?o:i?a(o,c):function(){return o.apply(c,arguments)}}},(r,e,t)=>{var n=t(15),s=t(14);r.exports=function(i){if(n(i)==="Function")return s(i)}},(r,e,t)=>{var n=t(94),s=t(98).findLastIndex,i=n.aTypedArray,a=n.exportTypedArrayMethod;a("findLastIndex",function(c){return s(i(this),c,arguments.length>1?arguments[1]:void 0)})},(r,e,t)=>{var n=t(4),s=t(8),i=t(94),a=t(64),o=t(103),c=t(40),l=t(7),u=n.RangeError,d=n.Int8Array,m=d&&d.prototype,y=m&&m.set,h=i.aTypedArray,p=i.exportTypedArrayMethod,f=!l(function(){var _=new Uint8ClampedArray(2);return s(y,_,{length:1,0:3},1),_[1]!==3}),v=f&&i.NATIVE_ARRAY_BUFFER_VIEWS&&l(function(){var _=new d(2);return _.set(1),_.set("2",1),_[0]!==0||_[1]!==2});p("set",function(O){h(this);var k=o(arguments.length>1?arguments[1]:void 0,1),g=c(O);if(f)return s(y,this,g,k);var b=this.length,N=a(g),S=0;if(N+k>b)throw u("Wrong length");for(;S<N;)this[k+S]=g[S++]},!f||v)},(r,e,t)=>{var n=t(104),s=RangeError;r.exports=function(i,a){var o=n(i);if(o%a)throw s("Wrong offset");return o}},(r,e,t)=>{var n=t(62),s=RangeError;r.exports=function(i){var a=n(i);if(a<0)throw s("The argument can't be less than 0");return a}},(r,e,t)=>{var n=t(106),s=t(94),i=s.aTypedArray,a=s.exportTypedArrayMethod,o=s.getTypedArrayConstructor;a("toReversed",function(){return n(i(this),o(this))})},(r,e,t)=>{var n=t(64);r.exports=function(s,i){for(var a=n(s),o=new i(a),c=0;c<a;c++)o[c]=s[a-c-1];return o}},(r,e,t)=>{var n=t(94),s=t(14),i=t(31),a=t(108),o=n.aTypedArray,c=n.getTypedArrayConstructor,l=n.exportTypedArrayMethod,u=s(n.TypedArrayPrototype.sort);l("toSorted",function(m){m!==void 0&&i(m);var y=o(this),h=a(c(y),y);return u(h,m)})},(r,e,t)=>{var n=t(64);r.exports=function(s,i){for(var a=0,o=n(i),c=new s(o);o>a;)c[a]=i[a++];return c}},(r,e,t)=>{var n=t(110),s=t(94),i=t(111),a=t(62),o=t(112),c=s.aTypedArray,l=s.getTypedArrayConstructor,u=s.exportTypedArrayMethod,d=!!function(){try{new Int8Array(1).with(2,{valueOf:function(){throw 8}})}catch(m){return m===8}}();u("with",function(m,y){var h=c(this),p=a(m),f=i(h)?o(y):+y;return n(h,l(h),p,f)},!d)},(r,e,t)=>{var n=t(64),s=t(62),i=RangeError;r.exports=function(a,o,c,l){var u=n(a),d=s(c),m=d<0?u+d:d;if(m>=u||m<0)throw i("Incorrect index");for(var y=new o(u),h=0;h<u;h++)y[h]=h===m?l:a[h];return y}},(r,e,t)=>{var n=t(78);r.exports=function(s){var i=n(s);return i==="BigInt64Array"||i==="BigUint64Array"}},(r,e,t)=>{var n=t(19),s=TypeError;r.exports=function(i){var a=n(i,"number");if(typeof a=="number")throw s("Can't convert number to bigint");return BigInt(a)}},(r,e,t)=>{var n=t(6),s=t(88),i=t(114),a=ArrayBuffer.prototype;n&&!("detached"in a)&&s(a,"detached",{configurable:!0,get:function(){return i(this)}})},(r,e,t)=>{var n=t(14),s=t(115),i=n(ArrayBuffer.prototype.slice);r.exports=function(a){if(s(a)!==0)return!1;try{return i(a,0,0),!1}catch{return!0}}},(r,e,t)=>{var n=t(72),s=t(15),i=TypeError;r.exports=n(ArrayBuffer.prototype,"byteLength","get")||function(a){if(s(a)!=="ArrayBuffer")throw i("ArrayBuffer expected");return a.byteLength}},(r,e,t)=>{var n=t(3),s=t(117);s&&n({target:"ArrayBuffer",proto:!0},{transfer:function(){return s(this,arguments.length?arguments[0]:void 0,!0)}})},(r,e,t)=>{var n=t(4),s=t(14),i=t(72),a=t(118),o=t(114),c=t(115),l=t(119),u=n.TypeError,d=n.structuredClone,m=n.ArrayBuffer,y=n.DataView,h=Math.min,p=m.prototype,f=y.prototype,v=s(p.slice),_=i(p,"resizable","get"),O=i(p,"maxByteLength","get"),k=s(f.getInt8),g=s(f.setInt8);r.exports=l&&function(b,N,S){var T=c(b),M=N===void 0?T:a(N),P=!_||!_(b);if(o(b))throw u("ArrayBuffer is detached");var $=d(b,{transfer:[b]});if(T===M&&(S||P))return $;if(T>=M&&(!S||P))return v($,0,M);for(var K=S&&!P&&O?{maxByteLength:O($)}:void 0,L=new m(M,K),j=new y($),q=new y(L),te=h(M,T),F=0;F<te;F++)g(q,F,k(j,F));return L}},(r,e,t)=>{var n=t(62),s=t(65),i=RangeError;r.exports=function(a){if(a===void 0)return 0;var o=n(a),c=s(o);if(o!==c)throw i("Wrong length or index");return c}},(r,e,t)=>{var n=t(4),s=t(7),i=t(28),a=t(120),o=t(121),c=t(122),l=n.structuredClone;r.exports=!!l&&!s(function(){if(o&&i>92||c&&i>94||a&&i>97)return!1;var u=new ArrayBuffer(8),d=l(u,{transfer:[u]});return u.byteLength!==0||d.byteLength!==8})},(r,e,t)=>{var n=t(121),s=t(122);r.exports=!n&&!s&&typeof window=="object"&&typeof document=="object"},r=>{r.exports=typeof Deno=="object"&&Deno&&typeof Deno.version=="object"},(r,e,t)=>{var n=t(4),s=t(15);r.exports=s(n.process)==="process"},(r,e,t)=>{var n=t(3),s=t(117);s&&n({target:"ArrayBuffer",proto:!0},{transferToFixedLength:function(){return s(this,arguments.length?arguments[0]:void 0,!1)}})},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var r,t,n,s,St,a,Dt,c,l,u,d,m,y,h,p,f,Ft,_,O,Kt,g,b;Object.defineProperty(exports,"__esModule",{value:!0}),exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,Object.defineProperty(exports,"SVGGraphics",{enumerable:!0,get:function(){return _displaySvg.SVGGraphics}}),exports.build=void 0,exports.getDocument=getDocument,exports.version=void 0,__w_pdfjs_require__(84),__w_pdfjs_require__(86),__w_pdfjs_require__(87),__w_pdfjs_require__(2),__w_pdfjs_require__(93),__w_pdfjs_require__(101),__w_pdfjs_require__(102),__w_pdfjs_require__(105),__w_pdfjs_require__(107),__w_pdfjs_require__(109),__w_pdfjs_require__(113),__w_pdfjs_require__(116),__w_pdfjs_require__(123),__w_pdfjs_require__(89),__w_pdfjs_require__(125),__w_pdfjs_require__(136),__w_pdfjs_require__(138),__w_pdfjs_require__(141),__w_pdfjs_require__(143),__w_pdfjs_require__(145),__w_pdfjs_require__(147),__w_pdfjs_require__(149),__w_pdfjs_require__(152);var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(163),_display_utils=__w_pdfjs_require__(168),_font_loader=__w_pdfjs_require__(171),_displayNode_utils=__w_pdfjs_require__(172),_canvas=__w_pdfjs_require__(173),_worker_options=__w_pdfjs_require__(176),_message_handler=__w_pdfjs_require__(177),_metadata=__w_pdfjs_require__(178),_optional_content_config=__w_pdfjs_require__(179),_transport_stream=__w_pdfjs_require__(180),_displayFetch_stream=__w_pdfjs_require__(181),_displayNetwork=__w_pdfjs_require__(184),_displayNode_stream=__w_pdfjs_require__(185),_displaySvg=__w_pdfjs_require__(186),_xfa_text=__w_pdfjs_require__(194);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_util.isNodeJS?_displayNode_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_util.isNodeJS?_displayNode_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;const DefaultFilterFactory=_util.isNodeJS?_displayNode_utils.NodeFilterFactory:_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;const DefaultStandardFontDataFactory=_util.isNodeJS?_displayNode_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;function getDocument(S){if(typeof S=="string"||S instanceof URL?S={url:S}:(0,_util.isArrayBuffer)(S)&&(S={data:S}),typeof S!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!S.url&&!S.data&&!S.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const T=new PDFDocumentLoadingTask,{docId:M}=T,P=S.url?getUrlProp(S.url):null,$=S.data?getDataProp(S.data):null,K=S.httpHeaders||null,L=S.withCredentials===!0,j=S.password??null,q=S.range instanceof PDFDataRangeTransport?S.range:null,te=Number.isInteger(S.rangeChunkSize)&&S.rangeChunkSize>0?S.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let F=S.worker instanceof PDFWorker?S.worker:null;const z=S.verbosity,Q=typeof S.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(S.docBaseUrl)?S.docBaseUrl:null,ne=typeof S.cMapUrl=="string"?S.cMapUrl:null,de=S.cMapPacked!==!1,U=S.CMapReaderFactory||DefaultCMapReaderFactory,w=typeof S.standardFontDataUrl=="string"?S.standardFontDataUrl:null,x=S.StandardFontDataFactory||DefaultStandardFontDataFactory,R=S.stopAtErrors!==!0,V=Number.isInteger(S.maxImageSize)&&S.maxImageSize>-1?S.maxImageSize:-1,D=S.isEvalSupported!==!1,Y=typeof S.isOffscreenCanvasSupported=="boolean"?S.isOffscreenCanvasSupported:!_util.isNodeJS,W=Number.isInteger(S.canvasMaxAreaInBytes)?S.canvasMaxAreaInBytes:-1,ee=typeof S.disableFontFace=="boolean"?S.disableFontFace:_util.isNodeJS,me=S.fontExtraProperties===!0,he=S.enableXfa===!0,Ae=S.ownerDocument||globalThis.document,ie=S.disableRange===!0,ye=S.disableStream===!0,xe=S.disableAutoFetch===!0,Ve=S.pdfBug===!0,We=q?q.length:S.length??NaN,Pe=typeof S.useSystemFonts=="boolean"?S.useSystemFonts:!_util.isNodeJS&&!ee,He=typeof S.useWorkerFetch=="boolean"?S.useWorkerFetch:U===_display_utils.DOMCMapReaderFactory&&x===_display_utils.DOMStandardFontDataFactory&&ne&&w&&(0,_display_utils.isValidFetchUrl)(ne,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(w,document.baseURI),Me=S.canvasFactory||new DefaultCanvasFactory({ownerDocument:Ae}),be=S.filterFactory||new DefaultFilterFactory({docId:M,ownerDocument:Ae}),fe=null;(0,_util.setVerbosityLevel)(z);const Ee={canvasFactory:Me,filterFactory:be};if(He||(Ee.cMapReaderFactory=new U({baseUrl:ne,isCompressed:de}),Ee.standardFontDataFactory=new x({baseUrl:w})),!F){const Re={verbosity:z,port:_worker_options.GlobalWorkerOptions.workerPort};F=Re.port?PDFWorker.fromPort(Re):new PDFWorker(Re),T._worker=F}const Be={docId:M,apiVersion:"3.10.111",data:$,password:j,disableAutoFetch:xe,rangeChunkSize:te,length:We,docBaseUrl:Q,enableXfa:he,evaluatorOptions:{maxImageSize:V,disableFontFace:ee,ignoreErrors:R,isEvalSupported:D,isOffscreenCanvasSupported:Y,canvasMaxAreaInBytes:W,fontExtraProperties:me,useSystemFonts:Pe,cMapUrl:He?ne:null,standardFontDataUrl:He?w:null}},Ge={ignoreErrors:R,isEvalSupported:D,disableFontFace:ee,fontExtraProperties:me,enableXfa:he,ownerDocument:Ae,disableAutoFetch:xe,pdfBug:Ve,styleElement:fe};return F.promise.then(function(){if(T.destroyed)throw new Error("Loading aborted");const Re=_fetchDocument(F,Be),Ce=new Promise(function(Ie){let ge;q?ge=new _transport_stream.PDFDataTransportStream({length:We,initialData:q.initialData,progressiveDone:q.progressiveDone,contentDispositionFilename:q.contentDispositionFilename,disableRange:ie,disableStream:ye},q):$||(ge=(Ke=>_util.isNodeJS?new _displayNode_stream.PDFNodeStream(Ke):(0,_display_utils.isValidFetchUrl)(Ke.url)?new _displayFetch_stream.PDFFetchStream(Ke):new _displayNetwork.PDFNetworkStream(Ke))({url:P,length:We,httpHeaders:K,withCredentials:L,rangeChunkSize:te,disableRange:ie,disableStream:ye})),Ie(ge)});return Promise.all([Re,Ce]).then(function(Ie){let[ge,Ze]=Ie;if(T.destroyed)throw new Error("Loading aborted");const Ke=new _message_handler.MessageHandler(M,ge,F.port),qe=new WorkerTransport(Ke,T,Ze,Ge,Ee);T._transport=qe,Ke.send("Ready",null)})}).catch(T._capability.reject),T}async function _fetchDocument(S,T){if(S.destroyed)throw new Error("Worker was destroyed");const M=await S.messageHandler.sendWithPromise("GetDocRequest",T,T.data?[T.data.buffer]:null);if(S.destroyed)throw new Error("Worker was destroyed");return M}function getUrlProp(S){if(S instanceof URL)return S.href;try{return new URL(S,window.location).href}catch{if(_util.isNodeJS&&typeof S=="string")return S}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(S){if(_util.isNodeJS&&typeof Buffer<"u"&&S instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(S instanceof Uint8Array&&S.byteLength===S.buffer.byteLength)return S;if(typeof S=="string")return(0,_util.stringToBytes)(S);if(typeof S=="object"&&!isNaN(S==null?void 0:S.length)||(0,_util.isArrayBuffer)(S))return new Uint8Array(S);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}const e=class e{constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${xt(e,r)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var T,M,P;this.destroyed=!0;try{(T=this._worker)!=null&&T.port&&(this._worker._pendingDestroy=!0),await((M=this._transport)==null?void 0:M.destroy())}catch($){throw(P=this._worker)!=null&&P.port&&delete this._worker._pendingDestroy,$}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};r=new WeakMap,se(e,r,0);let PDFDocumentLoadingTask=e;exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(T,M){let P=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,$=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;this.length=T,this.initialData=M,this.progressiveDone=P,this.contentDispositionFilename=$,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(T){this._rangeListeners.push(T)}addProgressListener(T){this._progressListeners.push(T)}addProgressiveReadListener(T){this._progressiveReadListeners.push(T)}addProgressiveDoneListener(T){this._progressiveDoneListeners.push(T)}onDataRange(T,M){for(const P of this._rangeListeners)P(T,M)}onDataProgress(T,M){this._readyCapability.promise.then(()=>{for(const P of this._progressListeners)P(T,M)})}onDataProgressiveRead(T){this._readyCapability.promise.then(()=>{for(const M of this._progressiveReadListeners)M(T)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const T of this._progressiveDoneListeners)T()})}transportReady(){this._readyCapability.resolve()}requestDataRange(T,M){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(T,M){this._pdfInfo=T,this._transport=M,Object.defineProperty(this,"getJavaScript",{value:()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getJavaScript`, please use `PDFDocumentProxy.getJSActions` instead."),this.getJSActions().then(P=>{if(!P)return P;const $=[];for(const K in P)$.push(...P[K]);return $}))})}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(T){return this._transport.getPage(T)}getPageIndex(T){return this._transport.getPageIndex(T)}getDestinations(){return this._transport.getDestinations()}getDestination(T){return this._transport.getDestination(T)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(){let T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._transport.startCleanup(T||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(T,M,P){se(this,s);se(this,a);se(this,t,null);se(this,n,!1);let $=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;this._pageIndex=T,this._pageInfo=M,this._transport=P,this._stats=$?new _display_utils.StatTimer:null,this._pdfBug=$,this.commonObjs=P.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport(){let{scale:T,rotation:M=this.rotate,offsetX:P=0,offsetY:$=0,dontFlip:K=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return new _display_utils.PageViewport({viewBox:this.view,scale:T,rotation:M,offsetX:P,offsetY:$,dontFlip:K})}getAnnotations(){let{intent:T="display"}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const M=this._transport.getRenderingIntent(T);return this._transport.getAnnotations(this._pageIndex,M.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var T;return((T=this._transport._htmlForXfa)==null?void 0:T.children[this._pageIndex])||null}render(T){var R,V;let{canvasContext:M,viewport:P,intent:$="display",annotationMode:K=_util.AnnotationMode.ENABLE,transform:L=null,background:j=null,optionalContentConfigPromise:q=null,annotationCanvasMap:te=null,pageColors:F=null,printAnnotationStorage:z=null}=T;(R=this._stats)==null||R.time("Overall");const Q=this._transport.getRenderingIntent($,K,z);Se(this,n,!1),le(this,a,Dt).call(this),q||(q=this._transport.getOptionalContentConfig());let ne=this._intentStates.get(Q.cacheKey);ne||(ne=Object.create(null),this._intentStates.set(Q.cacheKey,ne)),ne.streamReaderCancelTimeout&&(clearTimeout(ne.streamReaderCancelTimeout),ne.streamReaderCancelTimeout=null);const de=!!(Q.renderingIntent&_util.RenderingIntentFlag.PRINT);ne.displayReadyCapability||(ne.displayReadyCapability=new _util.PromiseCapability,ne.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(V=this._stats)==null||V.time("Page Request"),this._pumpOperatorList(Q));const U=D=>{var Y,W;ne.renderTasks.delete(w),(this._maybeCleanupAfterRender||de)&&Se(this,n,!0),le(this,s,St).call(this,!de),D?(w.capability.reject(D),this._abortOperatorList({intentState:ne,reason:D instanceof Error?D:new Error(D)})):w.capability.resolve(),(Y=this._stats)==null||Y.timeEnd("Rendering"),(W=this._stats)==null||W.timeEnd("Overall")},w=new InternalRenderTask({callback:U,params:{canvasContext:M,viewport:P,transform:L,background:j},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:te,operatorList:ne.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!de,pdfBug:this._pdfBug,pageColors:F});(ne.renderTasks||(ne.renderTasks=new Set)).add(w);const x=w.task;return Promise.all([ne.displayReadyCapability.promise,q]).then(D=>{var ee;let[Y,W]=D;if(this.destroyed){U();return}(ee=this._stats)==null||ee.time("Rendering"),w.initializeGraphics({transparency:Y,optionalContentConfig:W}),w.operatorListChanged()}).catch(U),x}getOperatorList(){var q;let{intent:T="display",annotationMode:M=_util.AnnotationMode.ENABLE,printAnnotationStorage:P=null}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};function $(){L.operatorList.lastChunk&&(L.opListReadCapability.resolve(L.operatorList),L.renderTasks.delete(j))}const K=this._transport.getRenderingIntent(T,M,P,!0);let L=this._intentStates.get(K.cacheKey);L||(L=Object.create(null),this._intentStates.set(K.cacheKey,L));let j;return L.opListReadCapability||(j=Object.create(null),j.operatorListChanged=$,L.opListReadCapability=new _util.PromiseCapability,(L.renderTasks||(L.renderTasks=new Set)).add(j),L.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(q=this._stats)==null||q.time("Page Request"),this._pumpOperatorList(K)),L.opListReadCapability.promise}streamTextContent(){let{includeMarkedContent:T=!1,disableNormalization:M=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const P=100;return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:T===!0,disableNormalization:M===!0},{highWaterMark:P,size($){return $.items.length}})}getTextContent(){let T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this._transport._htmlForXfa)return this.getXfa().then(P=>_xfa_text.XfaText.textContent(P));const M=this.streamTextContent(T);return new Promise(function(P,$){function K(){L.read().then(function(q){let{value:te,done:F}=q;if(F){P(j);return}Object.assign(j.styles,te.styles),j.items.push(...te.items),K()},$)}const L=M.getReader(),j={items:[],styles:Object.create(null)};K()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const T=[];for(const M of this._intentStates.values())if(this._abortOperatorList({intentState:M,reason:new Error("Page was destroyed."),force:!0}),!M.opListReadCapability)for(const P of M.renderTasks)T.push(P.completed),P.cancel();return this.objs.clear(),Se(this,n,!1),le(this,a,Dt).call(this),Promise.all(T)}cleanup(){let T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;Se(this,n,!0);const M=le(this,s,St).call(this,!1);return T&&M&&this._stats&&(this._stats=new _display_utils.StatTimer),M}_startRenderPage(T,M){var $,K;const P=this._intentStates.get(M);P&&(($=this._stats)==null||$.timeEnd("Page Request"),(K=P.displayReadyCapability)==null||K.resolve(T))}_renderPageChunk(T,M){for(let P=0,$=T.length;P<$;P++)M.operatorList.fnArray.push(T.fnArray[P]),M.operatorList.argsArray.push(T.argsArray[P]);M.operatorList.lastChunk=T.lastChunk,M.operatorList.separateAnnots=T.separateAnnots;for(const P of M.renderTasks)P.operatorListChanged();T.lastChunk&&le(this,s,St).call(this,!0)}_pumpOperatorList(T){let{renderingIntent:M,cacheKey:P,annotationStorageSerializable:$}=T;const{map:K,transfers:L}=$,q=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:M,cacheKey:P,annotationStorage:K},L).getReader(),te=this._intentStates.get(P);te.streamReader=q;const F=()=>{q.read().then(z=>{let{value:Q,done:ne}=z;if(ne){te.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(Q,te),F())},z=>{if(te.streamReader=null,!this._transport.destroyed){if(te.operatorList){te.operatorList.lastChunk=!0;for(const Q of te.renderTasks)Q.operatorListChanged();le(this,s,St).call(this,!0)}if(te.displayReadyCapability)te.displayReadyCapability.reject(z);else if(te.opListReadCapability)te.opListReadCapability.reject(z);else throw z}})};F()}_abortOperatorList(T){let{intentState:M,reason:P,force:$=!1}=T;if(M.streamReader){if(M.streamReaderCancelTimeout&&(clearTimeout(M.streamReaderCancelTimeout),M.streamReaderCancelTimeout=null),!$){if(M.renderTasks.size>0)return;if(P instanceof _display_utils.RenderingCancelledException){let K=RENDERING_CANCELLED_TIMEOUT;P.extraDelay>0&&P.extraDelay<1e3&&(K+=P.extraDelay),M.streamReaderCancelTimeout=setTimeout(()=>{M.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:M,reason:P,force:!0})},K);return}}if(M.streamReader.cancel(new _util.AbortException(P.message)).catch(()=>{}),M.streamReader=null,!this._transport.destroyed){for(const[K,L]of this._intentStates)if(L===M){this._intentStates.delete(K);break}this.cleanup()}}}get stats(){return this._stats}}t=new WeakMap,n=new WeakMap,s=new WeakSet,St=function(){let T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(le(this,a,Dt).call(this),!E(this,n)||this.destroyed)return!1;if(T)return Se(this,t,setTimeout(()=>{Se(this,t,null),le(this,s,St).call(this,!1)},DELAYED_CLEANUP_TIMEOUT)),!1;for(const{renderTasks:M,operatorList:P}of this._intentStates.values())if(M.size>0||!P.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),Se(this,n,!1),!0},a=new WeakSet,Dt=function(){E(this,t)&&(clearTimeout(E(this,t)),Se(this,t,null))},exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){se(this,c,new Set);se(this,l,Promise.resolve())}postMessage(T,M){const P={data:structuredClone(T,null)};E(this,l).then(()=>{for(const $ of E(this,c))$.call(this,P)})}addEventListener(T,M){E(this,c).add(M)}removeEventListener(T,M){E(this,c).delete(M)}terminate(){E(this,c).clear()}}c=new WeakMap,l=new WeakMap,exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_util.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const S=(u=document==null?void 0:document.currentScript)==null?void 0:u.src;S&&(PDFWorkerUtil.fallbackWorkerSrc=S.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(S,T){let M;try{if(M=new URL(S),!M.origin||M.origin==="null")return!1}catch{return!1}const P=new URL(T,M);return M.origin===P.origin},PDFWorkerUtil.createCDNWrapper=function(S){const T=`importScripts("${S}");`;return URL.createObjectURL(new Blob([T]))}}const _PDFWorker=class _PDFWorker{constructor(){var P;let{name:S=null,port:T=null,verbosity:M=(0,_util.getVerbosityLevel)()}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this.name=S,this.destroyed=!1,this.verbosity=M,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,T){if((P=E(_PDFWorker,d))!=null&&P.has(T))throw new Error("Cannot use more than one PDFWorker per port.");(E(_PDFWorker,d)||Se(_PDFWorker,d,new WeakMap)).set(T,this),this._initializeFromPort(T);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(S){this._port=S,this._messageHandler=new _message_handler.MessageHandler("main","worker",S),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:S}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,S)||(S=PDFWorkerUtil.createCDNWrapper(new URL(S,window.location).href));const T=new Worker(S),M=new _message_handler.MessageHandler("main","worker",T),P=()=>{T.removeEventListener("error",$),M.destroy(),T.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},$=()=>{this._webWorker||P()};T.addEventListener("error",$),M.on("test",L=>{if(T.removeEventListener("error",$),this.destroyed){P();return}L?(this._messageHandler=M,this._port=T,this._webWorker=T,this._readyCapability.resolve(),M.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),M.destroy(),T.terminate())}),M.on("ready",L=>{if(T.removeEventListener("error",$),this.destroyed){P();return}try{K()}catch{this._setupFakeWorker()}});const K=()=>{const L=new Uint8Array;M.send("test",L,[L.buffer])};K();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(S=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const T=new LoopbackPort;this._port=T;const M=`fake${PDFWorkerUtil.fakeWorkerId++}`,P=new _message_handler.MessageHandler(M+"_worker",M,T);S.setup(P,T);const $=new _message_handler.MessageHandler(M,M+"_worker",T);this._messageHandler=$,this._readyCapability.resolve(),$.send("configure",{verbosity:this.verbosity})}).catch(S=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${S.message}".`))})}destroy(){var S;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(S=E(_PDFWorker,d))==null||S.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(S){var M;if(!(S!=null&&S.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const T=(M=E(this,d))==null?void 0:M.get(S.port);if(T){if(T._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return T}return new _PDFWorker(S)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _util.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var S;try{return((S=globalThis.pdfjsWorker)==null?void 0:S.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_util.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};d=new WeakMap,se(_PDFWorker,d,void 0);let PDFWorker=_PDFWorker;exports.PDFWorker=PDFWorker;class WorkerTransport{constructor(T,M,P,$,K){se(this,f);se(this,m,new Map);se(this,y,new Map);se(this,h,new Map);se(this,p,null);this.messageHandler=T,this.loadingTask=M,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:$.ownerDocument,styleElement:$.styleElement}),this._params=$,this.canvasFactory=K.canvasFactory,this.filterFactory=K.filterFactory,this.cMapReaderFactory=K.cMapReaderFactory,this.standardFontDataFactory=K.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=P,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(T){let M=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_util.AnnotationMode.ENABLE,P=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,$=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,K=_util.RenderingIntentFlag.DISPLAY,L=_annotation_storage.SerializableEmpty;switch(T){case"any":K=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":K=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${T}`)}switch(M){case _util.AnnotationMode.DISABLE:K+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:K+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:K+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,L=(K&_util.RenderingIntentFlag.PRINT&&P instanceof _annotation_storage.PrintAnnotationStorage?P:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${M}`)}return $&&(K+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:K,cacheKey:`${K}_${L.hash}`,annotationStorageSerializable:L}}destroy(){var P;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,(P=E(this,p))==null||P.reject(new Error("Worker was destroyed during onPassword callback"));const T=[];for(const $ of E(this,y).values())T.push($._destroy());E(this,y).clear(),E(this,h).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const M=this.messageHandler.sendWithPromise("Terminate",null);return T.push(M),Promise.all(T).then(()=>{var $;this.commonObjs.clear(),this.fontLoader.clear(),E(this,m).clear(),this.filterFactory.destroy(),($=this._networkStream)==null||$.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:T,loadingTask:M}=this;T.on("GetReader",(P,$)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=K=>{this._lastProgress={loaded:K.loaded,total:K.total}},$.onPull=()=>{this._fullReader.read().then(function(K){let{value:L,done:j}=K;if(j){$.close();return}(0,_util.assert)(L instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),$.enqueue(new Uint8Array(L),1,[L])}).catch(K=>{$.error(K)})},$.onCancel=K=>{this._fullReader.cancel(K),$.ready.catch(L=>{if(!this.destroyed)throw L})}}),T.on("ReaderHeadersReady",P=>{const $=new _util.PromiseCapability,K=this._fullReader;return K.headersReady.then(()=>{var L;(!K.isStreamingSupported||!K.isRangeSupported)&&(this._lastProgress&&((L=M.onProgress)==null||L.call(M,this._lastProgress)),K.onProgress=j=>{var q;(q=M.onProgress)==null||q.call(M,{loaded:j.loaded,total:j.total})}),$.resolve({isStreamingSupported:K.isStreamingSupported,isRangeSupported:K.isRangeSupported,contentLength:K.contentLength})},$.reject),$.promise}),T.on("GetRangeReader",(P,$)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const K=this._networkStream.getRangeReader(P.begin,P.end);if(!K){$.close();return}$.onPull=()=>{K.read().then(function(L){let{value:j,done:q}=L;if(q){$.close();return}(0,_util.assert)(j instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),$.enqueue(new Uint8Array(j),1,[j])}).catch(L=>{$.error(L)})},$.onCancel=L=>{K.cancel(L),$.ready.catch(j=>{if(!this.destroyed)throw j})}}),T.on("GetDoc",P=>{let{pdfInfo:$}=P;this._numPages=$.numPages,this._htmlForXfa=$.htmlForXfa,delete $.htmlForXfa,M._capability.resolve(new PDFDocumentProxy($,this))}),T.on("DocException",function(P){let $;switch(P.name){case"PasswordException":$=new _util.PasswordException(P.message,P.code);break;case"InvalidPDFException":$=new _util.InvalidPDFException(P.message);break;case"MissingPDFException":$=new _util.MissingPDFException(P.message);break;case"UnexpectedResponseException":$=new _util.UnexpectedResponseException(P.message,P.status);break;case"UnknownErrorException":$=new _util.UnknownErrorException(P.message,P.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}M._capability.reject($)}),T.on("PasswordRequest",P=>{if(Se(this,p,new _util.PromiseCapability),M.onPassword){const $=K=>{K instanceof Error?E(this,p).reject(K):E(this,p).resolve({password:K})};try{M.onPassword($,P.code)}catch(K){E(this,p).reject(K)}}else E(this,p).reject(new _util.PasswordException(P.message,P.code));return E(this,p).promise}),T.on("DataLoaded",P=>{var $;($=M.onProgress)==null||$.call(M,{loaded:P.length,total:P.length}),this.downloadInfoCapability.resolve(P)}),T.on("StartRenderPage",P=>{if(this.destroyed)return;E(this,y).get(P.pageIndex)._startRenderPage(P.transparency,P.cacheKey)}),T.on("commonobj",P=>{var j;let[$,K,L]=P;if(!this.destroyed&&!this.commonObjs.has($))switch(K){case"Font":const q=this._params;if("error"in L){const z=L.error;(0,_util.warn)(`Error during font loading: ${z}`),this.commonObjs.resolve($,z);break}const te=q.pdfBug&&((j=globalThis.FontInspector)!=null&&j.enabled)?(z,Q)=>globalThis.FontInspector.fontAdded(z,Q):null,F=new _font_loader.FontFaceObject(L,{isEvalSupported:q.isEvalSupported,disableFontFace:q.disableFontFace,ignoreErrors:q.ignoreErrors,inspectFont:te});this.fontLoader.bind(F).catch(z=>T.sendWithPromise("FontFallback",{id:$})).finally(()=>{!q.fontExtraProperties&&F.data&&(F.data=null),this.commonObjs.resolve($,F)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve($,L);break;default:throw new Error(`Got unknown common object type ${K}`)}}),T.on("obj",P=>{var te;let[$,K,L,j]=P;if(this.destroyed)return;const q=E(this,y).get(K);if(!q.objs.has($))switch(L){case"Image":if(q.objs.resolve($,j),j){let F;if(j.bitmap){const{width:z,height:Q}=j;F=z*Q*4}else F=((te=j.data)==null?void 0:te.length)||0;F>_util.MAX_IMAGE_SIZE_TO_CACHE&&(q._maybeCleanupAfterRender=!0)}break;case"Pattern":q.objs.resolve($,j);break;default:throw new Error(`Got unknown object type ${L}`)}}),T.on("DocProgress",P=>{var $;this.destroyed||($=M.onProgress)==null||$.call(M,{loaded:P.loaded,total:P.total})}),T.on("FetchBuiltInCMap",P=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(P):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),T.on("FetchStandardFontData",P=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(P):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var P;this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:T,transfers:M}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:T,filename:((P=this._fullReader)==null?void 0:P.filename)??null},M).finally(()=>{this.annotationStorage.resetModified()})}getPage(T){if(!Number.isInteger(T)||T<=0||T>this._numPages)return Promise.reject(new Error("Invalid page request."));const M=T-1,P=E(this,h).get(M);if(P)return P;const $=this.messageHandler.sendWithPromise("GetPage",{pageIndex:M}).then(K=>{if(this.destroyed)throw new Error("Transport destroyed");const L=new PDFPageProxy(M,K,this,this._params.pdfBug);return E(this,y).set(M,L),L});return E(this,h).set(M,$),$}getPageIndex(T){return typeof T!="object"||T===null||!Number.isInteger(T.num)||T.num<0||!Number.isInteger(T.gen)||T.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:T.num,gen:T.gen})}getAnnotations(T,M){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:T,intent:M})}getFieldObjects(){return le(this,f,Ft).call(this,"GetFieldObjects")}hasJSActions(){return le(this,f,Ft).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(T){return typeof T!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:T})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return le(this,f,Ft).call(this,"GetDocJSActions")}getPageJSActions(T){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:T})}getStructTree(T){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:T})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(T=>new _optional_content_config.OptionalContentConfig(T))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const T="GetMetadata",M=E(this,m).get(T);if(M)return M;const P=this.messageHandler.sendWithPromise(T,null).then($=>{var K,L;return{info:$[0],metadata:$[1]?new _metadata.Metadata($[1]):null,contentDispositionFilename:((K=this._fullReader)==null?void 0:K.filename)??null,contentLength:((L=this._fullReader)==null?void 0:L.contentLength)??null}});return E(this,m).set(T,P),P}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(){let T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const M of E(this,y).values())if(!M.cleanup())throw new Error(`startCleanup: Page ${M.pageNumber} is currently rendering.`);this.commonObjs.clear(),T||this.fontLoader.clear(),E(this,m).clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:T,enableXfa:M}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:T,enableXfa:M})}}m=new WeakMap,y=new WeakMap,h=new WeakMap,p=new WeakMap,f=new WeakSet,Ft=function(T){let M=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const P=E(this,m).get(T);if(P)return P;const $=this.messageHandler.sendWithPromise(T,M);return E(this,m).set(T,$),$};class PDFObjects{constructor(){se(this,O);se(this,_,Object.create(null))}get(T){let M=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(M){const $=le(this,O,Kt).call(this,T);return $.capability.promise.then(()=>M($.data)),null}const P=E(this,_)[T];if(!(P!=null&&P.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${T}.`);return P.data}has(T){const M=E(this,_)[T];return(M==null?void 0:M.capability.settled)||!1}resolve(T){let M=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const P=le(this,O,Kt).call(this,T);P.data=M,P.capability.resolve()}clear(){var T;for(const M in E(this,_)){const{data:P}=E(this,_)[M];(T=P==null?void 0:P.bitmap)==null||T.close()}Se(this,_,Object.create(null))}}_=new WeakMap,O=new WeakSet,Kt=function(T){var M;return(M=E(this,_))[T]||(M[T]={capability:new _util.PromiseCapability,data:null})};class RenderTask{constructor(T){se(this,g,null);Se(this,g,T),this.onContinue=null}get promise(){return E(this,g).capability.promise}cancel(){let T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;E(this,g).cancel(null,T)}get separateAnnots(){const{separateAnnots:T}=E(this,g).operatorList;if(!T)return!1;const{annotationCanvasMap:M}=E(this,g);return T.form||T.canvas&&(M==null?void 0:M.size)>0}}g=new WeakMap,exports.RenderTask=RenderTask;const N=class N{constructor(T){let{callback:M,params:P,objs:$,commonObjs:K,annotationCanvasMap:L,operatorList:j,pageIndex:q,canvasFactory:te,filterFactory:F,useRequestAnimationFrame:z=!1,pdfBug:Q=!1,pageColors:ne=null}=T;this.callback=M,this.params=P,this.objs=$,this.commonObjs=K,this.annotationCanvasMap=L,this.operatorListIdx=null,this.operatorList=j,this._pageIndex=q,this.canvasFactory=te,this.filterFactory=F,this._pdfBug=Q,this.pageColors=ne,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=z===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=P.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics(T){var q,te;let{transparency:M=!1,optionalContentConfig:P}=T;if(this.cancelled)return;if(this._canvas){if(E(N,b).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");E(N,b).add(this._canvas)}this._pdfBug&&((q=globalThis.StepperManager)!=null&&q.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:$,viewport:K,transform:L,background:j}=this.params;this.gfx=new _canvas.CanvasGraphics($,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:P},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:L,viewport:K,transparency:M,background:j}),this.operatorListIdx=0,this.graphicsReady=!0,(te=this.graphicsReadyCallback)==null||te.call(this)}cancel(){var P;let T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,M=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.running=!1,this.cancelled=!0,(P=this.gfx)==null||P.endDrawing(),this._canvas&&E(N,b).delete(this._canvas),this.callback(T||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,M))}operatorListChanged(){var T;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(T=this.stepper)==null||T.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(this.pageColors),this._canvas&&E(N,b).delete(this._canvas),this.callback())))}};b=new WeakMap,se(N,b,new WeakSet);let InternalRenderTask=N;const version="3.10.111";exports.version=version;const build="e142baecb";exports.build=build},(r,e,t)=>{var n=t(3),s=t(126),i=t(135);n({target:"Set",proto:!0,real:!0,forced:!i("difference")},{difference:s})},(r,e,t)=>{var n=t(127),s=t(128),i=t(129),a=t(132),o=t(133),c=t(130),l=t(131),u=s.has,d=s.remove;r.exports=function(y){var h=n(this),p=o(y),f=i(h);return a(h)<=p.size?c(h,function(v){p.includes(v)&&d(f,v)}):l(p.getIterator(),function(v){u(h,v)&&d(f,v)}),f}},(r,e,t)=>{var n=t(128).has;r.exports=function(s){return n(s),s}},(r,e,t)=>{var n=t(14),s=Set.prototype;r.exports={Set,add:n(s.add),has:n(s.has),remove:n(s.delete),proto:s}},(r,e,t)=>{var n=t(128),s=t(130),i=n.Set,a=n.add;r.exports=function(o){var c=new i;return s(o,function(l){a(c,l)}),c}},(r,e,t)=>{var n=t(14),s=t(131),i=t(128),a=i.Set,o=i.proto,c=n(o.forEach),l=n(o.keys),u=l(new a).next;r.exports=function(d,m,y){return y?s({iterator:l(d),next:u},m):c(d,m)}},(r,e,t)=>{var n=t(8);r.exports=function(s,i,a){for(var o=a?s:s.iterator,c=s.next,l,u;!(l=n(c,o)).done;)if(u=i(l.value),u!==void 0)return u}},(r,e,t)=>{var n=t(72),s=t(128);r.exports=n(s.proto,"size","get")||function(i){return i.size}},(r,e,t)=>{var n=t(31),s=t(47),i=t(8),a=t(62),o=t(134),c="Invalid size",l=RangeError,u=TypeError,d=Math.max,m=function(y,h,p,f){this.set=y,this.size=h,this.has=p,this.keys=f};m.prototype={getIterator:function(){return o(s(i(this.keys,this.set)))},includes:function(y){return i(this.has,this.set,y)}},r.exports=function(y){s(y);var h=+y.size;if(h!==h)throw u(c);var p=a(h);if(p<0)throw l(c);return new m(y,d(p,0),n(y.has),n(y.keys))}},r=>{r.exports=function(e){return{iterator:e,next:e.next,done:!1}}},(r,e,t)=>{var n=t(24),s=function(i){return{size:i,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}};r.exports=function(i){var a=n("Set");try{new a()[i](s(0));try{return new a()[i](s(-1)),!1}catch{return!0}}catch{return!1}}},(r,e,t)=>{var n=t(3),s=t(7),i=t(137),a=t(135),o=!a("intersection")||s(function(){return Array.from(new Set([1,2,3]).intersection(new Set([3,2])))!=="3,2"});n({target:"Set",proto:!0,real:!0,forced:o},{intersection:i})},(r,e,t)=>{var n=t(127),s=t(128),i=t(132),a=t(133),o=t(130),c=t(131),l=s.Set,u=s.add,d=s.has;r.exports=function(y){var h=n(this),p=a(y),f=new l;return i(h)>p.size?c(p.getIterator(),function(v){d(h,v)&&u(f,v)}):o(h,function(v){p.includes(v)&&u(f,v)}),f}},(r,e,t)=>{var n=t(3),s=t(139),i=t(135);n({target:"Set",proto:!0,real:!0,forced:!i("isDisjointFrom")},{isDisjointFrom:s})},(r,e,t)=>{var n=t(127),s=t(128).has,i=t(132),a=t(133),o=t(130),c=t(131),l=t(140);r.exports=function(d){var m=n(this),y=a(d);if(i(m)<=y.size)return o(m,function(p){if(y.includes(p))return!1},!0)!==!1;var h=y.getIterator();return c(h,function(p){if(s(m,p))return l(h,"normal",!1)})!==!1}},(r,e,t)=>{var n=t(8),s=t(47),i=t(30);r.exports=function(a,o,c){var l,u;s(a);try{if(l=i(a,"return"),!l){if(o==="throw")throw c;return c}l=n(l,a)}catch(d){u=!0,l=d}if(o==="throw")throw c;if(u)throw l;return s(l),c}},(r,e,t)=>{var n=t(3),s=t(142),i=t(135);n({target:"Set",proto:!0,real:!0,forced:!i("isSubsetOf")},{isSubsetOf:s})},(r,e,t)=>{var n=t(127),s=t(132),i=t(130),a=t(133);r.exports=function(c){var l=n(this),u=a(c);return s(l)>u.size?!1:i(l,function(d){if(!u.includes(d))return!1},!0)!==!1}},(r,e,t)=>{var n=t(3),s=t(144),i=t(135);n({target:"Set",proto:!0,real:!0,forced:!i("isSupersetOf")},{isSupersetOf:s})},(r,e,t)=>{var n=t(127),s=t(128).has,i=t(132),a=t(133),o=t(131),c=t(140);r.exports=function(u){var d=n(this),m=a(u);if(i(d)<m.size)return!1;var y=m.getIterator();return o(y,function(h){if(!s(d,h))return c(y,"normal",!1)})!==!1}},(r,e,t)=>{var n=t(3),s=t(146),i=t(135);n({target:"Set",proto:!0,real:!0,forced:!i("symmetricDifference")},{symmetricDifference:s})},(r,e,t)=>{var n=t(127),s=t(128),i=t(129),a=t(133),o=t(131),c=s.add,l=s.has,u=s.remove;r.exports=function(m){var y=n(this),h=a(m).getIterator(),p=i(y);return o(h,function(f){l(y,f)?u(p,f):c(p,f)}),p}},(r,e,t)=>{var n=t(3),s=t(148),i=t(135);n({target:"Set",proto:!0,real:!0,forced:!i("union")},{union:s})},(r,e,t)=>{var n=t(127),s=t(128).add,i=t(129),a=t(133),o=t(131);r.exports=function(l){var u=n(this),d=a(l).getIterator(),m=i(u);return o(d,function(y){s(m,y)}),m}},(r,e,t)=>{var n=t(3),s=t(4),i=t(24),a=t(11),o=t(45).f,c=t(39),l=t(150),u=t(75),d=t(76),m=t(151),y=t(82),h=t(6),p=t(36),f="DOMException",v=i("Error"),_=i(f),O=function(){l(this,k);var q=arguments.length,te=d(q<1?void 0:arguments[0]),F=d(q<2?void 0:arguments[1],"Error"),z=new _(te,F),Q=v(te);return Q.name=f,o(z,"stack",a(1,y(Q.stack,1))),u(z,this,O),z},k=O.prototype=_.prototype,g="stack"in v(f),b="stack"in new _(1,2),N=_&&h&&Object.getOwnPropertyDescriptor(s,f),S=!!N&&!(N.writable&&N.configurable),T=g&&!S&&!b;n({global:!0,constructor:!0,forced:p||T},{DOMException:T?O:_});var M=i(f),P=M.prototype;if(P.constructor!==M){p||o(P,"constructor",a(1,M));for(var $ in m)if(c(m,$)){var K=m[$],L=K.s;c(M,L)||o(M,L,a(6,K.c))}}},(r,e,t)=>{var n=t(25),s=TypeError;r.exports=function(i,a){if(n(a,i))return i;throw s("Incorrect invocation")}},r=>{r.exports={IndexSizeError:{s:"INDEX_SIZE_ERR",c:1,m:1},DOMStringSizeError:{s:"DOMSTRING_SIZE_ERR",c:2,m:0},HierarchyRequestError:{s:"HIERARCHY_REQUEST_ERR",c:3,m:1},WrongDocumentError:{s:"WRONG_DOCUMENT_ERR",c:4,m:1},InvalidCharacterError:{s:"INVALID_CHARACTER_ERR",c:5,m:1},NoDataAllowedError:{s:"NO_DATA_ALLOWED_ERR",c:6,m:0},NoModificationAllowedError:{s:"NO_MODIFICATION_ALLOWED_ERR",c:7,m:1},NotFoundError:{s:"NOT_FOUND_ERR",c:8,m:1},NotSupportedError:{s:"NOT_SUPPORTED_ERR",c:9,m:1},InUseAttributeError:{s:"INUSE_ATTRIBUTE_ERR",c:10,m:1},InvalidStateError:{s:"INVALID_STATE_ERR",c:11,m:1},SyntaxError:{s:"SYNTAX_ERR",c:12,m:1},InvalidModificationError:{s:"INVALID_MODIFICATION_ERR",c:13,m:1},NamespaceError:{s:"NAMESPACE_ERR",c:14,m:1},InvalidAccessError:{s:"INVALID_ACCESS_ERR",c:15,m:1},ValidationError:{s:"VALIDATION_ERR",c:16,m:0},TypeMismatchError:{s:"TYPE_MISMATCH_ERR",c:17,m:1},SecurityError:{s:"SECURITY_ERR",c:18,m:1},NetworkError:{s:"NETWORK_ERR",c:19,m:1},AbortError:{s:"ABORT_ERR",c:20,m:1},URLMismatchError:{s:"URL_MISMATCH_ERR",c:21,m:1},QuotaExceededError:{s:"QUOTA_EXCEEDED_ERR",c:22,m:1},TimeoutError:{s:"TIMEOUT_ERR",c:23,m:1},InvalidNodeTypeError:{s:"INVALID_NODE_TYPE_ERR",c:24,m:1},DataCloneError:{s:"DATA_CLONE_ERR",c:25,m:1}}},(r,e,t)=>{var n=t(36),s=t(3),i=t(4),a=t(24),o=t(14),c=t(7),l=t(41),u=t(21),d=t(153),m=t(17),y=t(20),h=t(23),p=t(154),f=t(47),v=t(78),_=t(39),O=t(159),k=t(44),g=t(64),b=t(85),N=t(160),S=t(162),T=t(128),M=t(83),P=t(119),$=i.Object,K=i.Array,L=i.Date,j=i.Error,q=i.EvalError,te=i.RangeError,F=i.ReferenceError,z=i.SyntaxError,Q=i.TypeError,ne=i.URIError,de=i.PerformanceMark,U=i.WebAssembly,w=U&&U.CompileError||j,x=U&&U.LinkError||j,R=U&&U.RuntimeError||j,V=a("DOMException"),D=S.Map,Y=S.has,W=S.get,ee=S.set,me=T.Set,he=T.add,Ae=a("Object","keys"),ie=o([].push),ye=o((!0).valueOf),xe=o(1 .valueOf),Ve=o("".valueOf),We=o(L.prototype.getTime),Pe=l("structuredClone"),He="DataCloneError",Me="Transferring",be=function(ve){return!c(function(){var re=new i.Set([7]),_e=ve(re),Le=ve($(7));return _e===re||!_e.has(7)||typeof Le!="object"||Le!==7})&&ve},fe=function(ve,re){return!c(function(){var _e=new re,Le=ve({a:_e,b:_e});return!(Le&&Le.a===Le.b&&Le.a instanceof re&&Le.a.stack===_e.stack)})},Ee=function(ve){return!c(function(){var re=ve(new i.AggregateError([1],Pe,{cause:3}));return re.name!=="AggregateError"||re.errors[0]!==1||re.message!==Pe||re.cause!==3})},Be=i.structuredClone,Ge=n||!fe(Be,j)||!fe(Be,V)||!Ee(Be),Re=!Be&&be(function(ve){return new de(Pe,{detail:ve}).detail}),Ce=be(Be)||Re,Ie=function(ve){throw new V("Uncloneable type: "+ve,He)},ge=function(ve,re){throw new V((re||"Cloning")+" of "+ve+" cannot be properly polyfilled in this engine",He)},Ze=function(ve,re){return Ce||ge(re),Ce(ve)},Ke=function(){var ve;try{ve=new i.DataTransfer}catch{try{ve=new i.ClipboardEvent("").clipboardData}catch{}}return ve&&ve.items&&ve.files?ve:null},qe=function(ve,re,_e){if(Y(re,ve))return W(re,ve);var Le=_e||v(ve),Te,G,I,Z,H,J;if(Le==="SharedArrayBuffer")Ce?Te=Ce(ve):Te=ve;else{var ce=i.DataView;!ce&&typeof ve.slice!="function"&&ge("ArrayBuffer");try{if(typeof ve.slice=="function"&&!ve.resizable)Te=ve.slice(0);else for(G=ve.byteLength,I=("maxByteLength"in ve)?{maxByteLength:ve.maxByteLength}:void 0,Te=new ArrayBuffer(G,I),Z=new ce(ve),H=new ce(Te),J=0;J<G;J++)H.setUint8(J,Z.getUint8(J))}catch{throw new V("ArrayBuffer is detached",He)}}return ee(re,ve,Te),Te},we=function(ve,re,_e,Le,Te){var G=i[re];return y(G)||ge(re),new G(qe(ve.buffer,Te),_e,Le)},ue=function(ve,re,_e){this.object=ve,this.type=re,this.metadata=_e},ae=function(ve,re,_e){if(h(ve)&&Ie("Symbol"),!y(ve))return ve;if(re){if(Y(re,ve))return W(re,ve)}else re=new D;var Le=v(ve),Te,G,I,Z,H,J,ce,ke;switch(Le){case"Array":I=K(g(ve));break;case"Object":I={};break;case"Map":I=new D;break;case"Set":I=new me;break;case"RegExp":I=new RegExp(ve.source,N(ve));break;case"Error":switch(G=ve.name,G){case"AggregateError":I=a("AggregateError")([]);break;case"EvalError":I=q();break;case"RangeError":I=te();break;case"ReferenceError":I=F();break;case"SyntaxError":I=z();break;case"TypeError":I=Q();break;case"URIError":I=ne();break;case"CompileError":I=w();break;case"LinkError":I=x();break;case"RuntimeError":I=R();break;default:I=j()}break;case"DOMException":I=new V(ve.message,ve.name);break;case"ArrayBuffer":case"SharedArrayBuffer":I=_e?new ue(ve,Le):qe(ve,re,Le);break;case"DataView":case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float16Array":case"Float32Array":case"Float64Array":case"BigInt64Array":case"BigUint64Array":J=Le==="DataView"?ve.byteLength:ve.length,I=_e?new ue(ve,Le,{offset:ve.byteOffset,length:J}):we(ve,Le,ve.byteOffset,J,re);break;case"DOMQuad":try{I=new DOMQuad(ae(ve.p1,re,_e),ae(ve.p2,re,_e),ae(ve.p3,re,_e),ae(ve.p4,re,_e))}catch{I=Ze(ve,Le)}break;case"File":if(Ce)try{I=Ce(ve),v(I)!==Le&&(I=void 0)}catch{}if(!I)try{I=new File([ve],ve.name,ve)}catch{}I||ge(Le);break;case"FileList":if(Z=Ke(),Z){for(H=0,J=g(ve);H<J;H++)Z.items.add(ae(ve[H],re,_e));I=Z.files}else I=Ze(ve,Le);break;case"ImageData":try{I=new ImageData(ae(ve.data,re,_e),ve.width,ve.height,{colorSpace:ve.colorSpace})}catch{I=Ze(ve,Le)}break;default:if(Ce)I=Ce(ve);else switch(Le){case"BigInt":I=$(ve.valueOf());break;case"Boolean":I=$(ye(ve));break;case"Number":I=$(xe(ve));break;case"String":I=$(Ve(ve));break;case"Date":I=new L(We(ve));break;case"Blob":try{I=ve.slice(0,ve.size,ve.type)}catch{ge(Le)}break;case"DOMPoint":case"DOMPointReadOnly":Te=i[Le];try{I=Te.fromPoint?Te.fromPoint(ve):new Te(ve.x,ve.y,ve.z,ve.w)}catch{ge(Le)}break;case"DOMRect":case"DOMRectReadOnly":Te=i[Le];try{I=Te.fromRect?Te.fromRect(ve):new Te(ve.x,ve.y,ve.width,ve.height)}catch{ge(Le)}break;case"DOMMatrix":case"DOMMatrixReadOnly":Te=i[Le];try{I=Te.fromMatrix?Te.fromMatrix(ve):new Te(ve)}catch{ge(Le)}break;case"AudioData":case"VideoFrame":u(ve.clone)||ge(Le);try{I=ve.clone()}catch{Ie(Le)}break;case"CropTarget":case"CryptoKey":case"FileSystemDirectoryHandle":case"FileSystemFileHandle":case"FileSystemHandle":case"GPUCompilationInfo":case"GPUCompilationMessage":case"ImageBitmap":case"RTCCertificate":case"WebAssembly.Module":ge(Le);default:Ie(Le)}}switch(ee(re,ve,I),Le){case"Array":case"Object":for(ce=Ae(ve),H=0,J=g(ce);H<J;H++)ke=ce[H],O(I,ke,ae(ve[ke],re,_e));break;case"Map":ve.forEach(function(X,oe){ee(I,ae(oe,re,_e),ae(X,re,_e))});break;case"Set":ve.forEach(function(X){he(I,ae(X,re,_e))});break;case"Error":k(I,"message",ae(ve.message,re,_e)),_(ve,"cause")&&k(I,"cause",ae(ve.cause,re,_e)),G==="AggregateError"&&(I.errors=ae(ve.errors,re,_e));case"DOMException":M&&k(I,"stack",ae(ve.stack,re,_e))}return I},ze=function(ve,re){if(!y(ve))return ve;if(Y(re,ve))return W(re,ve);var _e,Le,Te,G,I,Z,H,J;if(ve instanceof ue)switch(_e=ve.type,Le=ve.object,_e){case"ArrayBuffer":case"SharedArrayBuffer":J=qe(Le,re,_e);break;case"DataView":case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float16Array":case"Float32Array":case"Float64Array":case"BigInt64Array":case"BigUint64Array":Te=ve.metadata,J=we(Le,_e,Te.offset,Te.length,re)}else switch(v(ve)){case"Array":case"Object":for(Z=Ae(ve),G=0,I=g(Z);G<I;G++)H=Z[G],ve[H]=ze(ve[H],re);break;case"Map":J=new D,ve.forEach(function(ce,ke){ee(J,ze(ke,re),ze(ce,re))});break;case"Set":J=new me,ve.forEach(function(ce){he(J,ze(ce,re))});break;case"Error":ve.message=ze(ve.message,re),_(ve,"cause")&&(ve.cause=ze(ve.cause,re)),ve.name==="AggregateError"&&(ve.errors=ze(ve.errors,re));case"DOMException":M&&(ve.stack=ze(ve.stack,re))}return ee(re,ve,J||ve),J||ve},$e=function(ve,re){if(!y(ve))throw Q("Transfer option cannot be converted to a sequence");var _e=[];p(ve,function(X){ie(_e,f(X))});for(var Le=0,Te=g(_e),G=[],I,Z,H,J,ce,ke;Le<Te;){if(I=_e[Le++],Z=v(I),Z==="ArrayBuffer"){ie(G,I);continue}if(Y(re,I))throw new V("Duplicate transferable",He);if(P)J=Be(I,{transfer:[I]});else switch(Z){case"ImageBitmap":H=i.OffscreenCanvas,d(H)||ge(Z,Me);try{ce=new H(I.width,I.height),ke=ce.getContext("bitmaprenderer"),ke.transferFromImageBitmap(I),J=ce.transferToImageBitmap()}catch{}break;case"AudioData":case"VideoFrame":(!u(I.clone)||!u(I.close))&&ge(Z,Me);try{J=I.clone(),I.close()}catch{}break;case"MediaSourceHandle":case"MessagePort":case"OffscreenCanvas":case"ReadableStream":case"TransformStream":case"WritableStream":ge(Z,Me)}if(J===void 0)throw new V("This object cannot be transferred: "+Z,He);ee(re,I,J)}return G},nt=function(ve,re){for(var _e=0,Le=g(ve),Te,G;_e<Le;){if(Te=ve[_e++],Y(re,Te))throw new V("Duplicate transferable",He);P?G=Be(Te,{transfer:[Te]}):(u(Te.transfer)||ge("ArrayBuffer",Me),G=Te.transfer()),ee(re,Te,G)}};s({global:!0,enumerable:!0,sham:!P,forced:Ge},{structuredClone:function(re){var _e=b(arguments.length,1)>1&&!m(arguments[1])?f(arguments[1]):void 0,Le=_e?_e.transfer:void 0,Te=!1,G,I;Le!==void 0&&(G=new D,I=$e(Le,G),Te=!!g(I));var Z=ae(re,G,Te);return Te&&(G=new D,nt(Le,G),Z=ze(Z,G)),Z}})},(r,e,t)=>{var n=t(14),s=t(7),i=t(21),a=t(78),o=t(24),c=t(51),l=function(){},u=[],d=o("Reflect","construct"),m=/^\s*(?:class|function)\b/,y=n(m.exec),h=!m.exec(l),p=function(_){if(!i(_))return!1;try{return d(l,u,_),!0}catch{return!1}},f=function(_){if(!i(_))return!1;switch(a(_)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return h||!!y(m,c(_))}catch{return!0}};f.sham=!0,r.exports=!d||s(function(){var v;return p(p.call)||!p(Object)||!p(function(){v=!0})||v})?f:p},(r,e,t)=>{var n=t(99),s=t(8),i=t(47),a=t(32),o=t(155),c=t(64),l=t(25),u=t(157),d=t(158),m=t(140),y=TypeError,h=function(f,v){this.stopped=f,this.result=v},p=h.prototype;r.exports=function(f,v,_){var O=_&&_.that,k=!!(_&&_.AS_ENTRIES),g=!!(_&&_.IS_RECORD),b=!!(_&&_.IS_ITERATOR),N=!!(_&&_.INTERRUPTED),S=n(v,O),T,M,P,$,K,L,j,q=function(F){return T&&m(T,"normal",F),new h(!0,F)},te=function(F){return k?(i(F),N?S(F[0],F[1],q):S(F[0],F[1])):N?S(F,q):S(F)};if(g)T=f.iterator;else if(b)T=f;else{if(M=d(f),!M)throw y(a(f)+" is not iterable");if(o(M)){for(P=0,$=c(f);$>P;P++)if(K=te(f[P]),K&&l(p,K))return K;return new h(!1)}T=u(f,M)}for(L=g?f.next:T.next;!(j=s(L,T)).done;){try{K=te(j.value)}catch(F){m(T,"throw",F)}if(typeof K=="object"&&K&&l(p,K))return K}return new h(!1)}},(r,e,t)=>{var n=t(34),s=t(156),i=n("iterator"),a=Array.prototype;r.exports=function(o){return o!==void 0&&(s.Array===o||a[i]===o)}},r=>{r.exports={}},(r,e,t)=>{var n=t(8),s=t(31),i=t(47),a=t(32),o=t(158),c=TypeError;r.exports=function(l,u){var d=arguments.length<2?o(l):u;if(s(d))return i(n(d,l));throw c(a(l)+" is not iterable")}},(r,e,t)=>{var n=t(78),s=t(30),i=t(17),a=t(156),o=t(34),c=o("iterator");r.exports=function(l){if(!i(l))return s(l,c)||s(l,"@@iterator")||a[n(l)]}},(r,e,t)=>{var n=t(18),s=t(45),i=t(11);r.exports=function(a,o,c){var l=n(o);l in a?s.f(a,l,i(0,c)):a[l]=c}},(r,e,t)=>{var n=t(8),s=t(39),i=t(25),a=t(161),o=RegExp.prototype;r.exports=function(c){var l=c.flags;return l===void 0&&!("flags"in o)&&!s(c,"flags")&&i(o,c)?n(a,c):l}},(r,e,t)=>{var n=t(47);r.exports=function(){var s=n(this),i="";return s.hasIndices&&(i+="d"),s.global&&(i+="g"),s.ignoreCase&&(i+="i"),s.multiline&&(i+="m"),s.dotAll&&(i+="s"),s.unicode&&(i+="u"),s.unicodeSets&&(i+="v"),s.sticky&&(i+="y"),i}},(r,e,t)=>{var n=t(14),s=Map.prototype;r.exports={Map,set:n(s.set),get:n(s.get),has:n(s.has),remove:n(s.delete),proto:s}},(r,e,t)=>{var l,u,d,kn,y;Object.defineProperty(e,"__esModule",{value:!0}),e.SerializableEmpty=e.PrintAnnotationStorage=e.AnnotationStorage=void 0,t(89),t(149),t(152);var n=t(1),s=t(164),i=t(170);const a=Object.freeze({map:null,hash:"",transfers:void 0});e.SerializableEmpty=a;class o{constructor(){se(this,d);se(this,l,!1);se(this,u,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(p,f){const v=E(this,u).get(p);return v===void 0?f:Object.assign(f,v)}getRawValue(p){return E(this,u).get(p)}remove(p){if(E(this,u).delete(p),E(this,u).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const f of E(this,u).values())if(f instanceof s.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(p,f){const v=E(this,u).get(p);let _=!1;if(v!==void 0)for(const[O,k]of Object.entries(f))v[O]!==k&&(_=!0,v[O]=k);else _=!0,E(this,u).set(p,f);_&&le(this,d,kn).call(this),f instanceof s.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(f.constructor._type)}has(p){return E(this,u).has(p)}getAll(){return E(this,u).size>0?(0,n.objectFromMap)(E(this,u)):null}setAll(p){for(const[f,v]of Object.entries(p))this.setValue(f,v)}get size(){return E(this,u).size}resetModified(){E(this,l)&&(Se(this,l,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new c(this)}get serializable(){if(E(this,u).size===0)return a;const p=new Map,f=new i.MurmurHash3_64,v=[],_=Object.create(null);let O=!1;for(const[k,g]of E(this,u)){const b=g instanceof s.AnnotationEditor?g.serialize(!1,_):g;b&&(p.set(k,b),f.update(`${k}:${JSON.stringify(b)}`),O||(O=!!b.bitmap))}if(O)for(const k of p.values())k.bitmap&&v.push(k.bitmap);return p.size>0?{map:p,hash:f.hexdigest(),transfers:v}:a}}l=new WeakMap,u=new WeakMap,d=new WeakSet,kn=function(){E(this,l)||(Se(this,l,!0),typeof this.onSetModified=="function"&&this.onSetModified())},e.AnnotationStorage=o;class c extends o{constructor(f){super();se(this,y,void 0);const{map:v,hash:_,transfers:O}=f.serializable,k=structuredClone(v,null);Se(this,y,{map:k,hash:_,transfers:O})}get print(){(0,n.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return E(this,y)}}y=new WeakMap,e.PrintAnnotationStorage=c},(r,e,t)=>{var o,c,l,u,d,m,y,h,p,f,Zt,_,Qt,k,qt,b,On,S,Pn,M,Rn,$,In,L,Mn;Object.defineProperty(e,"__esModule",{value:!0}),e.AnnotationEditor=void 0,t(89),t(2);var n=t(165),s=t(1);const q=class q{constructor(F){se(this,f);se(this,k);se(this,S);se(this,M);se(this,$);se(this,L);se(this,o,!1);se(this,c,null);se(this,l,this.focusin.bind(this));se(this,u,this.focusout.bind(this));se(this,d,!1);se(this,m,!1);se(this,y,!1);rt(this,"_initialOptions",Object.create(null));rt(this,"_uiManager",null);rt(this,"_focusEventsAllowed",!0);se(this,h,!1);se(this,p,q._zIndex++);this.constructor===q&&(0,s.unreachable)("Cannot initialize AnnotationEditor."),this.parent=F.parent,this.id=F.id,this.width=this.height=null,this.pageIndex=F.parent.pageIndex,this.name=F.name,this.div=null,this._uiManager=F.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=F.isCentered;const{rotation:z,rawDims:{pageWidth:Q,pageHeight:ne,pageX:de,pageY:U}}=this.parent.viewport;this.rotation=z,this.pageRotation=(360+z-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[Q,ne],this.pageTranslation=[de,U];const[w,x]=this.parentDimensions;this.x=F.x/w,this.y=F.y/x,this.isAttachedToDOM=!1,this.deleted=!1}static get _defaultLineColor(){return(0,s.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(F){const z=new a({id:F.parent.getNextId(),parent:F.parent,uiManager:F._uiManager});z.annotationElementId=F.annotationElementId,z.deleted=!0,z._uiManager.addToAnnotationStorage(z)}static initialize(F){}static updateDefaultParams(F,z){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(F){return!1}static paste(F,z){(0,s.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return E(this,h)}set _isDraggable(F){var z;Se(this,h,F),(z=this.div)==null||z.classList.toggle("draggable",F)}center(){const[F,z]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*z/(F*2),this.y+=this.width*F/(z*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*z/(F*2),this.y-=this.width*F/(z*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(F){this._uiManager.addCommands(F)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=E(this,p)}setParent(F){F!==null&&(this.pageIndex=F.pageIndex,this.pageDimensions=F.pageDimensions),this.parent=F}focusin(F){this._focusEventsAllowed&&(E(this,d)?Se(this,d,!1):this.parent.setSelected(this))}focusout(F){var Q;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const z=F.relatedTarget;z!=null&&z.closest(`#${this.id}`)||(F.preventDefault(),(Q=this.parent)!=null&&Q.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(F,z,Q,ne){const[de,U]=this.parentDimensions;[Q,ne]=this.screenToPageTranslation(Q,ne),this.x=(F+Q)/de,this.y=(z+ne)/U,this.fixAndSetPosition()}translate(F,z){le(this,f,Zt).call(this,this.parentDimensions,F,z)}translateInPage(F,z){le(this,f,Zt).call(this,this.pageDimensions,F,z),this.moveInDOM(),this.div.scrollIntoView({block:"nearest"})}drag(F,z){const[Q,ne]=this.parentDimensions;if(this.x+=F/Q,this.y+=z/ne,this.x<0||this.x>1||this.y<0||this.y>1){const{x:de,y:U}=this.div.getBoundingClientRect();this.parent.findNewParent(this,de,U)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}this.div.style.left=`${(100*this.x).toFixed(2)}%`,this.div.style.top=`${(100*this.y).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}fixAndSetPosition(){const[F,z]=this.pageDimensions;let{x:Q,y:ne,width:de,height:U}=this;switch(de*=F,U*=z,Q*=F,ne*=z,this.rotation){case 0:Q=Math.max(0,Math.min(F-de,Q)),ne=Math.max(0,Math.min(z-U,ne));break;case 90:Q=Math.max(0,Math.min(F-U,Q)),ne=Math.min(z,Math.max(de,ne));break;case 180:Q=Math.min(F,Math.max(de,Q)),ne=Math.min(z,Math.max(U,ne));break;case 270:Q=Math.min(F,Math.max(U,Q)),ne=Math.max(0,Math.min(z-de,ne));break}this.x=Q/F,this.y=ne/z,this.div.style.left=`${(100*this.x).toFixed(2)}%`,this.div.style.top=`${(100*this.y).toFixed(2)}%`}screenToPageTranslation(F,z){var Q;return le(Q=q,_,Qt).call(Q,F,z,this.parentRotation)}pageTranslationToScreen(F,z){var Q;return le(Q=q,_,Qt).call(Q,F,z,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:F,pageDimensions:[z,Q]}=this,ne=z*F,de=Q*F;return s.FeatureTest.isCSSRoundSupported?[Math.round(ne),Math.round(de)]:[ne,de]}setDims(F,z){const[Q,ne]=this.parentDimensions;this.div.style.width=`${(100*F/Q).toFixed(2)}%`,E(this,o)||(this.div.style.height=`${(100*z/ne).toFixed(2)}%`)}fixDims(){const{style:F}=this.div,{height:z,width:Q}=F,ne=Q.endsWith("%"),de=!E(this,o)&&z.endsWith("%");if(ne&&de)return;const[U,w]=this.parentDimensions;ne||(F.width=`${(100*parseFloat(Q)/U).toFixed(2)}%`),!E(this,o)&&!de&&(F.height=`${(100*parseFloat(z)/w).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",E(this,l)),this.div.addEventListener("focusout",E(this,u));const[F,z]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*z/F).toFixed(2)}%`,this.div.style.maxHeight=`${(100*F/z).toFixed(2)}%`);const[Q,ne]=this.getInitialTranslation();return this.translate(Q,ne),(0,n.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(F){const{isMac:z}=s.FeatureTest.platform;if(F.button!==0||F.ctrlKey&&z){F.preventDefault();return}Se(this,d,!0),le(this,L,Mn).call(this,F)}moveInDOM(){this.parent.moveEditorInDOM(this)}_setParentAndPosition(F,z,Q){F.changeParent(this),this.x=z,this.y=Q,this.fixAndSetPosition(),this.moveInDOM()}getRect(F,z){const Q=this.parentScale,[ne,de]=this.pageDimensions,[U,w]=this.pageTranslation,x=F/Q,R=z/Q,V=this.x*ne,D=this.y*de,Y=this.width*ne,W=this.height*de;switch(this.rotation){case 0:return[V+x+U,de-D-R-W+w,V+x+Y+U,de-D-R+w];case 90:return[V+R+U,de-D+x+w,V+R+W+U,de-D+x+Y+w];case 180:return[V-x-Y+U,de-D+R+w,V-x+U,de-D+R+W+w];case 270:return[V-R-W+U,de-D-x-Y+w,V-R+U,de-D-x+w];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(F,z){const[Q,ne,de,U]=F,w=de-Q,x=U-ne;switch(this.rotation){case 0:return[Q,z-U,w,x];case 90:return[Q,z-ne,x,w];case 180:return[de,z-ne,w,x];case 270:return[de,z-U,x,w];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){Se(this,y,!0)}disableEditMode(){Se(this,y,!1)}isInEditMode(){return E(this,y)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var F,z;(F=this.div)==null||F.addEventListener("focusin",E(this,l)),(z=this.div)==null||z.addEventListener("focusout",E(this,u))}serialize(){(0,s.unreachable)("An editor must be serializable")}static deserialize(F,z,Q){const ne=new this.prototype.constructor({parent:z,id:z.getNextId(),uiManager:Q});ne.rotation=F.rotation;const[de,U]=ne.pageDimensions,[w,x,R,V]=ne.getRectInCurrentCoords(F.rect,U);return ne.x=w/de,ne.y=x/U,ne.width=R/de,ne.height=V/U,ne}remove(){this.div.removeEventListener("focusin",E(this,l)),this.div.removeEventListener("focusout",E(this,u)),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this)}get isResizable(){return!1}makeResizable(){this.isResizable&&(le(this,S,Pn).call(this),E(this,c).classList.remove("hidden"))}select(){var F;this.makeResizable(),(F=this.div)==null||F.classList.add("selectedEditor")}unselect(){var F,z,Q;(F=E(this,c))==null||F.classList.add("hidden"),(z=this.div)==null||z.classList.remove("selectedEditor"),(Q=this.div)!=null&&Q.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus()}updateParams(F,z){}disableEditing(){}enableEditing(){}enterInEditMode(){}get contentDiv(){return this.div}get isEditing(){return E(this,m)}set isEditing(F){Se(this,m,F),this.parent&&(F?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(F,z){Se(this,o,!0);const Q=F/z,{style:ne}=this.div;ne.aspectRatio=Q,ne.height="auto"}static get MIN_SIZE(){return 16}};o=new WeakMap,c=new WeakMap,l=new WeakMap,u=new WeakMap,d=new WeakMap,m=new WeakMap,y=new WeakMap,h=new WeakMap,p=new WeakMap,f=new WeakSet,Zt=function(F,z,Q){let[ne,de]=F;[z,Q]=this.screenToPageTranslation(z,Q),this.x+=z/ne,this.y+=Q/de,this.fixAndSetPosition()},_=new WeakSet,Qt=function(F,z,Q){switch(Q){case 90:return[z,-F];case 180:return[-F,-z];case 270:return[-z,F];default:return[F,z]}},k=new WeakSet,qt=function(F){switch(F){case 90:{const[z,Q]=this.pageDimensions;return[0,-z/Q,Q/z,0]}case 180:return[-1,0,0,-1];case 270:{const[z,Q]=this.pageDimensions;return[0,z/Q,-Q/z,0]}default:return[1,0,0,1]}},b=new WeakSet,On=function(F){F.preventDefault()},S=new WeakSet,Pn=function(){if(E(this,c))return;Se(this,c,document.createElement("div")),E(this,c).classList.add("resizers");const F=["topLeft","topRight","bottomRight","bottomLeft"];this._willKeepAspectRatio||F.push("topMiddle","middleRight","bottomMiddle","middleLeft");for(const z of F){const Q=document.createElement("div");E(this,c).append(Q),Q.classList.add("resizer",z),Q.addEventListener("pointerdown",le(this,M,Rn).bind(this,z)),Q.addEventListener("contextmenu",le(q,b,On))}this.div.prepend(E(this,c))},M=new WeakSet,Rn=function(F,z){z.preventDefault();const{isMac:Q}=s.FeatureTest.platform;if(z.button!==0||z.ctrlKey&&Q)return;const ne=le(this,$,In).bind(this,F),de=this._isDraggable;this._isDraggable=!1;const U={passive:!0,capture:!0};window.addEventListener("pointermove",ne,U);const w=this.x,x=this.y,R=this.width,V=this.height,D=this.parent.div.style.cursor,Y=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(z.target).cursor;const W=()=>{this._isDraggable=de,window.removeEventListener("pointerup",W),window.removeEventListener("blur",W),window.removeEventListener("pointermove",ne,U),this.parent.div.style.cursor=D,this.div.style.cursor=Y;const ee=this.x,me=this.y,he=this.width,Ae=this.height;ee===w&&me===x&&he===R&&Ae===V||this.addCommands({cmd:()=>{this.width=he,this.height=Ae,this.x=ee,this.y=me;const[ie,ye]=this.parentDimensions;this.setDims(ie*he,ye*Ae),this.fixAndSetPosition(),this.moveInDOM()},undo:()=>{this.width=R,this.height=V,this.x=w,this.y=x;const[ie,ye]=this.parentDimensions;this.setDims(ie*R,ye*V),this.fixAndSetPosition(),this.moveInDOM()},mustExec:!0})};window.addEventListener("pointerup",W),window.addEventListener("blur",W)},$=new WeakSet,In=function(F,z){const[Q,ne]=this.parentDimensions,de=this.x,U=this.y,w=this.width,x=this.height,R=q.MIN_SIZE/Q,V=q.MIN_SIZE/ne,D=Ie=>Math.round(Ie*1e4)/1e4,Y=le(this,k,qt).call(this,this.rotation),W=(Ie,ge)=>[Y[0]*Ie+Y[2]*ge,Y[1]*Ie+Y[3]*ge],ee=le(this,k,qt).call(this,360-this.rotation),me=(Ie,ge)=>[ee[0]*Ie+ee[2]*ge,ee[1]*Ie+ee[3]*ge];let he,Ae,ie=!1,ye=!1;switch(F){case"topLeft":ie=!0,he=(Ie,ge)=>[0,0],Ae=(Ie,ge)=>[Ie,ge];break;case"topMiddle":he=(Ie,ge)=>[Ie/2,0],Ae=(Ie,ge)=>[Ie/2,ge];break;case"topRight":ie=!0,he=(Ie,ge)=>[Ie,0],Ae=(Ie,ge)=>[0,ge];break;case"middleRight":ye=!0,he=(Ie,ge)=>[Ie,ge/2],Ae=(Ie,ge)=>[0,ge/2];break;case"bottomRight":ie=!0,he=(Ie,ge)=>[Ie,ge],Ae=(Ie,ge)=>[0,0];break;case"bottomMiddle":he=(Ie,ge)=>[Ie/2,ge],Ae=(Ie,ge)=>[Ie/2,0];break;case"bottomLeft":ie=!0,he=(Ie,ge)=>[0,ge],Ae=(Ie,ge)=>[Ie,0];break;case"middleLeft":ye=!0,he=(Ie,ge)=>[0,ge/2],Ae=(Ie,ge)=>[Ie,ge/2];break}const xe=he(w,x),Ve=Ae(w,x);let We=W(...Ve);const Pe=D(de+We[0]),He=D(U+We[1]);let Me=1,be=1,[fe,Ee]=this.screenToPageTranslation(z.movementX,z.movementY);if([fe,Ee]=me(fe/Q,Ee/ne),ie){const Ie=Math.hypot(w,x);Me=be=Math.max(Math.min(Math.hypot(Ve[0]-xe[0]-fe,Ve[1]-xe[1]-Ee)/Ie,1/w,1/x),R/w,V/x)}else ye?Me=Math.max(R,Math.min(1,Math.abs(Ve[0]-xe[0]-fe)))/w:be=Math.max(V,Math.min(1,Math.abs(Ve[1]-xe[1]-Ee)))/x;const Be=D(w*Me),Ge=D(x*be);We=W(...Ae(Be,Ge));const Re=Pe-We[0],Ce=He-We[1];this.width=Be,this.height=Ge,this.x=Re,this.y=Ce,this.setDims(Q*Be,ne*Ge),this.fixAndSetPosition()},L=new WeakSet,Mn=function(F){if(!this._isDraggable)return;const z=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let Q,ne;z&&(Q={passive:!0,capture:!0},ne=U=>{const[w,x]=this.screenToPageTranslation(U.movementX,U.movementY);this._uiManager.dragSelectedEditors(w,x)},window.addEventListener("pointermove",ne,Q));const de=()=>{if(window.removeEventListener("pointerup",de),window.removeEventListener("blur",de),z&&window.removeEventListener("pointermove",ne,Q),Se(this,d,!1),!this._uiManager.endDragSession()){const{isMac:U}=s.FeatureTest.platform;F.ctrlKey&&!U||F.shiftKey||F.metaKey&&U?this.parent.toggleSelected(this):this.parent.setSelected(this)}};window.addEventListener("pointerup",de),window.addEventListener("blur",de)},se(q,_),se(q,b),rt(q,"_colorManager",new n.ColorManager),rt(q,"_zIndex",1);let i=q;e.AnnotationEditor=i;class a extends i{constructor(F){super(F),this.annotationElementId=F.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},(r,e,t)=>{var y,h,p,f,v,Jt,k,g,b,N,S,Dn,P,$,K,L,j,q,te,F,z,Q,ne,de,U,w,x,R,V,D,Y,W,ee,me,he,Ae,ie,ye,xe,Ve,We,Pe,He,Me,be,fe,Ee,Fn,Ge,en,Ce,Ln,ge,tn,Ke,Bn,we,Vn,ae,ft,$e,Nt,ve,Wn,_e,Un,Te,nn,I,kt,H,rn;Object.defineProperty(e,"__esModule",{value:!0}),e.KeyboardManager=e.CommandManager=e.ColorManager=e.AnnotationEditorUIManager=void 0,e.bindEvents=i,e.opacityToHex=a,t(93),t(101),t(102),t(105),t(107),t(109),t(113),t(116),t(123),t(2),t(89),t(125),t(136),t(138),t(141),t(143),t(145),t(147),t(166);var n=t(1),s=t(168);function i(ke,X,oe){for(const pe of oe)X.addEventListener(pe,ke[pe].bind(ke))}function a(ke){return Math.round(Math.min(255,Math.max(1,255*ke))).toString(16).padStart(2,"0")}class o{constructor(){se(this,y,0)}getId(){return`${n.AnnotationEditorPrefix}${xt(this,y)._++}`}}y=new WeakMap;const O=class O{constructor(){se(this,v);se(this,h,(0,n.getUuid)());se(this,p,0);se(this,f,null)}static get _isSVGFittingCanvas(){const X='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',pe=new OffscreenCanvas(1,3).getContext("2d"),De=new Image;De.src=X;const Oe=De.decode().then(()=>(pe.drawImage(De,0,0,1,1,0,0,1,3),new Uint32Array(pe.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,n.shadow)(this,"_isSVGFittingCanvas",Oe)}async getFromFile(X){const{lastModified:oe,name:pe,size:De,type:Oe}=X;return le(this,v,Jt).call(this,`${oe}_${pe}_${De}_${Oe}`,X)}async getFromUrl(X){return le(this,v,Jt).call(this,X,X)}async getFromId(X){E(this,f)||Se(this,f,new Map);const oe=E(this,f).get(X);return oe?oe.bitmap?(oe.refCounter+=1,oe):oe.file?this.getFromFile(oe.file):this.getFromUrl(oe.url):null}getSvgUrl(X){const oe=E(this,f).get(X);return oe!=null&&oe.isSvg?oe.svgUrl:null}deleteId(X){E(this,f)||Se(this,f,new Map);const oe=E(this,f).get(X);oe&&(oe.refCounter-=1,oe.refCounter===0&&(oe.bitmap=null))}isValidId(X){return X.startsWith(`image_${E(this,h)}_`)}};h=new WeakMap,p=new WeakMap,f=new WeakMap,v=new WeakSet,Jt=async function(X,oe){E(this,f)||Se(this,f,new Map);let pe=E(this,f).get(X);if(pe===null)return null;if(pe!=null&&pe.bitmap)return pe.refCounter+=1,pe;try{pe||(pe={bitmap:null,id:`image_${E(this,h)}_${xt(this,p)._++}`,refCounter:0,isSvg:!1});let De;if(typeof oe=="string"){pe.url=oe;const Oe=await fetch(oe);if(!Oe.ok)throw new Error(Oe.statusText);De=await Oe.blob()}else De=pe.file=oe;if(De.type==="image/svg+xml"){const Oe=O._isSVGFittingCanvas,Fe=new FileReader,Ue=new Image,Ye=new Promise((Je,et)=>{Ue.onload=()=>{pe.bitmap=Ue,pe.isSvg=!0,Je()},Fe.onload=async()=>{const it=pe.svgUrl=Fe.result;Ue.src=await Oe?`${it}#svgView(preserveAspectRatio(none))`:it},Ue.onerror=Fe.onerror=et});Fe.readAsDataURL(De),await Ye}else pe.bitmap=await createImageBitmap(De);pe.refCounter=1}catch(De){console.error(De),pe=null}return E(this,f).set(X,pe),pe&&E(this,f).set(pe.id,pe),pe};let c=O;class l{constructor(){se(this,k,[]);se(this,g,!1);se(this,b,void 0);se(this,N,-1);let X=arguments.length>0&&arguments[0]!==void 0?arguments[0]:128;Se(this,b,X)}add(X){let{cmd:oe,undo:pe,mustExec:De,type:Oe=NaN,overwriteIfSameType:Fe=!1,keepUndo:Ue=!1}=X;if(De&&oe(),E(this,g))return;const Ye={cmd:oe,undo:pe,type:Oe};if(E(this,N)===-1){E(this,k).length>0&&(E(this,k).length=0),Se(this,N,0),E(this,k).push(Ye);return}if(Fe&&E(this,k)[E(this,N)].type===Oe){Ue&&(Ye.undo=E(this,k)[E(this,N)].undo),E(this,k)[E(this,N)]=Ye;return}const Je=E(this,N)+1;Je===E(this,b)?E(this,k).splice(0,1):(Se(this,N,Je),Je<E(this,k).length&&E(this,k).splice(Je)),E(this,k).push(Ye)}undo(){E(this,N)!==-1&&(Se(this,g,!0),E(this,k)[E(this,N)].undo(),Se(this,g,!1),Se(this,N,E(this,N)-1))}redo(){E(this,N)<E(this,k).length-1&&(Se(this,N,E(this,N)+1),Se(this,g,!0),E(this,k)[E(this,N)].cmd(),Se(this,g,!1))}hasSomethingToUndo(){return E(this,N)!==-1}hasSomethingToRedo(){return E(this,N)<E(this,k).length-1}destroy(){Se(this,k,null)}}k=new WeakMap,g=new WeakMap,b=new WeakMap,N=new WeakMap,e.CommandManager=l;class u{constructor(X){se(this,S);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:oe}=n.FeatureTest.platform;for(const[pe,De,Oe={}]of X)for(const Fe of pe){const Ue=Fe.startsWith("mac+");oe&&Ue?(this.callbacks.set(Fe.slice(4),{callback:De,options:Oe}),this.allKeys.add(Fe.split("+").at(-1))):!oe&&!Ue&&(this.callbacks.set(Fe,{callback:De,options:Oe}),this.allKeys.add(Fe.split("+").at(-1)))}}exec(X,oe){if(!this.allKeys.has(oe.key))return;const pe=this.callbacks.get(le(this,S,Dn).call(this,oe));if(!pe)return;const{callback:De,options:{bubbles:Oe=!1,args:Fe=[],checker:Ue=null}}=pe;Ue&&!Ue(X,oe)||(De.bind(X,...Fe)(),Oe||(oe.stopPropagation(),oe.preventDefault()))}}S=new WeakSet,Dn=function(X){X.altKey&&this.buffer.push("alt"),X.ctrlKey&&this.buffer.push("ctrl"),X.metaKey&&this.buffer.push("meta"),X.shiftKey&&this.buffer.push("shift"),this.buffer.push(X.key);const oe=this.buffer.join("+");return this.buffer.length=0,oe},e.KeyboardManager=u;const M=class M{get _colors(){const X=new Map([["CanvasText",null],["Canvas",null]]);return(0,s.getColorValues)(X),(0,n.shadow)(this,"_colors",X)}convert(X){const oe=(0,s.getRGB)(X);if(!window.matchMedia("(forced-colors: active)").matches)return oe;for(const[pe,De]of this._colors)if(De.every((Oe,Fe)=>Oe===oe[Fe]))return M._colorsMapping.get(pe);return oe}getHexCode(X){const oe=this._colors.get(X);return oe?n.Util.makeHexColor(...oe):X}};rt(M,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let d=M;e.ColorManager=d;const ce=class ce{constructor(X,oe,pe,De,Oe){se(this,Ee);se(this,Ge);se(this,Ce);se(this,ge);se(this,Ke);se(this,we);se(this,ae);se(this,$e);se(this,ve);se(this,_e);se(this,Te);se(this,I);se(this,H);se(this,P,null);se(this,$,new Map);se(this,K,new Map);se(this,L,null);se(this,j,new l);se(this,q,0);se(this,te,new Set);se(this,F,null);se(this,z,null);se(this,Q,new Set);se(this,ne,null);se(this,de,null);se(this,U,new o);se(this,w,!1);se(this,x,!1);se(this,R,null);se(this,V,n.AnnotationEditorType.NONE);se(this,D,new Set);se(this,Y,null);se(this,W,this.blur.bind(this));se(this,ee,this.focus.bind(this));se(this,me,this.copy.bind(this));se(this,he,this.cut.bind(this));se(this,Ae,this.paste.bind(this));se(this,ie,this.keydown.bind(this));se(this,ye,this.onEditingAction.bind(this));se(this,xe,this.onPageChanging.bind(this));se(this,Ve,this.onScaleChanging.bind(this));se(this,We,this.onRotationChanging.bind(this));se(this,Pe,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});se(this,He,[0,0]);se(this,Me,null);se(this,be,null);se(this,fe,null);Se(this,be,X),Se(this,fe,oe),Se(this,ne,pe),E(this,ne)._on("editingaction",E(this,ye)),E(this,ne)._on("pagechanging",E(this,xe)),E(this,ne)._on("scalechanging",E(this,Ve)),E(this,ne)._on("rotationchanging",E(this,We)),Se(this,L,De.annotationStorage),Se(this,de,De.filterFactory),Se(this,Y,Oe),this.viewParameters={realScale:s.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}static get _keyboardManager(){const X=ce.prototype,oe=Oe=>{const{activeElement:Fe}=document;return Fe&&E(Oe,be).contains(Fe)&&Oe.hasSomethingToControl()},pe=this.TRANSLATE_SMALL,De=this.TRANSLATE_BIG;return(0,n.shadow)(this,"_keyboardManager",new u([[["ctrl+a","mac+meta+a"],X.selectAll],[["ctrl+z","mac+meta+z"],X.undo],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],X.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],X.delete],[["Escape","mac+Escape"],X.unselectAll],[["ArrowLeft","mac+ArrowLeft"],X.translateSelectedEditors,{args:[-pe,0],checker:oe}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],X.translateSelectedEditors,{args:[-De,0],checker:oe}],[["ArrowRight","mac+ArrowRight"],X.translateSelectedEditors,{args:[pe,0],checker:oe}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],X.translateSelectedEditors,{args:[De,0],checker:oe}],[["ArrowUp","mac+ArrowUp"],X.translateSelectedEditors,{args:[0,-pe],checker:oe}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],X.translateSelectedEditors,{args:[0,-De],checker:oe}],[["ArrowDown","mac+ArrowDown"],X.translateSelectedEditors,{args:[0,pe],checker:oe}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],X.translateSelectedEditors,{args:[0,De],checker:oe}]]))}destroy(){le(this,ge,tn).call(this),le(this,Ge,en).call(this),E(this,ne)._off("editingaction",E(this,ye)),E(this,ne)._off("pagechanging",E(this,xe)),E(this,ne)._off("scalechanging",E(this,Ve)),E(this,ne)._off("rotationchanging",E(this,We));for(const X of E(this,K).values())X.destroy();E(this,K).clear(),E(this,$).clear(),E(this,Q).clear(),Se(this,P,null),E(this,D).clear(),E(this,j).destroy()}get hcmFilter(){return(0,n.shadow)(this,"hcmFilter",E(this,Y)?E(this,de).addHCMFilter(E(this,Y).foreground,E(this,Y).background):"none")}onPageChanging(X){let{pageNumber:oe}=X;Se(this,q,oe-1)}focusMainContainer(){E(this,be).focus()}findParent(X,oe){for(const pe of E(this,K).values()){const{x:De,y:Oe,width:Fe,height:Ue}=pe.div.getBoundingClientRect();if(X>=De&&X<=De+Fe&&oe>=Oe&&oe<=Oe+Ue)return pe}return null}disableUserSelect(){let X=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;E(this,fe).classList.toggle("noUserSelect",X)}addShouldRescale(X){E(this,Q).add(X)}removeShouldRescale(X){E(this,Q).delete(X)}onScaleChanging(X){let{scale:oe}=X;this.commitOrRemove(),this.viewParameters.realScale=oe*s.PixelsPerInch.PDF_TO_CSS_UNITS;for(const pe of E(this,Q))pe.onScaleChanging()}onRotationChanging(X){let{pagesRotation:oe}=X;this.commitOrRemove(),this.viewParameters.rotation=oe}addToAnnotationStorage(X){!X.isEmpty()&&E(this,L)&&!E(this,L).has(X.id)&&E(this,L).setValue(X.id,X)}blur(){if(!this.hasSelection)return;const{activeElement:X}=document;for(const oe of E(this,D))if(oe.div.contains(X)){Se(this,R,[oe,X]),oe._focusEventsAllowed=!1;break}}focus(){if(!E(this,R))return;const[X,oe]=E(this,R);Se(this,R,null),oe.addEventListener("focusin",()=>{X._focusEventsAllowed=!0},{once:!0}),oe.focus()}copy(X){var pe;if(X.preventDefault(),(pe=E(this,P))==null||pe.commitOrRemove(),!this.hasSelection)return;const oe=[];for(const De of E(this,D)){const Oe=De.serialize(!0);Oe&&oe.push(Oe)}oe.length!==0&&X.clipboardData.setData("application/pdfjs",JSON.stringify(oe))}cut(X){this.copy(X),this.delete()}paste(X){X.preventDefault();const{clipboardData:oe}=X;for(const Oe of oe.items)for(const Fe of E(this,z))if(Fe.isHandlingMimeForPasting(Oe.type)){Fe.paste(Oe,this.currentLayer);return}let pe=oe.getData("application/pdfjs");if(!pe)return;try{pe=JSON.parse(pe)}catch(Oe){(0,n.warn)(`paste: "${Oe.message}".`);return}if(!Array.isArray(pe))return;this.unselectAll();const De=this.currentLayer;try{const Oe=[];for(const Ye of pe){const Je=De.deserialize(Ye);if(!Je)return;Oe.push(Je)}const Fe=()=>{for(const Ye of Oe)le(this,Te,nn).call(this,Ye);le(this,H,rn).call(this,Oe)},Ue=()=>{for(const Ye of Oe)Ye.remove()};this.addCommands({cmd:Fe,undo:Ue,mustExec:!0})}catch(Oe){(0,n.warn)(`paste: "${Oe.message}".`)}}keydown(X){var oe;(oe=this.getActive())!=null&&oe.shouldGetKeyboardEvents()||ce._keyboardManager.exec(this,X)}onEditingAction(X){["undo","redo","delete","selectAll"].includes(X.name)&&this[X.name]()}setEditingState(X){X?(le(this,Ee,Fn).call(this),le(this,Ce,Ln).call(this),le(this,Ke,Bn).call(this),le(this,ae,ft).call(this,{isEditing:E(this,V)!==n.AnnotationEditorType.NONE,isEmpty:le(this,I,kt).call(this),hasSomethingToUndo:E(this,j).hasSomethingToUndo(),hasSomethingToRedo:E(this,j).hasSomethingToRedo(),hasSelectedEditor:!1})):(le(this,Ge,en).call(this),le(this,ge,tn).call(this),le(this,we,Vn).call(this),le(this,ae,ft).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(X){if(!E(this,z)){Se(this,z,X);for(const oe of E(this,z))le(this,$e,Nt).call(this,oe.defaultPropertiesToUpdate)}}getId(){return E(this,U).getId()}get currentLayer(){return E(this,K).get(E(this,q))}getLayer(X){return E(this,K).get(X)}get currentPageIndex(){return E(this,q)}addLayer(X){E(this,K).set(X.pageIndex,X),E(this,w)?X.enable():X.disable()}removeLayer(X){E(this,K).delete(X.pageIndex)}updateMode(X){let oe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(E(this,V)!==X){if(Se(this,V,X),X===n.AnnotationEditorType.NONE){this.setEditingState(!1),le(this,_e,Un).call(this);return}this.setEditingState(!0),le(this,ve,Wn).call(this),this.unselectAll();for(const pe of E(this,K).values())pe.updateMode(X);if(oe){for(const pe of E(this,$).values())if(pe.annotationElementId===oe){this.setSelected(pe),pe.enterInEditMode();break}}}}updateToolbar(X){X!==E(this,V)&&E(this,ne).dispatch("switchannotationeditormode",{source:this,mode:X})}updateParams(X,oe){if(E(this,z)){if(X===n.AnnotationEditorParamsType.CREATE){this.currentLayer.addNewEditor(X);return}for(const pe of E(this,D))pe.updateParams(X,oe);for(const pe of E(this,z))pe.updateDefaultParams(X,oe)}}enableWaiting(){let X=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(E(this,x)!==X){Se(this,x,X);for(const oe of E(this,K).values())X?oe.disableClick():oe.enableClick(),oe.div.classList.toggle("waiting",X)}}getEditors(X){const oe=[];for(const pe of E(this,$).values())pe.pageIndex===X&&oe.push(pe);return oe}getEditor(X){return E(this,$).get(X)}addEditor(X){E(this,$).set(X.id,X)}removeEditor(X){var oe;E(this,$).delete(X.id),this.unselect(X),(!X.annotationElementId||!E(this,te).has(X.annotationElementId))&&((oe=E(this,L))==null||oe.remove(X.id))}addDeletedAnnotationElement(X){E(this,te).add(X.annotationElementId),X.deleted=!0}isDeletedAnnotationElement(X){return E(this,te).has(X)}removeDeletedAnnotationElement(X){E(this,te).delete(X.annotationElementId),X.deleted=!1}setActiveEditor(X){E(this,P)!==X&&(Se(this,P,X),X&&le(this,$e,Nt).call(this,X.propertiesToUpdate))}toggleSelected(X){if(E(this,D).has(X)){E(this,D).delete(X),X.unselect(),le(this,ae,ft).call(this,{hasSelectedEditor:this.hasSelection});return}E(this,D).add(X),X.select(),le(this,$e,Nt).call(this,X.propertiesToUpdate),le(this,ae,ft).call(this,{hasSelectedEditor:!0})}setSelected(X){for(const oe of E(this,D))oe!==X&&oe.unselect();E(this,D).clear(),E(this,D).add(X),X.select(),le(this,$e,Nt).call(this,X.propertiesToUpdate),le(this,ae,ft).call(this,{hasSelectedEditor:!0})}isSelected(X){return E(this,D).has(X)}unselect(X){X.unselect(),E(this,D).delete(X),le(this,ae,ft).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return E(this,D).size!==0}undo(){E(this,j).undo(),le(this,ae,ft).call(this,{hasSomethingToUndo:E(this,j).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:le(this,I,kt).call(this)})}redo(){E(this,j).redo(),le(this,ae,ft).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:E(this,j).hasSomethingToRedo(),isEmpty:le(this,I,kt).call(this)})}addCommands(X){E(this,j).add(X),le(this,ae,ft).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:le(this,I,kt).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const X=[...E(this,D)],oe=()=>{for(const De of X)De.remove()},pe=()=>{for(const De of X)le(this,Te,nn).call(this,De)};this.addCommands({cmd:oe,undo:pe,mustExec:!0})}commitOrRemove(){var X;(X=E(this,P))==null||X.commitOrRemove()}hasSomethingToControl(){return E(this,P)||this.hasSelection}selectAll(){for(const X of E(this,D))X.commit();le(this,H,rn).call(this,E(this,$).values())}unselectAll(){if(E(this,P)){E(this,P).commitOrRemove();return}if(this.hasSelection){for(const X of E(this,D))X.unselect();E(this,D).clear(),le(this,ae,ft).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(X,oe){if((arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1)||this.commitOrRemove(),!this.hasSelection)return;E(this,He)[0]+=X,E(this,He)[1]+=oe;const[De,Oe]=E(this,He),Fe=[...E(this,D)],Ue=1e3;E(this,Me)&&clearTimeout(E(this,Me)),Se(this,Me,setTimeout(()=>{Se(this,Me,null),E(this,He)[0]=E(this,He)[1]=0,this.addCommands({cmd:()=>{for(const Ye of Fe)E(this,$).has(Ye.id)&&Ye.translateInPage(De,Oe)},undo:()=>{for(const Ye of Fe)E(this,$).has(Ye.id)&&Ye.translateInPage(-De,-Oe)},mustExec:!1})},Ue));for(const Ye of Fe)Ye.translateInPage(X,oe)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),Se(this,F,new Map);for(const X of E(this,D))E(this,F).set(X,{savedX:X.x,savedY:X.y,savedPageIndex:X.parent.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!E(this,F))return!1;this.disableUserSelect(!1);const X=E(this,F);Se(this,F,null);let oe=!1;for(const[{x:De,y:Oe,parent:Fe},Ue]of X)Ue.newX=De,Ue.newY=Oe,Ue.newPageIndex=Fe.pageIndex,oe||(oe=De!==Ue.savedX||Oe!==Ue.savedY||Fe.pageIndex!==Ue.savedPageIndex);if(!oe)return!1;const pe=(De,Oe,Fe,Ue)=>{if(E(this,$).has(De.id)){const Ye=E(this,K).get(Ue);Ye?De._setParentAndPosition(Ye,Oe,Fe):(De.pageIndex=Ue,De.x=Oe,De.y=Fe)}};return this.addCommands({cmd:()=>{for(const[De,{newX:Oe,newY:Fe,newPageIndex:Ue}]of X)pe(De,Oe,Fe,Ue)},undo:()=>{for(const[De,{savedX:Oe,savedY:Fe,savedPageIndex:Ue}]of X)pe(De,Oe,Fe,Ue)},mustExec:!0}),!0}dragSelectedEditors(X,oe){if(E(this,F))for(const pe of E(this,F).keys())pe.drag(X,oe)}rebuild(X){if(X.parent===null){const oe=this.getLayer(X.pageIndex);oe?(oe.changeParent(X),oe.addOrRebuild(X)):(this.addEditor(X),this.addToAnnotationStorage(X),X.rebuild())}else X.parent.addOrRebuild(X)}isActive(X){return E(this,P)===X}getActive(){return E(this,P)}getMode(){return E(this,V)}get imageManager(){return(0,n.shadow)(this,"imageManager",new c)}};P=new WeakMap,$=new WeakMap,K=new WeakMap,L=new WeakMap,j=new WeakMap,q=new WeakMap,te=new WeakMap,F=new WeakMap,z=new WeakMap,Q=new WeakMap,ne=new WeakMap,de=new WeakMap,U=new WeakMap,w=new WeakMap,x=new WeakMap,R=new WeakMap,V=new WeakMap,D=new WeakMap,Y=new WeakMap,W=new WeakMap,ee=new WeakMap,me=new WeakMap,he=new WeakMap,Ae=new WeakMap,ie=new WeakMap,ye=new WeakMap,xe=new WeakMap,Ve=new WeakMap,We=new WeakMap,Pe=new WeakMap,He=new WeakMap,Me=new WeakMap,be=new WeakMap,fe=new WeakMap,Ee=new WeakSet,Fn=function(){window.addEventListener("focus",E(this,ee)),window.addEventListener("blur",E(this,W))},Ge=new WeakSet,en=function(){window.removeEventListener("focus",E(this,ee)),window.removeEventListener("blur",E(this,W))},Ce=new WeakSet,Ln=function(){window.addEventListener("keydown",E(this,ie),{capture:!0})},ge=new WeakSet,tn=function(){window.removeEventListener("keydown",E(this,ie),{capture:!0})},Ke=new WeakSet,Bn=function(){document.addEventListener("copy",E(this,me)),document.addEventListener("cut",E(this,he)),document.addEventListener("paste",E(this,Ae))},we=new WeakSet,Vn=function(){document.removeEventListener("copy",E(this,me)),document.removeEventListener("cut",E(this,he)),document.removeEventListener("paste",E(this,Ae))},ae=new WeakSet,ft=function(X){Object.entries(X).some(pe=>{let[De,Oe]=pe;return E(this,Pe)[De]!==Oe})&&E(this,ne).dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(E(this,Pe),X)})},$e=new WeakSet,Nt=function(X){E(this,ne).dispatch("annotationeditorparamschanged",{source:this,details:X})},ve=new WeakSet,Wn=function(){if(!E(this,w)){Se(this,w,!0);for(const X of E(this,K).values())X.enable()}},_e=new WeakSet,Un=function(){if(this.unselectAll(),E(this,w)){Se(this,w,!1);for(const X of E(this,K).values())X.disable()}},Te=new WeakSet,nn=function(X){const oe=E(this,K).get(X.pageIndex);oe?oe.addOrRebuild(X):this.addEditor(X)},I=new WeakSet,kt=function(){if(E(this,$).size===0)return!0;if(E(this,$).size===1)for(const X of E(this,$).values())return X.isEmpty();return!1},H=new WeakSet,rn=function(X){E(this,D).clear();for(const oe of X)oe.isEmpty()||(E(this,D).add(oe),oe.select());le(this,ae,ft).call(this,{hasSelectedEditor:!0})},rt(ce,"TRANSLATE_SMALL",1),rt(ce,"TRANSLATE_BIG",10);let m=ce;e.AnnotationEditorUIManager=m},(r,e,t)=>{var n=t(3),s=t(6),i=t(4),a=t(24),o=t(14),c=t(8),l=t(21),u=t(20),d=t(91),m=t(39),y=t(77),h=t(64),p=t(159),f=t(7),v=t(167),_=t(27),O=i.JSON,k=i.Number,g=i.SyntaxError,b=O&&O.parse,N=a("Object","keys"),S=Object.getOwnPropertyDescriptor,T=o("".charAt),M=o("".slice),P=o(/./.exec),$=o([].push),K=/^\d$/,L=/^[1-9]$/,j=/^(-|\d)$/,q=/^[\t\n\r ]$/,te=0,F=1,z=function(R,V){R=y(R);var D=new U(R,0),Y=D.parse(),W=Y.value,ee=D.skip(q,Y.end);if(ee<R.length)throw g('Unexpected extra character: "'+T(R,ee)+'" after the parsed data at: '+ee);return l(V)?Q({"":W},"",V,Y):W},Q=function(R,V,D,Y){var W=R[V],ee=Y&&W===Y.value,me=ee&&typeof Y.source=="string"?{source:Y.source}:{},he,Ae,ie,ye,xe;if(u(W)){var Ve=d(W),We=ee?Y.nodes:Ve?[]:{};if(Ve)for(he=We.length,ie=h(W),ye=0;ye<ie;ye++)ne(W,ye,Q(W,""+ye,D,ye<he?We[ye]:void 0));else for(Ae=N(W),ie=h(Ae),ye=0;ye<ie;ye++)xe=Ae[ye],ne(W,xe,Q(W,xe,D,m(We,xe)?We[xe]:void 0))}return c(D,R,V,W,me)},ne=function(R,V,D){if(s){var Y=S(R,V);if(Y&&!Y.configurable)return}D===void 0?delete R[V]:p(R,V,D)},de=function(R,V,D,Y){this.value=R,this.end=V,this.source=D,this.nodes=Y},U=function(R,V){this.source=R,this.index=V};U.prototype={fork:function(R){return new U(this.source,R)},parse:function(){var R=this.source,V=this.skip(q,this.index),D=this.fork(V),Y=T(R,V);if(P(j,Y))return D.number();switch(Y){case"{":return D.object();case"[":return D.array();case'"':return D.string();case"t":return D.keyword(!0);case"f":return D.keyword(!1);case"n":return D.keyword(null)}throw g('Unexpected character: "'+Y+'" at: '+V)},node:function(R,V,D,Y,W){return new de(V,Y,R?null:M(this.source,D,Y),W)},object:function(){for(var R=this.source,V=this.index+1,D=!1,Y={},W={};V<R.length;){if(V=this.until(['"',"}"],V),T(R,V)==="}"&&!D){V++;break}var ee=this.fork(V).string(),me=ee.value;V=ee.end,V=this.until([":"],V)+1,V=this.skip(q,V),ee=this.fork(V).parse(),p(W,me,ee),p(Y,me,ee.value),V=this.until([",","}"],ee.end);var he=T(R,V);if(he===",")D=!0,V++;else if(he==="}"){V++;break}}return this.node(F,Y,this.index,V,W)},array:function(){for(var R=this.source,V=this.index+1,D=!1,Y=[],W=[];V<R.length;){if(V=this.skip(q,V),T(R,V)==="]"&&!D){V++;break}var ee=this.fork(V).parse();if($(W,ee),$(Y,ee.value),V=this.until([",","]"],ee.end),T(R,V)===",")D=!0,V++;else if(T(R,V)==="]"){V++;break}}return this.node(F,Y,this.index,V,W)},string:function(){var R=this.index,V=v(this.source,this.index+1);return this.node(te,V.value,R,V.end)},number:function(){var R=this.source,V=this.index,D=V;if(T(R,D)==="-"&&D++,T(R,D)==="0")D++;else if(P(L,T(R,D)))D=this.skip(K,++D);else throw g("Failed to parse number at: "+D);if(T(R,D)==="."&&(D=this.skip(K,++D)),T(R,D)==="e"||T(R,D)==="E"){D++,(T(R,D)==="+"||T(R,D)==="-")&&D++;var Y=D;if(D=this.skip(K,D),Y===D)throw g("Failed to parse number's exponent value at: "+D)}return this.node(te,k(M(R,V,D)),V,D)},keyword:function(R){var V=""+R,D=this.index,Y=D+V.length;if(M(this.source,D,Y)!==V)throw g("Failed to parse value at: "+D);return this.node(te,R,D,Y)},skip:function(R,V){for(var D=this.source;V<D.length&&P(R,T(D,V));V++);return V},until:function(R,V){V=this.skip(q,V);for(var D=T(this.source,V),Y=0;Y<R.length;Y++)if(R[Y]===D)return V;throw g('Unexpected character: "'+D+'" at: '+V)}};var w=f(function(){var R="9007199254740993",V;return b(R,function(D,Y,W){V=W.source}),V!==R}),x=_&&!f(function(){return 1/b("-0 	")!==-1/0});n({target:"JSON",stat:!0,forced:w},{parse:function(V,D){return x&&!l(D)?b(V):z(V,D)}})},(r,e,t)=>{var n=t(14),s=t(39),i=SyntaxError,a=parseInt,o=String.fromCharCode,c=n("".charAt),l=n("".slice),u=n(/./.exec),d={'\\"':'"',"\\\\":"\\","\\/":"/","\\b":"\b","\\f":"\f","\\n":`
`,"\\r":"\r","\\t":"	"},m=/^[\da-f]{4}$/i,y=/^[\u0000-\u001F]$/;r.exports=function(h,p){for(var f=!0,v="";p<h.length;){var _=c(h,p);if(_==="\\"){var O=l(h,p,p+2);if(s(d,O))v+=d[O],p+=2;else if(O==="\\u"){p+=2;var k=l(h,p,p+4);if(!u(m,k))throw i("Bad Unicode escape at: "+p);v+=o(a(k,16)),p+=4}else throw i('Unknown escape sequence: "'+O+'"')}else if(_==='"'){f=!1,p++;break}else{if(u(y,_))throw i("Bad control character in string literal at: "+p);v+=_,p++}}if(f)throw i("Unterminated string at: "+p);return{value:v,end:p}}},(r,e,t)=>{var te,F,z,Q,ne,de,U,w,x,R,V,D,Tt,W,Ct,me,sn,Ae,Lt,ye,Bt,Ve,Ot,Pe,Pt;Object.defineProperty(e,"__esModule",{value:!0}),e.StatTimer=e.RenderingCancelledException=e.PixelsPerInch=e.PageViewport=e.PDFDateString=e.DOMStandardFontDataFactory=e.DOMSVGFactory=e.DOMFilterFactory=e.DOMCanvasFactory=e.DOMCMapReaderFactory=e.AnnotationPrefix=void 0,e.deprecated=N,e.getColorValues=$,e.getCurrentTransform=K,e.getCurrentTransformInverse=L,e.getFilenameFromUrl=_,e.getPdfFilenameFromUrl=O,e.getRGB=P,e.getXfaPageViewport=M,e.isDataScheme=f,e.isPdfFile=v,e.isValidFetchUrl=g,e.loadScript=b,e.setLayerDimensions=j,t(2),t(93),t(101),t(102),t(105),t(107),t(109),t(113),t(116),t(123),t(89),t(84),t(86),t(87);var n=t(169),s=t(1);const i="http://www.w3.org/2000/svg",a="pdfjs_internal_id_";e.AnnotationPrefix=a;const q=class q{};rt(q,"CSS",96),rt(q,"PDF",72),rt(q,"PDF_TO_CSS_UNITS",q.CSS/q.PDF);let o=q;e.PixelsPerInch=o;class c extends n.BaseFilterFactory{constructor(){let{docId:fe,ownerDocument:Ee=globalThis.document}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super();se(this,D);se(this,W);se(this,me);se(this,Ae);se(this,ye);se(this,Ve);se(this,Pe);se(this,te,void 0);se(this,F,void 0);se(this,z,void 0);se(this,Q,void 0);se(this,ne,void 0);se(this,de,void 0);se(this,U,void 0);se(this,w,void 0);se(this,x,void 0);se(this,R,void 0);se(this,V,0);Se(this,z,fe),Se(this,Q,Ee)}addFilter(fe){if(!fe)return"none";let Ee=E(this,D,Tt).get(fe);if(Ee)return Ee;let Be,Ge,Re,Ce;if(fe.length===1){const Ke=fe[0],qe=new Array(256);for(let we=0;we<256;we++)qe[we]=Ke[we]/255;Ce=Be=Ge=Re=qe.join(",")}else{const[Ke,qe,we]=fe,ue=new Array(256),ae=new Array(256),ze=new Array(256);for(let $e=0;$e<256;$e++)ue[$e]=Ke[$e]/255,ae[$e]=qe[$e]/255,ze[$e]=we[$e]/255;Be=ue.join(","),Ge=ae.join(","),Re=ze.join(","),Ce=`${Be}${Ge}${Re}`}if(Ee=E(this,D,Tt).get(Ce),Ee)return E(this,D,Tt).set(fe,Ee),Ee;const Ie=`g_${E(this,z)}_transfer_map_${xt(this,V)._++}`,ge=`url(#${Ie})`;E(this,D,Tt).set(fe,ge),E(this,D,Tt).set(Ce,ge);const Ze=le(this,Ae,Lt).call(this,Ie);return le(this,Ve,Ot).call(this,Be,Ge,Re,Ze),ge}addHCMFilter(fe,Ee){var qe;const Be=`${fe}-${Ee}`;if(E(this,de)===Be)return E(this,U);if(Se(this,de,Be),Se(this,U,"none"),(qe=E(this,ne))==null||qe.remove(),!fe||!Ee)return E(this,U);const Ge=le(this,Pe,Pt).call(this,fe);fe=s.Util.makeHexColor(...Ge);const Re=le(this,Pe,Pt).call(this,Ee);if(Ee=s.Util.makeHexColor(...Re),E(this,W,Ct).style.color="",fe==="#000000"&&Ee==="#ffffff"||fe===Ee)return E(this,U);const Ce=new Array(256);for(let we=0;we<=255;we++){const ue=we/255;Ce[we]=ue<=.03928?ue/12.92:((ue+.055)/1.055)**2.4}const Ie=Ce.join(","),ge=`g_${E(this,z)}_hcm_filter`,Ze=Se(this,w,le(this,Ae,Lt).call(this,ge));le(this,Ve,Ot).call(this,Ie,Ie,Ie,Ze),le(this,me,sn).call(this,Ze);const Ke=(we,ue)=>{const ae=Ge[we]/255,ze=Re[we]/255,$e=new Array(ue+1);for(let nt=0;nt<=ue;nt++)$e[nt]=ae+nt/ue*(ze-ae);return $e.join(",")};return le(this,Ve,Ot).call(this,Ke(0,5),Ke(1,5),Ke(2,5),Ze),Se(this,U,`url(#${ge})`),E(this,U)}addHighlightHCMFilter(fe,Ee,Be,Ge){var ze;const Re=`${fe}-${Ee}-${Be}-${Ge}`;if(E(this,x)===Re)return E(this,R);if(Se(this,x,Re),Se(this,R,"none"),(ze=E(this,w))==null||ze.remove(),!fe||!Ee)return E(this,R);const[Ce,Ie]=[fe,Ee].map(le(this,Pe,Pt).bind(this));let ge=Math.round(.2126*Ce[0]+.7152*Ce[1]+.0722*Ce[2]),Ze=Math.round(.2126*Ie[0]+.7152*Ie[1]+.0722*Ie[2]),[Ke,qe]=[Be,Ge].map(le(this,Pe,Pt).bind(this));Ze<ge&&([ge,Ze,Ke,qe]=[Ze,ge,qe,Ke]),E(this,W,Ct).style.color="";const we=($e,nt,ve)=>{const re=new Array(256),_e=(Ze-ge)/ve,Le=$e/255,Te=(nt-$e)/(255*ve);let G=0;for(let I=0;I<=ve;I++){const Z=Math.round(ge+I*_e),H=Le+I*Te;for(let J=G;J<=Z;J++)re[J]=H;G=Z+1}for(let I=G;I<256;I++)re[I]=re[G-1];return re.join(",")},ue=`g_${E(this,z)}_hcm_highlight_filter`,ae=Se(this,w,le(this,Ae,Lt).call(this,ue));return le(this,me,sn).call(this,ae),le(this,Ve,Ot).call(this,we(Ke[0],qe[0],5),we(Ke[1],qe[1],5),we(Ke[2],qe[2],5),ae),Se(this,R,`url(#${ue})`),E(this,R)}destroy(){arguments.length>0&&arguments[0]!==void 0&&arguments[0]&&(E(this,U)||E(this,R))||(E(this,F)&&(E(this,F).parentNode.parentNode.remove(),Se(this,F,null)),E(this,te)&&(E(this,te).clear(),Se(this,te,null)),Se(this,V,0))}}te=new WeakMap,F=new WeakMap,z=new WeakMap,Q=new WeakMap,ne=new WeakMap,de=new WeakMap,U=new WeakMap,w=new WeakMap,x=new WeakMap,R=new WeakMap,V=new WeakMap,D=new WeakSet,Tt=function(){return E(this,te)||Se(this,te,new Map)},W=new WeakSet,Ct=function(){if(!E(this,F)){const fe=E(this,Q).createElement("div"),{style:Ee}=fe;Ee.visibility="hidden",Ee.contain="strict",Ee.width=Ee.height=0,Ee.position="absolute",Ee.top=Ee.left=0,Ee.zIndex=-1;const Be=E(this,Q).createElementNS(i,"svg");Be.setAttribute("width",0),Be.setAttribute("height",0),Se(this,F,E(this,Q).createElementNS(i,"defs")),fe.append(Be),Be.append(E(this,F)),E(this,Q).body.append(fe)}return E(this,F)},me=new WeakSet,sn=function(fe){const Ee=E(this,Q).createElementNS(i,"feColorMatrix");Ee.setAttribute("type","matrix"),Ee.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),fe.append(Ee)},Ae=new WeakSet,Lt=function(fe){const Ee=E(this,Q).createElementNS(i,"filter");return Ee.setAttribute("color-interpolation-filters","sRGB"),Ee.setAttribute("id",fe),E(this,W,Ct).append(Ee),Ee},ye=new WeakSet,Bt=function(fe,Ee,Be){const Ge=E(this,Q).createElementNS(i,Ee);Ge.setAttribute("type","discrete"),Ge.setAttribute("tableValues",Be),fe.append(Ge)},Ve=new WeakSet,Ot=function(fe,Ee,Be,Ge){const Re=E(this,Q).createElementNS(i,"feComponentTransfer");Ge.append(Re),le(this,ye,Bt).call(this,Re,"feFuncR",fe),le(this,ye,Bt).call(this,Re,"feFuncG",Ee),le(this,ye,Bt).call(this,Re,"feFuncB",Be)},Pe=new WeakSet,Pt=function(fe){return E(this,W,Ct).style.color=fe,P(getComputedStyle(E(this,W,Ct)).getPropertyValue("color"))},e.DOMFilterFactory=c;class l extends n.BaseCanvasFactory{constructor(){let{ownerDocument:be=globalThis.document}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(),this._document=be}_createCanvas(be,fe){const Ee=this._document.createElement("canvas");return Ee.width=be,Ee.height=fe,Ee}}e.DOMCanvasFactory=l;async function u(Me){let be=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(g(Me,document.baseURI)){const fe=await fetch(Me);if(!fe.ok)throw new Error(fe.statusText);return be?new Uint8Array(await fe.arrayBuffer()):(0,s.stringToBytes)(await fe.text())}return new Promise((fe,Ee)=>{const Be=new XMLHttpRequest;Be.open("GET",Me,!0),be&&(Be.responseType="arraybuffer"),Be.onreadystatechange=()=>{if(Be.readyState===XMLHttpRequest.DONE){if(Be.status===200||Be.status===0){let Ge;if(be&&Be.response?Ge=new Uint8Array(Be.response):!be&&Be.responseText&&(Ge=(0,s.stringToBytes)(Be.responseText)),Ge){fe(Ge);return}}Ee(new Error(Be.statusText))}},Be.send(null)})}class d extends n.BaseCMapReaderFactory{_fetchData(be,fe){return u(be,this.isCompressed).then(Ee=>({cMapData:Ee,compressionType:fe}))}}e.DOMCMapReaderFactory=d;class m extends n.BaseStandardFontDataFactory{_fetchData(be){return u(be,!0)}}e.DOMStandardFontDataFactory=m;class y extends n.BaseSVGFactory{_createSVG(be){return document.createElementNS(i,be)}}e.DOMSVGFactory=y;class h{constructor(be){let{viewBox:fe,scale:Ee,rotation:Be,offsetX:Ge=0,offsetY:Re=0,dontFlip:Ce=!1}=be;this.viewBox=fe,this.scale=Ee,this.rotation=Be,this.offsetX=Ge,this.offsetY=Re;const Ie=(fe[2]+fe[0])/2,ge=(fe[3]+fe[1])/2;let Ze,Ke,qe,we;switch(Be%=360,Be<0&&(Be+=360),Be){case 180:Ze=-1,Ke=0,qe=0,we=1;break;case 90:Ze=0,Ke=1,qe=1,we=0;break;case 270:Ze=0,Ke=-1,qe=-1,we=0;break;case 0:Ze=1,Ke=0,qe=0,we=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}Ce&&(qe=-qe,we=-we);let ue,ae,ze,$e;Ze===0?(ue=Math.abs(ge-fe[1])*Ee+Ge,ae=Math.abs(Ie-fe[0])*Ee+Re,ze=(fe[3]-fe[1])*Ee,$e=(fe[2]-fe[0])*Ee):(ue=Math.abs(Ie-fe[0])*Ee+Ge,ae=Math.abs(ge-fe[1])*Ee+Re,ze=(fe[2]-fe[0])*Ee,$e=(fe[3]-fe[1])*Ee),this.transform=[Ze*Ee,Ke*Ee,qe*Ee,we*Ee,ue-Ze*Ee*Ie-qe*Ee*ge,ae-Ke*Ee*Ie-we*Ee*ge],this.width=ze,this.height=$e}get rawDims(){const{viewBox:be}=this;return(0,s.shadow)(this,"rawDims",{pageWidth:be[2]-be[0],pageHeight:be[3]-be[1],pageX:be[0],pageY:be[1]})}clone(){let{scale:be=this.scale,rotation:fe=this.rotation,offsetX:Ee=this.offsetX,offsetY:Be=this.offsetY,dontFlip:Ge=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return new h({viewBox:this.viewBox.slice(),scale:be,rotation:fe,offsetX:Ee,offsetY:Be,dontFlip:Ge})}convertToViewportPoint(be,fe){return s.Util.applyTransform([be,fe],this.transform)}convertToViewportRectangle(be){const fe=s.Util.applyTransform([be[0],be[1]],this.transform),Ee=s.Util.applyTransform([be[2],be[3]],this.transform);return[fe[0],fe[1],Ee[0],Ee[1]]}convertToPdfPoint(be,fe){return s.Util.applyInverseTransform([be,fe],this.transform)}}e.PageViewport=h;class p extends s.BaseException{constructor(be){let fe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;super(be,"RenderingCancelledException"),this.extraDelay=fe}}e.RenderingCancelledException=p;function f(Me){const be=Me.length;let fe=0;for(;fe<be&&Me[fe].trim()==="";)fe++;return Me.substring(fe,fe+5).toLowerCase()==="data:"}function v(Me){return typeof Me=="string"&&/\.pdf$/i.test(Me)}function _(Me){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)||([Me]=Me.split(/[#?]/,1)),Me.substring(Me.lastIndexOf("/")+1)}function O(Me){let be=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"document.pdf";if(typeof Me!="string")return be;if(f(Me))return(0,s.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),be;const fe=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,Ee=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,Be=fe.exec(Me);let Ge=Ee.exec(Be[1])||Ee.exec(Be[2])||Ee.exec(Be[3]);if(Ge&&(Ge=Ge[0],Ge.includes("%")))try{Ge=Ee.exec(decodeURIComponent(Ge))[0]}catch{}return Ge||be}class k{constructor(){rt(this,"started",Object.create(null));rt(this,"times",[])}time(be){be in this.started&&(0,s.warn)(`Timer is already running for ${be}`),this.started[be]=Date.now()}timeEnd(be){be in this.started||(0,s.warn)(`Timer has not been started for ${be}`),this.times.push({name:be,start:this.started[be],end:Date.now()}),delete this.started[be]}toString(){const be=[];let fe=0;for(const{name:Ee}of this.times)fe=Math.max(Ee.length,fe);for(const{name:Ee,start:Be,end:Ge}of this.times)be.push(`${Ee.padEnd(fe)} ${Ge-Be}ms
`);return be.join("")}}e.StatTimer=k;function g(Me,be){try{const{protocol:fe}=be?new URL(Me,be):new URL(Me);return fe==="http:"||fe==="https:"}catch{return!1}}function b(Me){let be=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return new Promise((fe,Ee)=>{const Be=document.createElement("script");Be.src=Me,Be.onload=function(Ge){be&&Be.remove(),fe(Ge)},Be.onerror=function(){Ee(new Error(`Cannot load script at: ${Be.src}`))},(document.head||document.documentElement).append(Be)})}function N(Me){console.log("Deprecated API usage: "+Me)}let S;class T{static toDateObject(be){if(!be||typeof be!="string")return null;S||(S=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const fe=S.exec(be);if(!fe)return null;const Ee=parseInt(fe[1],10);let Be=parseInt(fe[2],10);Be=Be>=1&&Be<=12?Be-1:0;let Ge=parseInt(fe[3],10);Ge=Ge>=1&&Ge<=31?Ge:1;let Re=parseInt(fe[4],10);Re=Re>=0&&Re<=23?Re:0;let Ce=parseInt(fe[5],10);Ce=Ce>=0&&Ce<=59?Ce:0;let Ie=parseInt(fe[6],10);Ie=Ie>=0&&Ie<=59?Ie:0;const ge=fe[7]||"Z";let Ze=parseInt(fe[8],10);Ze=Ze>=0&&Ze<=23?Ze:0;let Ke=parseInt(fe[9],10)||0;return Ke=Ke>=0&&Ke<=59?Ke:0,ge==="-"?(Re+=Ze,Ce+=Ke):ge==="+"&&(Re-=Ze,Ce-=Ke),new Date(Date.UTC(Ee,Be,Ge,Re,Ce,Ie))}}e.PDFDateString=T;function M(Me,be){let{scale:fe=1,rotation:Ee=0}=be;const{width:Be,height:Ge}=Me.attributes.style,Re=[0,0,parseInt(Be),parseInt(Ge)];return new h({viewBox:Re,scale:fe,rotation:Ee})}function P(Me){if(Me.startsWith("#")){const be=parseInt(Me.slice(1),16);return[(be&16711680)>>16,(be&65280)>>8,be&255]}return Me.startsWith("rgb(")?Me.slice(4,-1).split(",").map(be=>parseInt(be)):Me.startsWith("rgba(")?Me.slice(5,-1).split(",").map(be=>parseInt(be)).slice(0,3):((0,s.warn)(`Not a valid color format: "${Me}"`),[0,0,0])}function $(Me){const be=document.createElement("span");be.style.visibility="hidden",document.body.append(be);for(const fe of Me.keys()){be.style.color=fe;const Ee=window.getComputedStyle(be).color;Me.set(fe,P(Ee))}be.remove()}function K(Me){const{a:be,b:fe,c:Ee,d:Be,e:Ge,f:Re}=Me.getTransform();return[be,fe,Ee,Be,Ge,Re]}function L(Me){const{a:be,b:fe,c:Ee,d:Be,e:Ge,f:Re}=Me.getTransform().invertSelf();return[be,fe,Ee,Be,Ge,Re]}function j(Me,be){let fe=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,Ee=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0;if(be instanceof h){const{pageWidth:Be,pageHeight:Ge}=be.rawDims,{style:Re}=Me,Ce=s.FeatureTest.isCSSRoundSupported,Ie=`var(--scale-factor) * ${Be}px`,ge=`var(--scale-factor) * ${Ge}px`,Ze=Ce?`round(${Ie}, 1px)`:`calc(${Ie})`,Ke=Ce?`round(${ge}, 1px)`:`calc(${ge})`;!fe||be.rotation%180===0?(Re.width=Ze,Re.height=Ke):(Re.width=Ke,Re.height=Ze)}Ee&&Me.setAttribute("data-main-rotation",be.rotation)}},(r,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BaseStandardFontDataFactory=e.BaseSVGFactory=e.BaseFilterFactory=e.BaseCanvasFactory=e.BaseCMapReaderFactory=void 0,t(2);var n=t(1);class s{constructor(){this.constructor===s&&(0,n.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(u){return"none"}addHCMFilter(u,d){return"none"}addHighlightHCMFilter(u,d,m,y){return"none"}destroy(){}}e.BaseFilterFactory=s;class i{constructor(){this.constructor===i&&(0,n.unreachable)("Cannot initialize BaseCanvasFactory.")}create(u,d){if(u<=0||d<=0)throw new Error("Invalid canvas size");const m=this._createCanvas(u,d);return{canvas:m,context:m.getContext("2d")}}reset(u,d,m){if(!u.canvas)throw new Error("Canvas is not specified");if(d<=0||m<=0)throw new Error("Invalid canvas size");u.canvas.width=d,u.canvas.height=m}destroy(u){if(!u.canvas)throw new Error("Canvas is not specified");u.canvas.width=0,u.canvas.height=0,u.canvas=null,u.context=null}_createCanvas(u,d){(0,n.unreachable)("Abstract method `_createCanvas` called.")}}e.BaseCanvasFactory=i;class a{constructor(u){let{baseUrl:d=null,isCompressed:m=!0}=u;this.constructor===a&&(0,n.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=d,this.isCompressed=m}async fetch(u){let{name:d}=u;if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!d)throw new Error("CMap name must be specified.");const m=this.baseUrl+d+(this.isCompressed?".bcmap":""),y=this.isCompressed?n.CMapCompressionType.BINARY:n.CMapCompressionType.NONE;return this._fetchData(m,y).catch(h=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${m}`)})}_fetchData(u,d){(0,n.unreachable)("Abstract method `_fetchData` called.")}}e.BaseCMapReaderFactory=a;class o{constructor(u){let{baseUrl:d=null}=u;this.constructor===o&&(0,n.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=d}async fetch(u){let{filename:d}=u;if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!d)throw new Error("Font filename must be specified.");const m=`${this.baseUrl}${d}`;return this._fetchData(m).catch(y=>{throw new Error(`Unable to load font data at: ${m}`)})}_fetchData(u){(0,n.unreachable)("Abstract method `_fetchData` called.")}}e.BaseStandardFontDataFactory=o;class c{constructor(){this.constructor===c&&(0,n.unreachable)("Cannot initialize BaseSVGFactory.")}create(u,d){let m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(u<=0||d<=0)throw new Error("Invalid SVG dimensions");const y=this._createSVG("svg:svg");return y.setAttribute("version","1.1"),m||(y.setAttribute("width",`${u}px`),y.setAttribute("height",`${d}px`)),y.setAttribute("preserveAspectRatio","none"),y.setAttribute("viewBox",`0 0 ${u} ${d}`),y}createElement(u){if(typeof u!="string")throw new Error("Invalid SVG element type");return this._createSVG(u)}_createSVG(u){(0,n.unreachable)("Abstract method `_createSVG` called.")}}e.BaseSVGFactory=c},(r,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.MurmurHash3_64=void 0,t(93),t(101),t(102),t(105),t(107),t(109),t(113),t(116),t(123),t(2);var n=t(1);const s=3285377520,i=4294901760,a=65535;class o{constructor(l){this.h1=l?l&4294967295:s,this.h2=l?l&4294967295:s}update(l){let u,d;if(typeof l=="string"){u=new Uint8Array(l.length*2),d=0;for(let N=0,S=l.length;N<S;N++){const T=l.charCodeAt(N);T<=255?u[d++]=T:(u[d++]=T>>>8,u[d++]=T&255)}}else if((0,n.isArrayBuffer)(l))u=l.slice(),d=u.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const m=d>>2,y=d-m*4,h=new Uint32Array(u.buffer,0,m);let p=0,f=0,v=this.h1,_=this.h2;const O=3432918353,k=461845907,g=O&a,b=k&a;for(let N=0;N<m;N++)N&1?(p=h[N],p=p*O&i|p*g&a,p=p<<15|p>>>17,p=p*k&i|p*b&a,v^=p,v=v<<13|v>>>19,v=v*5+3864292196):(f=h[N],f=f*O&i|f*g&a,f=f<<15|f>>>17,f=f*k&i|f*b&a,_^=f,_=_<<13|_>>>19,_=_*5+3864292196);switch(p=0,y){case 3:p^=u[m*4+2]<<16;case 2:p^=u[m*4+1]<<8;case 1:p^=u[m*4],p=p*O&i|p*g&a,p=p<<15|p>>>17,p=p*k&i|p*b&a,m&1?v^=p:_^=p}this.h1=v,this.h2=_}hexdigest(){let l=this.h1,u=this.h2;return l^=u>>>1,l=l*3981806797&i|l*36045&a,u=u*4283543511&i|((u<<16|l>>>16)*2950163797&i)>>>16,l^=u>>>1,l=l*444984403&i|l*60499&a,u=u*3301882366&i|((u<<16|l>>>16)*3120437893&i)>>>16,l^=u>>>1,(l>>>0).toString(16).padStart(8,"0")+(u>>>0).toString(16).padStart(8,"0")}}e.MurmurHash3_64=o},(r,e,t)=>{var a;Object.defineProperty(e,"__esModule",{value:!0}),e.FontLoader=e.FontFaceObject=void 0,t(125),t(136),t(138),t(141),t(143),t(145),t(147),t(89),t(149);var n=t(1);class s{constructor(c){se(this,a,new Set);let{ownerDocument:l=globalThis.document,styleElement:u=null}=c;this._document=l,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(c){this.nativeFontFaces.add(c),this._document.fonts.add(c)}removeNativeFontFace(c){this.nativeFontFaces.delete(c),this._document.fonts.delete(c)}insertRule(c){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const l=this.styleElement.sheet;l.insertRule(c,l.cssRules.length)}clear(){for(const c of this.nativeFontFaces)this._document.fonts.delete(c);this.nativeFontFaces.clear(),E(this,a).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(c){if(!(!c||E(this,a).has(c.loadedName))){if((0,n.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:l,src:u,style:d}=c,m=new FontFace(l,u,d);this.addNativeFontFace(m);try{await m.load(),E(this,a).add(l)}catch{(0,n.warn)(`Cannot load system font: ${c.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(m)}return}(0,n.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(c){if(c.attached||c.missingFile&&!c.systemFontInfo)return;if(c.attached=!0,c.systemFontInfo){await this.loadSystemFont(c.systemFontInfo);return}if(this.isFontLoadingAPISupported){const u=c.createNativeFontFace();if(u){this.addNativeFontFace(u);try{await u.loaded}catch(d){throw(0,n.warn)(`Failed to load font '${u.family}': '${d}'.`),c.disableFontFace=!0,d}}return}const l=c.createFontFaceRule();if(l){if(this.insertRule(l),this.isSyncFontLoadingSupported)return;await new Promise(u=>{const d=this._queueLoadingCallback(u);this._prepareFontLoadEvent(c,d)})}}get isFontLoadingAPISupported(){var l;const c=!!((l=this._document)!=null&&l.fonts);return(0,n.shadow)(this,"isFontLoadingAPISupported",c)}get isSyncFontLoadingSupported(){let c=!1;return(n.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(c=!0),(0,n.shadow)(this,"isSyncFontLoadingSupported",c)}_queueLoadingCallback(c){function l(){for((0,n.assert)(!d.done,"completeRequest() cannot be called twice."),d.done=!0;u.length>0&&u[0].done;){const m=u.shift();setTimeout(m.callback,0)}}const{loadingRequests:u}=this,d={done:!1,complete:l,callback:c};return u.push(d),d}get _loadTestFont(){const c=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,n.shadow)(this,"_loadTestFont",c)}_prepareFontLoadEvent(c,l){function u(P,$){return P.charCodeAt($)<<24|P.charCodeAt($+1)<<16|P.charCodeAt($+2)<<8|P.charCodeAt($+3)&255}function d(P,$,K,L){const j=P.substring(0,$),q=P.substring($+K);return j+L+q}let m,y;const h=this._document.createElement("canvas");h.width=1,h.height=1;const p=h.getContext("2d");let f=0;function v(P,$){if(++f>30){(0,n.warn)("Load test font never loaded."),$();return}if(p.font="30px "+P,p.fillText(".",0,20),p.getImageData(0,0,1,1).data[3]>0){$();return}setTimeout(v.bind(null,P,$))}const _=`lt${Date.now()}${this.loadTestFontId++}`;let O=this._loadTestFont;O=d(O,976,_.length,_);const g=16,b=1482184792;let N=u(O,g);for(m=0,y=_.length-3;m<y;m+=4)N=N-b+u(_,m)|0;m<_.length&&(N=N-b+u(_+"XXX",m)|0),O=d(O,g,4,(0,n.string32)(N));const S=`url(data:font/opentype;base64,${btoa(O)});`,T=`@font-face {font-family:"${_}";src:${S}}`;this.insertRule(T);const M=this._document.createElement("div");M.style.visibility="hidden",M.style.width=M.style.height="10px",M.style.position="absolute",M.style.top=M.style.left="0px";for(const P of[c.loadedName,_]){const $=this._document.createElement("span");$.textContent="Hi",$.style.fontFamily=P,M.append($)}this._document.body.append(M),v(_,()=>{M.remove(),l.complete()})}}a=new WeakMap,e.FontLoader=s;class i{constructor(c,l){let{isEvalSupported:u=!0,disableFontFace:d=!1,ignoreErrors:m=!1,inspectFont:y=null}=l;this.compiledGlyphs=Object.create(null);for(const h in c)this[h]=c[h];this.isEvalSupported=u!==!1,this.disableFontFace=d===!0,this.ignoreErrors=m===!0,this._inspectFont=y}createNativeFontFace(){var l;if(!this.data||this.disableFontFace)return null;let c;if(!this.cssFontInfo)c=new FontFace(this.loadedName,this.data,{});else{const u={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(u.style=`oblique ${this.cssFontInfo.italicAngle}deg`),c=new FontFace(this.cssFontInfo.fontFamily,this.data,u)}return(l=this._inspectFont)==null||l.call(this,this),c}createFontFaceRule(){var d;if(!this.data||this.disableFontFace)return null;const c=(0,n.bytesToString)(this.data),l=`url(data:${this.mimetype};base64,${btoa(c)});`;let u;if(!this.cssFontInfo)u=`@font-face {font-family:"${this.loadedName}";src:${l}}`;else{let m=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(m+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),u=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${m}src:${l}}`}return(d=this._inspectFont)==null||d.call(this,this,l),u}getPathGenerator(c,l){if(this.compiledGlyphs[l]!==void 0)return this.compiledGlyphs[l];let u;try{u=c.get(this.loadedName+"_path_"+l)}catch(d){if(!this.ignoreErrors)throw d;return(0,n.warn)(`getPathGenerator - ignoring character: "${d}".`),this.compiledGlyphs[l]=function(m,y){}}if(this.isEvalSupported&&n.FeatureTest.isEvalSupported){const d=[];for(const m of u){const y=m.args!==void 0?m.args.join(","):"";d.push("c.",m.cmd,"(",y,`);
`)}return this.compiledGlyphs[l]=new Function("c","size",d.join(""))}return this.compiledGlyphs[l]=function(d,m){for(const y of u)y.cmd==="scale"&&(y.args=[m,-m]),d[y.cmd].apply(d,y.args)}}}e.FontFaceObject=i},(r,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.NodeStandardFontDataFactory=e.NodeFilterFactory=e.NodeCanvasFactory=e.NodeCMapReaderFactory=void 0,t(2),t(93),t(101),t(102),t(105),t(107),t(109),t(113),t(116),t(123);var n=t(169),s=t(1);(function(){if(!(globalThis.DOMMatrix||!s.isNodeJS))try{globalThis.DOMMatrix=require$$6.DOMMatrix}catch(d){(0,s.warn)(`Cannot polyfill \`DOMMatrix\`, rendering may be broken: "${d}".`)}})(),function(){if(!(globalThis.Path2D||!s.isNodeJS))try{const{CanvasRenderingContext2D:d}=require$$6,{polyfillPath2D:m}=requirePath2dPolyfill_esm();globalThis.CanvasRenderingContext2D=d,m(globalThis)}catch(d){(0,s.warn)(`Cannot polyfill \`Path2D\`, rendering may be broken: "${d}".`)}}();const i=function(u){return new Promise((d,m)=>{require$$6.readFile(u,(h,p)=>{if(h||!p){m(new Error(h));return}d(new Uint8Array(p))})})};class a extends n.BaseFilterFactory{}e.NodeFilterFactory=a;class o extends n.BaseCanvasFactory{_createCanvas(d,m){return require$$6.createCanvas(d,m)}}e.NodeCanvasFactory=o;class c extends n.BaseCMapReaderFactory{_fetchData(d,m){return i(d).then(y=>({cMapData:y,compressionType:m}))}}e.NodeCMapReaderFactory=c;class l extends n.BaseStandardFontDataFactory{_fetchData(d){return i(d)}}e.NodeStandardFontDataFactory=l},(r,e,t)=>{var F,an,Q,on;Object.defineProperty(e,"__esModule",{value:!0}),e.CanvasGraphics=void 0,t(2),t(93),t(101),t(102),t(105),t(107),t(109),t(113),t(116),t(123),t(89);var n=t(1),s=t(168),i=t(174),a=t(175);const o=16,c=100,l=4096,u=15,d=10,m=1e3,y=16;function h(U,w){if(U._removeMirroring)throw new Error("Context is already forwarding operations.");U.__originalSave=U.save,U.__originalRestore=U.restore,U.__originalRotate=U.rotate,U.__originalScale=U.scale,U.__originalTranslate=U.translate,U.__originalTransform=U.transform,U.__originalSetTransform=U.setTransform,U.__originalResetTransform=U.resetTransform,U.__originalClip=U.clip,U.__originalMoveTo=U.moveTo,U.__originalLineTo=U.lineTo,U.__originalBezierCurveTo=U.bezierCurveTo,U.__originalRect=U.rect,U.__originalClosePath=U.closePath,U.__originalBeginPath=U.beginPath,U._removeMirroring=()=>{U.save=U.__originalSave,U.restore=U.__originalRestore,U.rotate=U.__originalRotate,U.scale=U.__originalScale,U.translate=U.__originalTranslate,U.transform=U.__originalTransform,U.setTransform=U.__originalSetTransform,U.resetTransform=U.__originalResetTransform,U.clip=U.__originalClip,U.moveTo=U.__originalMoveTo,U.lineTo=U.__originalLineTo,U.bezierCurveTo=U.__originalBezierCurveTo,U.rect=U.__originalRect,U.closePath=U.__originalClosePath,U.beginPath=U.__originalBeginPath,delete U._removeMirroring},U.save=function(){w.save(),this.__originalSave()},U.restore=function(){w.restore(),this.__originalRestore()},U.translate=function(R,V){w.translate(R,V),this.__originalTranslate(R,V)},U.scale=function(R,V){w.scale(R,V),this.__originalScale(R,V)},U.transform=function(R,V,D,Y,W,ee){w.transform(R,V,D,Y,W,ee),this.__originalTransform(R,V,D,Y,W,ee)},U.setTransform=function(R,V,D,Y,W,ee){w.setTransform(R,V,D,Y,W,ee),this.__originalSetTransform(R,V,D,Y,W,ee)},U.resetTransform=function(){w.resetTransform(),this.__originalResetTransform()},U.rotate=function(R){w.rotate(R),this.__originalRotate(R)},U.clip=function(R){w.clip(R),this.__originalClip(R)},U.moveTo=function(x,R){w.moveTo(x,R),this.__originalMoveTo(x,R)},U.lineTo=function(x,R){w.lineTo(x,R),this.__originalLineTo(x,R)},U.bezierCurveTo=function(x,R,V,D,Y,W){w.bezierCurveTo(x,R,V,D,Y,W),this.__originalBezierCurveTo(x,R,V,D,Y,W)},U.rect=function(x,R,V,D){w.rect(x,R,V,D),this.__originalRect(x,R,V,D)},U.closePath=function(){w.closePath(),this.__originalClosePath()},U.beginPath=function(){w.beginPath(),this.__originalBeginPath()}}class p{constructor(w){this.canvasFactory=w,this.cache=Object.create(null)}getCanvas(w,x,R){let V;return this.cache[w]!==void 0?(V=this.cache[w],this.canvasFactory.reset(V,x,R)):(V=this.canvasFactory.create(x,R),this.cache[w]=V),V}delete(w){delete this.cache[w]}clear(){for(const w in this.cache){const x=this.cache[w];this.canvasFactory.destroy(x),delete this.cache[w]}}}function f(U,w,x,R,V,D,Y,W,ee,me){const[he,Ae,ie,ye,xe,Ve]=(0,s.getCurrentTransform)(U);if(Ae===0&&ie===0){const He=Y*he+xe,Me=Math.round(He),be=W*ye+Ve,fe=Math.round(be),Ee=(Y+ee)*he+xe,Be=Math.abs(Math.round(Ee)-Me)||1,Ge=(W+me)*ye+Ve,Re=Math.abs(Math.round(Ge)-fe)||1;return U.setTransform(Math.sign(he),0,0,Math.sign(ye),Me,fe),U.drawImage(w,x,R,V,D,0,0,Be,Re),U.setTransform(he,Ae,ie,ye,xe,Ve),[Be,Re]}if(he===0&&ye===0){const He=W*ie+xe,Me=Math.round(He),be=Y*Ae+Ve,fe=Math.round(be),Ee=(W+me)*ie+xe,Be=Math.abs(Math.round(Ee)-Me)||1,Ge=(Y+ee)*Ae+Ve,Re=Math.abs(Math.round(Ge)-fe)||1;return U.setTransform(0,Math.sign(Ae),Math.sign(ie),0,Me,fe),U.drawImage(w,x,R,V,D,0,0,Re,Be),U.setTransform(he,Ae,ie,ye,xe,Ve),[Re,Be]}U.drawImage(w,x,R,V,D,Y,W,ee,me);const We=Math.hypot(he,Ae),Pe=Math.hypot(ie,ye);return[We*ee,Pe*me]}function v(U){const{width:w,height:x}=U;if(w>m||x>m)return null;const R=1e3,V=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),D=w+1;let Y=new Uint8Array(D*(x+1)),W,ee,me;const he=w+7&-8;let Ae=new Uint8Array(he*x),ie=0;for(const Pe of U.data){let He=128;for(;He>0;)Ae[ie++]=Pe&He?0:255,He>>=1}let ye=0;for(ie=0,Ae[ie]!==0&&(Y[0]=1,++ye),ee=1;ee<w;ee++)Ae[ie]!==Ae[ie+1]&&(Y[ee]=Ae[ie]?2:1,++ye),ie++;for(Ae[ie]!==0&&(Y[ee]=2,++ye),W=1;W<x;W++){ie=W*he,me=W*D,Ae[ie-he]!==Ae[ie]&&(Y[me]=Ae[ie]?1:8,++ye);let Pe=(Ae[ie]?4:0)+(Ae[ie-he]?8:0);for(ee=1;ee<w;ee++)Pe=(Pe>>2)+(Ae[ie+1]?4:0)+(Ae[ie-he+1]?8:0),V[Pe]&&(Y[me+ee]=V[Pe],++ye),ie++;if(Ae[ie-he]!==Ae[ie]&&(Y[me+ee]=Ae[ie]?2:4,++ye),ye>R)return null}for(ie=he*(x-1),me=W*D,Ae[ie]!==0&&(Y[me]=8,++ye),ee=1;ee<w;ee++)Ae[ie]!==Ae[ie+1]&&(Y[me+ee]=Ae[ie]?4:8,++ye),ie++;if(Ae[ie]!==0&&(Y[me+ee]=4,++ye),ye>R)return null;const xe=new Int32Array([0,D,-1,0,-D,0,0,0,1]),Ve=new Path2D;for(W=0;ye&&W<=x;W++){let Pe=W*D;const He=Pe+w;for(;Pe<He&&!Y[Pe];)Pe++;if(Pe===He)continue;Ve.moveTo(Pe%D,W);const Me=Pe;let be=Y[Pe];do{const fe=xe[be];do Pe+=fe;while(!Y[Pe]);const Ee=Y[Pe];Ee!==5&&Ee!==10?(be=Ee,Y[Pe]=0):(be=Ee&51*be>>4,Y[Pe]&=be>>2|be<<2),Ve.lineTo(Pe%D,Pe/D|0),Y[Pe]||--ye}while(Me!==Pe);--W}return Ae=null,Y=null,function(Pe){Pe.save(),Pe.scale(1/w,-1/x),Pe.translate(0,-x),Pe.fill(Ve),Pe.beginPath(),Pe.restore()}}class _{constructor(w,x){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=n.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=n.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=n.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,w,x])}clone(){const w=Object.create(this);return w.clipBox=this.clipBox.slice(),w}setCurrentPoint(w,x){this.x=w,this.y=x}updatePathMinMax(w,x,R){[x,R]=n.Util.applyTransform([x,R],w),this.minX=Math.min(this.minX,x),this.minY=Math.min(this.minY,R),this.maxX=Math.max(this.maxX,x),this.maxY=Math.max(this.maxY,R)}updateRectMinMax(w,x){const R=n.Util.applyTransform(x,w),V=n.Util.applyTransform(x.slice(2),w);this.minX=Math.min(this.minX,R[0],V[0]),this.minY=Math.min(this.minY,R[1],V[1]),this.maxX=Math.max(this.maxX,R[0],V[0]),this.maxY=Math.max(this.maxY,R[1],V[1])}updateScalingPathMinMax(w,x){n.Util.scaleMinMax(w,x),this.minX=Math.min(this.minX,x[0]),this.maxX=Math.max(this.maxX,x[1]),this.minY=Math.min(this.minY,x[2]),this.maxY=Math.max(this.maxY,x[3])}updateCurvePathMinMax(w,x,R,V,D,Y,W,ee,me,he){const Ae=n.Util.bezierBoundingBox(x,R,V,D,Y,W,ee,me);if(he){he[0]=Math.min(he[0],Ae[0],Ae[2]),he[1]=Math.max(he[1],Ae[0],Ae[2]),he[2]=Math.min(he[2],Ae[1],Ae[3]),he[3]=Math.max(he[3],Ae[1],Ae[3]);return}this.updateRectMinMax(w,Ae)}getPathBoundingBox(){let w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:i.PathType.FILL,x=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const R=[this.minX,this.minY,this.maxX,this.maxY];if(w===i.PathType.STROKE){x||(0,n.unreachable)("Stroke bounding box must include transform.");const V=n.Util.singularValueDecompose2dScale(x),D=V[0]*this.lineWidth/2,Y=V[1]*this.lineWidth/2;R[0]-=D,R[1]-=Y,R[2]+=D,R[3]+=Y}return R}updateClipFromPath(){const w=n.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(w||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(w){this.clipBox=w,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(){let w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:i.PathType.FILL,x=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return n.Util.intersect(this.clipBox,this.getPathBoundingBox(w,x))}}function O(U,w){if(typeof ImageData<"u"&&w instanceof ImageData){U.putImageData(w,0,0);return}const x=w.height,R=w.width,V=x%y,D=(x-V)/y,Y=V===0?D:D+1,W=U.createImageData(R,y);let ee=0,me;const he=w.data,Ae=W.data;let ie,ye,xe,Ve;if(w.kind===n.ImageKind.GRAYSCALE_1BPP){const We=he.byteLength,Pe=new Uint32Array(Ae.buffer,0,Ae.byteLength>>2),He=Pe.length,Me=R+7>>3,be=4294967295,fe=n.FeatureTest.isLittleEndian?4278190080:255;for(ie=0;ie<Y;ie++){for(xe=ie<D?y:V,me=0,ye=0;ye<xe;ye++){const Ee=We-ee;let Be=0;const Ge=Ee>Me?R:Ee*8-7,Re=Ge&-8;let Ce=0,Ie=0;for(;Be<Re;Be+=8)Ie=he[ee++],Pe[me++]=Ie&128?be:fe,Pe[me++]=Ie&64?be:fe,Pe[me++]=Ie&32?be:fe,Pe[me++]=Ie&16?be:fe,Pe[me++]=Ie&8?be:fe,Pe[me++]=Ie&4?be:fe,Pe[me++]=Ie&2?be:fe,Pe[me++]=Ie&1?be:fe;for(;Be<Ge;Be++)Ce===0&&(Ie=he[ee++],Ce=128),Pe[me++]=Ie&Ce?be:fe,Ce>>=1}for(;me<He;)Pe[me++]=0;U.putImageData(W,0,ie*y)}}else if(w.kind===n.ImageKind.RGBA_32BPP){for(ye=0,Ve=R*y*4,ie=0;ie<D;ie++)Ae.set(he.subarray(ee,ee+Ve)),ee+=Ve,U.putImageData(W,0,ye),ye+=y;ie<Y&&(Ve=R*V*4,Ae.set(he.subarray(ee,ee+Ve)),U.putImageData(W,0,ye))}else if(w.kind===n.ImageKind.RGB_24BPP)for(xe=y,Ve=R*xe,ie=0;ie<Y;ie++){for(ie>=D&&(xe=V,Ve=R*xe),me=0,ye=Ve;ye--;)Ae[me++]=he[ee++],Ae[me++]=he[ee++],Ae[me++]=he[ee++],Ae[me++]=255;U.putImageData(W,0,ie*y)}else throw new Error(`bad image kind: ${w.kind}`)}function k(U,w){if(w.bitmap){U.drawImage(w.bitmap,0,0);return}const x=w.height,R=w.width,V=x%y,D=(x-V)/y,Y=V===0?D:D+1,W=U.createImageData(R,y);let ee=0;const me=w.data,he=W.data;for(let Ae=0;Ae<Y;Ae++){const ie=Ae<D?y:V;({srcPos:ee}=(0,a.convertBlackAndWhiteToRGBA)({src:me,srcPos:ee,dest:he,width:R,height:ie,nonBlackColor:0})),U.putImageData(W,0,Ae*y)}}function g(U,w){const x=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const R of x)U[R]!==void 0&&(w[R]=U[R]);U.setLineDash!==void 0&&(w.setLineDash(U.getLineDash()),w.lineDashOffset=U.lineDashOffset)}function b(U){if(U.strokeStyle=U.fillStyle="#000000",U.fillRule="nonzero",U.globalAlpha=1,U.lineWidth=1,U.lineCap="butt",U.lineJoin="miter",U.miterLimit=10,U.globalCompositeOperation="source-over",U.font="10px sans-serif",U.setLineDash!==void 0&&(U.setLineDash([]),U.lineDashOffset=0),!n.isNodeJS){const{filter:w}=U;w!=="none"&&w!==""&&(U.filter="none")}}function N(U,w,x,R){const V=U.length;for(let D=3;D<V;D+=4){const Y=U[D];if(Y===0)U[D-3]=w,U[D-2]=x,U[D-1]=R;else if(Y<255){const W=255-Y;U[D-3]=U[D-3]*Y+w*W>>8,U[D-2]=U[D-2]*Y+x*W>>8,U[D-1]=U[D-1]*Y+R*W>>8}}}function S(U,w,x){const R=U.length,V=1/255;for(let D=3;D<R;D+=4){const Y=x?x[U[D]]:U[D];w[D]=w[D]*Y*V|0}}function T(U,w,x){const R=U.length;for(let V=3;V<R;V+=4){const D=U[V-3]*77+U[V-2]*152+U[V-1]*28;w[V]=x?w[V]*x[D>>8]>>8:w[V]*D>>16}}function M(U,w,x,R,V,D,Y,W,ee,me,he){const Ae=!!D,ie=Ae?D[0]:0,ye=Ae?D[1]:0,xe=Ae?D[2]:0,Ve=V==="Luminosity"?T:S,Pe=Math.min(R,Math.ceil(1048576/x));for(let He=0;He<R;He+=Pe){const Me=Math.min(Pe,R-He),be=U.getImageData(W-me,He+(ee-he),x,Me),fe=w.getImageData(W,He+ee,x,Me);Ae&&N(be.data,ie,ye,xe),Ve(be.data,fe.data,Y),w.putImageData(fe,W,He+ee)}}function P(U,w,x,R){const V=R[0],D=R[1],Y=R[2]-V,W=R[3]-D;Y===0||W===0||(M(w.context,x,Y,W,w.subtype,w.backdrop,w.transferMap,V,D,w.offsetX,w.offsetY),U.save(),U.globalAlpha=1,U.globalCompositeOperation="source-over",U.setTransform(1,0,0,1,0,0),U.drawImage(x.canvas,0,0),U.restore())}function $(U,w){const x=n.Util.singularValueDecompose2dScale(U);x[0]=Math.fround(x[0]),x[1]=Math.fround(x[1]);const R=Math.fround((globalThis.devicePixelRatio||1)*s.PixelsPerInch.PDF_TO_CSS_UNITS);return w!==void 0?w:x[0]<=R||x[1]<=R}const K=["butt","round","square"],L=["miter","round","bevel"],j={},q={},de=class de{constructor(w,x,R,V,D,Y,W,ee){se(this,F);se(this,Q);let{optionalContentConfig:me,markedContentStack:he=null}=Y;this.ctx=w,this.current=new _(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=x,this.objs=R,this.canvasFactory=V,this.filterFactory=D,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=he||[],this.optionalContentConfig=me,this.cachedCanvases=new p(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=W,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=ee,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(w){let x=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return typeof w=="string"?w.startsWith("g_")?this.commonObjs.get(w):this.objs.get(w):x}beginDrawing(w){let{transform:x,viewport:R,transparency:V=!1,background:D=null}=w;const Y=this.ctx.canvas.width,W=this.ctx.canvas.height,ee=this.ctx.fillStyle;if(this.ctx.fillStyle=D||"#ffffff",this.ctx.fillRect(0,0,Y,W),this.ctx.fillStyle=ee,V){const me=this.cachedCanvases.getCanvas("transparent",Y,W);this.compositeCtx=this.ctx,this.transparentCanvas=me.canvas,this.ctx=me.context,this.ctx.save(),this.ctx.transform(...(0,s.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),b(this.ctx),x&&(this.ctx.transform(...x),this.outputScaleX=x[0],this.outputScaleY=x[0]),this.ctx.transform(...R.transform),this.viewportScale=R.scale,this.baseTransform=(0,s.getCurrentTransform)(this.ctx)}executeOperatorList(w,x,R,V){const D=w.argsArray,Y=w.fnArray;let W=x||0;const ee=D.length;if(ee===W)return W;const me=ee-W>d&&typeof R=="function",he=me?Date.now()+u:0;let Ae=0;const ie=this.commonObjs,ye=this.objs;let xe;for(;;){if(V!==void 0&&W===V.nextBreakPoint)return V.breakIt(W,R),W;if(xe=Y[W],xe!==n.OPS.dependency)this[xe].apply(this,D[W]);else for(const Ve of D[W]){const We=Ve.startsWith("g_")?ie:ye;if(!We.has(Ve))return We.get(Ve,R),W}if(W++,W===ee)return W;if(me&&++Ae>d){if(Date.now()>he)return R(),W;Ae=0}}}endDrawing(){le(this,F,an).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const w of this._cachedBitmapsMap.values()){for(const x of w.values())typeof HTMLCanvasElement<"u"&&x instanceof HTMLCanvasElement&&(x.width=x.height=0);w.clear()}this._cachedBitmapsMap.clear(),le(this,Q,on).call(this)}_scaleImage(w,x){const R=w.width,V=w.height;let D=Math.max(Math.hypot(x[0],x[1]),1),Y=Math.max(Math.hypot(x[2],x[3]),1),W=R,ee=V,me="prescale1",he,Ae;for(;D>2&&W>1||Y>2&&ee>1;){let ie=W,ye=ee;D>2&&W>1&&(ie=W>=16384?Math.floor(W/2)-1||1:Math.ceil(W/2),D/=W/ie),Y>2&&ee>1&&(ye=ee>=16384?Math.floor(ee/2)-1||1:Math.ceil(ee)/2,Y/=ee/ye),he=this.cachedCanvases.getCanvas(me,ie,ye),Ae=he.context,Ae.clearRect(0,0,ie,ye),Ae.drawImage(w,0,0,W,ee,0,0,ie,ye),w=he.canvas,W=ie,ee=ye,me=me==="prescale1"?"prescale2":"prescale1"}return{img:w,paintWidth:W,paintHeight:ee}}_createMaskCanvas(w){const x=this.ctx,{width:R,height:V}=w,D=this.current.fillColor,Y=this.current.patternFill,W=(0,s.getCurrentTransform)(x);let ee,me,he,Ae;if((w.bitmap||w.data)&&w.count>1){const Be=w.bitmap||w.data.buffer;me=JSON.stringify(Y?W:[W.slice(0,4),D]),ee=this._cachedBitmapsMap.get(Be),ee||(ee=new Map,this._cachedBitmapsMap.set(Be,ee));const Ge=ee.get(me);if(Ge&&!Y){const Re=Math.round(Math.min(W[0],W[2])+W[4]),Ce=Math.round(Math.min(W[1],W[3])+W[5]);return{canvas:Ge,offsetX:Re,offsetY:Ce}}he=Ge}he||(Ae=this.cachedCanvases.getCanvas("maskCanvas",R,V),k(Ae.context,w));let ie=n.Util.transform(W,[1/R,0,0,-1/V,0,0]);ie=n.Util.transform(ie,[1,0,0,1,0,-V]);const ye=n.Util.applyTransform([0,0],ie),xe=n.Util.applyTransform([R,V],ie),Ve=n.Util.normalizeRect([ye[0],ye[1],xe[0],xe[1]]),We=Math.round(Ve[2]-Ve[0])||1,Pe=Math.round(Ve[3]-Ve[1])||1,He=this.cachedCanvases.getCanvas("fillCanvas",We,Pe),Me=He.context,be=Math.min(ye[0],xe[0]),fe=Math.min(ye[1],xe[1]);Me.translate(-be,-fe),Me.transform(...ie),he||(he=this._scaleImage(Ae.canvas,(0,s.getCurrentTransformInverse)(Me)),he=he.img,ee&&Y&&ee.set(me,he)),Me.imageSmoothingEnabled=$((0,s.getCurrentTransform)(Me),w.interpolate),f(Me,he,0,0,he.width,he.height,0,0,R,V),Me.globalCompositeOperation="source-in";const Ee=n.Util.transform((0,s.getCurrentTransformInverse)(Me),[1,0,0,1,-be,-fe]);return Me.fillStyle=Y?D.getPattern(x,this,Ee,i.PathType.FILL):D,Me.fillRect(0,0,R,V),ee&&!Y&&(this.cachedCanvases.delete("fillCanvas"),ee.set(me,He.canvas)),{canvas:He.canvas,offsetX:Math.round(be),offsetY:Math.round(fe)}}setLineWidth(w){w!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=w,this.ctx.lineWidth=w}setLineCap(w){this.ctx.lineCap=K[w]}setLineJoin(w){this.ctx.lineJoin=L[w]}setMiterLimit(w){this.ctx.miterLimit=w}setDash(w,x){const R=this.ctx;R.setLineDash!==void 0&&(R.setLineDash(w),R.lineDashOffset=x)}setRenderingIntent(w){}setFlatness(w){}setGState(w){for(const[x,R]of w)switch(x){case"LW":this.setLineWidth(R);break;case"LC":this.setLineCap(R);break;case"LJ":this.setLineJoin(R);break;case"ML":this.setMiterLimit(R);break;case"D":this.setDash(R[0],R[1]);break;case"RI":this.setRenderingIntent(R);break;case"FL":this.setFlatness(R);break;case"Font":this.setFont(R[0],R[1]);break;case"CA":this.current.strokeAlpha=R;break;case"ca":this.current.fillAlpha=R,this.ctx.globalAlpha=R;break;case"BM":this.ctx.globalCompositeOperation=R;break;case"SMask":this.current.activeSMask=R?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(R);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const w=this.inSMaskMode;this.current.activeSMask&&!w?this.beginSMaskMode():!this.current.activeSMask&&w&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const w=this.ctx.canvas.width,x=this.ctx.canvas.height,R="smaskGroupAt"+this.groupLevel,V=this.cachedCanvases.getCanvas(R,w,x);this.suspendedCtx=this.ctx,this.ctx=V.context;const D=this.ctx;D.setTransform(...(0,s.getCurrentTransform)(this.suspendedCtx)),g(this.suspendedCtx,D),h(D,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),g(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(w){if(!this.current.activeSMask)return;w?(w[0]=Math.floor(w[0]),w[1]=Math.floor(w[1]),w[2]=Math.ceil(w[2]),w[3]=Math.ceil(w[3])):w=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const x=this.current.activeSMask,R=this.suspendedCtx;P(R,x,this.ctx,w),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(g(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const w=this.current;this.stateStack.push(w),this.current=w.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),g(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(w,x,R,V,D,Y){this.ctx.transform(w,x,R,V,D,Y),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(w,x,R){const V=this.ctx,D=this.current;let Y=D.x,W=D.y,ee,me;const he=(0,s.getCurrentTransform)(V),Ae=he[0]===0&&he[3]===0||he[1]===0&&he[2]===0,ie=Ae?R.slice(0):null;for(let ye=0,xe=0,Ve=w.length;ye<Ve;ye++)switch(w[ye]|0){case n.OPS.rectangle:Y=x[xe++],W=x[xe++];const We=x[xe++],Pe=x[xe++],He=Y+We,Me=W+Pe;V.moveTo(Y,W),We===0||Pe===0?V.lineTo(He,Me):(V.lineTo(He,W),V.lineTo(He,Me),V.lineTo(Y,Me)),Ae||D.updateRectMinMax(he,[Y,W,He,Me]),V.closePath();break;case n.OPS.moveTo:Y=x[xe++],W=x[xe++],V.moveTo(Y,W),Ae||D.updatePathMinMax(he,Y,W);break;case n.OPS.lineTo:Y=x[xe++],W=x[xe++],V.lineTo(Y,W),Ae||D.updatePathMinMax(he,Y,W);break;case n.OPS.curveTo:ee=Y,me=W,Y=x[xe+4],W=x[xe+5],V.bezierCurveTo(x[xe],x[xe+1],x[xe+2],x[xe+3],Y,W),D.updateCurvePathMinMax(he,ee,me,x[xe],x[xe+1],x[xe+2],x[xe+3],Y,W,ie),xe+=6;break;case n.OPS.curveTo2:ee=Y,me=W,V.bezierCurveTo(Y,W,x[xe],x[xe+1],x[xe+2],x[xe+3]),D.updateCurvePathMinMax(he,ee,me,Y,W,x[xe],x[xe+1],x[xe+2],x[xe+3],ie),Y=x[xe+2],W=x[xe+3],xe+=4;break;case n.OPS.curveTo3:ee=Y,me=W,Y=x[xe+2],W=x[xe+3],V.bezierCurveTo(x[xe],x[xe+1],Y,W,Y,W),D.updateCurvePathMinMax(he,ee,me,x[xe],x[xe+1],Y,W,Y,W,ie),xe+=4;break;case n.OPS.closePath:V.closePath();break}Ae&&D.updateScalingPathMinMax(he,ie),D.setCurrentPoint(Y,W)}closePath(){this.ctx.closePath()}stroke(){let w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;const x=this.ctx,R=this.current.strokeColor;x.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof R=="object"&&(R!=null&&R.getPattern)?(x.save(),x.strokeStyle=R.getPattern(x,this,(0,s.getCurrentTransformInverse)(x),i.PathType.STROKE),this.rescaleAndStroke(!1),x.restore()):this.rescaleAndStroke(!0)),w&&this.consumePath(this.current.getClippedPathBoundingBox()),x.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(){let w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;const x=this.ctx,R=this.current.fillColor,V=this.current.patternFill;let D=!1;V&&(x.save(),x.fillStyle=R.getPattern(x,this,(0,s.getCurrentTransformInverse)(x),i.PathType.FILL),D=!0);const Y=this.current.getClippedPathBoundingBox();this.contentVisible&&Y!==null&&(this.pendingEOFill?(x.fill("evenodd"),this.pendingEOFill=!1):x.fill()),D&&x.restore(),w&&this.consumePath(Y)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=j}eoClip(){this.pendingClip=q}beginText(){this.current.textMatrix=n.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const w=this.pendingTextPaths,x=this.ctx;if(w===void 0){x.beginPath();return}x.save(),x.beginPath();for(const R of w)x.setTransform(...R.transform),x.translate(R.x,R.y),R.addToPath(x,R.fontSize);x.restore(),x.clip(),x.beginPath(),delete this.pendingTextPaths}setCharSpacing(w){this.current.charSpacing=w}setWordSpacing(w){this.current.wordSpacing=w}setHScale(w){this.current.textHScale=w/100}setLeading(w){this.current.leading=-w}setFont(w,x){var he;const R=this.commonObjs.get(w),V=this.current;if(!R)throw new Error(`Can't find font for ${w}`);if(V.fontMatrix=R.fontMatrix||n.FONT_IDENTITY_MATRIX,(V.fontMatrix[0]===0||V.fontMatrix[3]===0)&&(0,n.warn)("Invalid font matrix for font "+w),x<0?(x=-x,V.fontDirection=-1):V.fontDirection=1,this.current.font=R,this.current.fontSize=x,R.isType3Font)return;const D=R.loadedName||"sans-serif",Y=((he=R.systemFontInfo)==null?void 0:he.css)||`"${D}", ${R.fallbackName}`;let W="normal";R.black?W="900":R.bold&&(W="bold");const ee=R.italic?"italic":"normal";let me=x;x<o?me=o:x>c&&(me=c),this.current.fontSizeScale=x/me,this.ctx.font=`${ee} ${W} ${me}px ${Y}`}setTextRenderingMode(w){this.current.textRenderingMode=w}setTextRise(w){this.current.textRise=w}moveText(w,x){this.current.x=this.current.lineX+=w,this.current.y=this.current.lineY+=x}setLeadingMoveText(w,x){this.setLeading(-x),this.moveText(w,x)}setTextMatrix(w,x,R,V,D,Y){this.current.textMatrix=[w,x,R,V,D,Y],this.current.textMatrixScale=Math.hypot(w,x),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(w,x,R,V){const D=this.ctx,Y=this.current,W=Y.font,ee=Y.textRenderingMode,me=Y.fontSize/Y.fontSizeScale,he=ee&n.TextRenderingMode.FILL_STROKE_MASK,Ae=!!(ee&n.TextRenderingMode.ADD_TO_PATH_FLAG),ie=Y.patternFill&&!W.missingFile;let ye;(W.disableFontFace||Ae||ie)&&(ye=W.getPathGenerator(this.commonObjs,w)),W.disableFontFace||ie?(D.save(),D.translate(x,R),D.beginPath(),ye(D,me),V&&D.setTransform(...V),(he===n.TextRenderingMode.FILL||he===n.TextRenderingMode.FILL_STROKE)&&D.fill(),(he===n.TextRenderingMode.STROKE||he===n.TextRenderingMode.FILL_STROKE)&&D.stroke(),D.restore()):((he===n.TextRenderingMode.FILL||he===n.TextRenderingMode.FILL_STROKE)&&D.fillText(w,x,R),(he===n.TextRenderingMode.STROKE||he===n.TextRenderingMode.FILL_STROKE)&&D.strokeText(w,x,R)),Ae&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,s.getCurrentTransform)(D),x,y:R,fontSize:me,addToPath:ye})}get isFontSubpixelAAEnabled(){const{context:w}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);w.scale(1.5,1),w.fillText("I",0,10);const x=w.getImageData(0,0,10,10).data;let R=!1;for(let V=3;V<x.length;V+=4)if(x[V]>0&&x[V]<255){R=!0;break}return(0,n.shadow)(this,"isFontSubpixelAAEnabled",R)}showText(w){const x=this.current,R=x.font;if(R.isType3Font)return this.showType3Text(w);const V=x.fontSize;if(V===0)return;const D=this.ctx,Y=x.fontSizeScale,W=x.charSpacing,ee=x.wordSpacing,me=x.fontDirection,he=x.textHScale*me,Ae=w.length,ie=R.vertical,ye=ie?1:-1,xe=R.defaultVMetrics,Ve=V*x.fontMatrix[0],We=x.textRenderingMode===n.TextRenderingMode.FILL&&!R.disableFontFace&&!x.patternFill;D.save(),D.transform(...x.textMatrix),D.translate(x.x,x.y+x.textRise),me>0?D.scale(he,-1):D.scale(he,1);let Pe;if(x.patternFill){D.save();const Ee=x.fillColor.getPattern(D,this,(0,s.getCurrentTransformInverse)(D),i.PathType.FILL);Pe=(0,s.getCurrentTransform)(D),D.restore(),D.fillStyle=Ee}let He=x.lineWidth;const Me=x.textMatrixScale;if(Me===0||He===0){const Ee=x.textRenderingMode&n.TextRenderingMode.FILL_STROKE_MASK;(Ee===n.TextRenderingMode.STROKE||Ee===n.TextRenderingMode.FILL_STROKE)&&(He=this.getSinglePixelWidth())}else He/=Me;if(Y!==1&&(D.scale(Y,Y),He/=Y),D.lineWidth=He,R.isInvalidPDFjsFont){const Ee=[];let Be=0;for(const Ge of w)Ee.push(Ge.unicode),Be+=Ge.width;D.fillText(Ee.join(""),0,0),x.x+=Be*Ve*he,D.restore(),this.compose();return}let be=0,fe;for(fe=0;fe<Ae;++fe){const Ee=w[fe];if(typeof Ee=="number"){be+=ye*Ee*V/1e3;continue}let Be=!1;const Ge=(Ee.isSpace?ee:0)+W,Re=Ee.fontChar,Ce=Ee.accent;let Ie,ge,Ze=Ee.width;if(ie){const qe=Ee.vmetric||xe,we=-(Ee.vmetric?qe[1]:Ze*.5)*Ve,ue=qe[2]*Ve;Ze=qe?-qe[0]:Ze,Ie=we/Y,ge=(be+ue)/Y}else Ie=be/Y,ge=0;if(R.remeasure&&Ze>0){const qe=D.measureText(Re).width*1e3/V*Y;if(Ze<qe&&this.isFontSubpixelAAEnabled){const we=Ze/qe;Be=!0,D.save(),D.scale(we,1),Ie/=we}else Ze!==qe&&(Ie+=(Ze-qe)/2e3*V/Y)}if(this.contentVisible&&(Ee.isInFont||R.missingFile)){if(We&&!Ce)D.fillText(Re,Ie,ge);else if(this.paintChar(Re,Ie,ge,Pe),Ce){const qe=Ie+V*Ce.offset.x/Y,we=ge-V*Ce.offset.y/Y;this.paintChar(Ce.fontChar,qe,we,Pe)}}const Ke=ie?Ze*Ve-Ge*me:Ze*Ve+Ge*me;be+=Ke,Be&&D.restore()}ie?x.y-=be:x.x+=be*he,D.restore(),this.compose()}showType3Text(w){const x=this.ctx,R=this.current,V=R.font,D=R.fontSize,Y=R.fontDirection,W=V.vertical?1:-1,ee=R.charSpacing,me=R.wordSpacing,he=R.textHScale*Y,Ae=R.fontMatrix||n.FONT_IDENTITY_MATRIX,ie=w.length,ye=R.textRenderingMode===n.TextRenderingMode.INVISIBLE;let xe,Ve,We,Pe;if(!(ye||D===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,x.save(),x.transform(...R.textMatrix),x.translate(R.x,R.y),x.scale(he,Y),xe=0;xe<ie;++xe){if(Ve=w[xe],typeof Ve=="number"){Pe=W*Ve*D/1e3,this.ctx.translate(Pe,0),R.x+=Pe*he;continue}const He=(Ve.isSpace?me:0)+ee,Me=V.charProcOperatorList[Ve.operatorListId];if(!Me){(0,n.warn)(`Type3 character "${Ve.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=Ve,this.save(),x.scale(D,D),x.transform(...Ae),this.executeOperatorList(Me),this.restore()),We=n.Util.applyTransform([Ve.width,0],Ae)[0]*D+He,x.translate(We,0),R.x+=We*he}x.restore(),this.processingType3=null}}setCharWidth(w,x){}setCharWidthAndBounds(w,x,R,V,D,Y){this.ctx.rect(R,V,D-R,Y-V),this.ctx.clip(),this.endPath()}getColorN_Pattern(w){let x;if(w[0]==="TilingPattern"){const R=w[1],V=this.baseTransform||(0,s.getCurrentTransform)(this.ctx),D={createCanvasGraphics:Y=>new de(Y,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};x=new i.TilingPattern(w,R,this.ctx,D,V)}else x=this._getPattern(w[1],w[2]);return x}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(w,x,R){const V=n.Util.makeHexColor(w,x,R);this.ctx.strokeStyle=V,this.current.strokeColor=V}setFillRGBColor(w,x,R){const V=n.Util.makeHexColor(w,x,R);this.ctx.fillStyle=V,this.current.fillColor=V,this.current.patternFill=!1}_getPattern(w){let x=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,R;return this.cachedPatterns.has(w)?R=this.cachedPatterns.get(w):(R=(0,i.getShadingPattern)(this.getObject(w)),this.cachedPatterns.set(w,R)),x&&(R.matrix=x),R}shadingFill(w){if(!this.contentVisible)return;const x=this.ctx;this.save();const R=this._getPattern(w);x.fillStyle=R.getPattern(x,this,(0,s.getCurrentTransformInverse)(x),i.PathType.SHADING);const V=(0,s.getCurrentTransformInverse)(x);if(V){const{width:D,height:Y}=x.canvas,[W,ee,me,he]=n.Util.getAxialAlignedBoundingBox([0,0,D,Y],V);this.ctx.fillRect(W,ee,me-W,he-ee)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,n.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,n.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(w,x){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(w)&&w.length===6&&this.transform(...w),this.baseTransform=(0,s.getCurrentTransform)(this.ctx),x)){const R=x[2]-x[0],V=x[3]-x[1];this.ctx.rect(x[0],x[1],R,V),this.current.updateRectMinMax((0,s.getCurrentTransform)(this.ctx),x),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(w){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const x=this.ctx;w.isolated||(0,n.info)("TODO: Support non-isolated groups."),w.knockout&&(0,n.warn)("Knockout groups not supported.");const R=(0,s.getCurrentTransform)(x);if(w.matrix&&x.transform(...w.matrix),!w.bbox)throw new Error("Bounding box is required.");let V=n.Util.getAxialAlignedBoundingBox(w.bbox,(0,s.getCurrentTransform)(x));const D=[0,0,x.canvas.width,x.canvas.height];V=n.Util.intersect(V,D)||[0,0,0,0];const Y=Math.floor(V[0]),W=Math.floor(V[1]);let ee=Math.max(Math.ceil(V[2])-Y,1),me=Math.max(Math.ceil(V[3])-W,1),he=1,Ae=1;ee>l&&(he=ee/l,ee=l),me>l&&(Ae=me/l,me=l),this.current.startNewPathAndClipBox([0,0,ee,me]);let ie="groupAt"+this.groupLevel;w.smask&&(ie+="_smask_"+this.smaskCounter++%2);const ye=this.cachedCanvases.getCanvas(ie,ee,me),xe=ye.context;xe.scale(1/he,1/Ae),xe.translate(-Y,-W),xe.transform(...R),w.smask?this.smaskStack.push({canvas:ye.canvas,context:xe,offsetX:Y,offsetY:W,scaleX:he,scaleY:Ae,subtype:w.smask.subtype,backdrop:w.smask.backdrop,transferMap:w.smask.transferMap||null,startTransformInverse:null}):(x.setTransform(1,0,0,1,0,0),x.translate(Y,W),x.scale(he,Ae),x.save()),g(x,xe),this.ctx=xe,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(x),this.groupLevel++}endGroup(w){if(!this.contentVisible)return;this.groupLevel--;const x=this.ctx,R=this.groupStack.pop();if(this.ctx=R,this.ctx.imageSmoothingEnabled=!1,w.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const V=(0,s.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...V);const D=n.Util.getAxialAlignedBoundingBox([0,0,x.canvas.width,x.canvas.height],V);this.ctx.drawImage(x.canvas,0,0),this.ctx.restore(),this.compose(D)}}beginAnnotation(w,x,R,V,D){if(le(this,F,an).call(this),b(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(x)&&x.length===4){const Y=x[2]-x[0],W=x[3]-x[1];if(D&&this.annotationCanvasMap){R=R.slice(),R[4]-=x[0],R[5]-=x[1],x=x.slice(),x[0]=x[1]=0,x[2]=Y,x[3]=W;const[ee,me]=n.Util.singularValueDecompose2dScale((0,s.getCurrentTransform)(this.ctx)),{viewportScale:he}=this,Ae=Math.ceil(Y*this.outputScaleX*he),ie=Math.ceil(W*this.outputScaleY*he);this.annotationCanvas=this.canvasFactory.create(Ae,ie);const{canvas:ye,context:xe}=this.annotationCanvas;this.annotationCanvasMap.set(w,ye),this.annotationCanvas.savedCtx=this.ctx,this.ctx=xe,this.ctx.save(),this.ctx.setTransform(ee,0,0,-me,0,W*me),b(this.ctx)}else b(this.ctx),this.ctx.rect(x[0],x[1],Y,W),this.ctx.clip(),this.endPath()}this.current=new _(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...R),this.transform(...V)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),le(this,Q,on).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(w){if(!this.contentVisible)return;const x=w.count;w=this.getObject(w.data,w),w.count=x;const R=this.ctx,V=this.processingType3;if(V&&(V.compiled===void 0&&(V.compiled=v(w)),V.compiled)){V.compiled(R);return}const D=this._createMaskCanvas(w),Y=D.canvas;R.save(),R.setTransform(1,0,0,1,0,0),R.drawImage(Y,D.offsetX,D.offsetY),R.restore(),this.compose()}paintImageMaskXObjectRepeat(w,x){let R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,V=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,D=arguments.length>4?arguments[4]:void 0,Y=arguments.length>5?arguments[5]:void 0;if(!this.contentVisible)return;w=this.getObject(w.data,w);const W=this.ctx;W.save();const ee=(0,s.getCurrentTransform)(W);W.transform(x,R,V,D,0,0);const me=this._createMaskCanvas(w);W.setTransform(1,0,0,1,me.offsetX-ee[4],me.offsetY-ee[5]);for(let he=0,Ae=Y.length;he<Ae;he+=2){const ie=n.Util.transform(ee,[x,R,V,D,Y[he],Y[he+1]]),[ye,xe]=n.Util.applyTransform([0,0],ie);W.drawImage(me.canvas,ye,xe)}W.restore(),this.compose()}paintImageMaskXObjectGroup(w){if(!this.contentVisible)return;const x=this.ctx,R=this.current.fillColor,V=this.current.patternFill;for(const D of w){const{data:Y,width:W,height:ee,transform:me}=D,he=this.cachedCanvases.getCanvas("maskCanvas",W,ee),Ae=he.context;Ae.save();const ie=this.getObject(Y,D);k(Ae,ie),Ae.globalCompositeOperation="source-in",Ae.fillStyle=V?R.getPattern(Ae,this,(0,s.getCurrentTransformInverse)(x),i.PathType.FILL):R,Ae.fillRect(0,0,W,ee),Ae.restore(),x.save(),x.transform(...me),x.scale(1,-1),f(x,he.canvas,0,0,W,ee,0,-1,1,1),x.restore()}this.compose()}paintImageXObject(w){if(!this.contentVisible)return;const x=this.getObject(w);if(!x){(0,n.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(x)}paintImageXObjectRepeat(w,x,R,V){if(!this.contentVisible)return;const D=this.getObject(w);if(!D){(0,n.warn)("Dependent image isn't ready yet");return}const Y=D.width,W=D.height,ee=[];for(let me=0,he=V.length;me<he;me+=2)ee.push({transform:[x,0,0,R,V[me],V[me+1]],x:0,y:0,w:Y,h:W});this.paintInlineImageXObjectGroup(D,ee)}applyTransferMapsToCanvas(w){return this.current.transferMaps!=="none"&&(w.filter=this.current.transferMaps,w.drawImage(w.canvas,0,0),w.filter="none"),w.canvas}applyTransferMapsToBitmap(w){if(this.current.transferMaps==="none")return w.bitmap;const{bitmap:x,width:R,height:V}=w,D=this.cachedCanvases.getCanvas("inlineImage",R,V),Y=D.context;return Y.filter=this.current.transferMaps,Y.drawImage(x,0,0),Y.filter="none",D.canvas}paintInlineImageXObject(w){if(!this.contentVisible)return;const x=w.width,R=w.height,V=this.ctx;if(this.save(),!n.isNodeJS){const{filter:W}=V;W!=="none"&&W!==""&&(V.filter="none")}V.scale(1/x,-1/R);let D;if(w.bitmap)D=this.applyTransferMapsToBitmap(w);else if(typeof HTMLElement=="function"&&w instanceof HTMLElement||!w.data)D=w;else{const ee=this.cachedCanvases.getCanvas("inlineImage",x,R).context;O(ee,w),D=this.applyTransferMapsToCanvas(ee)}const Y=this._scaleImage(D,(0,s.getCurrentTransformInverse)(V));V.imageSmoothingEnabled=$((0,s.getCurrentTransform)(V),w.interpolate),f(V,Y.img,0,0,Y.paintWidth,Y.paintHeight,0,-R,x,R),this.compose(),this.restore()}paintInlineImageXObjectGroup(w,x){if(!this.contentVisible)return;const R=this.ctx;let V;if(w.bitmap)V=w.bitmap;else{const D=w.width,Y=w.height,ee=this.cachedCanvases.getCanvas("inlineImage",D,Y).context;O(ee,w),V=this.applyTransferMapsToCanvas(ee)}for(const D of x)R.save(),R.transform(...D.transform),R.scale(1,-1),f(R,V,D.x,D.y,D.w,D.h,0,-1,1,1),R.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(w){}markPointProps(w,x){}beginMarkedContent(w){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(w,x){w==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(x)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(w){const x=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(w);const R=this.ctx;this.pendingClip&&(x||(this.pendingClip===q?R.clip("evenodd"):R.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),R.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const w=(0,s.getCurrentTransform)(this.ctx);if(w[1]===0&&w[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(w[0]),Math.abs(w[3]));else{const x=Math.abs(w[0]*w[3]-w[2]*w[1]),R=Math.hypot(w[0],w[2]),V=Math.hypot(w[1],w[3]);this._cachedGetSinglePixelWidth=Math.max(R,V)/x}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:w}=this.current,{a:x,b:R,c:V,d:D}=this.ctx.getTransform();let Y,W;if(R===0&&V===0){const ee=Math.abs(x),me=Math.abs(D);if(ee===me)if(w===0)Y=W=1/ee;else{const he=ee*w;Y=W=he<1?1/he:1}else if(w===0)Y=1/ee,W=1/me;else{const he=ee*w,Ae=me*w;Y=he<1?1/he:1,W=Ae<1?1/Ae:1}}else{const ee=Math.abs(x*D-R*V),me=Math.hypot(x,R),he=Math.hypot(V,D);if(w===0)Y=he/ee,W=me/ee;else{const Ae=w*ee;Y=he>Ae?he/Ae:1,W=me>Ae?me/Ae:1}}this._cachedScaleForStroking[0]=Y,this._cachedScaleForStroking[1]=W}return this._cachedScaleForStroking}rescaleAndStroke(w){const{ctx:x}=this,{lineWidth:R}=this.current,[V,D]=this.getScaleForStroking();if(x.lineWidth=R||1,V===1&&D===1){x.stroke();return}const Y=x.getLineDash();if(w&&x.save(),x.scale(V,D),Y.length>0){const W=Math.max(V,D);x.setLineDash(Y.map(ee=>ee/W)),x.lineDashOffset/=W}x.stroke(),w&&x.restore()}isContentVisible(){for(let w=this.markedContentStack.length-1;w>=0;w--)if(!this.markedContentStack[w].visible)return!1;return!0}};F=new WeakSet,an=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},Q=new WeakSet,on=function(){if(this.pageColors){const w=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(w!=="none"){const x=this.ctx.filter;this.ctx.filter=w,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=x}}};let te=de;e.CanvasGraphics=te;for(const U in n.OPS)te.prototype[U]!==void 0&&(te.prototype[n.OPS[U]]=te.prototype[U])},(r,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TilingPattern=e.PathType=void 0,e.getShadingPattern=y,t(2);var n=t(1),s=t(168);const i={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};e.PathType=i;function a(v,_){if(!_)return;const O=_[2]-_[0],k=_[3]-_[1],g=new Path2D;g.rect(_[0],_[1],O,k),v.clip(g)}class o{constructor(){this.constructor===o&&(0,n.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,n.unreachable)("Abstract method `getPattern` called.")}}class c extends o{constructor(_){super(),this._type=_[1],this._bbox=_[2],this._colorStops=_[3],this._p0=_[4],this._p1=_[5],this._r0=_[6],this._r1=_[7],this.matrix=null}_createGradient(_){let O;this._type==="axial"?O=_.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(O=_.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const k of this._colorStops)O.addColorStop(k[0],k[1]);return O}getPattern(_,O,k,g){let b;if(g===i.STROKE||g===i.FILL){const N=O.current.getClippedPathBoundingBox(g,(0,s.getCurrentTransform)(_))||[0,0,0,0],S=Math.ceil(N[2]-N[0])||1,T=Math.ceil(N[3]-N[1])||1,M=O.cachedCanvases.getCanvas("pattern",S,T,!0),P=M.context;P.clearRect(0,0,P.canvas.width,P.canvas.height),P.beginPath(),P.rect(0,0,P.canvas.width,P.canvas.height),P.translate(-N[0],-N[1]),k=n.Util.transform(k,[1,0,0,1,N[0],N[1]]),P.transform(...O.baseTransform),this.matrix&&P.transform(...this.matrix),a(P,this._bbox),P.fillStyle=this._createGradient(P),P.fill(),b=_.createPattern(M.canvas,"no-repeat");const $=new DOMMatrix(k);b.setTransform($)}else a(_,this._bbox),b=this._createGradient(_);return b}}function l(v,_,O,k,g,b,N,S){const T=_.coords,M=_.colors,P=v.data,$=v.width*4;let K;T[O+1]>T[k+1]&&(K=O,O=k,k=K,K=b,b=N,N=K),T[k+1]>T[g+1]&&(K=k,k=g,g=K,K=N,N=S,S=K),T[O+1]>T[k+1]&&(K=O,O=k,k=K,K=b,b=N,N=K);const L=(T[O]+_.offsetX)*_.scaleX,j=(T[O+1]+_.offsetY)*_.scaleY,q=(T[k]+_.offsetX)*_.scaleX,te=(T[k+1]+_.offsetY)*_.scaleY,F=(T[g]+_.offsetX)*_.scaleX,z=(T[g+1]+_.offsetY)*_.scaleY;if(j>=z)return;const Q=M[b],ne=M[b+1],de=M[b+2],U=M[N],w=M[N+1],x=M[N+2],R=M[S],V=M[S+1],D=M[S+2],Y=Math.round(j),W=Math.round(z);let ee,me,he,Ae,ie,ye,xe,Ve;for(let We=Y;We<=W;We++){if(We<te){const fe=We<j?0:(j-We)/(j-te);ee=L-(L-q)*fe,me=Q-(Q-U)*fe,he=ne-(ne-w)*fe,Ae=de-(de-x)*fe}else{let fe;We>z?fe=1:te===z?fe=0:fe=(te-We)/(te-z),ee=q-(q-F)*fe,me=U-(U-R)*fe,he=w-(w-V)*fe,Ae=x-(x-D)*fe}let Pe;We<j?Pe=0:We>z?Pe=1:Pe=(j-We)/(j-z),ie=L-(L-F)*Pe,ye=Q-(Q-R)*Pe,xe=ne-(ne-V)*Pe,Ve=de-(de-D)*Pe;const He=Math.round(Math.min(ee,ie)),Me=Math.round(Math.max(ee,ie));let be=$*We+He*4;for(let fe=He;fe<=Me;fe++)Pe=(ee-fe)/(ee-ie),Pe<0?Pe=0:Pe>1&&(Pe=1),P[be++]=me-(me-ye)*Pe|0,P[be++]=he-(he-xe)*Pe|0,P[be++]=Ae-(Ae-Ve)*Pe|0,P[be++]=255}}function u(v,_,O){const k=_.coords,g=_.colors;let b,N;switch(_.type){case"lattice":const S=_.verticesPerRow,T=Math.floor(k.length/S)-1,M=S-1;for(b=0;b<T;b++){let P=b*S;for(let $=0;$<M;$++,P++)l(v,O,k[P],k[P+1],k[P+S],g[P],g[P+1],g[P+S]),l(v,O,k[P+S+1],k[P+1],k[P+S],g[P+S+1],g[P+1],g[P+S])}break;case"triangles":for(b=0,N=k.length;b<N;b+=3)l(v,O,k[b],k[b+1],k[b+2],g[b],g[b+1],g[b+2]);break;default:throw new Error("illegal figure")}}class d extends o{constructor(_){super(),this._coords=_[2],this._colors=_[3],this._figures=_[4],this._bounds=_[5],this._bbox=_[7],this._background=_[8],this.matrix=null}_createMeshCanvas(_,O,k){const S=Math.floor(this._bounds[0]),T=Math.floor(this._bounds[1]),M=Math.ceil(this._bounds[2])-S,P=Math.ceil(this._bounds[3])-T,$=Math.min(Math.ceil(Math.abs(M*_[0]*1.1)),3e3),K=Math.min(Math.ceil(Math.abs(P*_[1]*1.1)),3e3),L=M/$,j=P/K,q={coords:this._coords,colors:this._colors,offsetX:-S,offsetY:-T,scaleX:1/L,scaleY:1/j},te=$+2*2,F=K+2*2,z=k.getCanvas("mesh",te,F,!1),Q=z.context,ne=Q.createImageData($,K);if(O){const U=ne.data;for(let w=0,x=U.length;w<x;w+=4)U[w]=O[0],U[w+1]=O[1],U[w+2]=O[2],U[w+3]=255}for(const U of this._figures)u(ne,U,q);return Q.putImageData(ne,2,2),{canvas:z.canvas,offsetX:S-2*L,offsetY:T-2*j,scaleX:L,scaleY:j}}getPattern(_,O,k,g){a(_,this._bbox);let b;if(g===i.SHADING)b=n.Util.singularValueDecompose2dScale((0,s.getCurrentTransform)(_));else if(b=n.Util.singularValueDecompose2dScale(O.baseTransform),this.matrix){const S=n.Util.singularValueDecompose2dScale(this.matrix);b=[b[0]*S[0],b[1]*S[1]]}const N=this._createMeshCanvas(b,g===i.SHADING?null:this._background,O.cachedCanvases);return g!==i.SHADING&&(_.setTransform(...O.baseTransform),this.matrix&&_.transform(...this.matrix)),_.translate(N.offsetX,N.offsetY),_.scale(N.scaleX,N.scaleY),_.createPattern(N.canvas,"no-repeat")}}class m extends o{getPattern(){return"hotpink"}}function y(v){switch(v[0]){case"RadialAxial":return new c(v);case"Mesh":return new d(v);case"Dummy":return new m}throw new Error(`Unknown IR type: ${v[0]}`)}const h={COLORED:1,UNCOLORED:2},f=class f{constructor(_,O,k,g,b){this.operatorList=_[2],this.matrix=_[3]||[1,0,0,1,0,0],this.bbox=_[4],this.xstep=_[5],this.ystep=_[6],this.paintType=_[7],this.tilingType=_[8],this.color=O,this.ctx=k,this.canvasGraphicsFactory=g,this.baseTransform=b}createPatternCanvas(_){const O=this.operatorList,k=this.bbox,g=this.xstep,b=this.ystep,N=this.paintType,S=this.tilingType,T=this.color,M=this.canvasGraphicsFactory;(0,n.info)("TilingType: "+S);const P=k[0],$=k[1],K=k[2],L=k[3],j=n.Util.singularValueDecompose2dScale(this.matrix),q=n.Util.singularValueDecompose2dScale(this.baseTransform),te=[j[0]*q[0],j[1]*q[1]],F=this.getSizeAndScale(g,this.ctx.canvas.width,te[0]),z=this.getSizeAndScale(b,this.ctx.canvas.height,te[1]),Q=_.cachedCanvases.getCanvas("pattern",F.size,z.size,!0),ne=Q.context,de=M.createCanvasGraphics(ne);de.groupLevel=_.groupLevel,this.setFillAndStrokeStyleToContext(de,N,T);let U=P,w=$,x=K,R=L;return P<0&&(U=0,x+=Math.abs(P)),$<0&&(w=0,R+=Math.abs($)),ne.translate(-(F.scale*U),-(z.scale*w)),de.transform(F.scale,0,0,z.scale,0,0),ne.save(),this.clipBbox(de,U,w,x,R),de.baseTransform=(0,s.getCurrentTransform)(de.ctx),de.executeOperatorList(O),de.endDrawing(),{canvas:Q.canvas,scaleX:F.scale,scaleY:z.scale,offsetX:U,offsetY:w}}getSizeAndScale(_,O,k){_=Math.abs(_);const g=Math.max(f.MAX_PATTERN_SIZE,O);let b=Math.ceil(_*k);return b>=g?b=g:k=b/_,{scale:k,size:b}}clipBbox(_,O,k,g,b){const N=g-O,S=b-k;_.ctx.rect(O,k,N,S),_.current.updateRectMinMax((0,s.getCurrentTransform)(_.ctx),[O,k,g,b]),_.clip(),_.endPath()}setFillAndStrokeStyleToContext(_,O,k){const g=_.ctx,b=_.current;switch(O){case h.COLORED:const N=this.ctx;g.fillStyle=N.fillStyle,g.strokeStyle=N.strokeStyle,b.fillColor=N.fillStyle,b.strokeColor=N.strokeStyle;break;case h.UNCOLORED:const S=n.Util.makeHexColor(k[0],k[1],k[2]);g.fillStyle=S,g.strokeStyle=S,b.fillColor=S,b.strokeColor=S;break;default:throw new n.FormatError(`Unsupported paint type: ${O}`)}}getPattern(_,O,k,g){let b=k;g!==i.SHADING&&(b=n.Util.transform(b,O.baseTransform),this.matrix&&(b=n.Util.transform(b,this.matrix)));const N=this.createPatternCanvas(O);let S=new DOMMatrix(b);S=S.translate(N.offsetX,N.offsetY),S=S.scale(1/N.scaleX,1/N.scaleY);const T=_.createPattern(N.canvas,"repeat");return T.setTransform(S),T}};rt(f,"MAX_PATTERN_SIZE",3e3);let p=f;e.TilingPattern=p},(r,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.convertBlackAndWhiteToRGBA=i,e.convertToRGBA=s,e.grayToRGBA=o,t(93),t(101),t(102),t(105),t(107),t(109),t(113),t(116),t(123);var n=t(1);function s(c){switch(c.kind){case n.ImageKind.GRAYSCALE_1BPP:return i(c);case n.ImageKind.RGB_24BPP:return a(c)}return null}function i(c){let{src:l,srcPos:u=0,dest:d,width:m,height:y,nonBlackColor:h=4294967295,inverseDecode:p=!1}=c;const f=n.FeatureTest.isLittleEndian?4278190080:255,[v,_]=p?[h,f]:[f,h],O=m>>3,k=m&7,g=l.length;d=new Uint32Array(d.buffer);let b=0;for(let N=0;N<y;N++){for(const T=u+O;u<T;u++){const M=u<g?l[u]:255;d[b++]=M&128?_:v,d[b++]=M&64?_:v,d[b++]=M&32?_:v,d[b++]=M&16?_:v,d[b++]=M&8?_:v,d[b++]=M&4?_:v,d[b++]=M&2?_:v,d[b++]=M&1?_:v}if(k===0)continue;const S=u<g?l[u++]:255;for(let T=0;T<k;T++)d[b++]=S&1<<7-T?_:v}return{srcPos:u,destPos:b}}function a(c){let{src:l,srcPos:u=0,dest:d,destPos:m=0,width:y,height:h}=c,p=0;const f=l.length>>2,v=new Uint32Array(l.buffer,u,f);if(n.FeatureTest.isLittleEndian){for(;p<f-2;p+=3,m+=4){const _=v[p],O=v[p+1],k=v[p+2];d[m]=_|4278190080,d[m+1]=_>>>24|O<<8|4278190080,d[m+2]=O>>>16|k<<16|4278190080,d[m+3]=k>>>8|4278190080}for(let _=p*4,O=l.length;_<O;_+=3)d[m++]=l[_]|l[_+1]<<8|l[_+2]<<16|4278190080}else{for(;p<f-2;p+=3,m+=4){const _=v[p],O=v[p+1],k=v[p+2];d[m]=_|255,d[m+1]=_<<24|O>>>8|255,d[m+2]=O<<16|k>>>16|255,d[m+3]=k<<8|255}for(let _=p*4,O=l.length;_<O;_+=3)d[m++]=l[_]<<24|l[_+1]<<16|l[_+2]<<8|255}return{srcPos:u,destPos:m}}function o(c,l){if(n.FeatureTest.isLittleEndian)for(let u=0,d=c.length;u<d;u++)l[u]=c[u]*65793|4278190080;else for(let u=0,d=c.length;u<d;u++)l[u]=c[u]*16843008|255}},(r,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.GlobalWorkerOptions=void 0;const t=Object.create(null);e.GlobalWorkerOptions=t,t.workerPort=null,t.workerSrc=""},(r,e,t)=>{var c,$n,u,zn,m,Vt;Object.defineProperty(e,"__esModule",{value:!0}),e.MessageHandler=void 0,t(2);var n=t(1);const s={UNKNOWN:0,DATA:1,ERROR:2},i={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function a(h){switch(h instanceof Error||typeof h=="object"&&h!==null||(0,n.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),h.name){case"AbortException":return new n.AbortException(h.message);case"MissingPDFException":return new n.MissingPDFException(h.message);case"PasswordException":return new n.PasswordException(h.message,h.code);case"UnexpectedResponseException":return new n.UnexpectedResponseException(h.message,h.status);case"UnknownErrorException":return new n.UnknownErrorException(h.message,h.details);default:return new n.UnknownErrorException(h.message,h.toString())}}class o{constructor(p,f,v){se(this,c);se(this,u);se(this,m);this.sourceName=p,this.targetName=f,this.comObj=v,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=_=>{const O=_.data;if(O.targetName!==this.sourceName)return;if(O.stream){le(this,u,zn).call(this,O);return}if(O.callback){const g=O.callbackId,b=this.callbackCapabilities[g];if(!b)throw new Error(`Cannot resolve callback ${g}`);if(delete this.callbackCapabilities[g],O.callback===s.DATA)b.resolve(O.data);else if(O.callback===s.ERROR)b.reject(a(O.reason));else throw new Error("Unexpected callback case");return}const k=this.actionHandler[O.action];if(!k)throw new Error(`Unknown action from worker: ${O.action}`);if(O.callbackId){const g=this.sourceName,b=O.sourceName;new Promise(function(N){N(k(O.data))}).then(function(N){v.postMessage({sourceName:g,targetName:b,callback:s.DATA,callbackId:O.callbackId,data:N})},function(N){v.postMessage({sourceName:g,targetName:b,callback:s.ERROR,callbackId:O.callbackId,reason:a(N)})});return}if(O.streamId){le(this,c,$n).call(this,O);return}k(O.data)},v.addEventListener("message",this._onComObjOnMessage)}on(p,f){const v=this.actionHandler;if(v[p])throw new Error(`There is already an actionName called "${p}"`);v[p]=f}send(p,f,v){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:p,data:f},v)}sendWithPromise(p,f,v){const _=this.callbackId++,O=new n.PromiseCapability;this.callbackCapabilities[_]=O;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:p,callbackId:_,data:f},v)}catch(k){O.reject(k)}return O.promise}sendWithStream(p,f,v,_){const O=this.streamId++,k=this.sourceName,g=this.targetName,b=this.comObj;return new ReadableStream({start:N=>{const S=new n.PromiseCapability;return this.streamControllers[O]={controller:N,startCall:S,pullCall:null,cancelCall:null,isClosed:!1},b.postMessage({sourceName:k,targetName:g,action:p,streamId:O,data:f,desiredSize:N.desiredSize},_),S.promise},pull:N=>{const S=new n.PromiseCapability;return this.streamControllers[O].pullCall=S,b.postMessage({sourceName:k,targetName:g,stream:i.PULL,streamId:O,desiredSize:N.desiredSize}),S.promise},cancel:N=>{(0,n.assert)(N instanceof Error,"cancel must have a valid reason");const S=new n.PromiseCapability;return this.streamControllers[O].cancelCall=S,this.streamControllers[O].isClosed=!0,b.postMessage({sourceName:k,targetName:g,stream:i.CANCEL,streamId:O,reason:a(N)}),S.promise}},v)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}c=new WeakSet,$n=function(p){const f=p.streamId,v=this.sourceName,_=p.sourceName,O=this.comObj,k=this,g=this.actionHandler[p.action],b={enqueue(N){let S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,T=arguments.length>2?arguments[2]:void 0;if(this.isCancelled)return;const M=this.desiredSize;this.desiredSize-=S,M>0&&this.desiredSize<=0&&(this.sinkCapability=new n.PromiseCapability,this.ready=this.sinkCapability.promise),O.postMessage({sourceName:v,targetName:_,stream:i.ENQUEUE,streamId:f,chunk:N},T)},close(){this.isCancelled||(this.isCancelled=!0,O.postMessage({sourceName:v,targetName:_,stream:i.CLOSE,streamId:f}),delete k.streamSinks[f])},error(N){(0,n.assert)(N instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,O.postMessage({sourceName:v,targetName:_,stream:i.ERROR,streamId:f,reason:a(N)}))},sinkCapability:new n.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:p.desiredSize,ready:null};b.sinkCapability.resolve(),b.ready=b.sinkCapability.promise,this.streamSinks[f]=b,new Promise(function(N){N(g(p.data,b))}).then(function(){O.postMessage({sourceName:v,targetName:_,stream:i.START_COMPLETE,streamId:f,success:!0})},function(N){O.postMessage({sourceName:v,targetName:_,stream:i.START_COMPLETE,streamId:f,reason:a(N)})})},u=new WeakSet,zn=function(p){const f=p.streamId,v=this.sourceName,_=p.sourceName,O=this.comObj,k=this.streamControllers[f],g=this.streamSinks[f];switch(p.stream){case i.START_COMPLETE:p.success?k.startCall.resolve():k.startCall.reject(a(p.reason));break;case i.PULL_COMPLETE:p.success?k.pullCall.resolve():k.pullCall.reject(a(p.reason));break;case i.PULL:if(!g){O.postMessage({sourceName:v,targetName:_,stream:i.PULL_COMPLETE,streamId:f,success:!0});break}g.desiredSize<=0&&p.desiredSize>0&&g.sinkCapability.resolve(),g.desiredSize=p.desiredSize,new Promise(function(b){var N;b((N=g.onPull)==null?void 0:N.call(g))}).then(function(){O.postMessage({sourceName:v,targetName:_,stream:i.PULL_COMPLETE,streamId:f,success:!0})},function(b){O.postMessage({sourceName:v,targetName:_,stream:i.PULL_COMPLETE,streamId:f,reason:a(b)})});break;case i.ENQUEUE:if((0,n.assert)(k,"enqueue should have stream controller"),k.isClosed)break;k.controller.enqueue(p.chunk);break;case i.CLOSE:if((0,n.assert)(k,"close should have stream controller"),k.isClosed)break;k.isClosed=!0,k.controller.close(),le(this,m,Vt).call(this,k,f);break;case i.ERROR:(0,n.assert)(k,"error should have stream controller"),k.controller.error(a(p.reason)),le(this,m,Vt).call(this,k,f);break;case i.CANCEL_COMPLETE:p.success?k.cancelCall.resolve():k.cancelCall.reject(a(p.reason)),le(this,m,Vt).call(this,k,f);break;case i.CANCEL:if(!g)break;new Promise(function(b){var N;b((N=g.onCancel)==null?void 0:N.call(g,a(p.reason)))}).then(function(){O.postMessage({sourceName:v,targetName:_,stream:i.CANCEL_COMPLETE,streamId:f,success:!0})},function(b){O.postMessage({sourceName:v,targetName:_,stream:i.CANCEL_COMPLETE,streamId:f,reason:a(b)})}),g.sinkCapability.reject(a(p.reason)),g.isCancelled=!0,delete this.streamSinks[f];break;default:throw new Error("Unexpected stream case")}},m=new WeakSet,Vt=async function(p,f){var v,_,O;await Promise.allSettled([(v=p.startCall)==null?void 0:v.promise,(_=p.pullCall)==null?void 0:_.promise,(O=p.cancelCall)==null?void 0:O.promise]),delete this.streamControllers[f]},e.MessageHandler=o},(r,e,t)=>{var i,a;Object.defineProperty(e,"__esModule",{value:!0}),e.Metadata=void 0;var n=t(1);class s{constructor(c){se(this,i,void 0);se(this,a,void 0);let{parsedData:l,rawData:u}=c;Se(this,i,l),Se(this,a,u)}getRaw(){return E(this,a)}get(c){return E(this,i).get(c)??null}getAll(){return(0,n.objectFromMap)(E(this,i))}has(c){return E(this,i).has(c)}}i=new WeakMap,a=new WeakMap,e.Metadata=s},(r,e,t)=>{var c,l,u,d,m,y,cn;Object.defineProperty(e,"__esModule",{value:!0}),e.OptionalContentConfig=void 0;var n=t(1),s=t(170);const i=Symbol("INTERNAL");class a{constructor(f,v){se(this,c,!0);this.name=f,this.intent=v}get visible(){return E(this,c)}_setVisible(f,v){f!==i&&(0,n.unreachable)("Internal method `_setVisible` called."),Se(this,c,v)}}c=new WeakMap;class o{constructor(f){se(this,y);se(this,l,null);se(this,u,new Map);se(this,d,null);se(this,m,null);if(this.name=null,this.creator=null,f!==null){this.name=f.name,this.creator=f.creator,Se(this,m,f.order);for(const v of f.groups)E(this,u).set(v.id,new a(v.name,v.intent));if(f.baseState==="OFF")for(const v of E(this,u).values())v._setVisible(i,!1);for(const v of f.on)E(this,u).get(v)._setVisible(i,!0);for(const v of f.off)E(this,u).get(v)._setVisible(i,!1);Se(this,d,this.getHash())}}isVisible(f){if(E(this,u).size===0)return!0;if(!f)return(0,n.warn)("Optional content group not defined."),!0;if(f.type==="OCG")return E(this,u).has(f.id)?E(this,u).get(f.id).visible:((0,n.warn)(`Optional content group not found: ${f.id}`),!0);if(f.type==="OCMD"){if(f.expression)return le(this,y,cn).call(this,f.expression);if(!f.policy||f.policy==="AnyOn"){for(const v of f.ids){if(!E(this,u).has(v))return(0,n.warn)(`Optional content group not found: ${v}`),!0;if(E(this,u).get(v).visible)return!0}return!1}else if(f.policy==="AllOn"){for(const v of f.ids){if(!E(this,u).has(v))return(0,n.warn)(`Optional content group not found: ${v}`),!0;if(!E(this,u).get(v).visible)return!1}return!0}else if(f.policy==="AnyOff"){for(const v of f.ids){if(!E(this,u).has(v))return(0,n.warn)(`Optional content group not found: ${v}`),!0;if(!E(this,u).get(v).visible)return!0}return!1}else if(f.policy==="AllOff"){for(const v of f.ids){if(!E(this,u).has(v))return(0,n.warn)(`Optional content group not found: ${v}`),!0;if(E(this,u).get(v).visible)return!1}return!0}return(0,n.warn)(`Unknown optional content policy ${f.policy}.`),!0}return(0,n.warn)(`Unknown group type ${f.type}.`),!0}setVisibility(f){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!E(this,u).has(f)){(0,n.warn)(`Optional content group not found: ${f}`);return}E(this,u).get(f)._setVisible(i,!!v),Se(this,l,null)}get hasInitialVisibility(){return E(this,d)===null||this.getHash()===E(this,d)}getOrder(){return E(this,u).size?E(this,m)?E(this,m).slice():[...E(this,u).keys()]:null}getGroups(){return E(this,u).size>0?(0,n.objectFromMap)(E(this,u)):null}getGroup(f){return E(this,u).get(f)||null}getHash(){if(E(this,l)!==null)return E(this,l);const f=new s.MurmurHash3_64;for(const[v,_]of E(this,u))f.update(`${v}:${_.visible}`);return Se(this,l,f.hexdigest())}}l=new WeakMap,u=new WeakMap,d=new WeakMap,m=new WeakMap,y=new WeakSet,cn=function(f){const v=f.length;if(v<2)return!0;const _=f[0];for(let O=1;O<v;O++){const k=f[O];let g;if(Array.isArray(k))g=le(this,y,cn).call(this,k);else if(E(this,u).has(k))g=E(this,u).get(k).visible;else return(0,n.warn)(`Optional content group not found: ${k}`),!0;switch(_){case"And":if(!g)return!1;break;case"Or":if(g)return!0;break;case"Not":return!g;default:return!0}}return _==="And"},e.OptionalContentConfig=o},(r,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFDataTransportStream=void 0,t(93),t(101),t(102),t(105),t(107),t(109),t(113),t(116),t(123),t(89);var n=t(1),s=t(168);class i{constructor(l,u){let{length:d,initialData:m,progressiveDone:y=!1,contentDispositionFilename:h=null,disableRange:p=!1,disableStream:f=!1}=l;if((0,n.assert)(u,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=y,this._contentDispositionFilename=h,(m==null?void 0:m.length)>0){const v=m instanceof Uint8Array&&m.byteLength===m.buffer.byteLength?m.buffer:new Uint8Array(m).buffer;this._queuedChunks.push(v)}this._pdfDataRangeTransport=u,this._isStreamingSupported=!f,this._isRangeSupported=!p,this._contentLength=d,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((v,_)=>{this._onReceiveData({begin:v,chunk:_})}),this._pdfDataRangeTransport.addProgressListener((v,_)=>{this._onProgress({loaded:v,total:_})}),this._pdfDataRangeTransport.addProgressiveReadListener(v=>{this._onReceiveData({chunk:v})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData(l){let{begin:u,chunk:d}=l;const m=d instanceof Uint8Array&&d.byteLength===d.buffer.byteLength?d.buffer:new Uint8Array(d).buffer;if(u===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(m):this._queuedChunks.push(m);else{const y=this._rangeReaders.some(function(h){return h._begin!==u?!1:(h._enqueue(m),!0)});(0,n.assert)(y,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var l;return((l=this._fullRequestReader)==null?void 0:l._loaded)??0}_onProgress(l){var u,d,m,y;l.total===void 0?(d=(u=this._rangeReaders[0])==null?void 0:u.onProgress)==null||d.call(u,{loaded:l.loaded}):(y=(m=this._fullRequestReader)==null?void 0:m.onProgress)==null||y.call(m,{loaded:l.loaded,total:l.total})}_onProgressiveDone(){var l;(l=this._fullRequestReader)==null||l.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(l){const u=this._rangeReaders.indexOf(l);u>=0&&this._rangeReaders.splice(u,1)}getFullReader(){(0,n.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const l=this._queuedChunks;return this._queuedChunks=null,new a(this,l,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(l,u){if(u<=this._progressiveDataLength)return null;const d=new o(this,l,u);return this._pdfDataRangeTransport.requestDataRange(l,u),this._rangeReaders.push(d),d}cancelAllRequests(l){var u;(u=this._fullRequestReader)==null||u.cancel(l);for(const d of this._rangeReaders.slice(0))d.cancel(l);this._pdfDataRangeTransport.abort()}}e.PDFDataTransportStream=i;class a{constructor(l,u){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,m=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;this._stream=l,this._done=d||!1,this._filename=(0,s.isPdfFile)(m)?m:null,this._queuedChunks=u||[],this._loaded=0;for(const y of this._queuedChunks)this._loaded+=y.byteLength;this._requests=[],this._headersReady=Promise.resolve(),l._fullRequestReader=this,this.onProgress=null}_enqueue(l){this._done||(this._requests.length>0?this._requests.shift().resolve({value:l,done:!1}):this._queuedChunks.push(l),this._loaded+=l.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const l=new n.PromiseCapability;return this._requests.push(l),l.promise}cancel(l){this._done=!0;for(const u of this._requests)u.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class o{constructor(l,u,d){this._stream=l,this._begin=u,this._end=d,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(l){if(!this._done){if(this._requests.length===0)this._queuedChunk=l;else{this._requests.shift().resolve({value:l,done:!1});for(const d of this._requests)d.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const u=this._queuedChunk;return this._queuedChunk=null,{value:u,done:!1}}if(this._done)return{value:void 0,done:!0};const l=new n.PromiseCapability;return this._requests.push(l),l.promise}cancel(l){this._done=!0;for(const u of this._requests)u.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(r,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFFetchStream=void 0,t(93),t(101),t(102),t(105),t(107),t(109),t(113),t(116),t(123),t(89);var n=t(1),s=t(182);function i(d,m,y){return{method:"GET",headers:d,signal:y.signal,mode:"cors",credentials:m?"include":"same-origin",redirect:"follow"}}function a(d){const m=new Headers;for(const y in d){const h=d[y];h!==void 0&&m.append(y,h)}return m}function o(d){return d instanceof Uint8Array?d.buffer:d instanceof ArrayBuffer?d:((0,n.warn)(`getArrayBuffer - unexpected data format: ${d}`),new Uint8Array(d).buffer)}class c{constructor(m){this.source=m,this.isHttp=/^https?:/i.test(m.url),this.httpHeaders=this.isHttp&&m.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var m;return((m=this._fullRequestReader)==null?void 0:m._loaded)??0}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new l(this),this._fullRequestReader}getRangeReader(m,y){if(y<=this._progressiveDataLength)return null;const h=new u(this,m,y);return this._rangeRequestReaders.push(h),h}cancelAllRequests(m){var y;(y=this._fullRequestReader)==null||y.cancel(m);for(const h of this._rangeRequestReaders.slice(0))h.cancel(m)}}e.PDFFetchStream=c;class l{constructor(m){this._stream=m,this._reader=null,this._loaded=0,this._filename=null;const y=m.source;this._withCredentials=y.withCredentials||!1,this._contentLength=y.length,this._headersCapability=new n.PromiseCapability,this._disableRange=y.disableRange||!1,this._rangeChunkSize=y.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!y.disableStream,this._isRangeSupported=!y.disableRange,this._headers=a(this._stream.httpHeaders);const h=y.url;fetch(h,i(this._headers,this._withCredentials,this._abortController)).then(p=>{if(!(0,s.validateResponseStatus)(p.status))throw(0,s.createResponseStatusError)(p.status,h);this._reader=p.body.getReader(),this._headersCapability.resolve();const f=O=>p.headers.get(O),{allowRangeRequests:v,suggestedLength:_}=(0,s.validateRangeRequestCapabilities)({getResponseHeader:f,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=v,this._contentLength=_||this._contentLength,this._filename=(0,s.extractFilenameFromHeader)(f),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new n.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var h;await this._headersCapability.promise;const{value:m,done:y}=await this._reader.read();return y?{value:m,done:y}:(this._loaded+=m.byteLength,(h=this.onProgress)==null||h.call(this,{loaded:this._loaded,total:this._contentLength}),{value:o(m),done:!1})}cancel(m){var y;(y=this._reader)==null||y.cancel(m),this._abortController.abort()}}class u{constructor(m,y,h){this._stream=m,this._reader=null,this._loaded=0;const p=m.source;this._withCredentials=p.withCredentials||!1,this._readCapability=new n.PromiseCapability,this._isStreamingSupported=!p.disableStream,this._abortController=new AbortController,this._headers=a(this._stream.httpHeaders),this._headers.append("Range",`bytes=${y}-${h-1}`);const f=p.url;fetch(f,i(this._headers,this._withCredentials,this._abortController)).then(v=>{if(!(0,s.validateResponseStatus)(v.status))throw(0,s.createResponseStatusError)(v.status,f);this._readCapability.resolve(),this._reader=v.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var h;await this._readCapability.promise;const{value:m,done:y}=await this._reader.read();return y?{value:m,done:y}:(this._loaded+=m.byteLength,(h=this.onProgress)==null||h.call(this,{loaded:this._loaded}),{value:o(m),done:!1})}cancel(m){var y;(y=this._reader)==null||y.cancel(m),this._abortController.abort()}}},(r,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.createResponseStatusError=c,e.extractFilenameFromHeader=o,e.validateRangeRequestCapabilities=a,e.validateResponseStatus=l;var n=t(1),s=t(183),i=t(168);function a(u){let{getResponseHeader:d,isHttp:m,rangeChunkSize:y,disableRange:h}=u;const p={allowRangeRequests:!1,suggestedLength:void 0},f=parseInt(d("Content-Length"),10);return!Number.isInteger(f)||(p.suggestedLength=f,f<=2*y)||h||!m||d("Accept-Ranges")!=="bytes"||(d("Content-Encoding")||"identity")!=="identity"||(p.allowRangeRequests=!0),p}function o(u){const d=u("Content-Disposition");if(d){let m=(0,s.getFilenameFromContentDispositionHeader)(d);if(m.includes("%"))try{m=decodeURIComponent(m)}catch{}if((0,i.isPdfFile)(m))return m}return null}function c(u,d){return u===404||u===0&&d.startsWith("file:")?new n.MissingPDFException('Missing PDF "'+d+'".'):new n.UnexpectedResponseException(`Unexpected server response (${u}) while retrieving PDF "${d}".`,u)}function l(u){return u===200||u===206}},(r,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getFilenameFromContentDispositionHeader=s,t(89),t(149);var n=t(1);function s(i){let a=!0,o=c("filename\\*","i").exec(i);if(o){o=o[1];let p=m(o);return p=unescape(p),p=y(p),p=h(p),u(p)}if(o=d(i),o){const p=h(o);return u(p)}if(o=c("filename","i").exec(i),o){o=o[1];let p=m(o);return p=h(p),u(p)}function c(p,f){return new RegExp("(?:^|;)\\s*"+p+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',f)}function l(p,f){if(p){if(!/^[\x00-\xFF]+$/.test(f))return f;try{const v=new TextDecoder(p,{fatal:!0}),_=(0,n.stringToBytes)(f);f=v.decode(_),a=!1}catch{}}return f}function u(p){return a&&/[\x80-\xff]/.test(p)&&(p=l("utf-8",p),a&&(p=l("iso-8859-1",p))),p}function d(p){const f=[];let v;const _=c("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(v=_.exec(p))!==null;){let[,k,g,b]=v;if(k=parseInt(k,10),k in f){if(k===0)break;continue}f[k]=[g,b]}const O=[];for(let k=0;k<f.length&&k in f;++k){let[g,b]=f[k];b=m(b),g&&(b=unescape(b),k===0&&(b=y(b))),O.push(b)}return O.join("")}function m(p){if(p.startsWith('"')){const f=p.slice(1).split('\\"');for(let v=0;v<f.length;++v){const _=f[v].indexOf('"');_!==-1&&(f[v]=f[v].slice(0,_),f.length=v+1),f[v]=f[v].replaceAll(/\\(.)/g,"$1")}p=f.join('"')}return p}function y(p){const f=p.indexOf("'");if(f===-1)return p;const v=p.slice(0,f),O=p.slice(f+1).replace(/^[^']*'/,"");return l(v,O)}function h(p){return!p.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(p)?p:p.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(f,v,_,O){if(_==="q"||_==="Q")return O=O.replaceAll("_"," "),O=O.replaceAll(/=([0-9a-fA-F]{2})/g,function(k,g){return String.fromCharCode(parseInt(g,16))}),l(v,O);try{O=atob(O)}catch{}return l(v,O)})}return""}},(r,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFNetworkStream=void 0,t(89);var n=t(1),s=t(182);const i=200,a=206;function o(m){const y=m.response;return typeof y!="string"?y:(0,n.stringToBytes)(y).buffer}class c{constructor(y){let h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.url=y,this.isHttp=/^https?:/i.test(y),this.httpHeaders=this.isHttp&&h.httpHeaders||Object.create(null),this.withCredentials=h.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(y,h,p){const f={begin:y,end:h};for(const v in p)f[v]=p[v];return this.request(f)}requestFull(y){return this.request(y)}request(y){const h=new XMLHttpRequest,p=this.currXhrId++,f=this.pendingRequests[p]={xhr:h};h.open("GET",this.url),h.withCredentials=this.withCredentials;for(const v in this.httpHeaders){const _=this.httpHeaders[v];_!==void 0&&h.setRequestHeader(v,_)}return this.isHttp&&"begin"in y&&"end"in y?(h.setRequestHeader("Range",`bytes=${y.begin}-${y.end-1}`),f.expectedStatus=a):f.expectedStatus=i,h.responseType="arraybuffer",y.onError&&(h.onerror=function(v){y.onError(h.status)}),h.onreadystatechange=this.onStateChange.bind(this,p),h.onprogress=this.onProgress.bind(this,p),f.onHeadersReceived=y.onHeadersReceived,f.onDone=y.onDone,f.onError=y.onError,f.onProgress=y.onProgress,h.send(null),p}onProgress(y,h){var f;const p=this.pendingRequests[y];p&&((f=p.onProgress)==null||f.call(p,h))}onStateChange(y,h){var k,g,b;const p=this.pendingRequests[y];if(!p)return;const f=p.xhr;if(f.readyState>=2&&p.onHeadersReceived&&(p.onHeadersReceived(),delete p.onHeadersReceived),f.readyState!==4||!(y in this.pendingRequests))return;if(delete this.pendingRequests[y],f.status===0&&this.isHttp){(k=p.onError)==null||k.call(p,f.status);return}const v=f.status||i;if(!(v===i&&p.expectedStatus===a)&&v!==p.expectedStatus){(g=p.onError)==null||g.call(p,f.status);return}const O=o(f);if(v===a){const N=f.getResponseHeader("Content-Range"),S=/bytes (\d+)-(\d+)\/(\d+)/.exec(N);p.onDone({begin:parseInt(S[1],10),chunk:O})}else O?p.onDone({begin:0,chunk:O}):(b=p.onError)==null||b.call(p,f.status)}getRequestXhr(y){return this.pendingRequests[y].xhr}isPendingRequest(y){return y in this.pendingRequests}abortRequest(y){const h=this.pendingRequests[y].xhr;delete this.pendingRequests[y],h.abort()}}class l{constructor(y){this._source=y,this._manager=new c(y.url,{httpHeaders:y.httpHeaders,withCredentials:y.withCredentials}),this._rangeChunkSize=y.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(y){const h=this._rangeRequestReaders.indexOf(y);h>=0&&this._rangeRequestReaders.splice(h,1)}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new u(this._manager,this._source),this._fullRequestReader}getRangeReader(y,h){const p=new d(this._manager,y,h);return p.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(p),p}cancelAllRequests(y){var h;(h=this._fullRequestReader)==null||h.cancel(y);for(const p of this._rangeRequestReaders.slice(0))p.cancel(y)}}e.PDFNetworkStream=l;class u{constructor(y,h){this._manager=y;const p={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=h.url,this._fullRequestId=y.requestFull(p),this._headersReceivedCapability=new n.PromiseCapability,this._disableRange=h.disableRange||!1,this._contentLength=h.length,this._rangeChunkSize=h.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const y=this._fullRequestId,h=this._manager.getRequestXhr(y),p=_=>h.getResponseHeader(_),{allowRangeRequests:f,suggestedLength:v}=(0,s.validateRangeRequestCapabilities)({getResponseHeader:p,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});f&&(this._isRangeSupported=!0),this._contentLength=v||this._contentLength,this._filename=(0,s.extractFilenameFromHeader)(p),this._isRangeSupported&&this._manager.abortRequest(y),this._headersReceivedCapability.resolve()}_onDone(y){if(y&&(this._requests.length>0?this._requests.shift().resolve({value:y.chunk,done:!1}):this._cachedChunks.push(y.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const h of this._requests)h.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(y){this._storedError=(0,s.createResponseStatusError)(y,this._url),this._headersReceivedCapability.reject(this._storedError);for(const h of this._requests)h.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(y){var h;(h=this.onProgress)==null||h.call(this,{loaded:y.loaded,total:y.lengthComputable?y.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const y=new n.PromiseCapability;return this._requests.push(y),y.promise}cancel(y){this._done=!0,this._headersReceivedCapability.reject(y);for(const h of this._requests)h.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class d{constructor(y,h,p){this._manager=y;const f={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=y.url,this._requestId=y.requestRange(h,p,f),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var y;(y=this.onClosed)==null||y.call(this,this)}_onDone(y){const h=y.chunk;this._requests.length>0?this._requests.shift().resolve({value:h,done:!1}):this._queuedChunk=h,this._done=!0;for(const p of this._requests)p.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(y){this._storedError=(0,s.createResponseStatusError)(y,this._url);for(const h of this._requests)h.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(y){var h;this.isStreamingSupported||(h=this.onProgress)==null||h.call(this,{loaded:y.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const h=this._queuedChunk;return this._queuedChunk=null,{value:h,done:!1}}if(this._done)return{value:void 0,done:!0};const y=new n.PromiseCapability;return this._requests.push(y),y.promise}cancel(y){this._done=!0;for(const h of this._requests)h.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(r,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFNodeStream=void 0,t(89),t(93),t(101),t(102),t(105),t(107),t(109),t(113),t(116),t(123);var n=t(1),s=t(182);const i=/^file:\/\/\/[a-zA-Z]:\//;function a(p){const f=require$$6,v=f.parse(p);return v.protocol==="file:"||v.host?v:/^[a-z]:[/\\]/i.test(p)?f.parse(`file:///${p}`):(v.host||(v.protocol="file:"),v)}class o{constructor(f){this.source=f,this.url=a(f.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&f.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var f;return((f=this._fullRequestReader)==null?void 0:f._loaded)??0}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new y(this):new d(this),this._fullRequestReader}getRangeReader(f,v){if(v<=this._progressiveDataLength)return null;const _=this.isFsUrl?new h(this,f,v):new m(this,f,v);return this._rangeRequestReaders.push(_),_}cancelAllRequests(f){var v;(v=this._fullRequestReader)==null||v.cancel(f);for(const _ of this._rangeRequestReaders.slice(0))_.cancel(f)}}e.PDFNodeStream=o;class c{constructor(f){this._url=f.url,this._done=!1,this._storedError=null,this.onProgress=null;const v=f.source;this._contentLength=v.length,this._loaded=0,this._filename=null,this._disableRange=v.disableRange||!1,this._rangeChunkSize=v.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!v.disableStream,this._isRangeSupported=!v.disableRange,this._readableStream=null,this._readCapability=new n.PromiseCapability,this._headersCapability=new n.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var _;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const f=this._readableStream.read();return f===null?(this._readCapability=new n.PromiseCapability,this.read()):(this._loaded+=f.length,(_=this.onProgress)==null||_.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(f).buffer,done:!1})}cancel(f){if(!this._readableStream){this._error(f);return}this._readableStream.destroy(f)}_error(f){this._storedError=f,this._readCapability.resolve()}_setReadableStream(f){this._readableStream=f,f.on("readable",()=>{this._readCapability.resolve()}),f.on("end",()=>{f.destroy(),this._done=!0,this._readCapability.resolve()}),f.on("error",v=>{this._error(v)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new n.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class l{constructor(f){this._url=f.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new n.PromiseCapability;const v=f.source;this._isStreamingSupported=!v.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var _;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const f=this._readableStream.read();return f===null?(this._readCapability=new n.PromiseCapability,this.read()):(this._loaded+=f.length,(_=this.onProgress)==null||_.call(this,{loaded:this._loaded}),{value:new Uint8Array(f).buffer,done:!1})}cancel(f){if(!this._readableStream){this._error(f);return}this._readableStream.destroy(f)}_error(f){this._storedError=f,this._readCapability.resolve()}_setReadableStream(f){this._readableStream=f,f.on("readable",()=>{this._readCapability.resolve()}),f.on("end",()=>{f.destroy(),this._done=!0,this._readCapability.resolve()}),f.on("error",v=>{this._error(v)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function u(p,f){return{protocol:p.protocol,auth:p.auth,host:p.hostname,port:p.port,path:p.path,method:"GET",headers:f}}class d extends c{constructor(f){super(f);const v=_=>{if(_.statusCode===404){const b=new n.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=b,this._headersCapability.reject(b);return}this._headersCapability.resolve(),this._setReadableStream(_);const O=b=>this._readableStream.headers[b.toLowerCase()],{allowRangeRequests:k,suggestedLength:g}=(0,s.validateRangeRequestCapabilities)({getResponseHeader:O,isHttp:f.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=k,this._contentLength=g||this._contentLength,this._filename=(0,s.extractFilenameFromHeader)(O)};if(this._request=null,this._url.protocol==="http:"){const _=require$$6;this._request=_.request(u(this._url,f.httpHeaders),v)}else{const _=require$$6;this._request=_.request(u(this._url,f.httpHeaders),v)}this._request.on("error",_=>{this._storedError=_,this._headersCapability.reject(_)}),this._request.end()}}class m extends l{constructor(f,v,_){super(f),this._httpHeaders={};for(const k in f.httpHeaders){const g=f.httpHeaders[k];g!==void 0&&(this._httpHeaders[k]=g)}this._httpHeaders.Range=`bytes=${v}-${_-1}`;const O=k=>{if(k.statusCode===404){const g=new n.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=g;return}this._setReadableStream(k)};if(this._request=null,this._url.protocol==="http:"){const k=require$$6;this._request=k.request(u(this._url,this._httpHeaders),O)}else{const k=require$$6;this._request=k.request(u(this._url,this._httpHeaders),O)}this._request.on("error",k=>{this._storedError=k}),this._request.end()}}class y extends c{constructor(f){super(f);let v=decodeURIComponent(this._url.path);i.test(this._url.href)&&(v=v.replace(/^\//,""));const _=require$$6;_.lstat(v,(O,k)=>{if(O){O.code==="ENOENT"&&(O=new n.MissingPDFException(`Missing PDF "${v}".`)),this._storedError=O,this._headersCapability.reject(O);return}this._contentLength=k.size,this._setReadableStream(_.createReadStream(v)),this._headersCapability.resolve()})}}class h extends l{constructor(f,v,_){super(f);let O=decodeURIComponent(this._url.path);i.test(this._url.href)&&(O=O.replace(/^\//,""));const k=require$$6;this._setReadableStream(k.createReadStream(O,{start:v,end:_-1}))}}},(r,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.SVGGraphics=void 0,t(84),t(86),t(87),t(93),t(101),t(102),t(105),t(107),t(109),t(113),t(116),t(123),t(2),t(89),t(187);var n=t(168),s=t(1);const i={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},a="http://www.w3.org/XML/1998/namespace",o="http://www.w3.org/1999/xlink",c=["butt","round","square"],l=["miter","round","bevel"],u=function(k){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(URL.createObjectURL&&typeof Blob<"u"&&!b)return URL.createObjectURL(new Blob([k],{type:g}));const N="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let S=`data:${g};base64,`;for(let T=0,M=k.length;T<M;T+=3){const P=k[T]&255,$=k[T+1]&255,K=k[T+2]&255,L=P>>2,j=(P&3)<<4|$>>4,q=T+1<M?($&15)<<2|K>>6:64,te=T+2<M?K&63:64;S+=N[L]+N[j]+N[q]+N[te]}return S},d=function(){const k=new Uint8Array([137,80,78,71,13,10,26,10]),g=12,b=new Int32Array(256);for(let K=0;K<256;K++){let L=K;for(let j=0;j<8;j++)L=L&1?3988292384^L>>1&2147483647:L>>1&2147483647;b[K]=L}function N(K,L,j){let q=-1;for(let te=L;te<j;te++){const F=(q^K[te])&255,z=b[F];q=q>>>8^z}return q^-1}function S(K,L,j,q){let te=q;const F=L.length;j[te]=F>>24&255,j[te+1]=F>>16&255,j[te+2]=F>>8&255,j[te+3]=F&255,te+=4,j[te]=K.charCodeAt(0)&255,j[te+1]=K.charCodeAt(1)&255,j[te+2]=K.charCodeAt(2)&255,j[te+3]=K.charCodeAt(3)&255,te+=4,j.set(L,te),te+=L.length;const z=N(j,q+4,te);j[te]=z>>24&255,j[te+1]=z>>16&255,j[te+2]=z>>8&255,j[te+3]=z&255}function T(K,L,j){let q=1,te=0;for(let F=L;F<j;++F)q=(q+(K[F]&255))%65521,te=(te+q)%65521;return te<<16|q}function M(K){if(!s.isNodeJS)return P(K);try{const L=parseInt(process.versions.node)>=8?K:Buffer.from(K),j=require$$6.deflateSync(L,{level:9});return j instanceof Uint8Array?j:new Uint8Array(j)}catch(L){(0,s.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+L)}return P(K)}function P(K){let L=K.length;const j=65535,q=Math.ceil(L/j),te=new Uint8Array(2+L+q*5+4);let F=0;te[F++]=120,te[F++]=156;let z=0;for(;L>j;)te[F++]=0,te[F++]=255,te[F++]=255,te[F++]=0,te[F++]=0,te.set(K.subarray(z,z+j),F),F+=j,z+=j,L-=j;te[F++]=1,te[F++]=L&255,te[F++]=L>>8&255,te[F++]=~L&65535&255,te[F++]=(~L&65535)>>8&255,te.set(K.subarray(z),F),F+=K.length-z;const Q=T(K,0,K.length);return te[F++]=Q>>24&255,te[F++]=Q>>16&255,te[F++]=Q>>8&255,te[F++]=Q&255,te}function $(K,L,j,q){const te=K.width,F=K.height;let z,Q,ne;const de=K.data;switch(L){case s.ImageKind.GRAYSCALE_1BPP:Q=0,z=1,ne=te+7>>3;break;case s.ImageKind.RGB_24BPP:Q=2,z=8,ne=te*3;break;case s.ImageKind.RGBA_32BPP:Q=6,z=8,ne=te*4;break;default:throw new Error("invalid format")}const U=new Uint8Array((1+ne)*F);let w=0,x=0;for(let ee=0;ee<F;++ee)U[w++]=0,U.set(de.subarray(x,x+ne),w),x+=ne,w+=ne;if(L===s.ImageKind.GRAYSCALE_1BPP&&q){w=0;for(let ee=0;ee<F;ee++){w++;for(let me=0;me<ne;me++)U[w++]^=255}}const R=new Uint8Array([te>>24&255,te>>16&255,te>>8&255,te&255,F>>24&255,F>>16&255,F>>8&255,F&255,z,Q,0,0,0]),V=M(U),D=k.length+g*3+R.length+V.length,Y=new Uint8Array(D);let W=0;return Y.set(k,W),W+=k.length,S("IHDR",R,Y,W),W+=g+R.length,S("IDATA",V,Y,W),W+=g+V.length,S("IEND",new Uint8Array(0),Y,W),u(Y,"image/png",j)}return function(L,j,q){const te=L.kind===void 0?s.ImageKind.GRAYSCALE_1BPP:L.kind;return $(L,te,j,q)}}();class m{constructor(){this.fontSizeScale=1,this.fontWeight=i.fontWeight,this.fontSize=0,this.textMatrix=s.IDENTITY_MATRIX,this.fontMatrix=s.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=s.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=i.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(g,b){this.x=g,this.y=b}}function y(k){let g=[];const b=[];for(const N of k){if(N.fn==="save"){g.push({fnId:92,fn:"group",items:[]}),b.push(g),g=g.at(-1).items;continue}N.fn==="restore"?g=b.pop():g.push(N)}return g}function h(k){if(Number.isInteger(k))return k.toString();const g=k.toFixed(10);let b=g.length-1;if(g[b]!=="0")return g;do b--;while(g[b]==="0");return g.substring(0,g[b]==="."?b:b+1)}function p(k){if(k[4]===0&&k[5]===0){if(k[1]===0&&k[2]===0)return k[0]===1&&k[3]===1?"":`scale(${h(k[0])} ${h(k[3])})`;if(k[0]===k[3]&&k[1]===-k[2]){const g=Math.acos(k[0])*180/Math.PI;return`rotate(${h(g)})`}}else if(k[0]===1&&k[1]===0&&k[2]===0&&k[3]===1)return`translate(${h(k[4])} ${h(k[5])})`;return`matrix(${h(k[0])} ${h(k[1])} ${h(k[2])} ${h(k[3])} ${h(k[4])} ${h(k[5])})`}let f=0,v=0,_=0;class O{constructor(g,b){let N=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;(0,n.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new n.DOMSVGFactory,this.current=new m,this.transformMatrix=s.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=g,this.objs=b,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!N,this._operatorIdMapping=[];for(const S in s.OPS)this._operatorIdMapping[s.OPS[S]]=S}getObject(g){let b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return typeof g=="string"?g.startsWith("g_")?this.commonObjs.get(g):this.objs.get(g):b}save(){this.transformStack.push(this.transformMatrix);const g=this.current;this.extraStack.push(g),this.current=g.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(g){this.save(),this.executeOpTree(g),this.restore()}loadDependencies(g){const b=g.fnArray,N=g.argsArray;for(let S=0,T=b.length;S<T;S++)if(b[S]===s.OPS.dependency)for(const M of N[S]){const P=M.startsWith("g_")?this.commonObjs:this.objs,$=new Promise(K=>{P.get(M,K)});this.current.dependencies.push($)}return Promise.all(this.current.dependencies)}transform(g,b,N,S,T,M){const P=[g,b,N,S,T,M];this.transformMatrix=s.Util.transform(this.transformMatrix,P),this.tgrp=null}getSVG(g,b){this.viewport=b;const N=this._initialize(b);return this.loadDependencies(g).then(()=>(this.transformMatrix=s.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(g)),N))}convertOpList(g){const b=this._operatorIdMapping,N=g.argsArray,S=g.fnArray,T=[];for(let M=0,P=S.length;M<P;M++){const $=S[M];T.push({fnId:$,fn:b[$],args:N[M]})}return y(T)}executeOpTree(g){for(const b of g){const N=b.fn,S=b.fnId,T=b.args;switch(S|0){case s.OPS.beginText:this.beginText();break;case s.OPS.dependency:break;case s.OPS.setLeading:this.setLeading(T);break;case s.OPS.setLeadingMoveText:this.setLeadingMoveText(T[0],T[1]);break;case s.OPS.setFont:this.setFont(T);break;case s.OPS.showText:this.showText(T[0]);break;case s.OPS.showSpacedText:this.showText(T[0]);break;case s.OPS.endText:this.endText();break;case s.OPS.moveText:this.moveText(T[0],T[1]);break;case s.OPS.setCharSpacing:this.setCharSpacing(T[0]);break;case s.OPS.setWordSpacing:this.setWordSpacing(T[0]);break;case s.OPS.setHScale:this.setHScale(T[0]);break;case s.OPS.setTextMatrix:this.setTextMatrix(T[0],T[1],T[2],T[3],T[4],T[5]);break;case s.OPS.setTextRise:this.setTextRise(T[0]);break;case s.OPS.setTextRenderingMode:this.setTextRenderingMode(T[0]);break;case s.OPS.setLineWidth:this.setLineWidth(T[0]);break;case s.OPS.setLineJoin:this.setLineJoin(T[0]);break;case s.OPS.setLineCap:this.setLineCap(T[0]);break;case s.OPS.setMiterLimit:this.setMiterLimit(T[0]);break;case s.OPS.setFillRGBColor:this.setFillRGBColor(T[0],T[1],T[2]);break;case s.OPS.setStrokeRGBColor:this.setStrokeRGBColor(T[0],T[1],T[2]);break;case s.OPS.setStrokeColorN:this.setStrokeColorN(T);break;case s.OPS.setFillColorN:this.setFillColorN(T);break;case s.OPS.shadingFill:this.shadingFill(T[0]);break;case s.OPS.setDash:this.setDash(T[0],T[1]);break;case s.OPS.setRenderingIntent:this.setRenderingIntent(T[0]);break;case s.OPS.setFlatness:this.setFlatness(T[0]);break;case s.OPS.setGState:this.setGState(T[0]);break;case s.OPS.fill:this.fill();break;case s.OPS.eoFill:this.eoFill();break;case s.OPS.stroke:this.stroke();break;case s.OPS.fillStroke:this.fillStroke();break;case s.OPS.eoFillStroke:this.eoFillStroke();break;case s.OPS.clip:this.clip("nonzero");break;case s.OPS.eoClip:this.clip("evenodd");break;case s.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case s.OPS.paintImageXObject:this.paintImageXObject(T[0]);break;case s.OPS.paintInlineImageXObject:this.paintInlineImageXObject(T[0]);break;case s.OPS.paintImageMaskXObject:this.paintImageMaskXObject(T[0]);break;case s.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(T[0],T[1]);break;case s.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case s.OPS.closePath:this.closePath();break;case s.OPS.closeStroke:this.closeStroke();break;case s.OPS.closeFillStroke:this.closeFillStroke();break;case s.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case s.OPS.nextLine:this.nextLine();break;case s.OPS.transform:this.transform(T[0],T[1],T[2],T[3],T[4],T[5]);break;case s.OPS.constructPath:this.constructPath(T[0],T[1]);break;case s.OPS.endPath:this.endPath();break;case 92:this.group(b.items);break;default:(0,s.warn)(`Unimplemented operator ${N}`);break}}}setWordSpacing(g){this.current.wordSpacing=g}setCharSpacing(g){this.current.charSpacing=g}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(g,b,N,S,T,M){const P=this.current;P.textMatrix=P.lineMatrix=[g,b,N,S,T,M],P.textMatrixScale=Math.hypot(g,b),P.x=P.lineX=0,P.y=P.lineY=0,P.xcoords=[],P.ycoords=[],P.tspan=this.svgFactory.createElement("svg:tspan"),P.tspan.setAttributeNS(null,"font-family",P.fontFamily),P.tspan.setAttributeNS(null,"font-size",`${h(P.fontSize)}px`),P.tspan.setAttributeNS(null,"y",h(-P.y)),P.txtElement=this.svgFactory.createElement("svg:text"),P.txtElement.append(P.tspan)}beginText(){const g=this.current;g.x=g.lineX=0,g.y=g.lineY=0,g.textMatrix=s.IDENTITY_MATRIX,g.lineMatrix=s.IDENTITY_MATRIX,g.textMatrixScale=1,g.tspan=this.svgFactory.createElement("svg:tspan"),g.txtElement=this.svgFactory.createElement("svg:text"),g.txtgrp=this.svgFactory.createElement("svg:g"),g.xcoords=[],g.ycoords=[]}moveText(g,b){const N=this.current;N.x=N.lineX+=g,N.y=N.lineY+=b,N.xcoords=[],N.ycoords=[],N.tspan=this.svgFactory.createElement("svg:tspan"),N.tspan.setAttributeNS(null,"font-family",N.fontFamily),N.tspan.setAttributeNS(null,"font-size",`${h(N.fontSize)}px`),N.tspan.setAttributeNS(null,"y",h(-N.y))}showText(g){const b=this.current,N=b.font,S=b.fontSize;if(S===0)return;const T=b.fontSizeScale,M=b.charSpacing,P=b.wordSpacing,$=b.fontDirection,K=b.textHScale*$,L=N.vertical,j=L?1:-1,q=N.defaultVMetrics,te=S*b.fontMatrix[0];let F=0;for(const ne of g){if(ne===null){F+=$*P;continue}else if(typeof ne=="number"){F+=j*ne*S/1e3;continue}const de=(ne.isSpace?P:0)+M,U=ne.fontChar;let w,x,R=ne.width;if(L){let D;const Y=ne.vmetric||q;D=ne.vmetric?Y[1]:R*.5,D=-D*te;const W=Y[2]*te;R=Y?-Y[0]:R,w=D/T,x=(F+W)/T}else w=F/T,x=0;(ne.isInFont||N.missingFile)&&(b.xcoords.push(b.x+w),L&&b.ycoords.push(-b.y+x),b.tspan.textContent+=U);const V=L?R*te-de*$:R*te+de*$;F+=V}b.tspan.setAttributeNS(null,"x",b.xcoords.map(h).join(" ")),L?b.tspan.setAttributeNS(null,"y",b.ycoords.map(h).join(" ")):b.tspan.setAttributeNS(null,"y",h(-b.y)),L?b.y-=F:b.x+=F*K,b.tspan.setAttributeNS(null,"font-family",b.fontFamily),b.tspan.setAttributeNS(null,"font-size",`${h(b.fontSize)}px`),b.fontStyle!==i.fontStyle&&b.tspan.setAttributeNS(null,"font-style",b.fontStyle),b.fontWeight!==i.fontWeight&&b.tspan.setAttributeNS(null,"font-weight",b.fontWeight);const z=b.textRenderingMode&s.TextRenderingMode.FILL_STROKE_MASK;if(z===s.TextRenderingMode.FILL||z===s.TextRenderingMode.FILL_STROKE?(b.fillColor!==i.fillColor&&b.tspan.setAttributeNS(null,"fill",b.fillColor),b.fillAlpha<1&&b.tspan.setAttributeNS(null,"fill-opacity",b.fillAlpha)):b.textRenderingMode===s.TextRenderingMode.ADD_TO_PATH?b.tspan.setAttributeNS(null,"fill","transparent"):b.tspan.setAttributeNS(null,"fill","none"),z===s.TextRenderingMode.STROKE||z===s.TextRenderingMode.FILL_STROKE){const ne=1/(b.textMatrixScale||1);this._setStrokeAttributes(b.tspan,ne)}let Q=b.textMatrix;b.textRise!==0&&(Q=Q.slice(),Q[5]+=b.textRise),b.txtElement.setAttributeNS(null,"transform",`${p(Q)} scale(${h(K)}, -1)`),b.txtElement.setAttributeNS(a,"xml:space","preserve"),b.txtElement.append(b.tspan),b.txtgrp.append(b.txtElement),this._ensureTransformGroup().append(b.txtElement)}setLeadingMoveText(g,b){this.setLeading(-b),this.moveText(g,b)}addFontStyle(g){if(!g.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const b=u(g.data,g.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${g.loadedName}"; src: url(${b}); }
`}setFont(g){const b=this.current,N=this.commonObjs.get(g[0]);let S=g[1];b.font=N,this.embedFonts&&!N.missingFile&&!this.embeddedFonts[N.loadedName]&&(this.addFontStyle(N),this.embeddedFonts[N.loadedName]=N),b.fontMatrix=N.fontMatrix||s.FONT_IDENTITY_MATRIX;let T="normal";N.black?T="900":N.bold&&(T="bold");const M=N.italic?"italic":"normal";S<0?(S=-S,b.fontDirection=-1):b.fontDirection=1,b.fontSize=S,b.fontFamily=N.loadedName,b.fontWeight=T,b.fontStyle=M,b.tspan=this.svgFactory.createElement("svg:tspan"),b.tspan.setAttributeNS(null,"y",h(-b.y)),b.xcoords=[],b.ycoords=[]}endText(){var b;const g=this.current;g.textRenderingMode&s.TextRenderingMode.ADD_TO_PATH_FLAG&&((b=g.txtElement)!=null&&b.hasChildNodes())&&(g.element=g.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(g){g>0&&(this.current.lineWidth=g)}setLineCap(g){this.current.lineCap=c[g]}setLineJoin(g){this.current.lineJoin=l[g]}setMiterLimit(g){this.current.miterLimit=g}setStrokeAlpha(g){this.current.strokeAlpha=g}setStrokeRGBColor(g,b,N){this.current.strokeColor=s.Util.makeHexColor(g,b,N)}setFillAlpha(g){this.current.fillAlpha=g}setFillRGBColor(g,b,N){this.current.fillColor=s.Util.makeHexColor(g,b,N),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(g){this.current.strokeColor=this._makeColorN_Pattern(g)}setFillColorN(g){this.current.fillColor=this._makeColorN_Pattern(g)}shadingFill(g){const{width:b,height:N}=this.viewport,S=s.Util.inverseTransform(this.transformMatrix),[T,M,P,$]=s.Util.getAxialAlignedBoundingBox([0,0,b,N],S),K=this.svgFactory.createElement("svg:rect");K.setAttributeNS(null,"x",T),K.setAttributeNS(null,"y",M),K.setAttributeNS(null,"width",P-T),K.setAttributeNS(null,"height",$-M),K.setAttributeNS(null,"fill",this._makeShadingPattern(g)),this.current.fillAlpha<1&&K.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(K)}_makeColorN_Pattern(g){return g[0]==="TilingPattern"?this._makeTilingPattern(g):this._makeShadingPattern(g)}_makeTilingPattern(g){const b=g[1],N=g[2],S=g[3]||s.IDENTITY_MATRIX,[T,M,P,$]=g[4],K=g[5],L=g[6],j=g[7],q=`shading${_++}`,[te,F,z,Q]=s.Util.normalizeRect([...s.Util.applyTransform([T,M],S),...s.Util.applyTransform([P,$],S)]),[ne,de]=s.Util.singularValueDecompose2dScale(S),U=K*ne,w=L*de,x=this.svgFactory.createElement("svg:pattern");x.setAttributeNS(null,"id",q),x.setAttributeNS(null,"patternUnits","userSpaceOnUse"),x.setAttributeNS(null,"width",U),x.setAttributeNS(null,"height",w),x.setAttributeNS(null,"x",`${te}`),x.setAttributeNS(null,"y",`${F}`);const R=this.svg,V=this.transformMatrix,D=this.current.fillColor,Y=this.current.strokeColor,W=this.svgFactory.create(z-te,Q-F);if(this.svg=W,this.transformMatrix=S,j===2){const ee=s.Util.makeHexColor(...b);this.current.fillColor=ee,this.current.strokeColor=ee}return this.executeOpTree(this.convertOpList(N)),this.svg=R,this.transformMatrix=V,this.current.fillColor=D,this.current.strokeColor=Y,x.append(W.childNodes[0]),this.defs.append(x),`url(#${q})`}_makeShadingPattern(g){switch(typeof g=="string"&&(g=this.objs.get(g)),g[0]){case"RadialAxial":const b=`shading${_++}`,N=g[3];let S;switch(g[1]){case"axial":const T=g[4],M=g[5];S=this.svgFactory.createElement("svg:linearGradient"),S.setAttributeNS(null,"id",b),S.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),S.setAttributeNS(null,"x1",T[0]),S.setAttributeNS(null,"y1",T[1]),S.setAttributeNS(null,"x2",M[0]),S.setAttributeNS(null,"y2",M[1]);break;case"radial":const P=g[4],$=g[5],K=g[6],L=g[7];S=this.svgFactory.createElement("svg:radialGradient"),S.setAttributeNS(null,"id",b),S.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),S.setAttributeNS(null,"cx",$[0]),S.setAttributeNS(null,"cy",$[1]),S.setAttributeNS(null,"r",L),S.setAttributeNS(null,"fx",P[0]),S.setAttributeNS(null,"fy",P[1]),S.setAttributeNS(null,"fr",K);break;default:throw new Error(`Unknown RadialAxial type: ${g[1]}`)}for(const T of N){const M=this.svgFactory.createElement("svg:stop");M.setAttributeNS(null,"offset",T[0]),M.setAttributeNS(null,"stop-color",T[1]),S.append(M)}return this.defs.append(S),`url(#${b})`;case"Mesh":return(0,s.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${g[0]}`)}}setDash(g,b){this.current.dashArray=g,this.current.dashPhase=b}constructPath(g,b){const N=this.current;let S=N.x,T=N.y,M=[],P=0;for(const $ of g)switch($|0){case s.OPS.rectangle:S=b[P++],T=b[P++];const K=b[P++],L=b[P++],j=S+K,q=T+L;M.push("M",h(S),h(T),"L",h(j),h(T),"L",h(j),h(q),"L",h(S),h(q),"Z");break;case s.OPS.moveTo:S=b[P++],T=b[P++],M.push("M",h(S),h(T));break;case s.OPS.lineTo:S=b[P++],T=b[P++],M.push("L",h(S),h(T));break;case s.OPS.curveTo:S=b[P+4],T=b[P+5],M.push("C",h(b[P]),h(b[P+1]),h(b[P+2]),h(b[P+3]),h(S),h(T)),P+=6;break;case s.OPS.curveTo2:M.push("C",h(S),h(T),h(b[P]),h(b[P+1]),h(b[P+2]),h(b[P+3])),S=b[P+2],T=b[P+3],P+=4;break;case s.OPS.curveTo3:S=b[P+2],T=b[P+3],M.push("C",h(b[P]),h(b[P+1]),h(S),h(T),h(S),h(T)),P+=4;break;case s.OPS.closePath:M.push("Z");break}M=M.join(" "),N.path&&g.length>0&&g[0]!==s.OPS.rectangle&&g[0]!==s.OPS.moveTo?M=N.path.getAttributeNS(null,"d")+M:(N.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(N.path)),N.path.setAttributeNS(null,"d",M),N.path.setAttributeNS(null,"fill","none"),N.element=N.path,N.setCurrentPoint(S,T)}endPath(){const g=this.current;if(g.path=null,!this.pendingClip)return;if(!g.element){this.pendingClip=null;return}const b=`clippath${f++}`,N=this.svgFactory.createElement("svg:clipPath");N.setAttributeNS(null,"id",b),N.setAttributeNS(null,"transform",p(this.transformMatrix));const S=g.element.cloneNode(!0);if(this.pendingClip==="evenodd"?S.setAttributeNS(null,"clip-rule","evenodd"):S.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,N.append(S),this.defs.append(N),g.activeClipUrl){g.clipGroup=null;for(const T of this.extraStack)T.clipGroup=null;N.setAttributeNS(null,"clip-path",g.activeClipUrl)}g.activeClipUrl=`url(#${b})`,this.tgrp=null}clip(g){this.pendingClip=g}closePath(){const g=this.current;if(g.path){const b=`${g.path.getAttributeNS(null,"d")}Z`;g.path.setAttributeNS(null,"d",b)}}setLeading(g){this.current.leading=-g}setTextRise(g){this.current.textRise=g}setTextRenderingMode(g){this.current.textRenderingMode=g}setHScale(g){this.current.textHScale=g/100}setRenderingIntent(g){}setFlatness(g){}setGState(g){for(const[b,N]of g)switch(b){case"LW":this.setLineWidth(N);break;case"LC":this.setLineCap(N);break;case"LJ":this.setLineJoin(N);break;case"ML":this.setMiterLimit(N);break;case"D":this.setDash(N[0],N[1]);break;case"RI":this.setRenderingIntent(N);break;case"FL":this.setFlatness(N);break;case"Font":this.setFont(N);break;case"CA":this.setStrokeAlpha(N);break;case"ca":this.setFillAlpha(N);break;default:(0,s.warn)(`Unimplemented graphic state operator ${b}`);break}}fill(){const g=this.current;g.element&&(g.element.setAttributeNS(null,"fill",g.fillColor),g.element.setAttributeNS(null,"fill-opacity",g.fillAlpha),this.endPath())}stroke(){const g=this.current;g.element&&(this._setStrokeAttributes(g.element),g.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(g){let b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const N=this.current;let S=N.dashArray;b!==1&&S.length>0&&(S=S.map(function(T){return b*T})),g.setAttributeNS(null,"stroke",N.strokeColor),g.setAttributeNS(null,"stroke-opacity",N.strokeAlpha),g.setAttributeNS(null,"stroke-miterlimit",h(N.miterLimit)),g.setAttributeNS(null,"stroke-linecap",N.lineCap),g.setAttributeNS(null,"stroke-linejoin",N.lineJoin),g.setAttributeNS(null,"stroke-width",h(b*N.lineWidth)+"px"),g.setAttributeNS(null,"stroke-dasharray",S.map(h).join(" ")),g.setAttributeNS(null,"stroke-dashoffset",h(b*N.dashPhase)+"px")}eoFill(){var g;(g=this.current.element)==null||g.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){var g;(g=this.current.element)==null||g.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const g=this.svgFactory.createElement("svg:rect");g.setAttributeNS(null,"x","0"),g.setAttributeNS(null,"y","0"),g.setAttributeNS(null,"width","1px"),g.setAttributeNS(null,"height","1px"),g.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(g)}paintImageXObject(g){const b=this.getObject(g);if(!b){(0,s.warn)(`Dependent image with object ID ${g} is not ready yet`);return}this.paintInlineImageXObject(b)}paintInlineImageXObject(g,b){const N=g.width,S=g.height,T=d(g,this.forceDataSchema,!!b),M=this.svgFactory.createElement("svg:rect");M.setAttributeNS(null,"x","0"),M.setAttributeNS(null,"y","0"),M.setAttributeNS(null,"width",h(N)),M.setAttributeNS(null,"height",h(S)),this.current.element=M,this.clip("nonzero");const P=this.svgFactory.createElement("svg:image");P.setAttributeNS(o,"xlink:href",T),P.setAttributeNS(null,"x","0"),P.setAttributeNS(null,"y",h(-S)),P.setAttributeNS(null,"width",h(N)+"px"),P.setAttributeNS(null,"height",h(S)+"px"),P.setAttributeNS(null,"transform",`scale(${h(1/N)} ${h(-1/S)})`),b?b.append(P):this._ensureTransformGroup().append(P)}paintImageMaskXObject(g){const b=this.getObject(g.data,g);if(b.bitmap){(0,s.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const N=this.current,S=b.width,T=b.height,M=N.fillColor;N.maskId=`mask${v++}`;const P=this.svgFactory.createElement("svg:mask");P.setAttributeNS(null,"id",N.maskId);const $=this.svgFactory.createElement("svg:rect");$.setAttributeNS(null,"x","0"),$.setAttributeNS(null,"y","0"),$.setAttributeNS(null,"width",h(S)),$.setAttributeNS(null,"height",h(T)),$.setAttributeNS(null,"fill",M),$.setAttributeNS(null,"mask",`url(#${N.maskId})`),this.defs.append(P),this._ensureTransformGroup().append($),this.paintInlineImageXObject(b,P)}paintFormXObjectBegin(g,b){if(Array.isArray(g)&&g.length===6&&this.transform(g[0],g[1],g[2],g[3],g[4],g[5]),b){const N=b[2]-b[0],S=b[3]-b[1],T=this.svgFactory.createElement("svg:rect");T.setAttributeNS(null,"x",b[0]),T.setAttributeNS(null,"y",b[1]),T.setAttributeNS(null,"width",h(N)),T.setAttributeNS(null,"height",h(S)),this.current.element=T,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(g){const b=this.svgFactory.create(g.width,g.height),N=this.svgFactory.createElement("svg:defs");b.append(N),this.defs=N;const S=this.svgFactory.createElement("svg:g");return S.setAttributeNS(null,"transform",p(g.transform)),b.append(S),this.svg=S,b}_ensureClipGroup(){if(!this.current.clipGroup){const g=this.svgFactory.createElement("svg:g");g.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(g),this.current.clipGroup=g}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",p(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}e.SVGGraphics=O},(r,e,t)=>{var n=t(3),s=t(188),i=t(193);n({target:"Array",proto:!0},{group:function(o){var c=arguments.length>1?arguments[1]:void 0;return s(this,o,c)}}),i("group")},(r,e,t)=>{var n=t(99),s=t(14),i=t(13),a=t(40),o=t(18),c=t(64),l=t(189),u=t(108),d=Array,m=s([].push);r.exports=function(y,h,p,f){for(var v=a(y),_=i(v),O=n(h,p),k=l(null),g=c(_),b=0,N,S,T;g>b;b++)T=_[b],S=o(O(T,b,v)),S in k?m(k[S],T):k[S]=[T];if(f&&(N=f(v),N!==d))for(S in k)k[S]=u(N,k[S]);return k}},(r,e,t)=>{var n=t(47),s=t(190),i=t(66),a=t(55),o=t(192),c=t(43),l=t(54),u=">",d="<",m="prototype",y="script",h=l("IE_PROTO"),p=function(){},f=function(g){return d+y+u+g+d+"/"+y+u},v=function(g){g.write(f("")),g.close();var b=g.parentWindow.Object;return g=null,b},_=function(){var g=c("iframe"),b="java"+y+":",N;return g.style.display="none",o.appendChild(g),g.src=String(b),N=g.contentWindow.document,N.open(),N.write(f("document.F=Object")),N.close(),N.F},O,k=function(){try{O=new ActiveXObject("htmlfile")}catch{}k=typeof document<"u"?document.domain&&O?v(O):_():v(O);for(var g=i.length;g--;)delete k[m][i[g]];return k()};a[h]=!0,r.exports=Object.create||function(b,N){var S;return b!==null?(p[m]=n(b),S=new p,p[m]=null,S[h]=b):S=k(),N===void 0?S:s.f(S,N)}},(r,e,t)=>{var n=t(6),s=t(46),i=t(45),a=t(47),o=t(12),c=t(191);e.f=n&&!s?Object.defineProperties:function(u,d){a(u);for(var m=o(d),y=c(d),h=y.length,p=0,f;h>p;)i.f(u,f=y[p++],m[f]);return u}},(r,e,t)=>{var n=t(59),s=t(66);r.exports=Object.keys||function(a){return n(a,s)}},(r,e,t)=>{var n=t(24);r.exports=n("document","documentElement")},(r,e,t)=>{var n=t(34),s=t(189),i=t(45).f,a=n("unscopables"),o=Array.prototype;o[a]===void 0&&i(o,a,{configurable:!0,value:s(null)}),r.exports=function(c){o[a][c]=!0}},(r,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.XfaText=void 0,t(89);class n{static textContent(i){const a=[],o={items:a,styles:Object.create(null)};function c(l){var m;if(!l)return;let u=null;const d=l.name;if(d==="#text")u=l.value;else if(n.shouldBuildText(d))(m=l==null?void 0:l.attributes)!=null&&m.textContent?u=l.attributes.textContent:l.value&&(u=l.value);else return;if(u!==null&&a.push({str:u}),!!l.children)for(const y of l.children)c(y)}return c(i),o}static shouldBuildText(i){return!(i==="textarea"||i==="input"||i==="option"||i==="select")}}e.XfaText=n},(r,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TextLayerRenderTask=void 0,e.renderTextLayer=p,e.updateTextLayer=f,t(89),t(2);var n=t(1),s=t(168);const i=1e5,a=30,o=.8,c=new Map;function l(v,_){let O;if(_&&n.FeatureTest.isOffscreenCanvasSupported)O=new OffscreenCanvas(v,v).getContext("2d",{alpha:!1});else{const k=document.createElement("canvas");k.width=k.height=v,O=k.getContext("2d",{alpha:!1})}return O}function u(v,_){const O=c.get(v);if(O)return O;const k=l(a,_);k.font=`${a}px ${v}`;const g=k.measureText("");let b=g.fontBoundingBoxAscent,N=Math.abs(g.fontBoundingBoxDescent);if(b){const T=b/(b+N);return c.set(v,T),k.canvas.width=k.canvas.height=0,T}k.strokeStyle="red",k.clearRect(0,0,a,a),k.strokeText("g",0,0);let S=k.getImageData(0,0,a,a).data;N=0;for(let T=S.length-1-3;T>=0;T-=4)if(S[T]>0){N=Math.ceil(T/4/a);break}k.clearRect(0,0,a,a),k.strokeText("A",0,a),S=k.getImageData(0,0,a,a).data,b=0;for(let T=0,M=S.length;T<M;T+=4)if(S[T]>0){b=a-Math.floor(T/4/a);break}if(k.canvas.width=k.canvas.height=0,b){const T=b/(b+N);return c.set(v,T),T}return c.set(v,o),o}function d(v,_,O){const k=document.createElement("span"),g={angle:0,canvasWidth:0,hasText:_.str!=="",hasEOL:_.hasEOL,fontSize:0};v._textDivs.push(k);const b=n.Util.transform(v._transform,_.transform);let N=Math.atan2(b[1],b[0]);const S=O[_.fontName];S.vertical&&(N+=Math.PI/2);const T=Math.hypot(b[2],b[3]),M=T*u(S.fontFamily,v._isOffscreenCanvasSupported);let P,$;N===0?(P=b[4],$=b[5]-M):(P=b[4]+M*Math.sin(N),$=b[5]-M*Math.cos(N));const K="calc(var(--scale-factor)*",L=k.style;v._container===v._rootContainer?(L.left=`${(100*P/v._pageWidth).toFixed(2)}%`,L.top=`${(100*$/v._pageHeight).toFixed(2)}%`):(L.left=`${K}${P.toFixed(2)}px)`,L.top=`${K}${$.toFixed(2)}px)`),L.fontSize=`${K}${T.toFixed(2)}px)`,L.fontFamily=S.fontFamily,g.fontSize=T,k.setAttribute("role","presentation"),k.textContent=_.str,k.dir=_.dir,v._fontInspectorEnabled&&(k.dataset.fontName=_.fontName),N!==0&&(g.angle=N*(180/Math.PI));let j=!1;if(_.str.length>1)j=!0;else if(_.str!==" "&&_.transform[0]!==_.transform[3]){const q=Math.abs(_.transform[0]),te=Math.abs(_.transform[3]);q!==te&&Math.max(q,te)/Math.min(q,te)>1.5&&(j=!0)}j&&(g.canvasWidth=S.vertical?_.height:_.width),v._textDivProperties.set(k,g),v._isReadableStream&&v._layoutText(k)}function m(v){const{div:_,scale:O,properties:k,ctx:g,prevFontSize:b,prevFontFamily:N}=v,{style:S}=_;let T="";if(k.canvasWidth!==0&&k.hasText){const{fontFamily:M}=S,{canvasWidth:P,fontSize:$}=k;(b!==$||N!==M)&&(g.font=`${$*O}px ${M}`,v.prevFontSize=$,v.prevFontFamily=M);const{width:K}=g.measureText(_.textContent);K>0&&(T=`scaleX(${P*O/K})`)}k.angle!==0&&(T=`rotate(${k.angle}deg) ${T}`),T.length>0&&(S.transform=T)}function y(v){if(v._canceled)return;const _=v._textDivs,O=v._capability;if(_.length>i){O.resolve();return}if(!v._isReadableStream)for(const g of _)v._layoutText(g);O.resolve()}class h{constructor(_){var L;let{textContentSource:O,container:k,viewport:g,textDivs:b,textDivProperties:N,textContentItemsStr:S,isOffscreenCanvasSupported:T}=_;this._textContentSource=O,this._isReadableStream=O instanceof ReadableStream,this._container=this._rootContainer=k,this._textDivs=b||[],this._textContentItemsStr=S||[],this._isOffscreenCanvasSupported=T,this._fontInspectorEnabled=!!((L=globalThis.FontInspector)!=null&&L.enabled),this._reader=null,this._textDivProperties=N||new WeakMap,this._canceled=!1,this._capability=new n.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:g.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:l(0,T)};const{pageWidth:M,pageHeight:P,pageX:$,pageY:K}=g.rawDims;this._transform=[1,0,0,-1,-$,K+P],this._pageWidth=M,this._pageHeight=P,(0,s.setLayerDimensions)(k,g),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new n.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new n.AbortException("TextLayer task cancelled."))}_processItems(_,O){for(const k of _){if(k.str===void 0){if(k.type==="beginMarkedContentProps"||k.type==="beginMarkedContent"){const g=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),k.id!==null&&this._container.setAttribute("id",`${k.id}`),g.append(this._container)}else k.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(k.str),d(this,k,O)}}_layoutText(_){const O=this._layoutTextParams.properties=this._textDivProperties.get(_);if(this._layoutTextParams.div=_,m(this._layoutTextParams),O.hasText&&this._container.append(_),O.hasEOL){const k=document.createElement("br");k.setAttribute("role","presentation"),this._container.append(k)}}_render(){const _=new n.PromiseCapability;let O=Object.create(null);if(this._isReadableStream){const k=()=>{this._reader.read().then(g=>{let{value:b,done:N}=g;if(N){_.resolve();return}Object.assign(O,b.styles),this._processItems(b.items,O),k()},_.reject)};this._reader=this._textContentSource.getReader(),k()}else if(this._textContentSource){const{items:k,styles:g}=this._textContentSource;this._processItems(k,g),_.resolve()}else throw new Error('No "textContentSource" parameter specified.');_.promise.then(()=>{O=null,y(this)},this._capability.reject)}}e.TextLayerRenderTask=h;function p(v){!v.textContentSource&&(v.textContent||v.textContentStream)&&((0,s.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),v.textContentSource=v.textContent||v.textContentStream);const{container:_,viewport:O}=v,k=getComputedStyle(_),g=k.getPropertyValue("visibility"),b=parseFloat(k.getPropertyValue("--scale-factor"));g==="visible"&&(!b||Math.abs(b-O.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const N=new h(v);return N._render(),N}function f(v){let{container:_,viewport:O,textDivs:k,textDivProperties:g,isOffscreenCanvasSupported:b,mustRotate:N=!0,mustRescale:S=!0}=v;if(N&&(0,s.setLayerDimensions)(_,{rotation:O.rotation}),S){const T=l(0,b),P={prevFontSize:null,prevFontFamily:null,div:null,scale:O.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:T};for(const $ of k)P.properties=g.get($),P.div=$,m(P)}}},(r,e,t)=>{var u,d,m,y,h,p,f,v,_,O,k,ln,b,Wt,S,un,M,hn;Object.defineProperty(e,"__esModule",{value:!0}),e.AnnotationEditorLayer=void 0,t(125),t(136),t(138),t(141),t(143),t(145),t(147);var n=t(1),s=t(164),i=t(197),a=t(202),o=t(168),c=t(203);const $=class ${constructor(L){se(this,k);se(this,b);se(this,S);se(this,M);se(this,u,void 0);se(this,d,!1);se(this,m,null);se(this,y,this.pointerup.bind(this));se(this,h,this.pointerdown.bind(this));se(this,p,new Map);se(this,f,!1);se(this,v,!1);se(this,_,!1);se(this,O,void 0);let{uiManager:j,pageIndex:q,div:te,accessibilityManager:F,annotationLayer:z,viewport:Q,l10n:ne}=L;const de=[i.FreeTextEditor,a.InkEditor,c.StampEditor];if(!$._initialized){$._initialized=!0;for(const U of de)U.initialize(ne)}j.registerEditorTypes(de),Se(this,O,j),this.pageIndex=q,this.div=te,Se(this,u,F),Se(this,m,z),this.viewport=Q,E(this,O).addLayer(this)}get isEmpty(){return E(this,p).size===0}updateToolbar(L){E(this,O).updateToolbar(L)}updateMode(){let L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:E(this,O).getMode();le(this,M,hn).call(this),L===n.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),L!==n.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",L===n.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",L===n.AnnotationEditorType.INK),this.div.classList.toggle("stampEditing",L===n.AnnotationEditorType.STAMP),this.div.hidden=!1)}addInkEditorIfNeeded(L){if(!L&&E(this,O).getMode()!==n.AnnotationEditorType.INK)return;if(!L){for(const q of E(this,p).values())if(q.isEmpty()){q.setInBackground();return}}le(this,b,Wt).call(this,{offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(L){E(this,O).setEditingState(L)}addCommands(L){E(this,O).addCommands(L)}enable(){this.div.style.pointerEvents="auto";const L=new Set;for(const q of E(this,p).values())q.enableEditing(),q.annotationElementId&&L.add(q.annotationElementId);if(!E(this,m))return;const j=E(this,m).getEditableAnnotations();for(const q of j){if(q.hide(),E(this,O).isDeletedAnnotationElement(q.data.id)||L.has(q.data.id))continue;const te=this.deserialize(q);te&&(this.addOrRebuild(te),te.enableEditing())}}disable(){var j;Se(this,_,!0),this.div.style.pointerEvents="none";const L=new Set;for(const q of E(this,p).values()){if(q.disableEditing(),!q.annotationElementId||q.serialize()!==null){L.add(q.annotationElementId);continue}(j=this.getEditableAnnotation(q.annotationElementId))==null||j.show(),q.remove()}if(E(this,m)){const q=E(this,m).getEditableAnnotations();for(const te of q){const{id:F}=te.data;L.has(F)||E(this,O).isDeletedAnnotationElement(F)||te.show()}}le(this,M,hn).call(this),this.isEmpty&&(this.div.hidden=!0),Se(this,_,!1)}getEditableAnnotation(L){var j;return((j=E(this,m))==null?void 0:j.getEditableAnnotation(L))||null}setActiveEditor(L){E(this,O).getActive()!==L&&E(this,O).setActiveEditor(L)}enableClick(){this.div.addEventListener("pointerdown",E(this,h)),this.div.addEventListener("pointerup",E(this,y))}disableClick(){this.div.removeEventListener("pointerdown",E(this,h)),this.div.removeEventListener("pointerup",E(this,y))}attach(L){E(this,p).set(L.id,L);const{annotationElementId:j}=L;j&&E(this,O).isDeletedAnnotationElement(j)&&E(this,O).removeDeletedAnnotationElement(L)}detach(L){var j;E(this,p).delete(L.id),(j=E(this,u))==null||j.removePointerInTextLayer(L.contentDiv),!E(this,_)&&L.annotationElementId&&E(this,O).addDeletedAnnotationElement(L)}remove(L){this.detach(L),E(this,O).removeEditor(L),L.div.contains(document.activeElement)&&setTimeout(()=>{E(this,O).focusMainContainer()},0),L.div.remove(),L.isAttachedToDOM=!1,E(this,v)||this.addInkEditorIfNeeded(!1)}changeParent(L){var j;L.parent!==this&&(L.annotationElementId&&(E(this,O).addDeletedAnnotationElement(L.annotationElementId),s.AnnotationEditor.deleteAnnotationElement(L),L.annotationElementId=null),this.attach(L),(j=L.parent)==null||j.detach(L),L.setParent(this),L.div&&L.isAttachedToDOM&&(L.div.remove(),this.div.append(L.div)))}add(L){if(this.changeParent(L),E(this,O).addEditor(L),this.attach(L),!L.isAttachedToDOM){const j=L.render();this.div.append(j),L.isAttachedToDOM=!0}this.moveEditorInDOM(L),L.onceAdded(),E(this,O).addToAnnotationStorage(L)}moveEditorInDOM(L){var q;if(!L.isAttachedToDOM)return;const{activeElement:j}=document;L.div.contains(j)&&(L._focusEventsAllowed=!1,setTimeout(()=>{L.div.addEventListener("focusin",()=>{L._focusEventsAllowed=!0},{once:!0}),j.focus()},0)),(q=E(this,u))==null||q.moveElementInDOM(this.div,L.div,L.contentDiv,!0)}addOrRebuild(L){L.needsToBeRebuilt()?L.rebuild():this.add(L)}addUndoableEditor(L){const j=()=>L._uiManager.rebuild(L),q=()=>{L.remove()};this.addCommands({cmd:j,undo:q,mustExec:!1})}getNextId(){return E(this,O).getId()}pasteEditor(L,j){E(this,O).updateToolbar(L),E(this,O).updateMode(L);const{offsetX:q,offsetY:te}=le(this,S,un).call(this),F=this.getNextId(),z=le(this,k,ln).call(this,{parent:this,id:F,x:q,y:te,uiManager:E(this,O),isCentered:!0,...j});z&&this.add(z)}deserialize(L){switch(L.annotationType??L.annotationEditorType){case n.AnnotationEditorType.FREETEXT:return i.FreeTextEditor.deserialize(L,this,E(this,O));case n.AnnotationEditorType.INK:return a.InkEditor.deserialize(L,this,E(this,O));case n.AnnotationEditorType.STAMP:return c.StampEditor.deserialize(L,this,E(this,O))}return null}addNewEditor(){le(this,b,Wt).call(this,le(this,S,un).call(this),!0)}setSelected(L){E(this,O).setSelected(L)}toggleSelected(L){E(this,O).toggleSelected(L)}isSelected(L){return E(this,O).isSelected(L)}unselect(L){E(this,O).unselect(L)}pointerup(L){const{isMac:j}=n.FeatureTest.platform;if(!(L.button!==0||L.ctrlKey&&j)&&L.target===this.div&&E(this,f)){if(Se(this,f,!1),!E(this,d)){Se(this,d,!0);return}if(E(this,O).getMode()===n.AnnotationEditorType.STAMP){E(this,O).unselectAll();return}le(this,b,Wt).call(this,L,!1)}}pointerdown(L){if(E(this,f)){Se(this,f,!1);return}const{isMac:j}=n.FeatureTest.platform;if(L.button!==0||L.ctrlKey&&j||L.target!==this.div)return;Se(this,f,!0);const q=E(this,O).getActive();Se(this,d,!q||q.isEmpty())}findNewParent(L,j,q){const te=E(this,O).findParent(j,q);return te===null||te===this?!1:(te.changeParent(L),!0)}destroy(){var L,j;((L=E(this,O).getActive())==null?void 0:L.parent)===this&&E(this,O).setActiveEditor(null);for(const q of E(this,p).values())(j=E(this,u))==null||j.removePointerInTextLayer(q.contentDiv),q.setParent(null),q.isAttachedToDOM=!1,q.div.remove();this.div=null,E(this,p).clear(),E(this,O).removeLayer(this)}render(L){let{viewport:j}=L;this.viewport=j,(0,o.setLayerDimensions)(this.div,j);for(const q of E(this,O).getEditors(this.pageIndex))this.add(q);this.updateMode()}update(L){let{viewport:j}=L;E(this,O).commitOrRemove(),this.viewport=j,(0,o.setLayerDimensions)(this.div,{rotation:j.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:L,pageHeight:j}=this.viewport.rawDims;return[L,j]}};u=new WeakMap,d=new WeakMap,m=new WeakMap,y=new WeakMap,h=new WeakMap,p=new WeakMap,f=new WeakMap,v=new WeakMap,_=new WeakMap,O=new WeakMap,k=new WeakSet,ln=function(L){switch(E(this,O).getMode()){case n.AnnotationEditorType.FREETEXT:return new i.FreeTextEditor(L);case n.AnnotationEditorType.INK:return new a.InkEditor(L);case n.AnnotationEditorType.STAMP:return new c.StampEditor(L)}return null},b=new WeakSet,Wt=function(L,j){const q=this.getNextId(),te=le(this,k,ln).call(this,{parent:this,id:q,x:L.offsetX,y:L.offsetY,uiManager:E(this,O),isCentered:j});return te&&this.add(te),te},S=new WeakSet,un=function(){const{x:L,y:j,width:q,height:te}=this.div.getBoundingClientRect(),F=Math.max(0,L),z=Math.max(0,j),Q=Math.min(window.innerWidth,L+q),ne=Math.min(window.innerHeight,j+te),de=(F+Q)/2-L,U=(z+ne)/2-j,[w,x]=this.viewport.rotation%180===0?[de,U]:[U,de];return{offsetX:w,offsetY:x}},M=new WeakSet,hn=function(){Se(this,v,!0);for(const L of E(this,p).values())L.isEmpty()&&L.remove();Se(this,v,!1)},rt($,"_initialized",!1);let l=$;e.AnnotationEditorLayer=l},(r,e,t)=>{var c,l,u,d,m,y,h,p,f,v,Gn,O,Hn,g,Xn,N,Rt,T,dn,P,Yn,K,fn;Object.defineProperty(e,"__esModule",{value:!0}),e.FreeTextEditor=void 0,t(89);var n=t(1),s=t(165),i=t(164),a=t(198);const j=class j extends i.AnnotationEditor{constructor(F){super({...F,name:"freeTextEditor"});se(this,v);se(this,O);se(this,g);se(this,N);se(this,T);se(this,P);se(this,K);se(this,c,this.editorDivBlur.bind(this));se(this,l,this.editorDivFocus.bind(this));se(this,u,this.editorDivInput.bind(this));se(this,d,this.editorDivKeydown.bind(this));se(this,m,void 0);se(this,y,"");se(this,h,`${this.id}-editor`);se(this,p,void 0);se(this,f,null);Se(this,m,F.color||j._defaultColor||i.AnnotationEditor._defaultLineColor),Se(this,p,F.fontSize||j._defaultFontSize)}static get _keyboardManager(){const F=j.prototype,z=de=>de.isEmpty(),Q=s.AnnotationEditorUIManager.TRANSLATE_SMALL,ne=s.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,n.shadow)(this,"_keyboardManager",new s.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],F.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],F.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],F._translateEmpty,{args:[-Q,0],checker:z}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],F._translateEmpty,{args:[-ne,0],checker:z}],[["ArrowRight","mac+ArrowRight"],F._translateEmpty,{args:[Q,0],checker:z}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],F._translateEmpty,{args:[ne,0],checker:z}],[["ArrowUp","mac+ArrowUp"],F._translateEmpty,{args:[0,-Q],checker:z}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],F._translateEmpty,{args:[0,-ne],checker:z}],[["ArrowDown","mac+ArrowDown"],F._translateEmpty,{args:[0,Q],checker:z}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],F._translateEmpty,{args:[0,ne],checker:z}]]))}static initialize(F){this._l10nPromise=new Map(["free_text2_default_content","editor_free_text2_aria_label"].map(Q=>[Q,F.get(Q)]));const z=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(z.getPropertyValue("--freetext-padding"))}static updateDefaultParams(F,z){switch(F){case n.AnnotationEditorParamsType.FREETEXT_SIZE:j._defaultFontSize=z;break;case n.AnnotationEditorParamsType.FREETEXT_COLOR:j._defaultColor=z;break}}updateParams(F,z){switch(F){case n.AnnotationEditorParamsType.FREETEXT_SIZE:le(this,v,Gn).call(this,z);break;case n.AnnotationEditorParamsType.FREETEXT_COLOR:le(this,O,Hn).call(this,z);break}}static get defaultPropertiesToUpdate(){return[[n.AnnotationEditorParamsType.FREETEXT_SIZE,j._defaultFontSize],[n.AnnotationEditorParamsType.FREETEXT_COLOR,j._defaultColor||i.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[n.AnnotationEditorParamsType.FREETEXT_SIZE,E(this,p)],[n.AnnotationEditorParamsType.FREETEXT_COLOR,E(this,m)]]}_translateEmpty(F,z){this._uiManager.translateSelectedEditors(F,z,!0)}getInitialTranslation(){const F=this.parentScale;return[-j._internalPadding*F,-(j._internalPadding+E(this,p))*F]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(n.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",E(this,d)),this.editorDiv.addEventListener("focus",E(this,l)),this.editorDiv.addEventListener("blur",E(this,c)),this.editorDiv.addEventListener("input",E(this,u)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",E(this,h)),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",E(this,d)),this.editorDiv.removeEventListener("focus",E(this,l)),this.editorDiv.removeEventListener("blur",E(this,c)),this.editorDiv.removeEventListener("input",E(this,u)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(F){this._focusEventsAllowed&&(super.focusin(F),F.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var F;if(this.width){le(this,K,fn).call(this);return}this.enableEditMode(),this.editorDiv.focus(),(F=this._initialOptions)!=null&&F.isCentered&&this.center(),this._initialOptions=null}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const F=E(this,y),z=Se(this,y,le(this,g,Xn).call(this).trimEnd());if(F===z)return;const Q=ne=>{if(Se(this,y,ne),!ne){this.remove();return}le(this,T,dn).call(this),this._uiManager.rebuild(this),le(this,N,Rt).call(this)};this.addCommands({cmd:()=>{Q(z)},undo:()=>{Q(F)},mustExec:!1}),le(this,N,Rt).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(F){this.enterInEditMode()}keydown(F){F.target===this.div&&F.key==="Enter"&&(this.enterInEditMode(),F.preventDefault())}editorDivKeydown(F){j._keyboardManager.exec(this,F)}editorDivFocus(F){this.isEditing=!0}editorDivBlur(F){this.isEditing=!1}editorDivInput(F){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let F,z;this.width&&(F=this.x,z=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",E(this,h)),this.enableEditing(),j._l10nPromise.get("editor_free_text2_aria_label").then(ne=>{var de;return(de=this.editorDiv)==null?void 0:de.setAttribute("aria-label",ne)}),j._l10nPromise.get("free_text2_default_content").then(ne=>{var de;return(de=this.editorDiv)==null?void 0:de.setAttribute("default-content",ne)}),this.editorDiv.contentEditable=!0;const{style:Q}=this.editorDiv;if(Q.fontSize=`calc(${E(this,p)}px * var(--scale-factor))`,Q.color=E(this,m),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,s.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[ne,de]=this.parentDimensions;if(this.annotationElementId){const{position:U}=E(this,f);let[w,x]=this.getInitialTranslation();[w,x]=this.pageTranslationToScreen(w,x);const[R,V]=this.pageDimensions,[D,Y]=this.pageTranslation;let W,ee;switch(this.rotation){case 0:W=F+(U[0]-D)/R,ee=z+this.height-(U[1]-Y)/V;break;case 90:W=F+(U[0]-D)/R,ee=z-(U[1]-Y)/V,[w,x]=[x,-w];break;case 180:W=F-this.width+(U[0]-D)/R,ee=z-(U[1]-Y)/V,[w,x]=[-w,-x];break;case 270:W=F+(U[0]-D-this.height*V)/R,ee=z+(U[1]-Y-this.width*R)/V,[w,x]=[-x,w];break}this.setAt(W*ne,ee*de,w,x)}else this.setAt(F*ne,z*de,this.width*ne,this.height*de);le(this,T,dn).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(F,z,Q){let ne=null;if(F instanceof a.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:U,fontColor:w},rect:x,rotation:R,id:V},textContent:D,textPosition:Y,parent:{page:{pageNumber:W}}}=F;if(!D||D.length===0)return null;ne=F={annotationType:n.AnnotationEditorType.FREETEXT,color:Array.from(w),fontSize:U,value:D.join(`
`),position:Y,pageIndex:W-1,rect:x,rotation:R,id:V,deleted:!1}}const de=super.deserialize(F,z,Q);return Se(de,p,F.fontSize),Se(de,m,n.Util.makeHexColor(...F.color)),Se(de,y,F.value),de.annotationElementId=F.id||null,Se(de,f,ne),de}serialize(){let F=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const z=j._internalPadding*this.parentScale,Q=this.getRect(z,z),ne=i.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:E(this,m)),de={annotationType:n.AnnotationEditorType.FREETEXT,color:ne,fontSize:E(this,p),value:E(this,y),pageIndex:this.pageIndex,rect:Q,rotation:this.rotation};return F?de:this.annotationElementId&&!le(this,P,Yn).call(this,de)?null:(de.id=this.annotationElementId,de)}};c=new WeakMap,l=new WeakMap,u=new WeakMap,d=new WeakMap,m=new WeakMap,y=new WeakMap,h=new WeakMap,p=new WeakMap,f=new WeakMap,v=new WeakSet,Gn=function(F){const z=ne=>{this.editorDiv.style.fontSize=`calc(${ne}px * var(--scale-factor))`,this.translate(0,-(ne-E(this,p))*this.parentScale),Se(this,p,ne),le(this,N,Rt).call(this)},Q=E(this,p);this.addCommands({cmd:()=>{z(F)},undo:()=>{z(Q)},mustExec:!0,type:n.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},O=new WeakSet,Hn=function(F){const z=E(this,m);this.addCommands({cmd:()=>{Se(this,m,this.editorDiv.style.color=F)},undo:()=>{Se(this,m,this.editorDiv.style.color=z)},mustExec:!0,type:n.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},g=new WeakSet,Xn=function(){const F=this.editorDiv.getElementsByTagName("div");if(F.length===0)return this.editorDiv.innerText;const z=[];for(const Q of F)z.push(Q.innerText.replace(/\r\n?|\n/,""));return z.join(`
`)},N=new WeakSet,Rt=function(){const[F,z]=this.parentDimensions;let Q;if(this.isAttachedToDOM)Q=this.div.getBoundingClientRect();else{const{currentLayer:ne,div:de}=this,U=de.style.display;de.style.display="hidden",ne.div.append(this.div),Q=de.getBoundingClientRect(),de.remove(),de.style.display=U}this.rotation%180===this.parentRotation%180?(this.width=Q.width/F,this.height=Q.height/z):(this.width=Q.height/F,this.height=Q.width/z),this.fixAndSetPosition()},T=new WeakSet,dn=function(){if(this.editorDiv.replaceChildren(),!!E(this,y))for(const F of E(this,y).split(`
`)){const z=document.createElement("div");z.append(F?document.createTextNode(F):document.createElement("br")),this.editorDiv.append(z)}},P=new WeakSet,Yn=function(F){const{value:z,fontSize:Q,color:ne,rect:de,pageIndex:U}=E(this,f);return F.value!==z||F.fontSize!==Q||F.rect.some((w,x)=>Math.abs(w-de[x])>=1)||F.color.some((w,x)=>w!==ne[x])||F.pageIndex!==U},K=new WeakSet,fn=function(){let F=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.annotationElementId)return;if(le(this,N,Rt).call(this),!F&&(this.width===0||this.height===0)){setTimeout(()=>le(this,K,fn).call(this,!0),0);return}const z=j._internalPadding*this.parentScale;E(this,f).rect=this.getRect(z,z)},rt(j,"_freeTextDefaultContent",""),rt(j,"_l10nPromise"),rt(j,"_internalPadding",0),rt(j,"_defaultColor",null),rt(j,"_defaultFontSize",10),rt(j,"_type","freetext");let o=j;e.FreeTextEditor=o},(r,e,t)=>{var x,R,vt,D,jn,W,ee,me,he,Ae,ie,ye,xe,Ve,We,Pe,He,Me,be,fe,Ee,Be,pn,Re,mn,Ie,gn,Ze,Ke,qe,we,ue,ae,ze,$e,nt,ve,Kn,_e,vn;Object.defineProperty(e,"__esModule",{value:!0}),e.StampAnnotationElement=e.InkAnnotationElement=e.FreeTextAnnotationElement=e.AnnotationLayer=void 0,t(89),t(125),t(136),t(138),t(141),t(143),t(145),t(147);var n=t(1),s=t(168),i=t(163),a=t(199),o=t(200),c=t(201);const l=1e3,u=9,d=new WeakSet;function m(Te){return{width:Te[2]-Te[0],height:Te[3]-Te[1]}}class y{static create(G){switch(G.data.annotationType){case n.AnnotationType.LINK:return new p(G);case n.AnnotationType.TEXT:return new f(G);case n.AnnotationType.WIDGET:switch(G.data.fieldType){case"Tx":return new _(G);case"Btn":return G.data.radioButton?new g(G):G.data.checkBox?new k(G):new b(G);case"Ch":return new N(G);case"Sig":return new O(G)}return new v(G);case n.AnnotationType.POPUP:return new S(G);case n.AnnotationType.FREETEXT:return new M(G);case n.AnnotationType.LINE:return new P(G);case n.AnnotationType.SQUARE:return new $(G);case n.AnnotationType.CIRCLE:return new K(G);case n.AnnotationType.POLYLINE:return new L(G);case n.AnnotationType.CARET:return new q(G);case n.AnnotationType.INK:return new te(G);case n.AnnotationType.POLYGON:return new j(G);case n.AnnotationType.HIGHLIGHT:return new F(G);case n.AnnotationType.UNDERLINE:return new z(G);case n.AnnotationType.SQUIGGLY:return new Q(G);case n.AnnotationType.STRIKEOUT:return new ne(G);case n.AnnotationType.STAMP:return new de(G);case n.AnnotationType.FILEATTACHMENT:return new U(G);default:return new h(G)}}}class h{constructor(G){se(this,x,!1);let{isRenderable:I=!1,ignoreBorder:Z=!1,createQuadrilaterals:H=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.isRenderable=I,this.data=G.data,this.layer=G.layer,this.linkService=G.linkService,this.downloadManager=G.downloadManager,this.imageResourcesPath=G.imageResourcesPath,this.renderForms=G.renderForms,this.svgFactory=G.svgFactory,this.annotationStorage=G.annotationStorage,this.enableScripting=G.enableScripting,this.hasJSActions=G.hasJSActions,this._fieldObjects=G.fieldObjects,this.parent=G.parent,I&&(this.container=this._createContainer(Z)),H&&this._createQuadrilaterals()}_createContainer(G){const{data:I,parent:{page:Z,viewport:H}}=this,J=document.createElement("section");J.setAttribute("data-annotation-id",I.id),J.style.zIndex=this.parent.zIndex++,this.data.popupRef&&J.setAttribute("aria-haspopup","dialog"),I.noRotate&&J.classList.add("norotate");const{pageWidth:ce,pageHeight:ke,pageX:X,pageY:oe}=H.rawDims;if(!I.rect||this instanceof S){const{rotation:Ue}=I;return!I.hasOwnCanvas&&Ue!==0&&this.setRotation(Ue,J),J}const{width:pe,height:De}=m(I.rect),Oe=n.Util.normalizeRect([I.rect[0],Z.view[3]-I.rect[1]+Z.view[1],I.rect[2],Z.view[3]-I.rect[3]+Z.view[1]]);if(!G&&I.borderStyle.width>0){J.style.borderWidth=`${I.borderStyle.width}px`;const Ue=I.borderStyle.horizontalCornerRadius,Ye=I.borderStyle.verticalCornerRadius;if(Ue>0||Ye>0){const et=`calc(${Ue}px * var(--scale-factor)) / calc(${Ye}px * var(--scale-factor))`;J.style.borderRadius=et}else if(this instanceof g){const et=`calc(${pe}px * var(--scale-factor)) / calc(${De}px * var(--scale-factor))`;J.style.borderRadius=et}switch(I.borderStyle.style){case n.AnnotationBorderStyleType.SOLID:J.style.borderStyle="solid";break;case n.AnnotationBorderStyleType.DASHED:J.style.borderStyle="dashed";break;case n.AnnotationBorderStyleType.BEVELED:(0,n.warn)("Unimplemented border style: beveled");break;case n.AnnotationBorderStyleType.INSET:(0,n.warn)("Unimplemented border style: inset");break;case n.AnnotationBorderStyleType.UNDERLINE:J.style.borderBottomStyle="solid";break}const Je=I.borderColor||null;Je?(Se(this,x,!0),J.style.borderColor=n.Util.makeHexColor(Je[0]|0,Je[1]|0,Je[2]|0)):J.style.borderWidth=0}J.style.left=`${100*(Oe[0]-X)/ce}%`,J.style.top=`${100*(Oe[1]-oe)/ke}%`;const{rotation:Fe}=I;return I.hasOwnCanvas||Fe===0?(J.style.width=`${100*pe/ce}%`,J.style.height=`${100*De/ke}%`):this.setRotation(Fe,J),J}setRotation(G){let I=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.container;if(!this.data.rect)return;const{pageWidth:Z,pageHeight:H}=this.parent.viewport.rawDims,{width:J,height:ce}=m(this.data.rect);let ke,X;G%180===0?(ke=100*J/Z,X=100*ce/H):(ke=100*ce/Z,X=100*J/H),I.style.width=`${ke}%`,I.style.height=`${X}%`,I.setAttribute("data-main-rotation",(360-G)%360)}get _commonActions(){const G=(I,Z,H)=>{const J=H.detail[I],ce=J[0],ke=J.slice(1);H.target.style[Z]=a.ColorConverters[`${ce}_HTML`](ke),this.annotationStorage.setValue(this.data.id,{[Z]:a.ColorConverters[`${ce}_rgb`](ke)})};return(0,n.shadow)(this,"_commonActions",{display:I=>{const{display:Z}=I.detail,H=Z%2===1;this.container.style.visibility=H?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:H,noPrint:Z===1||Z===2})},print:I=>{this.annotationStorage.setValue(this.data.id,{noPrint:!I.detail.print})},hidden:I=>{const{hidden:Z}=I.detail;this.container.style.visibility=Z?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:Z,noView:Z})},focus:I=>{setTimeout(()=>I.target.focus({preventScroll:!1}),0)},userName:I=>{I.target.title=I.detail.userName},readonly:I=>{I.target.disabled=I.detail.readonly},required:I=>{this._setRequired(I.target,I.detail.required)},bgColor:I=>{G("bgColor","backgroundColor",I)},fillColor:I=>{G("fillColor","backgroundColor",I)},fgColor:I=>{G("fgColor","color",I)},textColor:I=>{G("textColor","color",I)},borderColor:I=>{G("borderColor","borderColor",I)},strokeColor:I=>{G("strokeColor","borderColor",I)},rotation:I=>{const Z=I.detail.rotation;this.setRotation(Z),this.annotationStorage.setValue(this.data.id,{rotation:Z})}})}_dispatchEventFromSandbox(G,I){const Z=this._commonActions;for(const H of Object.keys(I.detail)){const J=G[H]||Z[H];J==null||J(I)}}_setDefaultPropertiesFromJS(G){if(!this.enableScripting)return;const I=this.annotationStorage.getRawValue(this.data.id);if(!I)return;const Z=this._commonActions;for(const[H,J]of Object.entries(I)){const ce=Z[H];if(ce){const ke={detail:{[H]:J},target:G};ce(ke),delete I[H]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:G}=this.data;if(!G)return;const[I,Z,H,J]=this.data.rect;if(G.length===1){const[,{x:Ye,y:Je},{x:et,y:it}]=G[0];if(H===Ye&&J===Je&&I===et&&Z===it)return}const{style:ce}=this.container;let ke;if(E(this,x)){const{borderColor:Ye,borderWidth:Je}=ce;ce.borderWidth=0,ke=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${Ye}" stroke-width="${Je}">`],this.container.classList.add("hasBorder")}const X=H-I,oe=J-Z,{svgFactory:pe}=this,De=pe.createElement("svg");De.classList.add("quadrilateralsContainer"),De.setAttribute("width",0),De.setAttribute("height",0);const Oe=pe.createElement("defs");De.append(Oe);const Fe=pe.createElement("clipPath"),Ue=`clippath_${this.data.id}`;Fe.setAttribute("id",Ue),Fe.setAttribute("clipPathUnits","objectBoundingBox"),Oe.append(Fe);for(const[,{x:Ye,y:Je},{x:et,y:it}]of G){const tt=pe.createElement("rect"),ct=(et-I)/X,lt=(J-Je)/oe,ht=(Ye-et)/X,dt=(Je-it)/oe;tt.setAttribute("x",ct),tt.setAttribute("y",lt),tt.setAttribute("width",ht),tt.setAttribute("height",dt),Fe.append(tt),ke==null||ke.push(`<rect vector-effect="non-scaling-stroke" x="${ct}" y="${lt}" width="${ht}" height="${dt}"/>`)}E(this,x)&&(ke.push("</g></svg>')"),ce.backgroundImage=ke.join("")),this.container.append(De),this.container.style.clipPath=`url(#${Ue})`}_createPopup(){const{container:G,data:I}=this;G.setAttribute("aria-haspopup","dialog");const Z=new S({data:{color:I.color,titleObj:I.titleObj,modificationDate:I.modificationDate,contentsObj:I.contentsObj,richText:I.richText,parentRect:I.rect,borderStyle:0,id:`popup_${I.id}`,rotation:I.rotation},parent:this.parent,elements:[this]});this.parent.div.append(Z.render())}render(){(0,n.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(G){let I=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const Z=[];if(this._fieldObjects){const H=this._fieldObjects[G];if(H)for(const{page:J,id:ce,exportValues:ke}of H){if(J===-1||ce===I)continue;const X=typeof ke=="string"?ke:null,oe=document.querySelector(`[data-element-id="${ce}"]`);if(oe&&!d.has(oe)){(0,n.warn)(`_getElementsByName - element not allowed: ${ce}`);continue}Z.push({id:ce,exportValue:X,domElement:oe})}return Z}for(const H of document.getElementsByName(G)){const{exportValue:J}=H,ce=H.getAttribute("data-element-id");ce!==I&&d.has(H)&&Z.push({id:ce,exportValue:J,domElement:H})}return Z}show(){var G;this.container&&(this.container.hidden=!1),(G=this.popup)==null||G.maybeShow()}hide(){var G;this.container&&(this.container.hidden=!0),(G=this.popup)==null||G.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const G=this.getElementsToTriggerPopup();if(Array.isArray(G))for(const I of G)I.classList.add("highlightArea");else G.classList.add("highlightArea")}_editOnDoubleClick(){const{annotationEditorType:G,data:{id:I}}=this;this.container.addEventListener("dblclick",()=>{var Z;(Z=this.linkService.eventBus)==null||Z.dispatch("switchannotationeditormode",{source:this,mode:G,editId:I})})}}x=new WeakMap;class p extends h{constructor(I){let Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;super(I,{isRenderable:!0,ignoreBorder:!!(Z!=null&&Z.ignoreBorder),createQuadrilaterals:!0});se(this,R);se(this,D);this.isTooltipOnly=I.data.isTooltipOnly}render(){const{data:I,linkService:Z}=this,H=document.createElement("a");H.setAttribute("data-element-id",I.id);let J=!1;return I.url?(Z.addLinkAttributes(H,I.url,I.newWindow),J=!0):I.action?(this._bindNamedAction(H,I.action),J=!0):I.attachment?(this._bindAttachment(H,I.attachment),J=!0):I.setOCGState?(le(this,D,jn).call(this,H,I.setOCGState),J=!0):I.dest?(this._bindLink(H,I.dest),J=!0):(I.actions&&(I.actions.Action||I.actions["Mouse Up"]||I.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(H,I),J=!0),I.resetForm?(this._bindResetFormAction(H,I.resetForm),J=!0):this.isTooltipOnly&&!J&&(this._bindLink(H,""),J=!0)),this.container.classList.add("linkAnnotation"),J&&this.container.append(H),this.container}_bindLink(I,Z){I.href=this.linkService.getDestinationHash(Z),I.onclick=()=>(Z&&this.linkService.goToDestination(Z),!1),(Z||Z==="")&&le(this,R,vt).call(this)}_bindNamedAction(I,Z){I.href=this.linkService.getAnchorUrl(""),I.onclick=()=>(this.linkService.executeNamedAction(Z),!1),le(this,R,vt).call(this)}_bindAttachment(I,Z){I.href=this.linkService.getAnchorUrl(""),I.onclick=()=>{var H;return(H=this.downloadManager)==null||H.openOrDownloadData(this.container,Z.content,Z.filename),!1},le(this,R,vt).call(this)}_bindJSAction(I,Z){I.href=this.linkService.getAnchorUrl("");const H=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const J of Object.keys(Z.actions)){const ce=H.get(J);ce&&(I[ce]=()=>{var ke;return(ke=this.linkService.eventBus)==null||ke.dispatch("dispatcheventinsandbox",{source:this,detail:{id:Z.id,name:J}}),!1})}I.onclick||(I.onclick=()=>!1),le(this,R,vt).call(this)}_bindResetFormAction(I,Z){const H=I.onclick;if(H||(I.href=this.linkService.getAnchorUrl("")),le(this,R,vt).call(this),!this._fieldObjects){(0,n.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),H||(I.onclick=()=>!1);return}I.onclick=()=>{var De;H==null||H();const{fields:J,refs:ce,include:ke}=Z,X=[];if(J.length!==0||ce.length!==0){const Oe=new Set(ce);for(const Fe of J){const Ue=this._fieldObjects[Fe]||[];for(const{id:Ye}of Ue)Oe.add(Ye)}for(const Fe of Object.values(this._fieldObjects))for(const Ue of Fe)Oe.has(Ue.id)===ke&&X.push(Ue)}else for(const Oe of Object.values(this._fieldObjects))X.push(...Oe);const oe=this.annotationStorage,pe=[];for(const Oe of X){const{id:Fe}=Oe;switch(pe.push(Fe),Oe.type){case"text":{const Ye=Oe.defaultValue||"";oe.setValue(Fe,{value:Ye});break}case"checkbox":case"radiobutton":{const Ye=Oe.defaultValue===Oe.exportValues;oe.setValue(Fe,{value:Ye});break}case"combobox":case"listbox":{const Ye=Oe.defaultValue||"";oe.setValue(Fe,{value:Ye});break}default:continue}const Ue=document.querySelector(`[data-element-id="${Fe}"]`);if(Ue){if(!d.has(Ue)){(0,n.warn)(`_bindResetFormAction - element not allowed: ${Fe}`);continue}}else continue;Ue.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((De=this.linkService.eventBus)==null||De.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:pe,name:"ResetForm"}})),!1}}}R=new WeakSet,vt=function(){this.container.setAttribute("data-internal-link","")},D=new WeakSet,jn=function(I,Z){I.href=this.linkService.getAnchorUrl(""),I.onclick=()=>(this.linkService.executeSetOCGState(Z),!1),le(this,R,vt).call(this)};class f extends h{constructor(G){var Z,H,J;const I=!!(G.data.popupRef||(Z=G.data.titleObj)!=null&&Z.str||(H=G.data.contentsObj)!=null&&H.str||(J=G.data.richText)!=null&&J.str);super(G,{isRenderable:I})}render(){this.container.classList.add("textAnnotation");const G=document.createElement("img");return G.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",G.alt="[{{type}} Annotation]",G.dataset.l10nId="text_annotation_type",G.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.popupRef||this._createPopup(),this.container.append(G),this.container}}class v extends h{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(G){var I;this.data.hasOwnCanvas&&(((I=G.previousSibling)==null?void 0:I.nodeName)==="CANVAS"&&(G.previousSibling.hidden=!0),G.hidden=!1)}_getKeyModifier(G){const{isWin:I,isMac:Z}=n.FeatureTest.platform;return I&&G.ctrlKey||Z&&G.metaKey}_setEventListener(G,I,Z,H){I.includes("mouse")?G.addEventListener(I,J=>{var ce;(ce=this.linkService.eventBus)==null||ce.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:Z,value:H(J),shift:J.shiftKey,modifier:this._getKeyModifier(J)}})}):G.addEventListener(I,J=>{var ce;(ce=this.linkService.eventBus)==null||ce.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:Z,value:H(J)}})})}_setEventListeners(G,I,Z){var H;for(const[J,ce]of I)(ce==="Action"||(H=this.data.actions)!=null&&H[ce])&&this._setEventListener(G,J,ce,Z)}_setBackgroundColor(G){const I=this.data.backgroundColor||null;G.style.backgroundColor=I===null?"transparent":n.Util.makeHexColor(I[0],I[1],I[2])}_setTextStyle(G){const I=["left","center","right"],{fontColor:Z}=this.data.defaultAppearanceData,H=this.data.defaultAppearanceData.fontSize||u,J=G.style;let ce;const ke=2,X=oe=>Math.round(10*oe)/10;if(this.data.multiLine){const oe=Math.abs(this.data.rect[3]-this.data.rect[1]-ke),pe=Math.round(oe/(n.LINE_FACTOR*H))||1,De=oe/pe;ce=Math.min(H,X(De/n.LINE_FACTOR))}else{const oe=Math.abs(this.data.rect[3]-this.data.rect[1]-ke);ce=Math.min(H,X(oe/n.LINE_FACTOR))}J.fontSize=`calc(${ce}px * var(--scale-factor))`,J.color=n.Util.makeHexColor(Z[0],Z[1],Z[2]),this.data.textAlignment!==null&&(J.textAlign=I[this.data.textAlignment])}_setRequired(G,I){I?G.setAttribute("required",!0):G.removeAttribute("required"),G.setAttribute("aria-required",I)}}class _ extends v{constructor(G){const I=G.renderForms||!G.data.hasAppearance&&!!G.data.fieldValue;super(G,{isRenderable:I})}setPropertyOnSiblings(G,I,Z,H){const J=this.annotationStorage;for(const ce of this._getElementsByName(G.name,G.id))ce.domElement&&(ce.domElement[I]=Z),J.setValue(ce.id,{[H]:Z})}render(){var H,J;const G=this.annotationStorage,I=this.data.id;this.container.classList.add("textWidgetAnnotation");let Z=null;if(this.renderForms){const ce=G.getValue(I,{value:this.data.fieldValue});let ke=ce.value||"";const X=G.getValue(I,{charLimit:this.data.maxLen}).charLimit;X&&ke.length>X&&(ke=ke.slice(0,X));let oe=ce.formattedValue||((H=this.data.textContent)==null?void 0:H.join(`
`))||null;oe&&this.data.comb&&(oe=oe.replaceAll(/\s+/g,""));const pe={userValue:ke,formattedValue:oe,lastCommittedValue:null,commitKey:1};this.data.multiLine?(Z=document.createElement("textarea"),Z.textContent=oe??ke,this.data.doNotScroll&&(Z.style.overflowY="hidden")):(Z=document.createElement("input"),Z.type="text",Z.setAttribute("value",oe??ke),this.data.doNotScroll&&(Z.style.overflowX="hidden")),this.data.hasOwnCanvas&&(Z.hidden=!0),d.add(Z),Z.setAttribute("data-element-id",I),Z.disabled=this.data.readOnly,Z.name=this.data.fieldName,Z.tabIndex=l,this._setRequired(Z,this.data.required),X&&(Z.maxLength=X),Z.addEventListener("input",Oe=>{G.setValue(I,{value:Oe.target.value}),this.setPropertyOnSiblings(Z,"value",Oe.target.value,"value"),pe.formattedValue=null}),Z.addEventListener("resetform",Oe=>{const Fe=this.data.defaultFieldValue??"";Z.value=pe.userValue=Fe,pe.formattedValue=null});let De=Oe=>{const{formattedValue:Fe}=pe;Fe!=null&&(Oe.target.value=Fe),Oe.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){Z.addEventListener("focus",Fe=>{const{target:Ue}=Fe;pe.userValue&&(Ue.value=pe.userValue),pe.lastCommittedValue=Ue.value,pe.commitKey=1}),Z.addEventListener("updatefromsandbox",Fe=>{this.showElementAndHideCanvas(Fe.target);const Ue={value(Ye){pe.userValue=Ye.detail.value??"",G.setValue(I,{value:pe.userValue.toString()}),Ye.target.value=pe.userValue},formattedValue(Ye){const{formattedValue:Je}=Ye.detail;pe.formattedValue=Je,Je!=null&&Ye.target!==document.activeElement&&(Ye.target.value=Je),G.setValue(I,{formattedValue:Je})},selRange(Ye){Ye.target.setSelectionRange(...Ye.detail.selRange)},charLimit:Ye=>{var tt;const{charLimit:Je}=Ye.detail,{target:et}=Ye;if(Je===0){et.removeAttribute("maxLength");return}et.setAttribute("maxLength",Je);let it=pe.userValue;!it||it.length<=Je||(it=it.slice(0,Je),et.value=pe.userValue=it,G.setValue(I,{value:it}),(tt=this.linkService.eventBus)==null||tt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:I,name:"Keystroke",value:it,willCommit:!0,commitKey:1,selStart:et.selectionStart,selEnd:et.selectionEnd}}))}};this._dispatchEventFromSandbox(Ue,Fe)}),Z.addEventListener("keydown",Fe=>{var Je;pe.commitKey=1;let Ue=-1;if(Fe.key==="Escape"?Ue=0:Fe.key==="Enter"&&!this.data.multiLine?Ue=2:Fe.key==="Tab"&&(pe.commitKey=3),Ue===-1)return;const{value:Ye}=Fe.target;pe.lastCommittedValue!==Ye&&(pe.lastCommittedValue=Ye,pe.userValue=Ye,(Je=this.linkService.eventBus)==null||Je.dispatch("dispatcheventinsandbox",{source:this,detail:{id:I,name:"Keystroke",value:Ye,willCommit:!0,commitKey:Ue,selStart:Fe.target.selectionStart,selEnd:Fe.target.selectionEnd}}))});const Oe=De;De=null,Z.addEventListener("blur",Fe=>{var Ye;if(!Fe.relatedTarget)return;const{value:Ue}=Fe.target;pe.userValue=Ue,pe.lastCommittedValue!==Ue&&((Ye=this.linkService.eventBus)==null||Ye.dispatch("dispatcheventinsandbox",{source:this,detail:{id:I,name:"Keystroke",value:Ue,willCommit:!0,commitKey:pe.commitKey,selStart:Fe.target.selectionStart,selEnd:Fe.target.selectionEnd}})),Oe(Fe)}),(J=this.data.actions)!=null&&J.Keystroke&&Z.addEventListener("beforeinput",Fe=>{var lt;pe.lastCommittedValue=null;const{data:Ue,target:Ye}=Fe,{value:Je,selectionStart:et,selectionEnd:it}=Ye;let tt=et,ct=it;switch(Fe.inputType){case"deleteWordBackward":{const ht=Je.substring(0,et).match(/\w*[^\w]*$/);ht&&(tt-=ht[0].length);break}case"deleteWordForward":{const ht=Je.substring(et).match(/^[^\w]*\w*/);ht&&(ct+=ht[0].length);break}case"deleteContentBackward":et===it&&(tt-=1);break;case"deleteContentForward":et===it&&(ct+=1);break}Fe.preventDefault(),(lt=this.linkService.eventBus)==null||lt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:I,name:"Keystroke",value:Je,change:Ue||"",willCommit:!1,selStart:tt,selEnd:ct}})}),this._setEventListeners(Z,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Fe=>Fe.target.value)}if(De&&Z.addEventListener("blur",De),this.data.comb){const Fe=(this.data.rect[2]-this.data.rect[0])/X;Z.classList.add("comb"),Z.style.letterSpacing=`calc(${Fe}px * var(--scale-factor) - 1ch)`}}else Z=document.createElement("div"),Z.textContent=this.data.fieldValue,Z.style.verticalAlign="middle",Z.style.display="table-cell";return this._setTextStyle(Z),this._setBackgroundColor(Z),this._setDefaultPropertiesFromJS(Z),this.container.append(Z),this.container}}class O extends v{constructor(G){super(G,{isRenderable:!!G.data.hasOwnCanvas})}}class k extends v{constructor(G){super(G,{isRenderable:G.renderForms})}render(){const G=this.annotationStorage,I=this.data,Z=I.id;let H=G.getValue(Z,{value:I.exportValue===I.fieldValue}).value;typeof H=="string"&&(H=H!=="Off",G.setValue(Z,{value:H})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const J=document.createElement("input");return d.add(J),J.setAttribute("data-element-id",Z),J.disabled=I.readOnly,this._setRequired(J,this.data.required),J.type="checkbox",J.name=I.fieldName,H&&J.setAttribute("checked",!0),J.setAttribute("exportValue",I.exportValue),J.tabIndex=l,J.addEventListener("change",ce=>{const{name:ke,checked:X}=ce.target;for(const oe of this._getElementsByName(ke,Z)){const pe=X&&oe.exportValue===I.exportValue;oe.domElement&&(oe.domElement.checked=pe),G.setValue(oe.id,{value:pe})}G.setValue(Z,{value:X})}),J.addEventListener("resetform",ce=>{const ke=I.defaultFieldValue||"Off";ce.target.checked=ke===I.exportValue}),this.enableScripting&&this.hasJSActions&&(J.addEventListener("updatefromsandbox",ce=>{const ke={value(X){X.target.checked=X.detail.value!=="Off",G.setValue(Z,{value:X.target.checked})}};this._dispatchEventFromSandbox(ke,ce)}),this._setEventListeners(J,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],ce=>ce.target.checked)),this._setBackgroundColor(J),this._setDefaultPropertiesFromJS(J),this.container.append(J),this.container}}class g extends v{constructor(G){super(G,{isRenderable:G.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const G=this.annotationStorage,I=this.data,Z=I.id;let H=G.getValue(Z,{value:I.fieldValue===I.buttonValue}).value;typeof H=="string"&&(H=H!==I.buttonValue,G.setValue(Z,{value:H}));const J=document.createElement("input");if(d.add(J),J.setAttribute("data-element-id",Z),J.disabled=I.readOnly,this._setRequired(J,this.data.required),J.type="radio",J.name=I.fieldName,H&&J.setAttribute("checked",!0),J.tabIndex=l,J.addEventListener("change",ce=>{const{name:ke,checked:X}=ce.target;for(const oe of this._getElementsByName(ke,Z))G.setValue(oe.id,{value:!1});G.setValue(Z,{value:X})}),J.addEventListener("resetform",ce=>{const ke=I.defaultFieldValue;ce.target.checked=ke!=null&&ke===I.buttonValue}),this.enableScripting&&this.hasJSActions){const ce=I.buttonValue;J.addEventListener("updatefromsandbox",ke=>{const X={value:oe=>{const pe=ce===oe.detail.value;for(const De of this._getElementsByName(oe.target.name)){const Oe=pe&&De.id===Z;De.domElement&&(De.domElement.checked=Oe),G.setValue(De.id,{value:Oe})}}};this._dispatchEventFromSandbox(X,ke)}),this._setEventListeners(J,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],ke=>ke.target.checked)}return this._setBackgroundColor(J),this._setDefaultPropertiesFromJS(J),this.container.append(J),this.container}}class b extends p{constructor(G){super(G,{ignoreBorder:G.data.hasAppearance})}render(){const G=super.render();G.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(G.title=this.data.alternativeText);const I=G.lastChild;return this.enableScripting&&this.hasJSActions&&I&&(this._setDefaultPropertiesFromJS(I),I.addEventListener("updatefromsandbox",Z=>{this._dispatchEventFromSandbox({},Z)})),G}}class N extends v{constructor(G){super(G,{isRenderable:G.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const G=this.annotationStorage,I=this.data.id,Z=G.getValue(I,{value:this.data.fieldValue}),H=document.createElement("select");d.add(H),H.setAttribute("data-element-id",I),H.disabled=this.data.readOnly,this._setRequired(H,this.data.required),H.name=this.data.fieldName,H.tabIndex=l;let J=this.data.combo&&this.data.options.length>0;this.data.combo||(H.size=this.data.options.length,this.data.multiSelect&&(H.multiple=!0)),H.addEventListener("resetform",pe=>{const De=this.data.defaultFieldValue;for(const Oe of H.options)Oe.selected=Oe.value===De});for(const pe of this.data.options){const De=document.createElement("option");De.textContent=pe.displayValue,De.value=pe.exportValue,Z.value.includes(pe.exportValue)&&(De.setAttribute("selected",!0),J=!1),H.append(De)}let ce=null;if(J){const pe=document.createElement("option");pe.value=" ",pe.setAttribute("hidden",!0),pe.setAttribute("selected",!0),H.prepend(pe),ce=()=>{pe.remove(),H.removeEventListener("input",ce),ce=null},H.addEventListener("input",ce)}const ke=pe=>{const De=pe?"value":"textContent",{options:Oe,multiple:Fe}=H;return Fe?Array.prototype.filter.call(Oe,Ue=>Ue.selected).map(Ue=>Ue[De]):Oe.selectedIndex===-1?null:Oe[Oe.selectedIndex][De]};let X=ke(!1);const oe=pe=>{const De=pe.target.options;return Array.prototype.map.call(De,Oe=>({displayValue:Oe.textContent,exportValue:Oe.value}))};return this.enableScripting&&this.hasJSActions?(H.addEventListener("updatefromsandbox",pe=>{const De={value(Oe){ce==null||ce();const Fe=Oe.detail.value,Ue=new Set(Array.isArray(Fe)?Fe:[Fe]);for(const Ye of H.options)Ye.selected=Ue.has(Ye.value);G.setValue(I,{value:ke(!0)}),X=ke(!1)},multipleSelection(Oe){H.multiple=!0},remove(Oe){const Fe=H.options,Ue=Oe.detail.remove;Fe[Ue].selected=!1,H.remove(Ue),Fe.length>0&&Array.prototype.findIndex.call(Fe,Je=>Je.selected)===-1&&(Fe[0].selected=!0),G.setValue(I,{value:ke(!0),items:oe(Oe)}),X=ke(!1)},clear(Oe){for(;H.length!==0;)H.remove(0);G.setValue(I,{value:null,items:[]}),X=ke(!1)},insert(Oe){const{index:Fe,displayValue:Ue,exportValue:Ye}=Oe.detail.insert,Je=H.children[Fe],et=document.createElement("option");et.textContent=Ue,et.value=Ye,Je?Je.before(et):H.append(et),G.setValue(I,{value:ke(!0),items:oe(Oe)}),X=ke(!1)},items(Oe){const{items:Fe}=Oe.detail;for(;H.length!==0;)H.remove(0);for(const Ue of Fe){const{displayValue:Ye,exportValue:Je}=Ue,et=document.createElement("option");et.textContent=Ye,et.value=Je,H.append(et)}H.options.length>0&&(H.options[0].selected=!0),G.setValue(I,{value:ke(!0),items:oe(Oe)}),X=ke(!1)},indices(Oe){const Fe=new Set(Oe.detail.indices);for(const Ue of Oe.target.options)Ue.selected=Fe.has(Ue.index);G.setValue(I,{value:ke(!0)}),X=ke(!1)},editable(Oe){Oe.target.disabled=!Oe.detail.editable}};this._dispatchEventFromSandbox(De,pe)}),H.addEventListener("input",pe=>{var Oe;const De=ke(!0);G.setValue(I,{value:De}),pe.preventDefault(),(Oe=this.linkService.eventBus)==null||Oe.dispatch("dispatcheventinsandbox",{source:this,detail:{id:I,name:"Keystroke",value:X,changeEx:De,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(H,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],pe=>pe.target.value)):H.addEventListener("input",function(pe){G.setValue(I,{value:ke(!0)})}),this.data.combo&&this._setTextStyle(H),this._setBackgroundColor(H),this._setDefaultPropertiesFromJS(H),this.container.append(H),this.container}}class S extends h{constructor(G){var J,ce,ke;const{data:I,elements:Z}=G,H=!!((J=I.titleObj)!=null&&J.str||(ce=I.contentsObj)!=null&&ce.str||(ke=I.richText)!=null&&ke.str);super(G,{isRenderable:H}),this.elements=Z}render(){this.container.classList.add("popupAnnotation");const G=new T({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),I=[];for(const Z of this.elements)Z.popup=G,I.push(Z.data.id),Z.addHighlightArea();return this.container.setAttribute("aria-controls",I.join(",")),this.container}}class T{constructor(G){se(this,Be);se(this,Re);se(this,Ie);se(this,W,null);se(this,ee,le(this,Ie,gn).bind(this));se(this,me,le(this,Re,mn).bind(this));se(this,he,le(this,Be,pn).bind(this));se(this,Ae,null);se(this,ie,null);se(this,ye,null);se(this,xe,null);se(this,Ve,null);se(this,We,null);se(this,Pe,!1);se(this,He,null);se(this,Me,null);se(this,be,null);se(this,fe,null);se(this,Ee,!1);let{container:I,color:Z,elements:H,titleObj:J,modificationDate:ce,contentsObj:ke,richText:X,parent:oe,rect:pe,parentRect:De,open:Oe}=G;Se(this,ie,I),Se(this,fe,J),Se(this,ye,ke),Se(this,be,X),Se(this,Ve,oe),Se(this,Ae,Z),Se(this,Me,pe),Se(this,We,De),Se(this,xe,H);const Fe=s.PDFDateString.toDateObject(ce);Fe&&Se(this,W,oe.l10n.get("annotation_date_string",{date:Fe.toLocaleDateString(),time:Fe.toLocaleTimeString()})),this.trigger=H.flatMap(Ue=>Ue.getElementsToTriggerPopup());for(const Ue of this.trigger)Ue.addEventListener("click",E(this,he)),Ue.addEventListener("mouseenter",E(this,me)),Ue.addEventListener("mouseleave",E(this,ee));E(this,ie).hidden=!0,Oe&&le(this,Be,pn).call(this)}render(){if(E(this,He))return;const{page:{view:G},viewport:{rawDims:{pageWidth:I,pageHeight:Z,pageX:H,pageY:J}}}=E(this,Ve),ce=Se(this,He,document.createElement("div"));if(ce.className="popup",E(this,Ae)){const tt=ce.style.outlineColor=n.Util.makeHexColor(...E(this,Ae));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?ce.style.backgroundColor=`color-mix(in srgb, ${tt} 30%, white)`:ce.style.backgroundColor=n.Util.makeHexColor(...E(this,Ae).map(lt=>Math.floor(.7*(255-lt)+lt)))}const ke=document.createElement("span");ke.className="header";const X=document.createElement("h1");if(ke.append(X),{dir:X.dir,str:X.textContent}=E(this,fe),ce.append(ke),E(this,W)){const tt=document.createElement("span");tt.classList.add("popupDate"),E(this,W).then(ct=>{tt.textContent=ct}),ke.append(tt)}const oe=E(this,ye),pe=E(this,be);if(pe!=null&&pe.str&&(!(oe!=null&&oe.str)||oe.str===pe.str))c.XfaLayer.render({xfaHtml:pe.html,intent:"richText",div:ce}),ce.lastChild.classList.add("richText","popupContent");else{const tt=this._formatContents(oe);ce.append(tt)}let De=!!E(this,We),Oe=De?E(this,We):E(this,Me);for(const tt of E(this,xe))if(!Oe||n.Util.intersect(tt.data.rect,Oe)!==null){Oe=tt.data.rect,De=!0;break}const Fe=n.Util.normalizeRect([Oe[0],G[3]-Oe[1]+G[1],Oe[2],G[3]-Oe[3]+G[1]]),Ue=5,Ye=De?Oe[2]-Oe[0]+Ue:0,Je=Fe[0]+Ye,et=Fe[1],{style:it}=E(this,ie);it.left=`${100*(Je-H)/I}%`,it.top=`${100*(et-J)/Z}%`,E(this,ie).append(ce)}_formatContents(G){let{str:I,dir:Z}=G;const H=document.createElement("p");H.classList.add("popupContent"),H.dir=Z;const J=I.split(/(?:\r\n?|\n)/);for(let ce=0,ke=J.length;ce<ke;++ce){const X=J[ce];H.append(document.createTextNode(X)),ce<ke-1&&H.append(document.createElement("br"))}return H}forceHide(){Se(this,Ee,this.isVisible),E(this,Ee)&&(E(this,ie).hidden=!0)}maybeShow(){E(this,Ee)&&(Se(this,Ee,!1),E(this,ie).hidden=!1)}get isVisible(){return E(this,ie).hidden===!1}}W=new WeakMap,ee=new WeakMap,me=new WeakMap,he=new WeakMap,Ae=new WeakMap,ie=new WeakMap,ye=new WeakMap,xe=new WeakMap,Ve=new WeakMap,We=new WeakMap,Pe=new WeakMap,He=new WeakMap,Me=new WeakMap,be=new WeakMap,fe=new WeakMap,Ee=new WeakMap,Be=new WeakSet,pn=function(){Se(this,Pe,!E(this,Pe)),E(this,Pe)?(le(this,Re,mn).call(this),E(this,ie).addEventListener("click",E(this,he))):(le(this,Ie,gn).call(this),E(this,ie).removeEventListener("click",E(this,he)))},Re=new WeakSet,mn=function(){E(this,He)||this.render(),this.isVisible?E(this,Pe)&&E(this,ie).classList.add("focused"):(E(this,ie).hidden=!1,E(this,ie).style.zIndex=parseInt(E(this,ie).style.zIndex)+1e3)},Ie=new WeakSet,gn=function(){E(this,ie).classList.remove("focused"),!(E(this,Pe)||!this.isVisible)&&(E(this,ie).hidden=!0,E(this,ie).style.zIndex=parseInt(E(this,ie).style.zIndex)-1e3)};class M extends h{constructor(G){var Z,H,J;const I=!!(G.data.popupRef||(Z=G.data.titleObj)!=null&&Z.str||(H=G.data.contentsObj)!=null&&H.str||(J=G.data.richText)!=null&&J.str);super(G,{isRenderable:I,ignoreBorder:!0}),this.textContent=G.data.textContent,this.textPosition=G.data.textPosition,this.annotationEditorType=n.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const G=document.createElement("div");G.classList.add("annotationTextContent"),G.setAttribute("role","comment");for(const I of this.textContent){const Z=document.createElement("span");Z.textContent=I,G.append(Z)}this.container.append(G)}return this.data.popupRef||this._createPopup(),this._editOnDoubleClick(),this.container}}e.FreeTextAnnotationElement=M;class P extends h{constructor(I){var H,J,ce;const Z=!!(I.data.popupRef||(H=I.data.titleObj)!=null&&H.str||(J=I.data.contentsObj)!=null&&J.str||(ce=I.data.richText)!=null&&ce.str);super(I,{isRenderable:Z,ignoreBorder:!0});se(this,Ze,null)}render(){this.container.classList.add("lineAnnotation");const I=this.data,{width:Z,height:H}=m(I.rect),J=this.svgFactory.create(Z,H,!0),ce=Se(this,Ze,this.svgFactory.createElement("svg:line"));return ce.setAttribute("x1",I.rect[2]-I.lineCoordinates[0]),ce.setAttribute("y1",I.rect[3]-I.lineCoordinates[1]),ce.setAttribute("x2",I.rect[2]-I.lineCoordinates[2]),ce.setAttribute("y2",I.rect[3]-I.lineCoordinates[3]),ce.setAttribute("stroke-width",I.borderStyle.width||1),ce.setAttribute("stroke","transparent"),ce.setAttribute("fill","transparent"),J.append(ce),this.container.append(J),I.popupRef||this._createPopup(),this.container}getElementsToTriggerPopup(){return E(this,Ze)}addHighlightArea(){this.container.classList.add("highlightArea")}}Ze=new WeakMap;class $ extends h{constructor(I){var H,J,ce;const Z=!!(I.data.popupRef||(H=I.data.titleObj)!=null&&H.str||(J=I.data.contentsObj)!=null&&J.str||(ce=I.data.richText)!=null&&ce.str);super(I,{isRenderable:Z,ignoreBorder:!0});se(this,Ke,null)}render(){this.container.classList.add("squareAnnotation");const I=this.data,{width:Z,height:H}=m(I.rect),J=this.svgFactory.create(Z,H,!0),ce=I.borderStyle.width,ke=Se(this,Ke,this.svgFactory.createElement("svg:rect"));return ke.setAttribute("x",ce/2),ke.setAttribute("y",ce/2),ke.setAttribute("width",Z-ce),ke.setAttribute("height",H-ce),ke.setAttribute("stroke-width",ce||1),ke.setAttribute("stroke","transparent"),ke.setAttribute("fill","transparent"),J.append(ke),this.container.append(J),I.popupRef||this._createPopup(),this.container}getElementsToTriggerPopup(){return E(this,Ke)}addHighlightArea(){this.container.classList.add("highlightArea")}}Ke=new WeakMap;class K extends h{constructor(I){var H,J,ce;const Z=!!(I.data.popupRef||(H=I.data.titleObj)!=null&&H.str||(J=I.data.contentsObj)!=null&&J.str||(ce=I.data.richText)!=null&&ce.str);super(I,{isRenderable:Z,ignoreBorder:!0});se(this,qe,null)}render(){this.container.classList.add("circleAnnotation");const I=this.data,{width:Z,height:H}=m(I.rect),J=this.svgFactory.create(Z,H,!0),ce=I.borderStyle.width,ke=Se(this,qe,this.svgFactory.createElement("svg:ellipse"));return ke.setAttribute("cx",Z/2),ke.setAttribute("cy",H/2),ke.setAttribute("rx",Z/2-ce/2),ke.setAttribute("ry",H/2-ce/2),ke.setAttribute("stroke-width",ce||1),ke.setAttribute("stroke","transparent"),ke.setAttribute("fill","transparent"),J.append(ke),this.container.append(J),I.popupRef||this._createPopup(),this.container}getElementsToTriggerPopup(){return E(this,qe)}addHighlightArea(){this.container.classList.add("highlightArea")}}qe=new WeakMap;class L extends h{constructor(I){var H,J,ce;const Z=!!(I.data.popupRef||(H=I.data.titleObj)!=null&&H.str||(J=I.data.contentsObj)!=null&&J.str||(ce=I.data.richText)!=null&&ce.str);super(I,{isRenderable:Z,ignoreBorder:!0});se(this,we,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const I=this.data,{width:Z,height:H}=m(I.rect),J=this.svgFactory.create(Z,H,!0);let ce=[];for(const X of I.vertices){const oe=X.x-I.rect[0],pe=I.rect[3]-X.y;ce.push(oe+","+pe)}ce=ce.join(" ");const ke=Se(this,we,this.svgFactory.createElement(this.svgElementName));return ke.setAttribute("points",ce),ke.setAttribute("stroke-width",I.borderStyle.width||1),ke.setAttribute("stroke","transparent"),ke.setAttribute("fill","transparent"),J.append(ke),this.container.append(J),I.popupRef||this._createPopup(ke,I),this.container}getElementsToTriggerPopup(){return E(this,we)}addHighlightArea(){this.container.classList.add("highlightArea")}}we=new WeakMap;class j extends L{constructor(G){super(G),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class q extends h{constructor(G){var Z,H,J;const I=!!(G.data.popupRef||(Z=G.data.titleObj)!=null&&Z.str||(H=G.data.contentsObj)!=null&&H.str||(J=G.data.richText)!=null&&J.str);super(G,{isRenderable:I,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),this.data.popupRef||this._createPopup(),this.container}}class te extends h{constructor(I){var H,J,ce;const Z=!!(I.data.popupRef||(H=I.data.titleObj)!=null&&H.str||(J=I.data.contentsObj)!=null&&J.str||(ce=I.data.richText)!=null&&ce.str);super(I,{isRenderable:Z,ignoreBorder:!0});se(this,ue,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=n.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const I=this.data,{width:Z,height:H}=m(I.rect),J=this.svgFactory.create(Z,H,!0);for(const ce of I.inkLists){let ke=[];for(const oe of ce){const pe=oe.x-I.rect[0],De=I.rect[3]-oe.y;ke.push(`${pe},${De}`)}ke=ke.join(" ");const X=this.svgFactory.createElement(this.svgElementName);E(this,ue).push(X),X.setAttribute("points",ke),X.setAttribute("stroke-width",I.borderStyle.width||1),X.setAttribute("stroke","transparent"),X.setAttribute("fill","transparent"),I.popupRef||this._createPopup(X,I),J.append(X)}return this.container.append(J),this.container}getElementsToTriggerPopup(){return E(this,ue)}addHighlightArea(){this.container.classList.add("highlightArea")}}ue=new WeakMap,e.InkAnnotationElement=te;class F extends h{constructor(G){var Z,H,J;const I=!!(G.data.popupRef||(Z=G.data.titleObj)!=null&&Z.str||(H=G.data.contentsObj)!=null&&H.str||(J=G.data.richText)!=null&&J.str);super(G,{isRenderable:I,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.popupRef||this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class z extends h{constructor(G){var Z,H,J;const I=!!(G.data.popupRef||(Z=G.data.titleObj)!=null&&Z.str||(H=G.data.contentsObj)!=null&&H.str||(J=G.data.richText)!=null&&J.str);super(G,{isRenderable:I,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.popupRef||this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class Q extends h{constructor(G){var Z,H,J;const I=!!(G.data.popupRef||(Z=G.data.titleObj)!=null&&Z.str||(H=G.data.contentsObj)!=null&&H.str||(J=G.data.richText)!=null&&J.str);super(G,{isRenderable:I,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.popupRef||this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class ne extends h{constructor(G){var Z,H,J;const I=!!(G.data.popupRef||(Z=G.data.titleObj)!=null&&Z.str||(H=G.data.contentsObj)!=null&&H.str||(J=G.data.richText)!=null&&J.str);super(G,{isRenderable:I,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.popupRef||this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class de extends h{constructor(G){var Z,H,J;const I=!!(G.data.popupRef||(Z=G.data.titleObj)!=null&&Z.str||(H=G.data.contentsObj)!=null&&H.str||(J=G.data.richText)!=null&&J.str);super(G,{isRenderable:I,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),this.data.popupRef||this._createPopup(),this.container}}e.StampAnnotationElement=de;class U extends h{constructor(I){var J;super(I,{isRenderable:!0});se(this,ae,null);const{filename:Z,content:H}=this.data.file;this.filename=(0,s.getFilenameFromUrl)(Z,!0),this.content=H,(J=this.linkService.eventBus)==null||J.dispatch("fileattachmentannotation",{source:this,filename:Z,content:H})}render(){var H,J;this.container.classList.add("fileAttachmentAnnotation");const{data:I}=this;let Z;return I.hasAppearance||I.fillAlpha===0?Z=document.createElement("div"):(Z=document.createElement("img"),Z.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(I.name)?"paperclip":"pushpin"}.svg`,I.fillAlpha&&I.fillAlpha<1&&(Z.style=`filter: opacity(${Math.round(I.fillAlpha*100)}%);`)),Z.classList.add("popupTriggerArea"),Z.addEventListener("dblclick",this._download.bind(this)),Se(this,ae,Z),!I.popupRef&&((H=I.titleObj)!=null&&H.str||(J=I.contentsObj)!=null&&J.str||I.richText)&&this._createPopup(),this.container.append(Z),this.container}getElementsToTriggerPopup(){return E(this,ae)}addHighlightArea(){this.container.classList.add("highlightArea")}_download(){var I;(I=this.downloadManager)==null||I.openOrDownloadData(this.container,this.content,this.filename)}}ae=new WeakMap;class w{constructor(G){se(this,ve);se(this,_e);se(this,ze,null);se(this,$e,null);se(this,nt,new Map);let{div:I,accessibilityManager:Z,annotationCanvasMap:H,l10n:J,page:ce,viewport:ke}=G;this.div=I,Se(this,ze,Z),Se(this,$e,H),this.l10n=J,this.page=ce,this.viewport=ke,this.zIndex=0,this.l10n||(this.l10n=o.NullL10n)}async render(G){const{annotations:I}=G,Z=this.div;(0,s.setLayerDimensions)(Z,this.viewport);const H=new Map,J={data:null,layer:Z,linkService:G.linkService,downloadManager:G.downloadManager,imageResourcesPath:G.imageResourcesPath||"",renderForms:G.renderForms!==!1,svgFactory:new s.DOMSVGFactory,annotationStorage:G.annotationStorage||new i.AnnotationStorage,enableScripting:G.enableScripting===!0,hasJSActions:G.hasJSActions,fieldObjects:G.fieldObjects,parent:this,elements:null};for(const ce of I){if(ce.noHTML)continue;const ke=ce.annotationType===n.AnnotationType.POPUP;if(ke){const pe=H.get(ce.id);if(!pe)continue;J.elements=pe}else{const{width:pe,height:De}=m(ce.rect);if(pe<=0||De<=0)continue}J.data=ce;const X=y.create(J);if(!X.isRenderable)continue;if(!ke&&ce.popupRef){const pe=H.get(ce.popupRef);pe?pe.push(X):H.set(ce.popupRef,[X])}X.annotationEditorType>0&&E(this,nt).set(X.data.id,X);const oe=X.render();ce.hidden&&(oe.style.visibility="hidden"),le(this,ve,Kn).call(this,oe,ce.id)}le(this,_e,vn).call(this),await this.l10n.translate(Z)}update(G){let{viewport:I}=G;const Z=this.div;this.viewport=I,(0,s.setLayerDimensions)(Z,{rotation:I.rotation}),le(this,_e,vn).call(this),Z.hidden=!1}getEditableAnnotations(){return Array.from(E(this,nt).values())}getEditableAnnotation(G){return E(this,nt).get(G)}}ze=new WeakMap,$e=new WeakMap,nt=new WeakMap,ve=new WeakSet,Kn=function(G,I){var H;const Z=G.firstChild||G;Z.id=`${s.AnnotationPrefix}${I}`,this.div.append(G),(H=E(this,ze))==null||H.moveElementInDOM(this.div,G,Z,!1)},_e=new WeakSet,vn=function(){if(!E(this,$e))return;const G=this.div;for(const[I,Z]of E(this,$e)){const H=G.querySelector(`[data-annotation-id="${I}"]`);if(!H)continue;const{firstChild:J}=H;J?J.nodeName==="CANVAS"?J.replaceWith(Z):J.before(Z):H.append(Z)}E(this,$e).clear()},e.AnnotationLayer=w},(r,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ColorConverters=void 0;function t(i){return Math.floor(Math.max(0,Math.min(1,i))*255).toString(16).padStart(2,"0")}function n(i){return Math.max(0,Math.min(255,255*i))}class s{static CMYK_G(a){let[o,c,l,u]=a;return["G",1-Math.min(1,.3*o+.59*l+.11*c+u)]}static G_CMYK(a){let[o]=a;return["CMYK",0,0,0,1-o]}static G_RGB(a){let[o]=a;return["RGB",o,o,o]}static G_rgb(a){let[o]=a;return o=n(o),[o,o,o]}static G_HTML(a){let[o]=a;const c=t(o);return`#${c}${c}${c}`}static RGB_G(a){let[o,c,l]=a;return["G",.3*o+.59*c+.11*l]}static RGB_rgb(a){return a.map(n)}static RGB_HTML(a){return`#${a.map(t).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB(a){let[o,c,l,u]=a;return["RGB",1-Math.min(1,o+u),1-Math.min(1,l+u),1-Math.min(1,c+u)]}static CMYK_rgb(a){let[o,c,l,u]=a;return[n(1-Math.min(1,o+u)),n(1-Math.min(1,l+u)),n(1-Math.min(1,c+u))]}static CMYK_HTML(a){const o=this.CMYK_RGB(a).slice(1);return this.RGB_HTML(o)}static RGB_CMYK(a){let[o,c,l]=a;const u=1-o,d=1-c,m=1-l,y=Math.min(u,d,m);return["CMYK",u,d,m,y]}}e.ColorConverters=s},(r,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.NullL10n=void 0,e.getL10nFallback=n;const t={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}} × {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}} × {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing…",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image"};t.print_progress_percent="{{progress}}%";function n(a,o){switch(a){case"find_match_count":a=`find_match_count[${o.total===1?"one":"other"}]`;break;case"find_match_count_limit":a=`find_match_count_limit[${o.limit===1?"one":"other"}]`;break}return t[a]||""}function s(a,o){return o?a.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(c,l)=>l in o?o[l]:"{{"+l+"}}"):a}const i={async getLanguage(){return"en-us"},async getDirection(){return"ltr"},async get(a){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n(a,o);return s(c,o)},async translate(a){}};e.NullL10n=i},(r,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.XfaLayer=void 0,t(89);var n=t(194);class s{static setupStorage(a,o,c,l,u){const d=l.getValue(o,{value:null});switch(c.name){case"textarea":if(d.value!==null&&(a.textContent=d.value),u==="print")break;a.addEventListener("input",m=>{l.setValue(o,{value:m.target.value})});break;case"input":if(c.attributes.type==="radio"||c.attributes.type==="checkbox"){if(d.value===c.attributes.xfaOn?a.setAttribute("checked",!0):d.value===c.attributes.xfaOff&&a.removeAttribute("checked"),u==="print")break;a.addEventListener("change",m=>{l.setValue(o,{value:m.target.checked?m.target.getAttribute("xfaOn"):m.target.getAttribute("xfaOff")})})}else{if(d.value!==null&&a.setAttribute("value",d.value),u==="print")break;a.addEventListener("input",m=>{l.setValue(o,{value:m.target.value})})}break;case"select":if(d.value!==null){a.setAttribute("value",d.value);for(const m of c.children)m.attributes.value===d.value?m.attributes.selected=!0:m.attributes.hasOwnProperty("selected")&&delete m.attributes.selected}a.addEventListener("input",m=>{const y=m.target.options,h=y.selectedIndex===-1?"":y[y.selectedIndex].value;l.setValue(o,{value:h})});break}}static setAttributes(a){let{html:o,element:c,storage:l=null,intent:u,linkService:d}=a;const{attributes:m}=c,y=o instanceof HTMLAnchorElement;m.type==="radio"&&(m.name=`${m.name}-${u}`);for(const[h,p]of Object.entries(m))if(p!=null)switch(h){case"class":p.length&&o.setAttribute(h,p.join(" "));break;case"dataId":break;case"id":o.setAttribute("data-element-id",p);break;case"style":Object.assign(o.style,p);break;case"textContent":o.textContent=p;break;default:(!y||h!=="href"&&h!=="newWindow")&&o.setAttribute(h,p)}y&&d.addLinkAttributes(o,m.href,m.newWindow),l&&m.dataId&&this.setupStorage(o,m.dataId,c,l)}static render(a){var p;const o=a.annotationStorage,c=a.linkService,l=a.xfaHtml,u=a.intent||"display",d=document.createElement(l.name);l.attributes&&this.setAttributes({html:d,element:l,intent:u,linkService:c});const m=[[l,-1,d]],y=a.div;if(y.append(d),a.viewport){const f=`matrix(${a.viewport.transform.join(",")})`;y.style.transform=f}u!=="richText"&&y.setAttribute("class","xfaLayer xfaFont");const h=[];for(;m.length>0;){const[f,v,_]=m.at(-1);if(v+1===f.children.length){m.pop();continue}const O=f.children[++m.at(-1)[1]];if(O===null)continue;const{name:k}=O;if(k==="#text"){const b=document.createTextNode(O.value);h.push(b),_.append(b);continue}const g=(p=O==null?void 0:O.attributes)!=null&&p.xmlns?document.createElementNS(O.attributes.xmlns,k):document.createElement(k);if(_.append(g),O.attributes&&this.setAttributes({html:g,element:O,storage:o,intent:u,linkService:c}),O.children&&O.children.length>0)m.push([O,-1,g]);else if(O.value){const b=document.createTextNode(O.value);n.XfaText.shouldBuildText(k)&&h.push(b),g.append(b)}}for(const f of y.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))f.setAttribute("readOnly",!0);return{textDivs:h}}static update(a){const o=`matrix(${a.viewport.transform.join(",")})`;a.div.style.transform=o,a.div.hidden=!1}}e.XfaLayer=s},(r,e,t)=>{var c,l,u,d,m,y,h,p,f,v,_,O,k,g,b,N,Zn,T,Qn,P,qn,K,Jn,j,yn,te,er,z,An,ne,tr,U,nr,x,rr,V,sr,Y,ir,ee,pt,he,bn,ie,Ut,xe,$t,We,_t,He,Sn,be,zt,Ee,ar,Ge,Tn,Ce,or,ge,cr,Ke,Cn,we,Gt,ae,Et;Object.defineProperty(e,"__esModule",{value:!0}),e.InkEditor=void 0,t(89),t(2);var n=t(1),s=t(164),i=t(198),a=t(165);const $e=class $e extends s.AnnotationEditor{constructor(re){super({...re,name:"inkEditor"});se(this,N);se(this,T);se(this,P);se(this,K);se(this,j);se(this,te);se(this,z);se(this,ne);se(this,U);se(this,x);se(this,V);se(this,Y);se(this,ee);se(this,he);se(this,ie);se(this,xe);se(this,We);se(this,He);se(this,be);se(this,ge);se(this,Ke);se(this,we);se(this,ae);se(this,c,0);se(this,l,0);se(this,u,this.canvasContextMenu.bind(this));se(this,d,this.canvasPointermove.bind(this));se(this,m,this.canvasPointerleave.bind(this));se(this,y,this.canvasPointerup.bind(this));se(this,h,this.canvasPointerdown.bind(this));se(this,p,new Path2D);se(this,f,!1);se(this,v,!1);se(this,_,!1);se(this,O,null);se(this,k,0);se(this,g,0);se(this,b,null);this.color=re.color||null,this.thickness=re.thickness||null,this.opacity=re.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(re){this._l10nPromise=new Map(["editor_ink_canvas_aria_label","editor_ink2_aria_label"].map(_e=>[_e,re.get(_e)]))}static updateDefaultParams(re,_e){switch(re){case n.AnnotationEditorParamsType.INK_THICKNESS:$e._defaultThickness=_e;break;case n.AnnotationEditorParamsType.INK_COLOR:$e._defaultColor=_e;break;case n.AnnotationEditorParamsType.INK_OPACITY:$e._defaultOpacity=_e/100;break}}updateParams(re,_e){switch(re){case n.AnnotationEditorParamsType.INK_THICKNESS:le(this,N,Zn).call(this,_e);break;case n.AnnotationEditorParamsType.INK_COLOR:le(this,T,Qn).call(this,_e);break;case n.AnnotationEditorParamsType.INK_OPACITY:le(this,P,qn).call(this,_e);break}}static get defaultPropertiesToUpdate(){return[[n.AnnotationEditorParamsType.INK_THICKNESS,$e._defaultThickness],[n.AnnotationEditorParamsType.INK_COLOR,$e._defaultColor||s.AnnotationEditor._defaultLineColor],[n.AnnotationEditorParamsType.INK_OPACITY,Math.round($e._defaultOpacity*100)]]}get propertiesToUpdate(){return[[n.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||$e._defaultThickness],[n.AnnotationEditorParamsType.INK_COLOR,this.color||$e._defaultColor||s.AnnotationEditor._defaultLineColor],[n.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??$e._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(le(this,ie,Ut).call(this),le(this,xe,$t).call(this)),this.isAttachedToDOM||(this.parent.add(this),le(this,We,_t).call(this)),le(this,ae,Et).call(this)))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,E(this,O).disconnect(),Se(this,O,null),super.remove())}setParent(re){!this.parent&&re?this._uiManager.removeShouldRescale(this):this.parent&&re===null&&this._uiManager.addShouldRescale(this),super.setParent(re)}onScaleChanging(){const[re,_e]=this.parentDimensions,Le=this.width*re,Te=this.height*_e;this.setDimensions(Le,Te)}enableEditMode(){E(this,f)||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",E(this,h)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",E(this,h)))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){E(this,f)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),Se(this,f,!0),this.div.classList.add("disabled"),le(this,ae,Et).call(this,!0),this.makeResizable(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(re){this._focusEventsAllowed&&(super.focusin(re),this.enableEditMode())}canvasPointerdown(re){re.button!==0||!this.isInEditMode()||E(this,f)||(this.setInForeground(),re.preventDefault(),re.type!=="mouse"&&this.div.focus(),le(this,te,er).call(this,re.offsetX,re.offsetY))}canvasContextMenu(re){re.preventDefault()}canvasPointermove(re){re.preventDefault(),le(this,z,An).call(this,re.offsetX,re.offsetY)}canvasPointerup(re){re.preventDefault(),le(this,he,bn).call(this,re)}canvasPointerleave(re){le(this,he,bn).call(this,re)}get isResizable(){return!this.isEmpty()&&E(this,f)}render(){if(this.div)return this.div;let re,_e;this.width&&(re=this.x,_e=this.y),super.render(),$e._l10nPromise.get("editor_ink2_aria_label").then(Z=>{var H;return(H=this.div)==null?void 0:H.setAttribute("aria-label",Z)});const[Le,Te,G,I]=le(this,K,Jn).call(this);if(this.setAt(Le,Te,0,0),this.setDims(G,I),le(this,ie,Ut).call(this),this.width){const[Z,H]=this.parentDimensions;this.setAspectRatio(this.width*Z,this.height*H),this.setAt(re*Z,_e*H,this.width*Z,this.height*H),Se(this,_,!0),le(this,We,_t).call(this),this.setDims(this.width*Z,this.height*H),le(this,ee,pt).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return le(this,xe,$t).call(this),this.div}setDimensions(re,_e){const Le=Math.round(re),Te=Math.round(_e);if(E(this,k)===Le&&E(this,g)===Te)return;Se(this,k,Le),Se(this,g,Te),this.canvas.style.visibility="hidden";const[G,I]=this.parentDimensions;this.width=re/G,this.height=_e/I,this.fixAndSetPosition(),E(this,f)&&le(this,He,Sn).call(this,re,_e),le(this,We,_t).call(this),le(this,ee,pt).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(re,_e,Le){var De,Oe,Fe;if(re instanceof i.InkAnnotationElement)return null;const Te=super.deserialize(re,_e,Le);Te.thickness=re.thickness,Te.color=n.Util.makeHexColor(...re.color),Te.opacity=re.opacity;const[G,I]=Te.pageDimensions,Z=Te.width*G,H=Te.height*I,J=Te.parentScale,ce=re.thickness/2;Se(Te,f,!0),Se(Te,k,Math.round(Z)),Se(Te,g,Math.round(H));const{paths:ke,rect:X,rotation:oe}=re;for(let{bezier:Ue}of ke){Ue=le(De=$e,Ce,or).call(De,Ue,X,oe);const Ye=[];Te.paths.push(Ye);let Je=J*(Ue[0]-ce),et=J*(Ue[1]-ce);for(let tt=2,ct=Ue.length;tt<ct;tt+=6){const lt=J*(Ue[tt]-ce),ht=J*(Ue[tt+1]-ce),dt=J*(Ue[tt+2]-ce),yt=J*(Ue[tt+3]-ce),mt=J*(Ue[tt+4]-ce),wt=J*(Ue[tt+5]-ce);Ye.push([[Je,et],[lt,ht],[dt,yt],[mt,wt]]),Je=mt,et=wt}const it=le(this,Ee,ar).call(this,Ye);Te.bezierPath2D.push(it)}const pe=le(Oe=Te,Ke,Cn).call(Oe);return Se(Te,l,Math.max(s.AnnotationEditor.MIN_SIZE,pe[2]-pe[0])),Se(Te,c,Math.max(s.AnnotationEditor.MIN_SIZE,pe[3]-pe[1])),le(Fe=Te,He,Sn).call(Fe,Z,H),Te}serialize(){if(this.isEmpty())return null;const re=this.getRect(0,0),_e=s.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:n.AnnotationEditorType.INK,color:_e,thickness:this.thickness,opacity:this.opacity,paths:le(this,ge,cr).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,re),pageIndex:this.pageIndex,rect:re,rotation:this.rotation}}};c=new WeakMap,l=new WeakMap,u=new WeakMap,d=new WeakMap,m=new WeakMap,y=new WeakMap,h=new WeakMap,p=new WeakMap,f=new WeakMap,v=new WeakMap,_=new WeakMap,O=new WeakMap,k=new WeakMap,g=new WeakMap,b=new WeakMap,N=new WeakSet,Zn=function(re){const _e=this.thickness;this.addCommands({cmd:()=>{this.thickness=re,le(this,ae,Et).call(this)},undo:()=>{this.thickness=_e,le(this,ae,Et).call(this)},mustExec:!0,type:n.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},T=new WeakSet,Qn=function(re){const _e=this.color;this.addCommands({cmd:()=>{this.color=re,le(this,ee,pt).call(this)},undo:()=>{this.color=_e,le(this,ee,pt).call(this)},mustExec:!0,type:n.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},P=new WeakSet,qn=function(re){re/=100;const _e=this.opacity;this.addCommands({cmd:()=>{this.opacity=re,le(this,ee,pt).call(this)},undo:()=>{this.opacity=_e,le(this,ee,pt).call(this)},mustExec:!0,type:n.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},K=new WeakSet,Jn=function(){const{parentRotation:re,parentDimensions:[_e,Le]}=this;switch(re){case 90:return[0,Le,Le,_e];case 180:return[_e,Le,_e,Le];case 270:return[_e,0,Le,_e];default:return[0,0,_e,Le]}},j=new WeakSet,yn=function(){const{ctx:re,color:_e,opacity:Le,thickness:Te,parentScale:G,scaleFactor:I}=this;re.lineWidth=Te*G/I,re.lineCap="round",re.lineJoin="round",re.miterLimit=10,re.strokeStyle=`${_e}${(0,a.opacityToHex)(Le)}`},te=new WeakSet,er=function(re,_e){this.canvas.addEventListener("contextmenu",E(this,u)),this.canvas.addEventListener("pointerleave",E(this,m)),this.canvas.addEventListener("pointermove",E(this,d)),this.canvas.addEventListener("pointerup",E(this,y)),this.canvas.removeEventListener("pointerdown",E(this,h)),this.isEditing=!0,E(this,_)||(Se(this,_,!0),le(this,We,_t).call(this),this.thickness||(this.thickness=$e._defaultThickness),this.color||(this.color=$e._defaultColor||s.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=$e._defaultOpacity)),this.currentPath.push([re,_e]),Se(this,v,!1),le(this,j,yn).call(this),Se(this,b,()=>{le(this,x,rr).call(this),E(this,b)&&window.requestAnimationFrame(E(this,b))}),window.requestAnimationFrame(E(this,b))},z=new WeakSet,An=function(re,_e){const[Le,Te]=this.currentPath.at(-1);if(this.currentPath.length>1&&re===Le&&_e===Te)return;const G=this.currentPath;let I=E(this,p);if(G.push([re,_e]),Se(this,v,!0),G.length<=2){I.moveTo(...G[0]),I.lineTo(re,_e);return}G.length===3&&(Se(this,p,I=new Path2D),I.moveTo(...G[0])),le(this,V,sr).call(this,I,...G.at(-3),...G.at(-2),re,_e)},ne=new WeakSet,tr=function(){if(this.currentPath.length===0)return;const re=this.currentPath.at(-1);E(this,p).lineTo(...re)},U=new WeakSet,nr=function(re,_e){Se(this,b,null),re=Math.min(Math.max(re,0),this.canvas.width),_e=Math.min(Math.max(_e,0),this.canvas.height),le(this,z,An).call(this,re,_e),le(this,ne,tr).call(this);let Le;if(this.currentPath.length!==1)Le=le(this,Y,ir).call(this);else{const H=[re,_e];Le=[[H,H.slice(),H.slice(),H]]}const Te=E(this,p),G=this.currentPath;this.currentPath=[],Se(this,p,new Path2D);const I=()=>{this.allRawPaths.push(G),this.paths.push(Le),this.bezierPath2D.push(Te),this.rebuild()},Z=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(le(this,ie,Ut).call(this),le(this,xe,$t).call(this)),le(this,ae,Et).call(this))};this.addCommands({cmd:I,undo:Z,mustExec:!0})},x=new WeakSet,rr=function(){if(!E(this,v))return;Se(this,v,!1);const re=Math.ceil(this.thickness*this.parentScale),_e=this.currentPath.slice(-3),Le=_e.map(I=>I[0]),Te=_e.map(I=>I[1]);Math.min(...Le)-re,Math.max(...Le)+re,Math.min(...Te)-re,Math.max(...Te)+re;const{ctx:G}=this;G.save(),G.clearRect(0,0,this.canvas.width,this.canvas.height);for(const I of this.bezierPath2D)G.stroke(I);G.stroke(E(this,p)),G.restore()},V=new WeakSet,sr=function(re,_e,Le,Te,G,I,Z){const H=(_e+Te)/2,J=(Le+G)/2,ce=(Te+I)/2,ke=(G+Z)/2;re.bezierCurveTo(H+2*(Te-H)/3,J+2*(G-J)/3,ce+2*(Te-ce)/3,ke+2*(G-ke)/3,ce,ke)},Y=new WeakSet,ir=function(){const re=this.currentPath;if(re.length<=2)return[[re[0],re[0],re.at(-1),re.at(-1)]];const _e=[];let Le,[Te,G]=re[0];for(Le=1;Le<re.length-2;Le++){const[X,oe]=re[Le],[pe,De]=re[Le+1],Oe=(X+pe)/2,Fe=(oe+De)/2,Ue=[Te+2*(X-Te)/3,G+2*(oe-G)/3],Ye=[Oe+2*(X-Oe)/3,Fe+2*(oe-Fe)/3];_e.push([[Te,G],Ue,Ye,[Oe,Fe]]),[Te,G]=[Oe,Fe]}const[I,Z]=re[Le],[H,J]=re[Le+1],ce=[Te+2*(I-Te)/3,G+2*(Z-G)/3],ke=[H+2*(I-H)/3,J+2*(Z-J)/3];return _e.push([[Te,G],ce,ke,[H,J]]),_e},ee=new WeakSet,pt=function(){if(this.isEmpty()){le(this,be,zt).call(this);return}le(this,j,yn).call(this);const{canvas:re,ctx:_e}=this;_e.setTransform(1,0,0,1,0,0),_e.clearRect(0,0,re.width,re.height),le(this,be,zt).call(this);for(const Le of this.bezierPath2D)_e.stroke(Le)},he=new WeakSet,bn=function(re){this.canvas.removeEventListener("pointerleave",E(this,m)),this.canvas.removeEventListener("pointermove",E(this,d)),this.canvas.removeEventListener("pointerup",E(this,y)),this.canvas.addEventListener("pointerdown",E(this,h)),setTimeout(()=>{this.canvas.removeEventListener("contextmenu",E(this,u))},10),le(this,U,nr).call(this,re.offsetX,re.offsetY),this.addToAnnotationStorage(),this.setInBackground()},ie=new WeakSet,Ut=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",$e._l10nPromise.get("editor_ink_canvas_aria_label").then(re=>{var _e;return(_e=this.canvas)==null?void 0:_e.setAttribute("aria-label",re)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},xe=new WeakSet,$t=function(){Se(this,O,new ResizeObserver(re=>{const _e=re[0].contentRect;_e.width&&_e.height&&this.setDimensions(_e.width,_e.height)})),E(this,O).observe(this.div)},We=new WeakSet,_t=function(){if(!E(this,_))return;const[re,_e]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*re),this.canvas.height=Math.ceil(this.height*_e),le(this,be,zt).call(this)},He=new WeakSet,Sn=function(re,_e){const Le=le(this,we,Gt).call(this),Te=(re-Le)/E(this,l),G=(_e-Le)/E(this,c);this.scaleFactor=Math.min(Te,G)},be=new WeakSet,zt=function(){const re=le(this,we,Gt).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+re,this.translationY*this.scaleFactor+re)},Ee=new WeakSet,ar=function(re){const _e=new Path2D;for(let Le=0,Te=re.length;Le<Te;Le++){const[G,I,Z,H]=re[Le];Le===0&&_e.moveTo(...G),_e.bezierCurveTo(I[0],I[1],Z[0],Z[1],H[0],H[1])}return _e},Ge=new WeakSet,Tn=function(re,_e,Le){const[Te,G,I,Z]=_e;switch(Le){case 0:for(let H=0,J=re.length;H<J;H+=2)re[H]+=Te,re[H+1]=Z-re[H+1];break;case 90:for(let H=0,J=re.length;H<J;H+=2){const ce=re[H];re[H]=re[H+1]+Te,re[H+1]=ce+G}break;case 180:for(let H=0,J=re.length;H<J;H+=2)re[H]=I-re[H],re[H+1]+=G;break;case 270:for(let H=0,J=re.length;H<J;H+=2){const ce=re[H];re[H]=I-re[H+1],re[H+1]=Z-ce}break;default:throw new Error("Invalid rotation")}return re},Ce=new WeakSet,or=function(re,_e,Le){const[Te,G,I,Z]=_e;switch(Le){case 0:for(let H=0,J=re.length;H<J;H+=2)re[H]-=Te,re[H+1]=Z-re[H+1];break;case 90:for(let H=0,J=re.length;H<J;H+=2){const ce=re[H];re[H]=re[H+1]-G,re[H+1]=ce-Te}break;case 180:for(let H=0,J=re.length;H<J;H+=2)re[H]=I-re[H],re[H+1]-=G;break;case 270:for(let H=0,J=re.length;H<J;H+=2){const ce=re[H];re[H]=Z-re[H+1],re[H+1]=I-ce}break;default:throw new Error("Invalid rotation")}return re},ge=new WeakSet,cr=function(re,_e,Le,Te){var J,ce;const G=[],I=this.thickness/2,Z=re*_e+I,H=re*Le+I;for(const ke of this.paths){const X=[],oe=[];for(let pe=0,De=ke.length;pe<De;pe++){const[Oe,Fe,Ue,Ye]=ke[pe],Je=re*Oe[0]+Z,et=re*Oe[1]+H,it=re*Fe[0]+Z,tt=re*Fe[1]+H,ct=re*Ue[0]+Z,lt=re*Ue[1]+H,ht=re*Ye[0]+Z,dt=re*Ye[1]+H;pe===0&&(X.push(Je,et),oe.push(Je,et)),X.push(it,tt,ct,lt,ht,dt),oe.push(it,tt),pe===De-1&&oe.push(ht,dt)}G.push({bezier:le(J=$e,Ge,Tn).call(J,X,Te,this.rotation),points:le(ce=$e,Ge,Tn).call(ce,oe,Te,this.rotation)})}return G},Ke=new WeakSet,Cn=function(){let re=1/0,_e=-1/0,Le=1/0,Te=-1/0;for(const G of this.paths)for(const[I,Z,H,J]of G){const ce=n.Util.bezierBoundingBox(...I,...Z,...H,...J);re=Math.min(re,ce[0]),Le=Math.min(Le,ce[1]),_e=Math.max(_e,ce[2]),Te=Math.max(Te,ce[3])}return[re,Le,_e,Te]},we=new WeakSet,Gt=function(){return E(this,f)?Math.ceil(this.thickness*this.parentScale):0},ae=new WeakSet,Et=function(){let re=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isEmpty())return;if(!E(this,f)){le(this,ee,pt).call(this);return}const _e=le(this,Ke,Cn).call(this),Le=le(this,we,Gt).call(this);Se(this,l,Math.max(s.AnnotationEditor.MIN_SIZE,_e[2]-_e[0])),Se(this,c,Math.max(s.AnnotationEditor.MIN_SIZE,_e[3]-_e[1]));const Te=Math.ceil(Le+E(this,l)*this.scaleFactor),G=Math.ceil(Le+E(this,c)*this.scaleFactor),[I,Z]=this.parentDimensions;this.width=Te/I,this.height=G/Z,this.setAspectRatio(Te,G);const H=this.translationX,J=this.translationY;this.translationX=-_e[0],this.translationY=-_e[1],le(this,We,_t).call(this),le(this,ee,pt).call(this),Se(this,k,Te),Se(this,g,G),this.setDims(Te,G);const ce=re?Le/this.scaleFactor/2:0;this.translate(H-this.translationX-ce,J-this.translationY-ce)},se($e,Ee),se($e,Ge),se($e,Ce),rt($e,"_defaultColor",null),rt($e,"_defaultOpacity",1),rt($e,"_defaultThickness",1),rt($e,"_l10nPromise"),rt($e,"_type","ink");let o=$e;e.InkEditor=o},(r,e,t)=>{var c,l,u,d,m,y,h,p,f,v,_,It,k,Mt,b,Ht,S,_n,M,lr,$,ur,L,En,q,Xt,F,hr;Object.defineProperty(e,"__esModule",{value:!0}),e.StampEditor=void 0,t(149),t(152);var n=t(1),s=t(164),i=t(168),a=t(198);const Q=class Q extends s.AnnotationEditor{constructor(U){super({...U,name:"stampEditor"});se(this,_);se(this,k);se(this,b);se(this,S);se(this,M);se(this,$);se(this,L);se(this,q);se(this,F);se(this,c,null);se(this,l,null);se(this,u,null);se(this,d,null);se(this,m,null);se(this,y,null);se(this,h,null);se(this,p,null);se(this,f,!1);se(this,v,!1);Se(this,d,U.bitmapUrl),Se(this,m,U.bitmapFile)}static get supportedTypes(){const U=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,n.shadow)(this,"supportedTypes",U.map(w=>`image/${w}`))}static get supportedTypesStr(){return(0,n.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(U){return this.supportedTypes.includes(U)}static paste(U,w){w.pasteEditor(n.AnnotationEditorType.STAMP,{bitmapFile:U.getAsFile()})}remove(){var U,w;E(this,l)&&(Se(this,c,null),this._uiManager.imageManager.deleteId(E(this,l)),(U=E(this,y))==null||U.remove(),Se(this,y,null),(w=E(this,h))==null||w.disconnect(),Se(this,h,null)),super.remove()}rebuild(){if(!this.parent){E(this,l)&&le(this,b,Ht).call(this);return}super.rebuild(),this.div!==null&&(E(this,l)&&le(this,b,Ht).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(E(this,u)||E(this,c)||E(this,d)||E(this,m))}get isResizable(){return!0}render(){if(this.div)return this.div;let U,w;if(this.width&&(U=this.x,w=this.y),super.render(),this.div.hidden=!0,E(this,c)?le(this,S,_n).call(this):le(this,b,Ht).call(this),this.width){const[x,R]=this.parentDimensions;this.setAt(U*x,w*R,this.width*x,this.height*R)}return this.div}static deserialize(U,w,x){if(U instanceof a.StampAnnotationElement)return null;const R=super.deserialize(U,w,x),{rect:V,bitmapUrl:D,bitmapId:Y,isSvg:W}=U;Y&&x.imageManager.isValidId(Y)?Se(R,l,Y):Se(R,d,D),Se(R,f,W);const[ee,me]=R.pageDimensions;return R.width=(V[2]-V[0])/ee,R.height=(V[3]-V[1])/me,R}serialize(){let U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(this.isEmpty())return null;const x={annotationType:n.AnnotationEditorType.STAMP,bitmapId:E(this,l),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:E(this,f)};if(U)return x.bitmapUrl=le(this,q,Xt).call(this,!0),x;if(w===null)return x;w.stamps||(w.stamps=new Map);const R=E(this,f)?(x.rect[2]-x.rect[0])*(x.rect[3]-x.rect[1]):null;if(!w.stamps.has(E(this,l)))w.stamps.set(E(this,l),{area:R,serialized:x}),x.bitmap=le(this,q,Xt).call(this,!1);else if(E(this,f)){const V=w.stamps.get(E(this,l));R>V.area&&(V.area=R,V.serialized.bitmap.close(),V.serialized.bitmap=le(this,q,Xt).call(this,!1))}return x}};c=new WeakMap,l=new WeakMap,u=new WeakMap,d=new WeakMap,m=new WeakMap,y=new WeakMap,h=new WeakMap,p=new WeakMap,f=new WeakMap,v=new WeakMap,_=new WeakSet,It=function(U){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!U){this.remove();return}Se(this,c,U.bitmap),w||(Se(this,l,U.id),Se(this,f,U.isSvg)),le(this,S,_n).call(this)},k=new WeakSet,Mt=function(){Se(this,u,null),this._uiManager.enableWaiting(!1),E(this,y)&&this.div.focus()},b=new WeakSet,Ht=function(){if(E(this,l)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(E(this,l)).then(w=>le(this,_,It).call(this,w,!0)).finally(()=>le(this,k,Mt).call(this));return}if(E(this,d)){const w=E(this,d);Se(this,d,null),this._uiManager.enableWaiting(!0),Se(this,u,this._uiManager.imageManager.getFromUrl(w).then(x=>le(this,_,It).call(this,x)).finally(()=>le(this,k,Mt).call(this)));return}if(E(this,m)){const w=E(this,m);Se(this,m,null),this._uiManager.enableWaiting(!0),Se(this,u,this._uiManager.imageManager.getFromFile(w).then(x=>le(this,_,It).call(this,x)).finally(()=>le(this,k,Mt).call(this)));return}const U=document.createElement("input");U.type="file",U.accept=Q.supportedTypesStr,Se(this,u,new Promise(w=>{U.addEventListener("change",async()=>{if(!U.files||U.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const x=await this._uiManager.imageManager.getFromFile(U.files[0]);le(this,_,It).call(this,x)}w()}),U.addEventListener("cancel",()=>{this.remove(),w()})}).finally(()=>le(this,k,Mt).call(this))),U.click()},S=new WeakSet,_n=function(){const{div:U}=this;let{width:w,height:x}=E(this,c);const[R,V]=this.pageDimensions,D=.75;if(this.width)w=this.width*R,x=this.height*V;else if(w>D*R||x>D*V){const me=Math.min(D*R/w,D*V/x);w*=me,x*=me}const[Y,W]=this.parentDimensions;this.setDims(w*Y/R,x*W/V),this._uiManager.enableWaiting(!1);const ee=Se(this,y,document.createElement("canvas"));U.append(ee),U.hidden=!1,le(this,L,En).call(this,w,x),le(this,F,hr).call(this),E(this,v)||(this.parent.addUndoableEditor(this),Se(this,v,!0))},M=new WeakSet,lr=function(U,w){var D;const[x,R]=this.parentDimensions;this.width=U/x,this.height=w/R,this.setDims(U,w),(D=this._initialOptions)!=null&&D.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,E(this,p)!==null&&clearTimeout(E(this,p)),Se(this,p,setTimeout(()=>{Se(this,p,null),le(this,L,En).call(this,U,w)},200))},$=new WeakSet,ur=function(U,w){const{width:x,height:R}=E(this,c);let V=x,D=R,Y=E(this,c);for(;V>2*U||D>2*w;){const W=V,ee=D;V>2*U&&(V=V>=16384?Math.floor(V/2)-1:Math.ceil(V/2)),D>2*w&&(D=D>=16384?Math.floor(D/2)-1:Math.ceil(D/2));const me=new OffscreenCanvas(V,D);me.getContext("2d").drawImage(Y,0,0,W,ee,0,0,V,D),Y=me.transferToImageBitmap()}return Y},L=new WeakSet,En=function(U,w){U=Math.ceil(U),w=Math.ceil(w);const x=E(this,y);if(!x||x.width===U&&x.height===w)return;x.width=U,x.height=w;const R=E(this,f)?E(this,c):le(this,$,ur).call(this,U,w),V=x.getContext("2d");V.filter=this._uiManager.hcmFilter,V.drawImage(R,0,0,R.width,R.height,0,0,U,w)},q=new WeakSet,Xt=function(U){if(U){if(E(this,f)){const R=this._uiManager.imageManager.getSvgUrl(E(this,l));if(R)return R}const w=document.createElement("canvas");return{width:w.width,height:w.height}=E(this,c),w.getContext("2d").drawImage(E(this,c),0,0),w.toDataURL()}if(E(this,f)){const[w,x]=this.pageDimensions,R=Math.round(this.width*w*i.PixelsPerInch.PDF_TO_CSS_UNITS),V=Math.round(this.height*x*i.PixelsPerInch.PDF_TO_CSS_UNITS),D=new OffscreenCanvas(R,V);return D.getContext("2d").drawImage(E(this,c),0,0,E(this,c).width,E(this,c).height,0,0,R,V),D.transferToImageBitmap()}return structuredClone(E(this,c))},F=new WeakSet,hr=function(){Se(this,h,new ResizeObserver(U=>{const w=U[0].contentRect;w.width&&w.height&&le(this,M,lr).call(this,w.width,w.height)})),E(this,h).observe(this.div)},rt(Q,"_type","stamp");let o=Q;e.StampEditor=o}],__webpack_module_cache__={};function __w_pdfjs_require__(r){var e=__webpack_module_cache__[r];if(e!==void 0)return e.exports;var t=__webpack_module_cache__[r]={exports:{}};return __webpack_modules__[r].call(t.exports,t,t.exports,__w_pdfjs_require__),t.exports}var __webpack_exports__={};return(()=>{var r=__webpack_exports__;Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"AbortException",{enumerable:!0,get:function(){return e.AbortException}}),Object.defineProperty(r,"AnnotationEditorLayer",{enumerable:!0,get:function(){return i.AnnotationEditorLayer}}),Object.defineProperty(r,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return e.AnnotationEditorParamsType}}),Object.defineProperty(r,"AnnotationEditorType",{enumerable:!0,get:function(){return e.AnnotationEditorType}}),Object.defineProperty(r,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return a.AnnotationEditorUIManager}}),Object.defineProperty(r,"AnnotationLayer",{enumerable:!0,get:function(){return o.AnnotationLayer}}),Object.defineProperty(r,"AnnotationMode",{enumerable:!0,get:function(){return e.AnnotationMode}}),Object.defineProperty(r,"CMapCompressionType",{enumerable:!0,get:function(){return e.CMapCompressionType}}),Object.defineProperty(r,"FeatureTest",{enumerable:!0,get:function(){return e.FeatureTest}}),Object.defineProperty(r,"GlobalWorkerOptions",{enumerable:!0,get:function(){return c.GlobalWorkerOptions}}),Object.defineProperty(r,"ImageKind",{enumerable:!0,get:function(){return e.ImageKind}}),Object.defineProperty(r,"InvalidPDFException",{enumerable:!0,get:function(){return e.InvalidPDFException}}),Object.defineProperty(r,"MissingPDFException",{enumerable:!0,get:function(){return e.MissingPDFException}}),Object.defineProperty(r,"OPS",{enumerable:!0,get:function(){return e.OPS}}),Object.defineProperty(r,"PDFDataRangeTransport",{enumerable:!0,get:function(){return t.PDFDataRangeTransport}}),Object.defineProperty(r,"PDFDateString",{enumerable:!0,get:function(){return n.PDFDateString}}),Object.defineProperty(r,"PDFWorker",{enumerable:!0,get:function(){return t.PDFWorker}}),Object.defineProperty(r,"PasswordResponses",{enumerable:!0,get:function(){return e.PasswordResponses}}),Object.defineProperty(r,"PermissionFlag",{enumerable:!0,get:function(){return e.PermissionFlag}}),Object.defineProperty(r,"PixelsPerInch",{enumerable:!0,get:function(){return n.PixelsPerInch}}),Object.defineProperty(r,"PromiseCapability",{enumerable:!0,get:function(){return e.PromiseCapability}}),Object.defineProperty(r,"RenderingCancelledException",{enumerable:!0,get:function(){return n.RenderingCancelledException}}),Object.defineProperty(r,"SVGGraphics",{enumerable:!0,get:function(){return t.SVGGraphics}}),Object.defineProperty(r,"UnexpectedResponseException",{enumerable:!0,get:function(){return e.UnexpectedResponseException}}),Object.defineProperty(r,"Util",{enumerable:!0,get:function(){return e.Util}}),Object.defineProperty(r,"VerbosityLevel",{enumerable:!0,get:function(){return e.VerbosityLevel}}),Object.defineProperty(r,"XfaLayer",{enumerable:!0,get:function(){return l.XfaLayer}}),Object.defineProperty(r,"build",{enumerable:!0,get:function(){return t.build}}),Object.defineProperty(r,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return e.createValidAbsoluteUrl}}),Object.defineProperty(r,"getDocument",{enumerable:!0,get:function(){return t.getDocument}}),Object.defineProperty(r,"getFilenameFromUrl",{enumerable:!0,get:function(){return n.getFilenameFromUrl}}),Object.defineProperty(r,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return n.getPdfFilenameFromUrl}}),Object.defineProperty(r,"getXfaPageViewport",{enumerable:!0,get:function(){return n.getXfaPageViewport}}),Object.defineProperty(r,"isDataScheme",{enumerable:!0,get:function(){return n.isDataScheme}}),Object.defineProperty(r,"isPdfFile",{enumerable:!0,get:function(){return n.isPdfFile}}),Object.defineProperty(r,"loadScript",{enumerable:!0,get:function(){return n.loadScript}}),Object.defineProperty(r,"normalizeUnicode",{enumerable:!0,get:function(){return e.normalizeUnicode}}),Object.defineProperty(r,"renderTextLayer",{enumerable:!0,get:function(){return s.renderTextLayer}}),Object.defineProperty(r,"setLayerDimensions",{enumerable:!0,get:function(){return n.setLayerDimensions}}),Object.defineProperty(r,"shadow",{enumerable:!0,get:function(){return e.shadow}}),Object.defineProperty(r,"updateTextLayer",{enumerable:!0,get:function(){return s.updateTextLayer}}),Object.defineProperty(r,"version",{enumerable:!0,get:function(){return t.version}});var e=__w_pdfjs_require__(1),t=__w_pdfjs_require__(124),n=__w_pdfjs_require__(168),s=__w_pdfjs_require__(195),i=__w_pdfjs_require__(196),a=__w_pdfjs_require__(165),o=__w_pdfjs_require__(198),c=__w_pdfjs_require__(176),l=__w_pdfjs_require__(201)})(),__webpack_exports__})())})(pdf);var pdfExports=pdf.exports;const pdfjsWorkerURL="/acchymns-pr-PR_kwDOHpETuc5zAJ8i/assets/pdf.worker.min-4bff82a4.js",_sfc_main$2=defineComponent({__name:"PDFWrapper",props:{src:{}},emits:["error"],setup(r,{emit:e}){const t=r;pdfExports.GlobalWorkerOptions.workerSrc=pdfjsWorkerURL;let n=ref();return onMounted(async()=>{var i;let s;try{s=await pdfExports.getDocument(t.src).promise}catch{e("error");return}for(let a=1;a<=s.numPages;a++){let o=document.createElement("canvas"),c=await s.getPage(a);const l=Capacitor.getPlatform()=="web"?5:window.devicePixelRatio;let u=c.getViewport({scale:l});o.height=u.height,o.width=u.width;let d=o.getContext("2d");if(d===null){e("error");return}try{await c.render({canvasContext:d,viewport:u}).promise,o.style.width="100%";const m=o.toDataURL("image/png"),y=document.createElement("img");y.classList.add("song-img"),y.src=m,(i=n.value)==null||i.appendChild(y)}catch{e("error");return}}}),(s,i)=>(openBlock(),createElementBlock("div",{ref_key:"root",ref:n,class:"container"},null,512))}}),PDFWrapper_vue_vue_type_style_index_0_lang="",PDFWrapper_vue_vue_type_style_index_1_lang="",_withScopeId=r=>(pushScopeId("data-v-bad92666"),r=r(),popScopeId(),r),_hoisted_1$1={key:0,class:"fallback-container"},_hoisted_2$1=_withScopeId(()=>createBaseVNode("img",{src:_imports_0,class:"wifi-fallback"},null,-1)),_hoisted_3$1=[_hoisted_2$1],_hoisted_4$1=["src"],_sfc_main$1=defineComponent({__name:"SongContainer",props:{book:{},number:{}},setup(r,{expose:e}){const t=r;let n=ref(""),s=ref();function i(O,k,g){const b=k+"."+g[O].fileExtension;return`${g[O].srcUrl}/songs/${b}`}function a(){return p.getTransform().scale}e({getZoom:a});let o=ref(""),c=ref(!1);const l=useMediaQuery("(prefers-color-scheme: dark)"),u=useLocalStorage("ACCOptions.overrideSystemTheme",!1),d=useLocalStorage("ACCOptions.overrideDarkMode",!1);let m=useLocalStorage("ACCOptions.songInverted",!1);const y=computed(()=>u.value?d.value:l.value),h=computed(()=>y.value&&m.value);let p;var f=Capacitor.getPlatform()!=="web";onMounted(async()=>{const O=await getAllBookMetaData();if(O[t.book]==null){c.value=!0;return}const k=i(t.book,t.number,O);n.value=O[t.book].fileExtension,o.value=k,p=createPanZoom$1(s.value,{beforeWheel:g=>g.shiftKey,maxZoom:3,minZoom:f?1:.25,bounds:!0,boundsPadding:f?1:.5,zoomDoubleClickSpeed:1}),f&&setInterval(()=>{_.refresh()},10)});class v{constructor(k){rt(this,"_observer");rt(this,"_observedNodes");this._observer=k,this._observedNodes=new Set}observe(k){this._observedNodes.add(k),this._observer.observe(k)}unobserve(k){try{this._observedNodes.delete(k),this._observer.unobserve(k)}catch{}}disconnect(){try{this._observedNodes.clear(),this._observer.disconnect()}catch{}}refresh(){for(let k of this._observedNodes)try{this._observer.unobserve(k),this._observer.observe(k)}catch{}}}const _=new v(new IntersectionObserver((O,k)=>{for(const g of O){let b=g.boundingClientRect;g.intersectionRect.height<b.height?p.setVerticalPan(!0):p.setVerticalPan(!1)}},{root:null,rootMargin:"0px",threshold:1}));return onUpdated(async()=>{f&&_.observe(s.value)}),(O,k)=>unref(c)?(openBlock(),createElementBlock("div",_hoisted_1$1,_hoisted_3$1)):(openBlock(),createElementBlock("div",{key:1,ref_key:"panzoom_container",ref:s,class:"panzoom-container"},[unref(n)=="pdf"?(openBlock(),createBlock(_sfc_main$2,{key:0,onError:k[0]||(k[0]=g=>isRef(c)?c.value=!0:c=!0),src:unref(o),class:normalizeClass(["song-img",{"inverted-song":h.value}])},null,8,["src","class"])):unref(n)!==""?(openBlock(),createElementBlock("img",{key:1,onError:k[1]||(k[1]=g=>isRef(c)?c.value=!0:c=!0),src:unref(o),class:normalizeClass(["song-img",{"inverted-song":h.value}])},null,42,_hoisted_4$1)):createCommentVNode("",!0)],512))}}),SongContainer_vue_vue_type_style_index_0_scoped_bad92666_lang="",SongContainer=_export_sfc(_sfc_main$1,[["__scopeId","data-v-bad92666"]]),version="14.7.77",createExtendedExponentialRampToValueAutomationEvent=(r,e,t)=>({endTime:e,insertTime:t,type:"exponentialRampToValue",value:r}),createExtendedLinearRampToValueAutomationEvent=(r,e,t)=>({endTime:e,insertTime:t,type:"linearRampToValue",value:r}),createSetValueAutomationEvent=(r,e)=>({startTime:e,type:"setValue",value:r}),createSetValueCurveAutomationEvent=(r,e,t)=>({duration:t,startTime:e,type:"setValueCurve",values:r}),getTargetValueAtTime=(r,e,{startTime:t,target:n,timeConstant:s})=>n+(e-n)*Math.exp((t-r)/s),isExponentialRampToValueAutomationEvent=r=>r.type==="exponentialRampToValue",isLinearRampToValueAutomationEvent=r=>r.type==="linearRampToValue",isAnyRampToValueAutomationEvent=r=>isExponentialRampToValueAutomationEvent(r)||isLinearRampToValueAutomationEvent(r),isSetValueAutomationEvent=r=>r.type==="setValue",isSetValueCurveAutomationEvent=r=>r.type==="setValueCurve",getValueOfAutomationEventAtIndexAtTime=(r,e,t,n)=>{const s=r[e];return s===void 0?n:isAnyRampToValueAutomationEvent(s)||isSetValueAutomationEvent(s)?s.value:isSetValueCurveAutomationEvent(s)?s.values[s.values.length-1]:getTargetValueAtTime(t,getValueOfAutomationEventAtIndexAtTime(r,e-1,s.startTime,n),s)},getEndTimeAndValueOfPreviousAutomationEvent=(r,e,t,n,s)=>t===void 0?[n.insertTime,s]:isAnyRampToValueAutomationEvent(t)?[t.endTime,t.value]:isSetValueAutomationEvent(t)?[t.startTime,t.value]:isSetValueCurveAutomationEvent(t)?[t.startTime+t.duration,t.values[t.values.length-1]]:[t.startTime,getValueOfAutomationEventAtIndexAtTime(r,e-1,t.startTime,s)],isCancelAndHoldAutomationEvent=r=>r.type==="cancelAndHold",isCancelScheduledValuesAutomationEvent=r=>r.type==="cancelScheduledValues",getEventTime=r=>isCancelAndHoldAutomationEvent(r)||isCancelScheduledValuesAutomationEvent(r)?r.cancelTime:isExponentialRampToValueAutomationEvent(r)||isLinearRampToValueAutomationEvent(r)?r.endTime:r.startTime,getExponentialRampValueAtTime=(r,e,t,{endTime:n,value:s})=>t===s?s:0<t&&0<s||t<0&&s<0?t*(s/t)**((r-e)/(n-e)):0,getLinearRampValueAtTime=(r,e,t,{endTime:n,value:s})=>t+(r-e)/(n-e)*(s-t),interpolateValue=(r,e)=>{const t=Math.floor(e),n=Math.ceil(e);return t===n?r[t]:(1-(e-t))*r[t]+(1-(n-e))*r[n]},getValueCurveValueAtTime=(r,{duration:e,startTime:t,values:n})=>{const s=(r-t)/e*(n.length-1);return interpolateValue(n,s)},isSetTargetAutomationEvent=r=>r.type==="setTarget";class AutomationEventList{constructor(e){this._automationEvents=[],this._currenTime=0,this._defaultValue=e}[Symbol.iterator](){return this._automationEvents[Symbol.iterator]()}add(e){const t=getEventTime(e);if(isCancelAndHoldAutomationEvent(e)||isCancelScheduledValuesAutomationEvent(e)){const n=this._automationEvents.findIndex(i=>isCancelScheduledValuesAutomationEvent(e)&&isSetValueCurveAutomationEvent(i)?i.startTime+i.duration>=t:getEventTime(i)>=t),s=this._automationEvents[n];if(n!==-1&&(this._automationEvents=this._automationEvents.slice(0,n)),isCancelAndHoldAutomationEvent(e)){const i=this._automationEvents[this._automationEvents.length-1];if(s!==void 0&&isAnyRampToValueAutomationEvent(s)){if(i!==void 0&&isSetTargetAutomationEvent(i))throw new Error("The internal list is malformed.");const a=i===void 0?s.insertTime:isSetValueCurveAutomationEvent(i)?i.startTime+i.duration:getEventTime(i),o=i===void 0?this._defaultValue:isSetValueCurveAutomationEvent(i)?i.values[i.values.length-1]:i.value,c=isExponentialRampToValueAutomationEvent(s)?getExponentialRampValueAtTime(t,a,o,s):getLinearRampValueAtTime(t,a,o,s),l=isExponentialRampToValueAutomationEvent(s)?createExtendedExponentialRampToValueAutomationEvent(c,t,this._currenTime):createExtendedLinearRampToValueAutomationEvent(c,t,this._currenTime);this._automationEvents.push(l)}if(i!==void 0&&isSetTargetAutomationEvent(i)&&this._automationEvents.push(createSetValueAutomationEvent(this.getValue(t),t)),i!==void 0&&isSetValueCurveAutomationEvent(i)&&i.startTime+i.duration>t){const a=t-i.startTime,o=(i.values.length-1)/i.duration,c=Math.max(2,1+Math.ceil(a*o)),l=a/(c-1)*o,u=i.values.slice(0,c);if(l<1)for(let d=1;d<c;d+=1){const m=l*d%1;u[d]=i.values[d-1]*(1-m)+i.values[d]*m}this._automationEvents[this._automationEvents.length-1]=createSetValueCurveAutomationEvent(u,i.startTime,a)}}}else{const n=this._automationEvents.findIndex(a=>getEventTime(a)>t),s=n===-1?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[n-1];if(s!==void 0&&isSetValueCurveAutomationEvent(s)&&getEventTime(s)+s.duration>t)return!1;const i=isExponentialRampToValueAutomationEvent(e)?createExtendedExponentialRampToValueAutomationEvent(e.value,e.endTime,this._currenTime):isLinearRampToValueAutomationEvent(e)?createExtendedLinearRampToValueAutomationEvent(e.value,t,this._currenTime):e;if(n===-1)this._automationEvents.push(i);else{if(isSetValueCurveAutomationEvent(e)&&t+e.duration>getEventTime(this._automationEvents[n]))return!1;this._automationEvents.splice(n,0,i)}}return!0}flush(e){const t=this._automationEvents.findIndex(n=>getEventTime(n)>e);if(t>1){const n=this._automationEvents.slice(t-1),s=n[0];isSetTargetAutomationEvent(s)&&n.unshift(createSetValueAutomationEvent(getValueOfAutomationEventAtIndexAtTime(this._automationEvents,t-2,s.startTime,this._defaultValue),s.startTime)),this._automationEvents=n}}getValue(e){if(this._automationEvents.length===0)return this._defaultValue;const t=this._automationEvents.findIndex(a=>getEventTime(a)>e),n=this._automationEvents[t],s=(t===-1?this._automationEvents.length:t)-1,i=this._automationEvents[s];if(i!==void 0&&isSetTargetAutomationEvent(i)&&(n===void 0||!isAnyRampToValueAutomationEvent(n)||n.insertTime>e))return getTargetValueAtTime(e,getValueOfAutomationEventAtIndexAtTime(this._automationEvents,s-1,i.startTime,this._defaultValue),i);if(i!==void 0&&isSetValueAutomationEvent(i)&&(n===void 0||!isAnyRampToValueAutomationEvent(n)))return i.value;if(i!==void 0&&isSetValueCurveAutomationEvent(i)&&(n===void 0||!isAnyRampToValueAutomationEvent(n)||i.startTime+i.duration>e))return e<i.startTime+i.duration?getValueCurveValueAtTime(e,i):i.values[i.values.length-1];if(i!==void 0&&isAnyRampToValueAutomationEvent(i)&&(n===void 0||!isAnyRampToValueAutomationEvent(n)))return i.value;if(n!==void 0&&isExponentialRampToValueAutomationEvent(n)){const[a,o]=getEndTimeAndValueOfPreviousAutomationEvent(this._automationEvents,s,i,n,this._defaultValue);return getExponentialRampValueAtTime(e,a,o,n)}if(n!==void 0&&isLinearRampToValueAutomationEvent(n)){const[a,o]=getEndTimeAndValueOfPreviousAutomationEvent(this._automationEvents,s,i,n,this._defaultValue);return getLinearRampValueAtTime(e,a,o,n)}return this._defaultValue}}const createCancelAndHoldAutomationEvent=r=>({cancelTime:r,type:"cancelAndHold"}),createCancelScheduledValuesAutomationEvent=r=>({cancelTime:r,type:"cancelScheduledValues"}),createExponentialRampToValueAutomationEvent=(r,e)=>({endTime:e,type:"exponentialRampToValue",value:r}),createLinearRampToValueAutomationEvent=(r,e)=>({endTime:e,type:"linearRampToValue",value:r}),createSetTargetAutomationEvent=(r,e,t)=>({startTime:e,target:r,timeConstant:t,type:"setTarget"}),createAbortError=()=>new DOMException("","AbortError"),createAddActiveInputConnectionToAudioNode=r=>(e,t,[n,s,i],a)=>{r(e[s],[t,n,i],o=>o[0]===t&&o[1]===n,a)},createAddAudioNodeConnections=r=>(e,t,n)=>{const s=[];for(let i=0;i<n.numberOfInputs;i+=1)s.push(new Set);r.set(e,{activeInputs:s,outputs:new Set,passiveInputs:new WeakMap,renderer:t})},createAddAudioParamConnections=r=>(e,t)=>{r.set(e,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:t})},ACTIVE_AUDIO_NODE_STORE=new WeakSet,AUDIO_NODE_CONNECTIONS_STORE=new WeakMap,AUDIO_NODE_STORE=new WeakMap,AUDIO_PARAM_CONNECTIONS_STORE=new WeakMap,AUDIO_PARAM_STORE=new WeakMap,CONTEXT_STORE=new WeakMap,EVENT_LISTENERS=new WeakMap,CYCLE_COUNTERS=new WeakMap,NODE_NAME_TO_PROCESSOR_CONSTRUCTOR_MAPS=new WeakMap,NODE_TO_PROCESSOR_MAPS=new WeakMap,handler={construct(){return handler}},isConstructible=r=>{try{const e=new Proxy(r,handler);new e}catch{return!1}return!0},IMPORT_STATEMENT_REGEX=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,splitImportStatements=(r,e)=>{const t=[];let n=r.replace(/^[\s]+/,""),s=n.match(IMPORT_STATEMENT_REGEX);for(;s!==null;){const i=s[1].slice(1,-1),a=s[0].replace(/([\s]+)?;?$/,"").replace(i,new URL(i,e).toString());t.push(a),n=n.slice(s[0].length).replace(/^[\s]+/,""),s=n.match(IMPORT_STATEMENT_REGEX)}return[t.join(";"),n]},verifyParameterDescriptors=r=>{if(r!==void 0&&!Array.isArray(r))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},verifyProcessorCtor=r=>{if(!isConstructible(r))throw new TypeError("The given value for processorCtor should be a constructor.");if(r.prototype===null||typeof r.prototype!="object")throw new TypeError("The given value for processorCtor should have a prototype.")},createAddAudioWorkletModule=(r,e,t,n,s,i,a,o,c,l,u,d,m)=>{let y=0;return(h,p,f={credentials:"omit"})=>{const v=u.get(h);if(v!==void 0&&v.has(p))return Promise.resolve();const _=l.get(h);if(_!==void 0){const g=_.get(p);if(g!==void 0)return g}const O=i(h),k=O.audioWorklet===void 0?s(p).then(([g,b])=>{const[N,S]=splitImportStatements(g,b),T=`${N};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${S}
})})(window,'_AWGS')`;return t(T)}).then(()=>{const g=m._AWGS.pop();if(g===void 0)throw new SyntaxError;n(O.currentTime,O.sampleRate,()=>g(class{},void 0,(b,N)=>{if(b.trim()==="")throw e();const S=NODE_NAME_TO_PROCESSOR_CONSTRUCTOR_MAPS.get(O);if(S!==void 0){if(S.has(b))throw e();verifyProcessorCtor(N),verifyParameterDescriptors(N.parameterDescriptors),S.set(b,N)}else verifyProcessorCtor(N),verifyParameterDescriptors(N.parameterDescriptors),NODE_NAME_TO_PROCESSOR_CONSTRUCTOR_MAPS.set(O,new Map([[b,N]]))},O.sampleRate,void 0,void 0))}):Promise.all([s(p),Promise.resolve(r(d,d))]).then(([[g,b],N])=>{const S=y+1;y=S;const[T,M]=splitImportStatements(g,b),L=`${T};((AudioWorkletProcessor,registerProcessor)=>{${M}
})(${N?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${N?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${N?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${S}',class extends AudioWorkletProcessor{process(){return !1}})`,j=new Blob([L],{type:"application/javascript; charset=utf-8"}),q=URL.createObjectURL(j);return O.audioWorklet.addModule(q,f).then(()=>{if(o(O))return O;const te=a(O);return te.audioWorklet.addModule(q,f).then(()=>te)}).then(te=>{if(c===null)throw new SyntaxError;try{new c(te,`__sac${S}`)}catch{throw new SyntaxError}}).finally(()=>URL.revokeObjectURL(q))});return _===void 0?l.set(h,new Map([[p,k]])):_.set(p,k),k.then(()=>{const g=u.get(h);g===void 0?u.set(h,new Set([p])):g.add(p)}).finally(()=>{const g=l.get(h);g!==void 0&&g.delete(p)}),k}},getValueForKey=(r,e)=>{const t=r.get(e);if(t===void 0)throw new Error("A value with the given key could not be found.");return t},pickElementFromSet=(r,e)=>{const t=Array.from(r).filter(e);if(t.length>1)throw Error("More than one element was found.");if(t.length===0)throw Error("No element was found.");const[n]=t;return r.delete(n),n},deletePassiveInputConnectionToAudioNode=(r,e,t,n)=>{const s=getValueForKey(r,e),i=pickElementFromSet(s,a=>a[0]===t&&a[1]===n);return s.size===0&&r.delete(e),i},getEventListenersOfAudioNode=r=>getValueForKey(EVENT_LISTENERS,r),setInternalStateToActive=r=>{if(ACTIVE_AUDIO_NODE_STORE.has(r))throw new Error("The AudioNode is already stored.");ACTIVE_AUDIO_NODE_STORE.add(r),getEventListenersOfAudioNode(r).forEach(e=>e(!0))},isAudioWorkletNode=r=>"port"in r,setInternalStateToPassive=r=>{if(!ACTIVE_AUDIO_NODE_STORE.has(r))throw new Error("The AudioNode is not stored.");ACTIVE_AUDIO_NODE_STORE.delete(r),getEventListenersOfAudioNode(r).forEach(e=>e(!1))},setInternalStateToPassiveWhenNecessary=(r,e)=>{!isAudioWorkletNode(r)&&e.every(t=>t.size===0)&&setInternalStateToPassive(r)},createAddConnectionToAudioNode=(r,e,t,n,s,i,a,o,c,l,u,d,m)=>{const y=new WeakMap;return(h,p,f,v,_)=>{const{activeInputs:O,passiveInputs:k}=i(p),{outputs:g}=i(h),b=o(h),N=S=>{const T=c(p),M=c(h);if(S){const P=deletePassiveInputConnectionToAudioNode(k,h,f,v);r(O,h,P,!1),!_&&!d(h)&&t(M,T,f,v),m(p)&&setInternalStateToActive(p)}else{const P=n(O,h,f,v);e(k,v,P,!1),!_&&!d(h)&&s(M,T,f,v);const $=a(p);if($===0)u(p)&&setInternalStateToPassiveWhenNecessary(p,O);else{const K=y.get(p);K!==void 0&&clearTimeout(K),y.set(p,setTimeout(()=>{u(p)&&setInternalStateToPassiveWhenNecessary(p,O)},$*1e3))}}};return l(g,[p,f,v],S=>S[0]===p&&S[1]===f&&S[2]===v,!0)?(b.add(N),u(h)?r(O,h,[f,v,N],!0):e(k,v,[h,f,N],!0),!0):!1}},createAddPassiveInputConnectionToAudioNode=r=>(e,t,[n,s,i],a)=>{const o=e.get(n);o===void 0?e.set(n,new Set([[s,t,i]])):r(o,[s,t,i],c=>c[0]===s&&c[1]===t,a)},createAddSilentConnection=r=>(e,t)=>{const n=r(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});t.connect(n).connect(e.destination);const s=()=>{t.removeEventListener("ended",s),t.disconnect(n),n.disconnect()};t.addEventListener("ended",s)},createAddUnrenderedAudioWorkletNode=r=>(e,t)=>{r(e).add(t)},DEFAULT_OPTIONS$j={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},createAnalyserNodeConstructor=(r,e,t,n,s,i)=>class extends r{constructor(o,c){const l=s(o),u={...DEFAULT_OPTIONS$j,...c},d=n(l,u),m=i(l)?e():null;super(o,!1,d,m),this._nativeAnalyserNode=d}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(o){this._nativeAnalyserNode.fftSize=o}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(o){const c=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=o,!(o>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=c,t()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(o){const c=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=o,!(this._nativeAnalyserNode.maxDecibels>o))throw this._nativeAnalyserNode.minDecibels=c,t()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(o){this._nativeAnalyserNode.smoothingTimeConstant=o}getByteFrequencyData(o){this._nativeAnalyserNode.getByteFrequencyData(o)}getByteTimeDomainData(o){this._nativeAnalyserNode.getByteTimeDomainData(o)}getFloatFrequencyData(o){this._nativeAnalyserNode.getFloatFrequencyData(o)}getFloatTimeDomainData(o){this._nativeAnalyserNode.getFloatTimeDomainData(o)}},isOwnedByContext=(r,e)=>r.context===e,createAnalyserNodeRendererFactory=(r,e,t)=>()=>{const n=new WeakMap,s=async(i,a)=>{let o=e(i);if(!isOwnedByContext(o,a)){const l={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,fftSize:o.fftSize,maxDecibels:o.maxDecibels,minDecibels:o.minDecibels,smoothingTimeConstant:o.smoothingTimeConstant};o=r(a,l)}return n.set(a,o),await t(i,a,o),o};return{render(i,a){const o=n.get(a);return o!==void 0?Promise.resolve(o):s(i,a)}}},testAudioBufferCopyChannelMethodsOutOfBoundsSupport=r=>{try{r.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},createIndexSizeError=()=>new DOMException("","IndexSizeError"),wrapAudioBufferGetChannelDataMethod=r=>{r.getChannelData=(e=>t=>{try{return e.call(r,t)}catch(n){throw n.code===12?createIndexSizeError():n}})(r.getChannelData)},DEFAULT_OPTIONS$i={numberOfChannels:1},createAudioBufferConstructor=(r,e,t,n,s,i,a,o)=>{let c=null;return class dr{constructor(u){if(s===null)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:d,numberOfChannels:m,sampleRate:y}={...DEFAULT_OPTIONS$i,...u};c===null&&(c=new s(1,1,44100));const h=n!==null&&e(i,i)?new n({length:d,numberOfChannels:m,sampleRate:y}):c.createBuffer(m,d,y);if(h.numberOfChannels===0)throw t();return typeof h.copyFromChannel!="function"?(a(h),wrapAudioBufferGetChannelDataMethod(h)):e(testAudioBufferCopyChannelMethodsOutOfBoundsSupport,()=>testAudioBufferCopyChannelMethodsOutOfBoundsSupport(h))||o(h),r.add(h),h}static[Symbol.hasInstance](u){return u!==null&&typeof u=="object"&&Object.getPrototypeOf(u)===dr.prototype||r.has(u)}}},MOST_NEGATIVE_SINGLE_FLOAT=-34028234663852886e22,MOST_POSITIVE_SINGLE_FLOAT=-MOST_NEGATIVE_SINGLE_FLOAT,isActiveAudioNode=r=>ACTIVE_AUDIO_NODE_STORE.has(r),DEFAULT_OPTIONS$h={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},createAudioBufferSourceNodeConstructor=(r,e,t,n,s,i,a,o)=>class extends r{constructor(l,u){const d=i(l),m={...DEFAULT_OPTIONS$h,...u},y=s(d,m),h=a(d),p=h?e():null;super(l,!1,y,p),this._audioBufferSourceNodeRenderer=p,this._isBufferNullified=!1,this._isBufferSet=m.buffer!==null,this._nativeAudioBufferSourceNode=y,this._onended=null,this._playbackRate=t(this,h,y.playbackRate,MOST_POSITIVE_SINGLE_FLOAT,MOST_NEGATIVE_SINGLE_FLOAT)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(l){if(this._nativeAudioBufferSourceNode.buffer=l,l!==null){if(this._isBufferSet)throw n();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(l){this._nativeAudioBufferSourceNode.loop=l}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(l){this._nativeAudioBufferSourceNode.loopEnd=l}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(l){this._nativeAudioBufferSourceNode.loopStart=l}get onended(){return this._onended}set onended(l){const u=typeof l=="function"?o(this,l):null;this._nativeAudioBufferSourceNode.onended=u;const d=this._nativeAudioBufferSourceNode.onended;this._onended=d!==null&&d===u?l:d}get playbackRate(){return this._playbackRate}start(l=0,u=0,d){if(this._nativeAudioBufferSourceNode.start(l,u,d),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.start=d===void 0?[l,u]:[l,u,d]),this.context.state!=="closed"){setInternalStateToActive(this);const m=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",m),isActiveAudioNode(this)&&setInternalStateToPassive(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",m)}}stop(l=0){this._nativeAudioBufferSourceNode.stop(l),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.stop=l)}},createAudioBufferSourceNodeRendererFactory=(r,e,t,n,s)=>()=>{const i=new WeakMap;let a=null,o=null;const c=async(l,u)=>{let d=t(l);const m=isOwnedByContext(d,u);if(!m){const y={buffer:d.buffer,channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,loop:d.loop,loopEnd:d.loopEnd,loopStart:d.loopStart,playbackRate:d.playbackRate.value};d=e(u,y),a!==null&&d.start(...a),o!==null&&d.stop(o)}return i.set(u,d),m?await r(u,l.playbackRate,d.playbackRate):await n(u,l.playbackRate,d.playbackRate),await s(l,u,d),d};return{set start(l){a=l},set stop(l){o=l},render(l,u){const d=i.get(u);return d!==void 0?Promise.resolve(d):c(l,u)}}},isAudioBufferSourceNode=r=>"playbackRate"in r,isBiquadFilterNode=r=>"frequency"in r&&"gain"in r,isConstantSourceNode=r=>"offset"in r,isGainNode=r=>!("frequency"in r)&&"gain"in r,isOscillatorNode=r=>"detune"in r&&"frequency"in r,isStereoPannerNode=r=>"pan"in r,getAudioNodeConnections=r=>getValueForKey(AUDIO_NODE_CONNECTIONS_STORE,r),getAudioParamConnections=r=>getValueForKey(AUDIO_PARAM_CONNECTIONS_STORE,r),deactivateActiveAudioNodeInputConnections=(r,e)=>{const{activeInputs:t}=getAudioNodeConnections(r);t.forEach(s=>s.forEach(([i])=>{e.includes(r)||deactivateActiveAudioNodeInputConnections(i,[...e,r])}));const n=isAudioBufferSourceNode(r)?[r.playbackRate]:isAudioWorkletNode(r)?Array.from(r.parameters.values()):isBiquadFilterNode(r)?[r.Q,r.detune,r.frequency,r.gain]:isConstantSourceNode(r)?[r.offset]:isGainNode(r)?[r.gain]:isOscillatorNode(r)?[r.detune,r.frequency]:isStereoPannerNode(r)?[r.pan]:[];for(const s of n){const i=getAudioParamConnections(s);i!==void 0&&i.activeInputs.forEach(([a])=>deactivateActiveAudioNodeInputConnections(a,e))}isActiveAudioNode(r)&&setInternalStateToPassive(r)},deactivateAudioGraph=r=>{deactivateActiveAudioNodeInputConnections(r.destination,[])},isValidLatencyHint=r=>r===void 0||typeof r=="number"||typeof r=="string"&&(r==="balanced"||r==="interactive"||r==="playback"),createAudioContextConstructor=(r,e,t,n,s,i,a,o,c)=>class extends r{constructor(u={}){if(c===null)throw new Error("Missing the native AudioContext constructor.");let d;try{d=new c(u)}catch(h){throw h.code===12&&h.message==="sampleRate is not in range"?t():h}if(d===null)throw n();if(!isValidLatencyHint(u.latencyHint))throw new TypeError(`The provided value '${u.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(u.sampleRate!==void 0&&d.sampleRate!==u.sampleRate)throw t();super(d,2);const{latencyHint:m}=u,{sampleRate:y}=d;if(this._baseLatency=typeof d.baseLatency=="number"?d.baseLatency:m==="balanced"?512/y:m==="interactive"||m===void 0?256/y:m==="playback"?1024/y:Math.max(2,Math.min(128,Math.round(m*y/128)))*128/y,this._nativeAudioContext=d,c.name==="webkitAudioContext"?(this._nativeGainNode=d.createGain(),this._nativeOscillatorNode=d.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(d.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,d.state==="running"){this._state="suspended";const h=()=>{this._state==="suspended"&&(this._state=null),d.removeEventListener("statechange",h)};d.addEventListener("statechange",h)}}get baseLatency(){return this._baseLatency}get state(){return this._state!==null?this._state:this._nativeAudioContext.state}close(){return this.state==="closed"?this._nativeAudioContext.close().then(()=>{throw e()}):(this._state==="suspended"&&(this._state=null),this._nativeAudioContext.close().then(()=>{this._nativeGainNode!==null&&this._nativeOscillatorNode!==null&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),deactivateAudioGraph(this)}))}createMediaElementSource(u){return new s(this,{mediaElement:u})}createMediaStreamDestination(){return new i(this)}createMediaStreamSource(u){return new a(this,{mediaStream:u})}createMediaStreamTrackSource(u){return new o(this,{mediaStreamTrack:u})}resume(){return this._state==="suspended"?new Promise((u,d)=>{const m=()=>{this._nativeAudioContext.removeEventListener("statechange",m),this._nativeAudioContext.state==="running"?u():this.resume().then(u,d)};this._nativeAudioContext.addEventListener("statechange",m)}):this._nativeAudioContext.resume().catch(u=>{throw u===void 0||u.code===15?e():u})}suspend(){return this._nativeAudioContext.suspend().catch(u=>{throw u===void 0?e():u})}},createAudioDestinationNodeConstructor=(r,e,t,n,s,i,a,o)=>class extends r{constructor(l,u){const d=i(l),m=a(d),y=s(d,u,m),h=m?e(o):null;super(l,!1,y,h),this._isNodeOfNativeOfflineAudioContext=m,this._nativeAudioDestinationNode=y}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(l){if(this._isNodeOfNativeOfflineAudioContext)throw n();if(l>this._nativeAudioDestinationNode.maxChannelCount)throw t();this._nativeAudioDestinationNode.channelCount=l}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(l){if(this._isNodeOfNativeOfflineAudioContext)throw n();this._nativeAudioDestinationNode.channelCountMode=l}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}},createAudioDestinationNodeRenderer=r=>{const e=new WeakMap,t=async(n,s)=>{const i=s.destination;return e.set(s,i),await r(n,s,i),i};return{render(n,s){const i=e.get(s);return i!==void 0?Promise.resolve(i):t(n,s)}}},createAudioListenerFactory=(r,e,t,n,s,i,a,o)=>(c,l)=>{const u=l.listener,d=()=>{const g=new Float32Array(1),b=e(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),N=a(l);let S=!1,T=[0,0,-1,0,1,0],M=[0,0,0];const P=()=>{if(S)return;S=!0;const j=n(l,256,9,0);j.onaudioprocess=({inputBuffer:q})=>{const te=[i(q,g,0),i(q,g,1),i(q,g,2),i(q,g,3),i(q,g,4),i(q,g,5)];te.some((z,Q)=>z!==T[Q])&&(u.setOrientation(...te),T=te);const F=[i(q,g,6),i(q,g,7),i(q,g,8)];F.some((z,Q)=>z!==M[Q])&&(u.setPosition(...F),M=F)},b.connect(j)},$=j=>q=>{q!==T[j]&&(T[j]=q,u.setOrientation(...T))},K=j=>q=>{q!==M[j]&&(M[j]=q,u.setPosition(...M))},L=(j,q,te)=>{const F=t(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:q});F.connect(b,0,j),F.start(),Object.defineProperty(F.offset,"defaultValue",{get(){return q}});const z=r({context:c},N,F.offset,MOST_POSITIVE_SINGLE_FLOAT,MOST_NEGATIVE_SINGLE_FLOAT);return o(z,"value",Q=>()=>Q.call(z),Q=>ne=>{try{Q.call(z,ne)}catch(de){if(de.code!==9)throw de}P(),N&&te(ne)}),z.cancelAndHoldAtTime=(Q=>N?()=>{throw s()}:(...ne)=>{const de=Q.apply(z,ne);return P(),de})(z.cancelAndHoldAtTime),z.cancelScheduledValues=(Q=>N?()=>{throw s()}:(...ne)=>{const de=Q.apply(z,ne);return P(),de})(z.cancelScheduledValues),z.exponentialRampToValueAtTime=(Q=>N?()=>{throw s()}:(...ne)=>{const de=Q.apply(z,ne);return P(),de})(z.exponentialRampToValueAtTime),z.linearRampToValueAtTime=(Q=>N?()=>{throw s()}:(...ne)=>{const de=Q.apply(z,ne);return P(),de})(z.linearRampToValueAtTime),z.setTargetAtTime=(Q=>N?()=>{throw s()}:(...ne)=>{const de=Q.apply(z,ne);return P(),de})(z.setTargetAtTime),z.setValueAtTime=(Q=>N?()=>{throw s()}:(...ne)=>{const de=Q.apply(z,ne);return P(),de})(z.setValueAtTime),z.setValueCurveAtTime=(Q=>N?()=>{throw s()}:(...ne)=>{const de=Q.apply(z,ne);return P(),de})(z.setValueCurveAtTime),z};return{forwardX:L(0,0,$(0)),forwardY:L(1,0,$(1)),forwardZ:L(2,-1,$(2)),positionX:L(6,0,K(0)),positionY:L(7,0,K(1)),positionZ:L(8,0,K(2)),upX:L(3,0,$(3)),upY:L(4,1,$(4)),upZ:L(5,0,$(5))}},{forwardX:m,forwardY:y,forwardZ:h,positionX:p,positionY:f,positionZ:v,upX:_,upY:O,upZ:k}=u.forwardX===void 0?d():u;return{get forwardX(){return m},get forwardY(){return y},get forwardZ(){return h},get positionX(){return p},get positionY(){return f},get positionZ(){return v},get upX(){return _},get upY(){return O},get upZ(){return k}}},isAudioNode$1=r=>"context"in r,isAudioNodeOutputConnection=r=>isAudioNode$1(r[0]),insertElementInSet=(r,e,t,n)=>{for(const s of r)if(t(s)){if(n)return!1;throw Error("The set contains at least one similar element.")}return r.add(e),!0},addActiveInputConnectionToAudioParam=(r,e,[t,n],s)=>{insertElementInSet(r,[e,t,n],i=>i[0]===e&&i[1]===t,s)},addPassiveInputConnectionToAudioParam=(r,[e,t,n],s)=>{const i=r.get(e);i===void 0?r.set(e,new Set([[t,n]])):insertElementInSet(i,[t,n],a=>a[0]===t,s)},isNativeAudioNodeFaker=r=>"inputs"in r,connectNativeAudioNodeToNativeAudioNode=(r,e,t,n)=>{if(isNativeAudioNodeFaker(e)){const s=e.inputs[n];return r.connect(s,t,0),[s,t,0]}return r.connect(e,t,n),[e,t,n]},deleteActiveInputConnection=(r,e,t)=>{for(const n of r)if(n[0]===e&&n[1]===t)return r.delete(n),n;return null},deleteActiveInputConnectionToAudioParam=(r,e,t)=>pickElementFromSet(r,n=>n[0]===e&&n[1]===t),deleteEventListenerOfAudioNode=(r,e)=>{if(!getEventListenersOfAudioNode(r).delete(e))throw new Error("Missing the expected event listener.")},deletePassiveInputConnectionToAudioParam=(r,e,t)=>{const n=getValueForKey(r,e),s=pickElementFromSet(n,i=>i[0]===t);return n.size===0&&r.delete(e),s},disconnectNativeAudioNodeFromNativeAudioNode=(r,e,t,n)=>{isNativeAudioNodeFaker(e)?r.disconnect(e.inputs[n],t,0):r.disconnect(e,t,n)},getNativeAudioNode=r=>getValueForKey(AUDIO_NODE_STORE,r),getNativeAudioParam=r=>getValueForKey(AUDIO_PARAM_STORE,r),isPartOfACycle=r=>CYCLE_COUNTERS.has(r),isPassiveAudioNode=r=>!ACTIVE_AUDIO_NODE_STORE.has(r),testAudioNodeDisconnectMethodSupport=(r,e)=>new Promise(t=>{if(e!==null)t(!0);else{const n=r.createScriptProcessor(256,1,1),s=r.createGain(),i=r.createBuffer(1,2,44100),a=i.getChannelData(0);a[0]=1,a[1]=1;const o=r.createBufferSource();o.buffer=i,o.loop=!0,o.connect(n).connect(r.destination),o.connect(s),o.disconnect(s),n.onaudioprocess=c=>{const l=c.inputBuffer.getChannelData(0);Array.prototype.some.call(l,u=>u===1)?t(!0):t(!1),o.stop(),n.onaudioprocess=null,o.disconnect(n),n.disconnect(r.destination)},o.start()}}),visitEachAudioNodeOnce=(r,e)=>{const t=new Map;for(const n of r)for(const s of n){const i=t.get(s);t.set(s,i===void 0?1:i+1)}t.forEach((n,s)=>e(s,n))},isNativeAudioNode$1=r=>"context"in r,wrapAudioNodeDisconnectMethod=r=>{const e=new Map;r.connect=(t=>(n,s=0,i=0)=>{const a=isNativeAudioNode$1(n)?t(n,s,i):t(n,s),o=e.get(n);return o===void 0?e.set(n,[{input:i,output:s}]):o.every(c=>c.input!==i||c.output!==s)&&o.push({input:i,output:s}),a})(r.connect.bind(r)),r.disconnect=(t=>(n,s,i)=>{if(t.apply(r),n===void 0)e.clear();else if(typeof n=="number")for(const[a,o]of e){const c=o.filter(l=>l.output!==n);c.length===0?e.delete(a):e.set(a,c)}else if(e.has(n))if(s===void 0)e.delete(n);else{const a=e.get(n);if(a!==void 0){const o=a.filter(c=>c.output!==s&&(c.input!==i||i===void 0));o.length===0?e.delete(n):e.set(n,o)}}for(const[a,o]of e)o.forEach(c=>{isNativeAudioNode$1(a)?r.connect(a,c.output,c.input):r.connect(a,c.output)})})(r.disconnect)},addConnectionToAudioParamOfAudioContext=(r,e,t,n)=>{const{activeInputs:s,passiveInputs:i}=getAudioParamConnections(e),{outputs:a}=getAudioNodeConnections(r),o=getEventListenersOfAudioNode(r),c=l=>{const u=getNativeAudioNode(r),d=getNativeAudioParam(e);if(l){const m=deletePassiveInputConnectionToAudioParam(i,r,t);addActiveInputConnectionToAudioParam(s,r,m,!1),!n&&!isPartOfACycle(r)&&u.connect(d,t)}else{const m=deleteActiveInputConnectionToAudioParam(s,r,t);addPassiveInputConnectionToAudioParam(i,m,!1),!n&&!isPartOfACycle(r)&&u.disconnect(d,t)}};return insertElementInSet(a,[e,t],l=>l[0]===e&&l[1]===t,!0)?(o.add(c),isActiveAudioNode(r)?addActiveInputConnectionToAudioParam(s,r,[t,c],!0):addPassiveInputConnectionToAudioParam(i,[r,t,c],!0),!0):!1},deleteInputConnectionOfAudioNode=(r,e,t,n)=>{const{activeInputs:s,passiveInputs:i}=getAudioNodeConnections(e),a=deleteActiveInputConnection(s[n],r,t);return a===null?[deletePassiveInputConnectionToAudioNode(i,r,t,n)[2],!1]:[a[2],!0]},deleteInputConnectionOfAudioParam=(r,e,t)=>{const{activeInputs:n,passiveInputs:s}=getAudioParamConnections(e),i=deleteActiveInputConnection(n,r,t);return i===null?[deletePassiveInputConnectionToAudioParam(s,r,t)[1],!1]:[i[2],!0]},deleteInputsOfAudioNode=(r,e,t,n,s)=>{const[i,a]=deleteInputConnectionOfAudioNode(r,t,n,s);if(i!==null&&(deleteEventListenerOfAudioNode(r,i),a&&!e&&!isPartOfACycle(r)&&disconnectNativeAudioNodeFromNativeAudioNode(getNativeAudioNode(r),getNativeAudioNode(t),n,s)),isActiveAudioNode(t)){const{activeInputs:o}=getAudioNodeConnections(t);setInternalStateToPassiveWhenNecessary(t,o)}},deleteInputsOfAudioParam=(r,e,t,n)=>{const[s,i]=deleteInputConnectionOfAudioParam(r,t,n);s!==null&&(deleteEventListenerOfAudioNode(r,s),i&&!e&&!isPartOfACycle(r)&&getNativeAudioNode(r).disconnect(getNativeAudioParam(t),n))},deleteAnyConnection=(r,e)=>{const t=getAudioNodeConnections(r),n=[];for(const s of t.outputs)isAudioNodeOutputConnection(s)?deleteInputsOfAudioNode(r,e,...s):deleteInputsOfAudioParam(r,e,...s),n.push(s[0]);return t.outputs.clear(),n},deleteConnectionAtOutput=(r,e,t)=>{const n=getAudioNodeConnections(r),s=[];for(const i of n.outputs)i[1]===t&&(isAudioNodeOutputConnection(i)?deleteInputsOfAudioNode(r,e,...i):deleteInputsOfAudioParam(r,e,...i),s.push(i[0]),n.outputs.delete(i));return s},deleteConnectionToDestination=(r,e,t,n,s)=>{const i=getAudioNodeConnections(r);return Array.from(i.outputs).filter(a=>a[0]===t&&(n===void 0||a[1]===n)&&(s===void 0||a[2]===s)).map(a=>(isAudioNodeOutputConnection(a)?deleteInputsOfAudioNode(r,e,...a):deleteInputsOfAudioParam(r,e,...a),i.outputs.delete(a),a[0]))},createAudioNodeConstructor=(r,e,t,n,s,i,a,o,c,l,u,d,m,y,h,p)=>class extends l{constructor(v,_,O,k){super(O),this._context=v,this._nativeAudioNode=O;const g=u(v);d(g)&&t(testAudioNodeDisconnectMethodSupport,()=>testAudioNodeDisconnectMethodSupport(g,p))!==!0&&wrapAudioNodeDisconnectMethod(O),AUDIO_NODE_STORE.set(this,O),EVENT_LISTENERS.set(this,new Set),v.state!=="closed"&&_&&setInternalStateToActive(this),r(this,k,O)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(v){this._nativeAudioNode.channelCount=v}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(v){this._nativeAudioNode.channelCountMode=v}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(v){this._nativeAudioNode.channelInterpretation=v}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(v,_=0,O=0){if(_<0||_>=this._nativeAudioNode.numberOfOutputs)throw s();const k=u(this._context),g=h(k);if(m(v)||y(v))throw i();if(isAudioNode$1(v)){const S=getNativeAudioNode(v);try{const M=connectNativeAudioNodeToNativeAudioNode(this._nativeAudioNode,S,_,O),P=isPassiveAudioNode(this);(g||P)&&this._nativeAudioNode.disconnect(...M),this.context.state!=="closed"&&!P&&isPassiveAudioNode(v)&&setInternalStateToActive(v)}catch(M){throw M.code===12?i():M}if(e(this,v,_,O,g)){const M=c([this],v);visitEachAudioNodeOnce(M,n(g))}return v}const b=getNativeAudioParam(v);if(b.name==="playbackRate"&&b.maxValue===1024)throw a();try{this._nativeAudioNode.connect(b,_),(g||isPassiveAudioNode(this))&&this._nativeAudioNode.disconnect(b,_)}catch(S){throw S.code===12?i():S}if(addConnectionToAudioParamOfAudioContext(this,v,_,g)){const S=c([this],v);visitEachAudioNodeOnce(S,n(g))}}disconnect(v,_,O){let k;const g=u(this._context),b=h(g);if(v===void 0)k=deleteAnyConnection(this,b);else if(typeof v=="number"){if(v<0||v>=this.numberOfOutputs)throw s();k=deleteConnectionAtOutput(this,b,v)}else{if(_!==void 0&&(_<0||_>=this.numberOfOutputs)||isAudioNode$1(v)&&O!==void 0&&(O<0||O>=v.numberOfInputs))throw s();if(k=deleteConnectionToDestination(this,b,v,_,O),k.length===0)throw i()}for(const N of k){const S=c([this],N);visitEachAudioNodeOnce(S,o)}}},createAudioParamFactory=(r,e,t,n,s,i,a,o,c,l,u,d,m)=>(y,h,p,f=null,v=null)=>{const _=p.value,O=new AutomationEventList(_),k=h?n(O):null,g={get defaultValue(){return _},get maxValue(){return f===null?p.maxValue:f},get minValue(){return v===null?p.minValue:v},get value(){return p.value},set value(b){p.value=b,g.setValueAtTime(b,y.context.currentTime)},cancelAndHoldAtTime(b){if(typeof p.cancelAndHoldAtTime=="function")k===null&&O.flush(y.context.currentTime),O.add(s(b)),p.cancelAndHoldAtTime(b);else{const N=Array.from(O).pop();k===null&&O.flush(y.context.currentTime),O.add(s(b));const S=Array.from(O).pop();p.cancelScheduledValues(b),N!==S&&S!==void 0&&(S.type==="exponentialRampToValue"?p.exponentialRampToValueAtTime(S.value,S.endTime):S.type==="linearRampToValue"?p.linearRampToValueAtTime(S.value,S.endTime):S.type==="setValue"?p.setValueAtTime(S.value,S.startTime):S.type==="setValueCurve"&&p.setValueCurveAtTime(S.values,S.startTime,S.duration))}return g},cancelScheduledValues(b){return k===null&&O.flush(y.context.currentTime),O.add(i(b)),p.cancelScheduledValues(b),g},exponentialRampToValueAtTime(b,N){if(b===0)throw new RangeError;if(!Number.isFinite(N)||N<0)throw new RangeError;const S=y.context.currentTime;return k===null&&O.flush(S),Array.from(O).length===0&&(O.add(l(_,S)),p.setValueAtTime(_,S)),O.add(a(b,N)),p.exponentialRampToValueAtTime(b,N),g},linearRampToValueAtTime(b,N){const S=y.context.currentTime;return k===null&&O.flush(S),Array.from(O).length===0&&(O.add(l(_,S)),p.setValueAtTime(_,S)),O.add(o(b,N)),p.linearRampToValueAtTime(b,N),g},setTargetAtTime(b,N,S){return k===null&&O.flush(y.context.currentTime),O.add(c(b,N,S)),p.setTargetAtTime(b,N,S),g},setValueAtTime(b,N){return k===null&&O.flush(y.context.currentTime),O.add(l(b,N)),p.setValueAtTime(b,N),g},setValueCurveAtTime(b,N,S){const T=b instanceof Float32Array?b:new Float32Array(b);if(d!==null&&d.name==="webkitAudioContext"){const M=N+S,P=y.context.sampleRate,$=Math.ceil(N*P),K=Math.floor(M*P),L=K-$,j=new Float32Array(L);for(let te=0;te<L;te+=1){const F=(T.length-1)/S*(($+te)/P-N),z=Math.floor(F),Q=Math.ceil(F);j[te]=z===Q?T[z]:(1-(F-z))*T[z]+(1-(Q-F))*T[Q]}k===null&&O.flush(y.context.currentTime),O.add(u(j,N,S)),p.setValueCurveAtTime(j,N,S);const q=K/P;q<M&&m(g,j[j.length-1],q),m(g,T[T.length-1],M)}else k===null&&O.flush(y.context.currentTime),O.add(u(T,N,S)),p.setValueCurveAtTime(T,N,S);return g}};return t.set(g,p),e.set(g,y),r(g,k),g},createAudioParamRenderer=r=>({replay(e){for(const t of r)if(t.type==="exponentialRampToValue"){const{endTime:n,value:s}=t;e.exponentialRampToValueAtTime(s,n)}else if(t.type==="linearRampToValue"){const{endTime:n,value:s}=t;e.linearRampToValueAtTime(s,n)}else if(t.type==="setTarget"){const{startTime:n,target:s,timeConstant:i}=t;e.setTargetAtTime(s,n,i)}else if(t.type==="setValue"){const{startTime:n,value:s}=t;e.setValueAtTime(s,n)}else if(t.type==="setValueCurve"){const{duration:n,startTime:s,values:i}=t;e.setValueCurveAtTime(i,s,n)}else throw new Error("Can't apply an unknown automation.")}});class ReadOnlyMap{constructor(e){this._map=new Map(e)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(e,t=null){return this._map.forEach((n,s)=>e.call(t,n,s,this))}get(e){return this._map.get(e)}has(e){return this._map.has(e)}keys(){return this._map.keys()}values(){return this._map.values()}}const DEFAULT_OPTIONS$g={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}},createAudioWorkletNodeConstructor=(r,e,t,n,s,i,a,o,c,l,u,d,m,y)=>class extends e{constructor(p,f,v){var _;const O=o(p),k=c(O),g=u({...DEFAULT_OPTIONS$g,...v});m(g);const b=NODE_NAME_TO_PROCESSOR_CONSTRUCTOR_MAPS.get(O),N=b==null?void 0:b.get(f),S=k||O.state!=="closed"?O:(_=a(O))!==null&&_!==void 0?_:O,T=s(S,k?null:p.baseLatency,l,f,N,g),M=k?n(f,g,N):null;super(p,!0,T,M);const P=[];T.parameters.forEach((K,L)=>{const j=t(this,k,K);P.push([L,j])}),this._nativeAudioWorkletNode=T,this._onprocessorerror=null,this._parameters=new ReadOnlyMap(P),k&&r(O,this);const{activeInputs:$}=i(this);d(T,$)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(p){const f=typeof p=="function"?y(this,p):null;this._nativeAudioWorkletNode.onprocessorerror=f;const v=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=v!==null&&v===f?p:v}get parameters(){return this._parameters===null?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}};function copyFromChannel(r,e,t,n,s){if(typeof r.copyFromChannel=="function")e[t].byteLength===0&&(e[t]=new Float32Array(128)),r.copyFromChannel(e[t],n,s);else{const i=r.getChannelData(n);if(e[t].byteLength===0)e[t]=i.slice(s,s+128);else{const a=new Float32Array(i.buffer,s*Float32Array.BYTES_PER_ELEMENT,128);e[t].set(a)}}}const copyToChannel=(r,e,t,n,s)=>{typeof r.copyToChannel=="function"?e[t].byteLength!==0&&r.copyToChannel(e[t],n,s):e[t].byteLength!==0&&r.getChannelData(n).set(e[t],s)},createNestedArrays=(r,e)=>{const t=[];for(let n=0;n<r;n+=1){const s=[],i=typeof e=="number"?e:e[n];for(let a=0;a<i;a+=1)s.push(new Float32Array(128));t.push(s)}return t},getAudioWorkletProcessor=(r,e)=>{const t=getValueForKey(NODE_TO_PROCESSOR_MAPS,r),n=getNativeAudioNode(e);return getValueForKey(t,n)},processBuffer=async(r,e,t,n,s,i,a)=>{const o=e===null?Math.ceil(r.context.length/128)*128:e.length,c=n.channelCount*n.numberOfInputs,l=s.reduce((f,v)=>f+v,0),u=l===0?null:t.createBuffer(l,o,t.sampleRate);if(i===void 0)throw new Error("Missing the processor constructor.");const d=getAudioNodeConnections(r),m=await getAudioWorkletProcessor(t,r),y=createNestedArrays(n.numberOfInputs,n.channelCount),h=createNestedArrays(n.numberOfOutputs,s),p=Array.from(r.parameters.keys()).reduce((f,v)=>({...f,[v]:new Float32Array(128)}),{});for(let f=0;f<o;f+=128){if(n.numberOfInputs>0&&e!==null)for(let v=0;v<n.numberOfInputs;v+=1)for(let _=0;_<n.channelCount;_+=1)copyFromChannel(e,y[v],_,_,f);i.parameterDescriptors!==void 0&&e!==null&&i.parameterDescriptors.forEach(({name:v},_)=>{copyFromChannel(e,p,v,c+_,f)});for(let v=0;v<n.numberOfInputs;v+=1)for(let _=0;_<s[v];_+=1)h[v][_].byteLength===0&&(h[v][_]=new Float32Array(128));try{const v=y.map((O,k)=>d.activeInputs[k].size===0?[]:O),_=a(f/t.sampleRate,t.sampleRate,()=>m.process(v,h,p));if(u!==null)for(let O=0,k=0;O<n.numberOfOutputs;O+=1){for(let g=0;g<s[O];g+=1)copyToChannel(u,h[O],g,k+g,f);k+=s[O]}if(!_)break}catch(v){r.dispatchEvent(new ErrorEvent("processorerror",{colno:v.colno,filename:v.filename,lineno:v.lineno,message:v.message}));break}}return u},createAudioWorkletNodeRendererFactory=(r,e,t,n,s,i,a,o,c,l,u,d,m,y,h,p)=>(f,v,_)=>{const O=new WeakMap;let k=null;const g=async(b,N)=>{let S=u(b),T=null;const M=isOwnedByContext(S,N),P=Array.isArray(v.outputChannelCount)?v.outputChannelCount:Array.from(v.outputChannelCount);if(d===null){const $=P.reduce((q,te)=>q+te,0),K=s(N,{channelCount:Math.max(1,$),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,$)}),L=[];for(let q=0;q<b.numberOfOutputs;q+=1)L.push(n(N,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:P[q]}));const j=a(N,{channelCount:v.channelCount,channelCountMode:v.channelCountMode,channelInterpretation:v.channelInterpretation,gain:1});j.connect=e.bind(null,L),j.disconnect=c.bind(null,L),T=[K,L,j]}else M||(S=new d(N,f));if(O.set(N,T===null?S:T[2]),T!==null){if(k===null){if(_===void 0)throw new Error("Missing the processor constructor.");if(m===null)throw new Error("Missing the native OfflineAudioContext constructor.");const te=b.channelCount*b.numberOfInputs,F=_.parameterDescriptors===void 0?0:_.parameterDescriptors.length,z=te+F;k=processBuffer(b,z===0?null:await(async()=>{const ne=new m(z,Math.ceil(b.context.length/128)*128,N.sampleRate),de=[],U=[];for(let R=0;R<v.numberOfInputs;R+=1)de.push(a(ne,{channelCount:v.channelCount,channelCountMode:v.channelCountMode,channelInterpretation:v.channelInterpretation,gain:1})),U.push(s(ne,{channelCount:v.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:v.channelCount}));const w=await Promise.all(Array.from(b.parameters.values()).map(async R=>{const V=i(ne,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:R.value});return await y(ne,R,V.offset),V})),x=n(ne,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,te+F)});for(let R=0;R<v.numberOfInputs;R+=1){de[R].connect(U[R]);for(let V=0;V<v.channelCount;V+=1)U[R].connect(x,V,R*v.channelCount+V)}for(const[R,V]of w.entries())V.connect(x,0,te+R),V.start(0);return x.connect(ne.destination),await Promise.all(de.map(R=>h(b,ne,R))),p(ne)})(),N,v,P,_,l)}const $=await k,K=t(N,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[L,j,q]=T;$!==null&&(K.buffer=$,K.start(0)),K.connect(L);for(let te=0,F=0;te<b.numberOfOutputs;te+=1){const z=j[te];for(let Q=0;Q<P[te];Q+=1)L.connect(z,F+Q,Q);F+=P[te]}return q}if(M)for(const[$,K]of b.parameters.entries())await r(N,K,S.parameters.get($));else for(const[$,K]of b.parameters.entries())await y(N,K,S.parameters.get($));return await h(b,N,S),S};return{render(b,N){o(N,b);const S=O.get(N);return S!==void 0?Promise.resolve(S):g(b,N)}}},createBaseAudioContextConstructor=(r,e,t,n,s,i,a,o,c,l,u,d,m,y,h,p,f,v,_,O)=>class extends h{constructor(g,b){super(g,b),this._nativeContext=g,this._audioWorklet=r===void 0?void 0:{addModule:(N,S)=>r(this,N,S)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new e(this)}createBiquadFilter(){return new s(this)}createBuffer(g,b,N){return new t({length:b,numberOfChannels:g,sampleRate:N})}createBufferSource(){return new n(this)}createChannelMerger(g=6){return new i(this,{numberOfInputs:g})}createChannelSplitter(g=6){return new a(this,{numberOfOutputs:g})}createConstantSource(){return new o(this)}createConvolver(){return new c(this)}createDelay(g=1){return new u(this,{maxDelayTime:g})}createDynamicsCompressor(){return new d(this)}createGain(){return new m(this)}createIIRFilter(g,b){return new y(this,{feedback:b,feedforward:g})}createOscillator(){return new p(this)}createPanner(){return new f(this)}createPeriodicWave(g,b,N={disableNormalization:!1}){return new v(this,{...N,imag:b,real:g})}createStereoPanner(){return new _(this)}createWaveShaper(){return new O(this)}decodeAudioData(g,b,N){return l(this._nativeContext,g).then(S=>(typeof b=="function"&&b(S),S),S=>{throw typeof N=="function"&&N(S),S})}},DEFAULT_OPTIONS$f={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},createBiquadFilterNodeConstructor=(r,e,t,n,s,i,a,o)=>class extends r{constructor(l,u){const d=i(l),m={...DEFAULT_OPTIONS$f,...u},y=s(d,m),h=a(d),p=h?t():null;super(l,!1,y,p),this._Q=e(this,h,y.Q,MOST_POSITIVE_SINGLE_FLOAT,MOST_NEGATIVE_SINGLE_FLOAT),this._detune=e(this,h,y.detune,1200*Math.log2(MOST_POSITIVE_SINGLE_FLOAT),-1200*Math.log2(MOST_POSITIVE_SINGLE_FLOAT)),this._frequency=e(this,h,y.frequency,l.sampleRate/2,0),this._gain=e(this,h,y.gain,40*Math.log10(MOST_POSITIVE_SINGLE_FLOAT),MOST_NEGATIVE_SINGLE_FLOAT),this._nativeBiquadFilterNode=y,o(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(l){this._nativeBiquadFilterNode.type=l}getFrequencyResponse(l,u,d){try{this._nativeBiquadFilterNode.getFrequencyResponse(l,u,d)}catch(m){throw m.code===11?n():m}if(l.length!==u.length||u.length!==d.length)throw n()}},createBiquadFilterNodeRendererFactory=(r,e,t,n,s)=>()=>{const i=new WeakMap,a=async(o,c)=>{let l=t(o);const u=isOwnedByContext(l,c);if(!u){const d={Q:l.Q.value,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,detune:l.detune.value,frequency:l.frequency.value,gain:l.gain.value,type:l.type};l=e(c,d)}return i.set(c,l),u?(await r(c,o.Q,l.Q),await r(c,o.detune,l.detune),await r(c,o.frequency,l.frequency),await r(c,o.gain,l.gain)):(await n(c,o.Q,l.Q),await n(c,o.detune,l.detune),await n(c,o.frequency,l.frequency),await n(c,o.gain,l.gain)),await s(o,c,l),l};return{render(o,c){const l=i.get(c);return l!==void 0?Promise.resolve(l):a(o,c)}}},createCacheTestResult=(r,e)=>(t,n)=>{const s=e.get(t);if(s!==void 0)return s;const i=r.get(t);if(i!==void 0)return i;try{const a=n();return a instanceof Promise?(r.set(t,a),a.catch(()=>!1).then(o=>(r.delete(t),e.set(t,o),o))):(e.set(t,a),a)}catch{return e.set(t,!1),!1}},DEFAULT_OPTIONS$e={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},createChannelMergerNodeConstructor=(r,e,t,n,s)=>class extends r{constructor(a,o){const c=n(a),l={...DEFAULT_OPTIONS$e,...o},u=t(c,l),d=s(c)?e():null;super(a,!1,u,d)}},createChannelMergerNodeRendererFactory=(r,e,t)=>()=>{const n=new WeakMap,s=async(i,a)=>{let o=e(i);if(!isOwnedByContext(o,a)){const l={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,numberOfInputs:o.numberOfInputs};o=r(a,l)}return n.set(a,o),await t(i,a,o),o};return{render(i,a){const o=n.get(a);return o!==void 0?Promise.resolve(o):s(i,a)}}},DEFAULT_OPTIONS$d={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},createChannelSplitterNodeConstructor=(r,e,t,n,s,i)=>class extends r{constructor(o,c){const l=n(o),u=i({...DEFAULT_OPTIONS$d,...c}),d=t(l,u),m=s(l)?e():null;super(o,!1,d,m)}},createChannelSplitterNodeRendererFactory=(r,e,t)=>()=>{const n=new WeakMap,s=async(i,a)=>{let o=e(i);if(!isOwnedByContext(o,a)){const l={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,numberOfOutputs:o.numberOfOutputs};o=r(a,l)}return n.set(a,o),await t(i,a,o),o};return{render(i,a){const o=n.get(a);return o!==void 0?Promise.resolve(o):s(i,a)}}},createConnectAudioParam=r=>(e,t,n)=>r(t,e,n),createConnectMultipleOutputs=r=>(e,t,n=0,s=0)=>{const i=e[n];if(i===void 0)throw r();return isNativeAudioNode$1(t)?i.connect(t,0,s):i.connect(t,0)},createConnectedNativeAudioBufferSourceNodeFactory=r=>(e,t)=>{const n=r(e,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),s=e.createBuffer(1,2,44100);return n.buffer=s,n.loop=!0,n.connect(t),n.start(),()=>{n.stop(),n.disconnect(t)}},DEFAULT_OPTIONS$c={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},createConstantSourceNodeConstructor=(r,e,t,n,s,i,a)=>class extends r{constructor(c,l){const u=s(c),d={...DEFAULT_OPTIONS$c,...l},m=n(u,d),y=i(u),h=y?t():null;super(c,!1,m,h),this._constantSourceNodeRenderer=h,this._nativeConstantSourceNode=m,this._offset=e(this,y,m.offset,MOST_POSITIVE_SINGLE_FLOAT,MOST_NEGATIVE_SINGLE_FLOAT),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(c){const l=typeof c=="function"?a(this,c):null;this._nativeConstantSourceNode.onended=l;const u=this._nativeConstantSourceNode.onended;this._onended=u!==null&&u===l?c:u}start(c=0){if(this._nativeConstantSourceNode.start(c),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.start=c),this.context.state!=="closed"){setInternalStateToActive(this);const l=()=>{this._nativeConstantSourceNode.removeEventListener("ended",l),isActiveAudioNode(this)&&setInternalStateToPassive(this)};this._nativeConstantSourceNode.addEventListener("ended",l)}}stop(c=0){this._nativeConstantSourceNode.stop(c),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.stop=c)}},createConstantSourceNodeRendererFactory=(r,e,t,n,s)=>()=>{const i=new WeakMap;let a=null,o=null;const c=async(l,u)=>{let d=t(l);const m=isOwnedByContext(d,u);if(!m){const y={channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,offset:d.offset.value};d=e(u,y),a!==null&&d.start(a),o!==null&&d.stop(o)}return i.set(u,d),m?await r(u,l.offset,d.offset):await n(u,l.offset,d.offset),await s(l,u,d),d};return{set start(l){a=l},set stop(l){o=l},render(l,u){const d=i.get(u);return d!==void 0?Promise.resolve(d):c(l,u)}}},createConvertNumberToUnsignedLong=r=>e=>(r[0]=e,r[0]),DEFAULT_OPTIONS$b={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},createConvolverNodeConstructor=(r,e,t,n,s,i)=>class extends r{constructor(o,c){const l=n(o),u={...DEFAULT_OPTIONS$b,...c},d=t(l,u),y=s(l)?e():null;super(o,!1,d,y),this._isBufferNullified=!1,this._nativeConvolverNode=d,u.buffer!==null&&i(this,u.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(o){if(this._nativeConvolverNode.buffer=o,o===null&&this._nativeConvolverNode.buffer!==null){const c=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=c.createBuffer(1,1,c.sampleRate),this._isBufferNullified=!0,i(this,0)}else this._isBufferNullified=!1,i(this,this._nativeConvolverNode.buffer===null?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(o){this._nativeConvolverNode.normalize=o}},createConvolverNodeRendererFactory=(r,e,t)=>()=>{const n=new WeakMap,s=async(i,a)=>{let o=e(i);if(!isOwnedByContext(o,a)){const l={buffer:o.buffer,channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,disableNormalization:!o.normalize};o=r(a,l)}return n.set(a,o),isNativeAudioNodeFaker(o)?await t(i,a,o.inputs[0]):await t(i,a,o),o};return{render(i,a){const o=n.get(a);return o!==void 0?Promise.resolve(o):s(i,a)}}},createCreateNativeOfflineAudioContext=(r,e)=>(t,n,s)=>{if(e===null)throw new Error("Missing the native OfflineAudioContext constructor.");try{return new e(t,n,s)}catch(i){throw i.name==="SyntaxError"?r():i}},createDataCloneError=()=>new DOMException("","DataCloneError"),detachArrayBuffer=r=>{const{port1:e,port2:t}=new MessageChannel;return new Promise(n=>{const s=()=>{t.onmessage=null,e.close(),t.close(),n()};t.onmessage=()=>s();try{e.postMessage(r,[r])}catch{}finally{s()}})},createDecodeAudioData=(r,e,t,n,s,i,a,o,c,l,u)=>(d,m)=>{const y=a(d)?d:i(d);if(s.has(m)){const h=t();return Promise.reject(h)}try{s.add(m)}catch{}return e(c,()=>c(y))?y.decodeAudioData(m).then(h=>(detachArrayBuffer(m).catch(()=>{}),e(o,()=>o(h))||u(h),r.add(h),h)):new Promise((h,p)=>{const f=async()=>{try{await detachArrayBuffer(m)}catch{}},v=_=>{p(_),f()};try{y.decodeAudioData(m,_=>{typeof _.copyFromChannel!="function"&&(l(_),wrapAudioBufferGetChannelDataMethod(_)),r.add(_),f().then(()=>h(_))},_=>{v(_===null?n():_)})}catch(_){v(_)}})},createDecrementCycleCounter=(r,e,t,n,s,i,a,o)=>(c,l)=>{const u=e.get(c);if(u===void 0)throw new Error("Missing the expected cycle count.");const d=i(c.context),m=o(d);if(u===l){if(e.delete(c),!m&&a(c)){const y=n(c),{outputs:h}=t(c);for(const p of h)if(isAudioNodeOutputConnection(p)){const f=n(p[0]);r(y,f,p[1],p[2])}else{const f=s(p[0]);y.connect(f,p[1])}}}else e.set(c,u-l)},DEFAULT_OPTIONS$a={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},createDelayNodeConstructor=(r,e,t,n,s,i,a)=>class extends r{constructor(c,l){const u=s(c),d={...DEFAULT_OPTIONS$a,...l},m=n(u,d),y=i(u),h=y?t(d.maxDelayTime):null;super(c,!1,m,h),this._delayTime=e(this,y,m.delayTime),a(this,d.maxDelayTime)}get delayTime(){return this._delayTime}},createDelayNodeRendererFactory=(r,e,t,n,s)=>i=>{const a=new WeakMap,o=async(c,l)=>{let u=t(c);const d=isOwnedByContext(u,l);if(!d){const m={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,delayTime:u.delayTime.value,maxDelayTime:i};u=e(l,m)}return a.set(l,u),d?await r(l,c.delayTime,u.delayTime):await n(l,c.delayTime,u.delayTime),await s(c,l,u),u};return{render(c,l){const u=a.get(l);return u!==void 0?Promise.resolve(u):o(c,l)}}},createDeleteActiveInputConnectionToAudioNode=r=>(e,t,n,s)=>r(e[s],i=>i[0]===t&&i[1]===n),createDeleteUnrenderedAudioWorkletNode=r=>(e,t)=>{r(e).delete(t)},isDelayNode=r=>"delayTime"in r,createDetectCycles=(r,e,t)=>function n(s,i){const a=isAudioNode$1(i)?i:t(r,i);if(isDelayNode(a))return[];if(s[0]===a)return[s];if(s.includes(a))return[];const{outputs:o}=e(a);return Array.from(o).map(c=>n([...s,a],c[0])).reduce((c,l)=>c.concat(l),[])},getOutputAudioNodeAtIndex=(r,e,t)=>{const n=e[t];if(n===void 0)throw r();return n},createDisconnectMultipleOutputs=r=>(e,t=void 0,n=void 0,s=0)=>t===void 0?e.forEach(i=>i.disconnect()):typeof t=="number"?getOutputAudioNodeAtIndex(r,e,t).disconnect():isNativeAudioNode$1(t)?n===void 0?e.forEach(i=>i.disconnect(t)):s===void 0?getOutputAudioNodeAtIndex(r,e,n).disconnect(t,0):getOutputAudioNodeAtIndex(r,e,n).disconnect(t,0,s):n===void 0?e.forEach(i=>i.disconnect(t)):getOutputAudioNodeAtIndex(r,e,n).disconnect(t,0),DEFAULT_OPTIONS$9={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},createDynamicsCompressorNodeConstructor=(r,e,t,n,s,i,a,o)=>class extends r{constructor(l,u){const d=i(l),m={...DEFAULT_OPTIONS$9,...u},y=n(d,m),h=a(d),p=h?t():null;super(l,!1,y,p),this._attack=e(this,h,y.attack),this._knee=e(this,h,y.knee),this._nativeDynamicsCompressorNode=y,this._ratio=e(this,h,y.ratio),this._release=e(this,h,y.release),this._threshold=e(this,h,y.threshold),o(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(l){const u=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=l,l>2)throw this._nativeDynamicsCompressorNode.channelCount=u,s()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(l){const u=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=l,l==="max")throw this._nativeDynamicsCompressorNode.channelCountMode=u,s()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return typeof this._nativeDynamicsCompressorNode.reduction.value=="number"?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}},createDynamicsCompressorNodeRendererFactory=(r,e,t,n,s)=>()=>{const i=new WeakMap,a=async(o,c)=>{let l=t(o);const u=isOwnedByContext(l,c);if(!u){const d={attack:l.attack.value,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,knee:l.knee.value,ratio:l.ratio.value,release:l.release.value,threshold:l.threshold.value};l=e(c,d)}return i.set(c,l),u?(await r(c,o.attack,l.attack),await r(c,o.knee,l.knee),await r(c,o.ratio,l.ratio),await r(c,o.release,l.release),await r(c,o.threshold,l.threshold)):(await n(c,o.attack,l.attack),await n(c,o.knee,l.knee),await n(c,o.ratio,l.ratio),await n(c,o.release,l.release),await n(c,o.threshold,l.threshold)),await s(o,c,l),l};return{render(o,c){const l=i.get(c);return l!==void 0?Promise.resolve(l):a(o,c)}}},createEncodingError=()=>new DOMException("","EncodingError"),createEvaluateSource=r=>e=>new Promise((t,n)=>{if(r===null){n(new SyntaxError);return}const s=r.document.head;if(s===null)n(new SyntaxError);else{const i=r.document.createElement("script"),a=new Blob([e],{type:"application/javascript"}),o=URL.createObjectURL(a),c=r.onerror,l=()=>{r.onerror=c,URL.revokeObjectURL(o)};r.onerror=(u,d,m,y,h)=>{if(d===o||d===r.location.href&&m===1&&y===1)return l(),n(h),!1;if(c!==null)return c(u,d,m,y,h)},i.onerror=()=>{l(),n(new SyntaxError)},i.onload=()=>{l(),t()},i.src=o,i.type="module",s.appendChild(i)}}),createEventTargetConstructor=r=>class{constructor(t){this._nativeEventTarget=t,this._listeners=new WeakMap}addEventListener(t,n,s){if(n!==null){let i=this._listeners.get(n);i===void 0&&(i=r(this,n),typeof n=="function"&&this._listeners.set(n,i)),this._nativeEventTarget.addEventListener(t,i,s)}}dispatchEvent(t){return this._nativeEventTarget.dispatchEvent(t)}removeEventListener(t,n,s){const i=n===null?void 0:this._listeners.get(n);this._nativeEventTarget.removeEventListener(t,i===void 0?null:i,s)}},createExposeCurrentFrameAndCurrentTime=r=>(e,t,n)=>{Object.defineProperties(r,{currentFrame:{configurable:!0,get(){return Math.round(e*t)}},currentTime:{configurable:!0,get(){return e}}});try{return n()}finally{r!==null&&(delete r.currentFrame,delete r.currentTime)}},createFetchSource=r=>async e=>{try{const t=await fetch(e);if(t.ok)return[await t.text(),t.url]}catch{}throw r()},DEFAULT_OPTIONS$8={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},createGainNodeConstructor=(r,e,t,n,s,i)=>class extends r{constructor(o,c){const l=s(o),u={...DEFAULT_OPTIONS$8,...c},d=n(l,u),m=i(l),y=m?t():null;super(o,!1,d,y),this._gain=e(this,m,d.gain,MOST_POSITIVE_SINGLE_FLOAT,MOST_NEGATIVE_SINGLE_FLOAT)}get gain(){return this._gain}},createGainNodeRendererFactory=(r,e,t,n,s)=>()=>{const i=new WeakMap,a=async(o,c)=>{let l=t(o);const u=isOwnedByContext(l,c);if(!u){const d={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,gain:l.gain.value};l=e(c,d)}return i.set(c,l),u?await r(c,o.gain,l.gain):await n(c,o.gain,l.gain),await s(o,c,l),l};return{render(o,c){const l=i.get(c);return l!==void 0?Promise.resolve(l):a(o,c)}}},createGetActiveAudioWorkletNodeInputs=(r,e)=>t=>e(r,t),createGetAudioNodeRenderer=r=>e=>{const t=r(e);if(t.renderer===null)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return t.renderer},createGetAudioNodeTailTime=r=>e=>{var t;return(t=r.get(e))!==null&&t!==void 0?t:0},createGetAudioParamRenderer=r=>e=>{const t=r(e);if(t.renderer===null)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return t.renderer},createGetBackupOfflineAudioContext=r=>e=>r.get(e),createInvalidStateError=()=>new DOMException("","InvalidStateError"),createGetNativeContext=r=>e=>{const t=r.get(e);if(t===void 0)throw createInvalidStateError();return t},createGetOrCreateBackupOfflineAudioContext=(r,e)=>t=>{let n=r.get(t);if(n!==void 0)return n;if(e===null)throw new Error("Missing the native OfflineAudioContext constructor.");return n=new e(1,1,44100),r.set(t,n),n},createGetUnrenderedAudioWorkletNodes=r=>e=>{const t=r.get(e);if(t===void 0)throw new Error("The context has no set of AudioWorkletNodes.");return t},createInvalidAccessError=()=>new DOMException("","InvalidAccessError"),wrapIIRFilterNodeGetFrequencyResponseMethod=r=>{r.getFrequencyResponse=(e=>(t,n,s)=>{if(t.length!==n.length||n.length!==s.length)throw createInvalidAccessError();return e.call(r,t,n,s)})(r.getFrequencyResponse)},DEFAULT_OPTIONS$7={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},createIIRFilterNodeConstructor=(r,e,t,n,s,i)=>class extends r{constructor(o,c){const l=n(o),u=s(l),d={...DEFAULT_OPTIONS$7,...c},m=e(l,u?null:o.baseLatency,d),y=u?t(d.feedback,d.feedforward):null;super(o,!1,m,y),wrapIIRFilterNodeGetFrequencyResponseMethod(m),this._nativeIIRFilterNode=m,i(this,1)}getFrequencyResponse(o,c,l){return this._nativeIIRFilterNode.getFrequencyResponse(o,c,l)}},filterBuffer=(r,e,t,n,s,i,a,o,c,l,u)=>{const d=l.length;let m=o;for(let y=0;y<d;y+=1){let h=t[0]*l[y];for(let p=1;p<s;p+=1){const f=m-p&c-1;h+=t[p]*i[f],h-=r[p]*a[f]}for(let p=s;p<n;p+=1)h+=t[p]*i[m-p&c-1];for(let p=s;p<e;p+=1)h-=r[p]*a[m-p&c-1];i[m]=l[y],a[m]=h,m=m+1&c-1,u[y]=h}return m},filterFullBuffer=(r,e,t,n)=>{const s=t instanceof Float64Array?t:new Float64Array(t),i=n instanceof Float64Array?n:new Float64Array(n),a=s.length,o=i.length,c=Math.min(a,o);if(s[0]!==1){for(let h=0;h<a;h+=1)i[h]/=s[0];for(let h=1;h<o;h+=1)s[h]/=s[0]}const l=32,u=new Float32Array(l),d=new Float32Array(l),m=e.createBuffer(r.numberOfChannels,r.length,r.sampleRate),y=r.numberOfChannels;for(let h=0;h<y;h+=1){const p=r.getChannelData(h),f=m.getChannelData(h);u.fill(0),d.fill(0),filterBuffer(s,a,i,o,c,u,d,0,l,p,f)}return m},createIIRFilterNodeRendererFactory=(r,e,t,n,s)=>(i,a)=>{const o=new WeakMap;let c=null;const l=async(u,d)=>{let m=null,y=e(u);const h=isOwnedByContext(y,d);if(d.createIIRFilter===void 0?m=r(d,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):h||(y=d.createIIRFilter(a,i)),o.set(d,m===null?y:m),m!==null){if(c===null){if(t===null)throw new Error("Missing the native OfflineAudioContext constructor.");const f=new t(u.context.destination.channelCount,u.context.length,d.sampleRate);c=(async()=>{await n(u,f,f.destination);const v=await s(f);return filterFullBuffer(v,d,i,a)})()}const p=await c;return m.buffer=p,m.start(0),m}return await n(u,d,y),y};return{render(u,d){const m=o.get(d);return m!==void 0?Promise.resolve(m):l(u,d)}}},createIncrementCycleCounterFactory=(r,e,t,n,s,i)=>a=>(o,c)=>{const l=r.get(o);if(l===void 0){if(!a&&i(o)){const u=n(o),{outputs:d}=t(o);for(const m of d)if(isAudioNodeOutputConnection(m)){const y=n(m[0]);e(u,y,m[1],m[2])}else{const y=s(m[0]);u.disconnect(y,m[1])}}r.set(o,c)}else r.set(o,l+c)},createIsAnyAudioContext=(r,e)=>t=>{const n=r.get(t);return e(n)||e(t)},createIsAnyAudioNode=(r,e)=>t=>r.has(t)||e(t),createIsAnyAudioParam=(r,e)=>t=>r.has(t)||e(t),createIsAnyOfflineAudioContext=(r,e)=>t=>{const n=r.get(t);return e(n)||e(t)},createIsNativeAudioContext=r=>e=>r!==null&&e instanceof r,createIsNativeAudioNode=r=>e=>r!==null&&typeof r.AudioNode=="function"&&e instanceof r.AudioNode,createIsNativeAudioParam=r=>e=>r!==null&&typeof r.AudioParam=="function"&&e instanceof r.AudioParam,createIsNativeContext=(r,e)=>t=>r(t)||e(t),createIsNativeOfflineAudioContext=r=>e=>r!==null&&e instanceof r,createIsSecureContext=r=>r!==null&&r.isSecureContext,createMediaElementAudioSourceNodeConstructor=(r,e,t,n)=>class extends r{constructor(i,a){const o=t(i),c=e(o,a);if(n(o))throw TypeError();super(i,!0,c,null),this._nativeMediaElementAudioSourceNode=c}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}},DEFAULT_OPTIONS$6={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},createMediaStreamAudioDestinationNodeConstructor=(r,e,t,n)=>class extends r{constructor(i,a){const o=t(i);if(n(o))throw new TypeError;const c={...DEFAULT_OPTIONS$6,...a},l=e(o,c);super(i,!1,l,null),this._nativeMediaStreamAudioDestinationNode=l}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}},createMediaStreamAudioSourceNodeConstructor=(r,e,t,n)=>class extends r{constructor(i,a){const o=t(i),c=e(o,a);if(n(o))throw new TypeError;super(i,!0,c,null),this._nativeMediaStreamAudioSourceNode=c}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}},createMediaStreamTrackAudioSourceNodeConstructor=(r,e,t)=>class extends r{constructor(s,i){const a=t(s),o=e(a,i);super(s,!0,o,null)}},createMinimalBaseAudioContextConstructor=(r,e,t,n,s,i)=>class extends t{constructor(o,c){super(o),this._nativeContext=o,CONTEXT_STORE.set(this,o),n(o)&&s.set(o,new Set),this._destination=new r(this,c),this._listener=e(this,o),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(o){const c=typeof o=="function"?i(this,o):null;this._nativeContext.onstatechange=c;const l=this._nativeContext.onstatechange;this._onstatechange=l!==null&&l===c?o:l}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}},testPromiseSupport=r=>{const e=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const t=r.decodeAudioData(e.buffer,()=>{});return t===void 0?!1:(t.catch(()=>{}),!0)}catch{}return!1},createMonitorConnections=(r,e)=>(t,n,s)=>{const i=new Set;return t.connect=(a=>(o,c=0,l=0)=>{const u=i.size===0;if(e(o))return a.call(t,o,c,l),r(i,[o,c,l],d=>d[0]===o&&d[1]===c&&d[2]===l,!0),u&&n(),o;a.call(t,o,c),r(i,[o,c],d=>d[0]===o&&d[1]===c,!0),u&&n()})(t.connect),t.disconnect=(a=>(o,c,l)=>{const u=i.size>0;if(o===void 0)a.apply(t),i.clear();else if(typeof o=="number"){a.call(t,o);for(const m of i)m[1]===o&&i.delete(m)}else{e(o)?a.call(t,o,c,l):a.call(t,o,c);for(const m of i)m[0]===o&&(c===void 0||m[1]===c)&&(l===void 0||m[2]===l)&&i.delete(m)}const d=i.size===0;u&&d&&s()})(t.disconnect),t},assignNativeAudioNodeOption=(r,e,t)=>{const n=e[t];n!==void 0&&n!==r[t]&&(r[t]=n)},assignNativeAudioNodeOptions=(r,e)=>{assignNativeAudioNodeOption(r,e,"channelCount"),assignNativeAudioNodeOption(r,e,"channelCountMode"),assignNativeAudioNodeOption(r,e,"channelInterpretation")},testAnalyserNodeGetFloatTimeDomainDataMethodSupport=r=>typeof r.getFloatTimeDomainData=="function",wrapAnalyserNodeGetFloatTimeDomainDataMethod=r=>{r.getFloatTimeDomainData=e=>{const t=new Uint8Array(e.length);r.getByteTimeDomainData(t);const n=Math.max(t.length,r.fftSize);for(let s=0;s<n;s+=1)e[s]=(t[s]-128)*.0078125;return e}},createNativeAnalyserNodeFactory=(r,e)=>(t,n)=>{const s=t.createAnalyser();if(assignNativeAudioNodeOptions(s,n),!(n.maxDecibels>n.minDecibels))throw e();return assignNativeAudioNodeOption(s,n,"fftSize"),assignNativeAudioNodeOption(s,n,"maxDecibels"),assignNativeAudioNodeOption(s,n,"minDecibels"),assignNativeAudioNodeOption(s,n,"smoothingTimeConstant"),r(testAnalyserNodeGetFloatTimeDomainDataMethodSupport,()=>testAnalyserNodeGetFloatTimeDomainDataMethodSupport(s))||wrapAnalyserNodeGetFloatTimeDomainDataMethod(s),s},createNativeAudioBufferConstructor=r=>r===null?null:r.hasOwnProperty("AudioBuffer")?r.AudioBuffer:null,assignNativeAudioNodeAudioParamValue=(r,e,t)=>{const n=e[t];n!==void 0&&n!==r[t].value&&(r[t].value=n)},wrapAudioBufferSourceNodeStartMethodConsecutiveCalls=r=>{r.start=(e=>{let t=!1;return(n=0,s=0,i)=>{if(t)throw createInvalidStateError();e.call(r,n,s,i),t=!0}})(r.start)},wrapAudioScheduledSourceNodeStartMethodNegativeParameters=r=>{r.start=(e=>(t=0,n=0,s)=>{if(typeof s=="number"&&s<0||n<0||t<0)throw new RangeError("The parameters can't be negative.");e.call(r,t,n,s)})(r.start)},wrapAudioScheduledSourceNodeStopMethodNegativeParameters=r=>{r.stop=(e=>(t=0)=>{if(t<0)throw new RangeError("The parameter can't be negative.");e.call(r,t)})(r.stop)},createNativeAudioBufferSourceNodeFactory=(r,e,t,n,s,i,a,o,c,l,u)=>(d,m)=>{const y=d.createBufferSource();return assignNativeAudioNodeOptions(y,m),assignNativeAudioNodeAudioParamValue(y,m,"playbackRate"),assignNativeAudioNodeOption(y,m,"buffer"),assignNativeAudioNodeOption(y,m,"loop"),assignNativeAudioNodeOption(y,m,"loopEnd"),assignNativeAudioNodeOption(y,m,"loopStart"),e(t,()=>t(d))||wrapAudioBufferSourceNodeStartMethodConsecutiveCalls(y),e(n,()=>n(d))||c(y),e(s,()=>s(d))||l(y,d),e(i,()=>i(d))||wrapAudioScheduledSourceNodeStartMethodNegativeParameters(y),e(a,()=>a(d))||u(y,d),e(o,()=>o(d))||wrapAudioScheduledSourceNodeStopMethodNegativeParameters(y),r(d,y),y},createNativeAudioContextConstructor=r=>r===null?null:r.hasOwnProperty("AudioContext")?r.AudioContext:r.hasOwnProperty("webkitAudioContext")?r.webkitAudioContext:null,createNativeAudioDestinationNodeFactory=(r,e)=>(t,n,s)=>{const i=t.destination;if(i.channelCount!==n)try{i.channelCount=n}catch{}s&&i.channelCountMode!=="explicit"&&(i.channelCountMode="explicit"),i.maxChannelCount===0&&Object.defineProperty(i,"maxChannelCount",{value:n});const a=r(t,{channelCount:n,channelCountMode:i.channelCountMode,channelInterpretation:i.channelInterpretation,gain:1});return e(a,"channelCount",o=>()=>o.call(a),o=>c=>{o.call(a,c);try{i.channelCount=c}catch(l){if(c>i.maxChannelCount)throw l}}),e(a,"channelCountMode",o=>()=>o.call(a),o=>c=>{o.call(a,c),i.channelCountMode=c}),e(a,"channelInterpretation",o=>()=>o.call(a),o=>c=>{o.call(a,c),i.channelInterpretation=c}),Object.defineProperty(a,"maxChannelCount",{get:()=>i.maxChannelCount}),a.connect(i),a},createNativeAudioWorkletNodeConstructor=r=>r===null?null:r.hasOwnProperty("AudioWorkletNode")?r.AudioWorkletNode:null,testClonabilityOfAudioWorkletNodeOptions=r=>{const{port1:e}=new MessageChannel;try{e.postMessage(r)}finally{e.close()}},createNativeAudioWorkletNodeFactory=(r,e,t,n,s)=>(i,a,o,c,l,u)=>{if(o!==null)try{const d=new o(i,c,u),m=new Map;let y=null;if(Object.defineProperties(d,{channelCount:{get:()=>u.channelCount,set:()=>{throw r()}},channelCountMode:{get:()=>"explicit",set:()=>{throw r()}},onprocessorerror:{get:()=>y,set:h=>{typeof y=="function"&&d.removeEventListener("processorerror",y),y=typeof h=="function"?h:null,typeof y=="function"&&d.addEventListener("processorerror",y)}}}),d.addEventListener=(h=>(...p)=>{if(p[0]==="processorerror"){const f=typeof p[1]=="function"?p[1]:typeof p[1]=="object"&&p[1]!==null&&typeof p[1].handleEvent=="function"?p[1].handleEvent:null;if(f!==null){const v=m.get(p[1]);v!==void 0?p[1]=v:(p[1]=_=>{_.type==="error"?(Object.defineProperties(_,{type:{value:"processorerror"}}),f(_)):f(new ErrorEvent(p[0],{..._}))},m.set(f,p[1]))}}return h.call(d,"error",p[1],p[2]),h.call(d,...p)})(d.addEventListener),d.removeEventListener=(h=>(...p)=>{if(p[0]==="processorerror"){const f=m.get(p[1]);f!==void 0&&(m.delete(p[1]),p[1]=f)}return h.call(d,"error",p[1],p[2]),h.call(d,p[0],p[1],p[2])})(d.removeEventListener),u.numberOfOutputs!==0){const h=t(i,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return d.connect(h).connect(i.destination),s(d,()=>h.disconnect(),()=>h.connect(i.destination))}return d}catch(d){throw d.code===11?n():d}if(l===void 0)throw n();return testClonabilityOfAudioWorkletNodeOptions(u),e(i,a,l,u)},computeBufferSize=(r,e)=>r===null?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(r*e))))),cloneAudioWorkletNodeOptions=r=>new Promise((e,t)=>{const{port1:n,port2:s}=new MessageChannel;n.onmessage=({data:i})=>{n.close(),s.close(),e(i)},n.onmessageerror=({data:i})=>{n.close(),s.close(),t(i)},s.postMessage(r)}),createAudioWorkletProcessorPromise=async(r,e)=>{const t=await cloneAudioWorkletNodeOptions(e);return new r(t)},createAudioWorkletProcessor=(r,e,t,n)=>{let s=NODE_TO_PROCESSOR_MAPS.get(r);s===void 0&&(s=new WeakMap,NODE_TO_PROCESSOR_MAPS.set(r,s));const i=createAudioWorkletProcessorPromise(t,n);return s.set(e,i),i},createNativeAudioWorkletNodeFakerFactory=(r,e,t,n,s,i,a,o,c,l,u,d,m)=>(y,h,p,f)=>{if(f.numberOfInputs===0&&f.numberOfOutputs===0)throw c();const v=Array.isArray(f.outputChannelCount)?f.outputChannelCount:Array.from(f.outputChannelCount);if(v.some(ie=>ie<1))throw c();if(v.length!==f.numberOfOutputs)throw e();if(f.channelCountMode!=="explicit")throw c();const _=f.channelCount*f.numberOfInputs,O=v.reduce((ie,ye)=>ie+ye,0),k=p.parameterDescriptors===void 0?0:p.parameterDescriptors.length;if(_+k>6||O>6)throw c();const g=new MessageChannel,b=[],N=[];for(let ie=0;ie<f.numberOfInputs;ie+=1)b.push(a(y,{channelCount:f.channelCount,channelCountMode:f.channelCountMode,channelInterpretation:f.channelInterpretation,gain:1})),N.push(s(y,{channelCount:f.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:f.channelCount}));const S=[];if(p.parameterDescriptors!==void 0)for(const{defaultValue:ie,maxValue:ye,minValue:xe,name:Ve}of p.parameterDescriptors){const We=i(y,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:f.parameterData[Ve]!==void 0?f.parameterData[Ve]:ie===void 0?0:ie});Object.defineProperties(We.offset,{defaultValue:{get:()=>ie===void 0?0:ie},maxValue:{get:()=>ye===void 0?MOST_POSITIVE_SINGLE_FLOAT:ye},minValue:{get:()=>xe===void 0?MOST_NEGATIVE_SINGLE_FLOAT:xe}}),S.push(We)}const T=n(y,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,_+k)}),M=computeBufferSize(h,y.sampleRate),P=o(y,M,_+k,Math.max(1,O)),$=s(y,{channelCount:Math.max(1,O),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,O)}),K=[];for(let ie=0;ie<f.numberOfOutputs;ie+=1)K.push(n(y,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:v[ie]}));for(let ie=0;ie<f.numberOfInputs;ie+=1){b[ie].connect(N[ie]);for(let ye=0;ye<f.channelCount;ye+=1)N[ie].connect(T,ye,ie*f.channelCount+ye)}const L=new ReadOnlyMap(p.parameterDescriptors===void 0?[]:p.parameterDescriptors.map(({name:ie},ye)=>{const xe=S[ye];return xe.connect(T,0,_+ye),xe.start(0),[ie,xe.offset]}));T.connect(P);let j=f.channelInterpretation,q=null;const te=f.numberOfOutputs===0?[P]:K,F={get bufferSize(){return M},get channelCount(){return f.channelCount},set channelCount(ie){throw t()},get channelCountMode(){return f.channelCountMode},set channelCountMode(ie){throw t()},get channelInterpretation(){return j},set channelInterpretation(ie){for(const ye of b)ye.channelInterpretation=ie;j=ie},get context(){return P.context},get inputs(){return b},get numberOfInputs(){return f.numberOfInputs},get numberOfOutputs(){return f.numberOfOutputs},get onprocessorerror(){return q},set onprocessorerror(ie){typeof q=="function"&&F.removeEventListener("processorerror",q),q=typeof ie=="function"?ie:null,typeof q=="function"&&F.addEventListener("processorerror",q)},get parameters(){return L},get port(){return g.port2},addEventListener(...ie){return P.addEventListener(ie[0],ie[1],ie[2])},connect:r.bind(null,te),disconnect:l.bind(null,te),dispatchEvent(...ie){return P.dispatchEvent(ie[0])},removeEventListener(...ie){return P.removeEventListener(ie[0],ie[1],ie[2])}},z=new Map;g.port1.addEventListener=(ie=>(...ye)=>{if(ye[0]==="message"){const xe=typeof ye[1]=="function"?ye[1]:typeof ye[1]=="object"&&ye[1]!==null&&typeof ye[1].handleEvent=="function"?ye[1].handleEvent:null;if(xe!==null){const Ve=z.get(ye[1]);Ve!==void 0?ye[1]=Ve:(ye[1]=We=>{u(y.currentTime,y.sampleRate,()=>xe(We))},z.set(xe,ye[1]))}}return ie.call(g.port1,ye[0],ye[1],ye[2])})(g.port1.addEventListener),g.port1.removeEventListener=(ie=>(...ye)=>{if(ye[0]==="message"){const xe=z.get(ye[1]);xe!==void 0&&(z.delete(ye[1]),ye[1]=xe)}return ie.call(g.port1,ye[0],ye[1],ye[2])})(g.port1.removeEventListener);let Q=null;Object.defineProperty(g.port1,"onmessage",{get:()=>Q,set:ie=>{typeof Q=="function"&&g.port1.removeEventListener("message",Q),Q=typeof ie=="function"?ie:null,typeof Q=="function"&&(g.port1.addEventListener("message",Q),g.port1.start())}}),p.prototype.port=g.port1;let ne=null;createAudioWorkletProcessor(y,F,p,f).then(ie=>ne=ie);const U=createNestedArrays(f.numberOfInputs,f.channelCount),w=createNestedArrays(f.numberOfOutputs,v),x=p.parameterDescriptors===void 0?[]:p.parameterDescriptors.reduce((ie,{name:ye})=>({...ie,[ye]:new Float32Array(128)}),{});let R=!0;const V=()=>{f.numberOfOutputs>0&&P.disconnect($);for(let ie=0,ye=0;ie<f.numberOfOutputs;ie+=1){const xe=K[ie];for(let Ve=0;Ve<v[ie];Ve+=1)$.disconnect(xe,ye+Ve,Ve);ye+=v[ie]}},D=new Map;P.onaudioprocess=({inputBuffer:ie,outputBuffer:ye})=>{if(ne!==null){const xe=d(F);for(let Ve=0;Ve<M;Ve+=128){for(let We=0;We<f.numberOfInputs;We+=1)for(let Pe=0;Pe<f.channelCount;Pe+=1)copyFromChannel(ie,U[We],Pe,Pe,Ve);p.parameterDescriptors!==void 0&&p.parameterDescriptors.forEach(({name:We},Pe)=>{copyFromChannel(ie,x,We,_+Pe,Ve)});for(let We=0;We<f.numberOfInputs;We+=1)for(let Pe=0;Pe<v[We];Pe+=1)w[We][Pe].byteLength===0&&(w[We][Pe]=new Float32Array(128));try{const We=U.map((He,Me)=>{if(xe[Me].size>0)return D.set(Me,M/128),He;const fe=D.get(Me);return fe===void 0?[]:(He.every(Ee=>Ee.every(Be=>Be===0))&&(fe===1?D.delete(Me):D.set(Me,fe-1)),He)});R=u(y.currentTime+Ve/y.sampleRate,y.sampleRate,()=>ne.process(We,w,x));for(let He=0,Me=0;He<f.numberOfOutputs;He+=1){for(let be=0;be<v[He];be+=1)copyToChannel(ye,w[He],be,Me+be,Ve);Me+=v[He]}}catch(We){R=!1,F.dispatchEvent(new ErrorEvent("processorerror",{colno:We.colno,filename:We.filename,lineno:We.lineno,message:We.message}))}if(!R){for(let We=0;We<f.numberOfInputs;We+=1){b[We].disconnect(N[We]);for(let Pe=0;Pe<f.channelCount;Pe+=1)N[Ve].disconnect(T,Pe,We*f.channelCount+Pe)}if(p.parameterDescriptors!==void 0){const We=p.parameterDescriptors.length;for(let Pe=0;Pe<We;Pe+=1){const He=S[Pe];He.disconnect(T,0,_+Pe),He.stop()}}T.disconnect(P),P.onaudioprocess=null,Y?V():me();break}}}};let Y=!1;const W=a(y,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),ee=()=>P.connect(W).connect(y.destination),me=()=>{P.disconnect(W),W.disconnect()},he=()=>{if(R){me(),f.numberOfOutputs>0&&P.connect($);for(let ie=0,ye=0;ie<f.numberOfOutputs;ie+=1){const xe=K[ie];for(let Ve=0;Ve<v[ie];Ve+=1)$.connect(xe,ye+Ve,Ve);ye+=v[ie]}}Y=!0},Ae=()=>{R&&(ee(),V()),Y=!1};return ee(),m(F,he,Ae)},createNativeBiquadFilterNode=(r,e)=>{const t=r.createBiquadFilter();return assignNativeAudioNodeOptions(t,e),assignNativeAudioNodeAudioParamValue(t,e,"Q"),assignNativeAudioNodeAudioParamValue(t,e,"detune"),assignNativeAudioNodeAudioParamValue(t,e,"frequency"),assignNativeAudioNodeAudioParamValue(t,e,"gain"),assignNativeAudioNodeOption(t,e,"type"),t},createNativeChannelMergerNodeFactory=(r,e)=>(t,n)=>{const s=t.createChannelMerger(n.numberOfInputs);return r!==null&&r.name==="webkitAudioContext"&&e(t,s),assignNativeAudioNodeOptions(s,n),s},wrapChannelSplitterNode=r=>{const e=r.numberOfOutputs;Object.defineProperty(r,"channelCount",{get:()=>e,set:t=>{if(t!==e)throw createInvalidStateError()}}),Object.defineProperty(r,"channelCountMode",{get:()=>"explicit",set:t=>{if(t!=="explicit")throw createInvalidStateError()}}),Object.defineProperty(r,"channelInterpretation",{get:()=>"discrete",set:t=>{if(t!=="discrete")throw createInvalidStateError()}})},createNativeChannelSplitterNode=(r,e)=>{const t=r.createChannelSplitter(e.numberOfOutputs);return assignNativeAudioNodeOptions(t,e),wrapChannelSplitterNode(t),t},createNativeConstantSourceNodeFactory=(r,e,t,n,s)=>(i,a)=>{if(i.createConstantSource===void 0)return t(i,a);const o=i.createConstantSource();return assignNativeAudioNodeOptions(o,a),assignNativeAudioNodeAudioParamValue(o,a,"offset"),e(n,()=>n(i))||wrapAudioScheduledSourceNodeStartMethodNegativeParameters(o),e(s,()=>s(i))||wrapAudioScheduledSourceNodeStopMethodNegativeParameters(o),r(i,o),o},interceptConnections=(r,e)=>(r.connect=e.connect.bind(e),r.disconnect=e.disconnect.bind(e),r),createNativeConstantSourceNodeFakerFactory=(r,e,t,n)=>(s,{offset:i,...a})=>{const o=s.createBuffer(1,2,44100),c=e(s,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),l=t(s,{...a,gain:i}),u=o.getChannelData(0);u[0]=1,u[1]=1,c.buffer=o,c.loop=!0;const d={get bufferSize(){},get channelCount(){return l.channelCount},set channelCount(h){l.channelCount=h},get channelCountMode(){return l.channelCountMode},set channelCountMode(h){l.channelCountMode=h},get channelInterpretation(){return l.channelInterpretation},set channelInterpretation(h){l.channelInterpretation=h},get context(){return l.context},get inputs(){return[]},get numberOfInputs(){return c.numberOfInputs},get numberOfOutputs(){return l.numberOfOutputs},get offset(){return l.gain},get onended(){return c.onended},set onended(h){c.onended=h},addEventListener(...h){return c.addEventListener(h[0],h[1],h[2])},dispatchEvent(...h){return c.dispatchEvent(h[0])},removeEventListener(...h){return c.removeEventListener(h[0],h[1],h[2])},start(h=0){c.start.call(c,h)},stop(h=0){c.stop.call(c,h)}},m=()=>c.connect(l),y=()=>c.disconnect(l);return r(s,c),n(interceptConnections(d,l),m,y)},createNativeConvolverNodeFactory=(r,e)=>(t,n)=>{const s=t.createConvolver();if(assignNativeAudioNodeOptions(s,n),n.disableNormalization===s.normalize&&(s.normalize=!n.disableNormalization),assignNativeAudioNodeOption(s,n,"buffer"),n.channelCount>2||(e(s,"channelCount",i=>()=>i.call(s),i=>a=>{if(a>2)throw r();return i.call(s,a)}),n.channelCountMode==="max"))throw r();return e(s,"channelCountMode",i=>()=>i.call(s),i=>a=>{if(a==="max")throw r();return i.call(s,a)}),s},createNativeDelayNode=(r,e)=>{const t=r.createDelay(e.maxDelayTime);return assignNativeAudioNodeOptions(t,e),assignNativeAudioNodeAudioParamValue(t,e,"delayTime"),t},createNativeDynamicsCompressorNodeFactory=r=>(e,t)=>{const n=e.createDynamicsCompressor();if(assignNativeAudioNodeOptions(n,t),t.channelCount>2||t.channelCountMode==="max")throw r();return assignNativeAudioNodeAudioParamValue(n,t,"attack"),assignNativeAudioNodeAudioParamValue(n,t,"knee"),assignNativeAudioNodeAudioParamValue(n,t,"ratio"),assignNativeAudioNodeAudioParamValue(n,t,"release"),assignNativeAudioNodeAudioParamValue(n,t,"threshold"),n},createNativeGainNode=(r,e)=>{const t=r.createGain();return assignNativeAudioNodeOptions(t,e),assignNativeAudioNodeAudioParamValue(t,e,"gain"),t},createNativeIIRFilterNodeFactory=r=>(e,t,n)=>{if(e.createIIRFilter===void 0)return r(e,t,n);const s=e.createIIRFilter(n.feedforward,n.feedback);return assignNativeAudioNodeOptions(s,n),s};function divide(r,e){const t=e[0]*e[0]+e[1]*e[1];return[(r[0]*e[0]+r[1]*e[1])/t,(r[1]*e[0]-r[0]*e[1])/t]}function multiply(r,e){return[r[0]*e[0]-r[1]*e[1],r[0]*e[1]+r[1]*e[0]]}function evaluatePolynomial(r,e){let t=[0,0];for(let n=r.length-1;n>=0;n-=1)t=multiply(t,e),t[0]+=r[n];return t}const createNativeIIRFilterNodeFakerFactory=(r,e,t,n)=>(s,i,{channelCount:a,channelCountMode:o,channelInterpretation:c,feedback:l,feedforward:u})=>{const d=computeBufferSize(i,s.sampleRate),m=l instanceof Float64Array?l:new Float64Array(l),y=u instanceof Float64Array?u:new Float64Array(u),h=m.length,p=y.length,f=Math.min(h,p);if(h===0||h>20)throw n();if(m[0]===0)throw e();if(p===0||p>20)throw n();if(y[0]===0)throw e();if(m[0]!==1){for(let S=0;S<p;S+=1)y[S]/=m[0];for(let S=1;S<h;S+=1)m[S]/=m[0]}const v=t(s,d,a,a);v.channelCount=a,v.channelCountMode=o,v.channelInterpretation=c;const _=32,O=[],k=[],g=[];for(let S=0;S<a;S+=1){O.push(0);const T=new Float32Array(_),M=new Float32Array(_);T.fill(0),M.fill(0),k.push(T),g.push(M)}v.onaudioprocess=S=>{const T=S.inputBuffer,M=S.outputBuffer,P=T.numberOfChannels;for(let $=0;$<P;$+=1){const K=T.getChannelData($),L=M.getChannelData($);O[$]=filterBuffer(m,h,y,p,f,k[$],g[$],O[$],_,K,L)}};const b=s.sampleRate/2;return interceptConnections({get bufferSize(){return d},get channelCount(){return v.channelCount},set channelCount(S){v.channelCount=S},get channelCountMode(){return v.channelCountMode},set channelCountMode(S){v.channelCountMode=S},get channelInterpretation(){return v.channelInterpretation},set channelInterpretation(S){v.channelInterpretation=S},get context(){return v.context},get inputs(){return[v]},get numberOfInputs(){return v.numberOfInputs},get numberOfOutputs(){return v.numberOfOutputs},addEventListener(...S){return v.addEventListener(S[0],S[1],S[2])},dispatchEvent(...S){return v.dispatchEvent(S[0])},getFrequencyResponse(S,T,M){if(S.length!==T.length||T.length!==M.length)throw r();const P=S.length;for(let $=0;$<P;$+=1){const K=-Math.PI*(S[$]/b),L=[Math.cos(K),Math.sin(K)],j=evaluatePolynomial(y,L),q=evaluatePolynomial(m,L),te=divide(j,q);T[$]=Math.sqrt(te[0]*te[0]+te[1]*te[1]),M[$]=Math.atan2(te[1],te[0])}},removeEventListener(...S){return v.removeEventListener(S[0],S[1],S[2])}},v)},createNativeMediaElementAudioSourceNode=(r,e)=>r.createMediaElementSource(e.mediaElement),createNativeMediaStreamAudioDestinationNode=(r,e)=>{const t=r.createMediaStreamDestination();return assignNativeAudioNodeOptions(t,e),t.numberOfOutputs===1&&Object.defineProperty(t,"numberOfOutputs",{get:()=>0}),t},createNativeMediaStreamAudioSourceNode=(r,{mediaStream:e})=>{const t=e.getAudioTracks();t.sort((i,a)=>i.id<a.id?-1:i.id>a.id?1:0);const n=t.slice(0,1),s=r.createMediaStreamSource(new MediaStream(n));return Object.defineProperty(s,"mediaStream",{value:e}),s},createNativeMediaStreamTrackAudioSourceNodeFactory=(r,e)=>(t,{mediaStreamTrack:n})=>{if(typeof t.createMediaStreamTrackSource=="function")return t.createMediaStreamTrackSource(n);const s=new MediaStream([n]),i=t.createMediaStreamSource(s);if(n.kind!=="audio")throw r();if(e(t))throw new TypeError;return i},createNativeOfflineAudioContextConstructor=r=>r===null?null:r.hasOwnProperty("OfflineAudioContext")?r.OfflineAudioContext:r.hasOwnProperty("webkitOfflineAudioContext")?r.webkitOfflineAudioContext:null,createNativeOscillatorNodeFactory=(r,e,t,n,s,i)=>(a,o)=>{const c=a.createOscillator();return assignNativeAudioNodeOptions(c,o),assignNativeAudioNodeAudioParamValue(c,o,"detune"),assignNativeAudioNodeAudioParamValue(c,o,"frequency"),o.periodicWave!==void 0?c.setPeriodicWave(o.periodicWave):assignNativeAudioNodeOption(c,o,"type"),e(t,()=>t(a))||wrapAudioScheduledSourceNodeStartMethodNegativeParameters(c),e(n,()=>n(a))||i(c,a),e(s,()=>s(a))||wrapAudioScheduledSourceNodeStopMethodNegativeParameters(c),r(a,c),c},createNativePannerNodeFactory=r=>(e,t)=>{const n=e.createPanner();return n.orientationX===void 0?r(e,t):(assignNativeAudioNodeOptions(n,t),assignNativeAudioNodeAudioParamValue(n,t,"orientationX"),assignNativeAudioNodeAudioParamValue(n,t,"orientationY"),assignNativeAudioNodeAudioParamValue(n,t,"orientationZ"),assignNativeAudioNodeAudioParamValue(n,t,"positionX"),assignNativeAudioNodeAudioParamValue(n,t,"positionY"),assignNativeAudioNodeAudioParamValue(n,t,"positionZ"),assignNativeAudioNodeOption(n,t,"coneInnerAngle"),assignNativeAudioNodeOption(n,t,"coneOuterAngle"),assignNativeAudioNodeOption(n,t,"coneOuterGain"),assignNativeAudioNodeOption(n,t,"distanceModel"),assignNativeAudioNodeOption(n,t,"maxDistance"),assignNativeAudioNodeOption(n,t,"panningModel"),assignNativeAudioNodeOption(n,t,"refDistance"),assignNativeAudioNodeOption(n,t,"rolloffFactor"),n)},createNativePannerNodeFakerFactory=(r,e,t,n,s,i,a,o,c,l)=>(u,{coneInnerAngle:d,coneOuterAngle:m,coneOuterGain:y,distanceModel:h,maxDistance:p,orientationX:f,orientationY:v,orientationZ:_,panningModel:O,positionX:k,positionY:g,positionZ:b,refDistance:N,rolloffFactor:S,...T})=>{const M=u.createPanner();if(T.channelCount>2||T.channelCountMode==="max")throw a();assignNativeAudioNodeOptions(M,T);const P={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},$=t(u,{...P,channelInterpretation:"speakers",numberOfInputs:6}),K=n(u,{...T,gain:1}),L=n(u,{...P,gain:1}),j=n(u,{...P,gain:0}),q=n(u,{...P,gain:0}),te=n(u,{...P,gain:0}),F=n(u,{...P,gain:0}),z=n(u,{...P,gain:0}),Q=s(u,256,6,1),ne=i(u,{...P,curve:new Float32Array([1,1]),oversample:"none"});let de=[f,v,_],U=[k,g,b];const w=new Float32Array(1);Q.onaudioprocess=({inputBuffer:D})=>{const Y=[c(D,w,0),c(D,w,1),c(D,w,2)];Y.some((ee,me)=>ee!==de[me])&&(M.setOrientation(...Y),de=Y);const W=[c(D,w,3),c(D,w,4),c(D,w,5)];W.some((ee,me)=>ee!==U[me])&&(M.setPosition(...W),U=W)},Object.defineProperty(j.gain,"defaultValue",{get:()=>0}),Object.defineProperty(q.gain,"defaultValue",{get:()=>0}),Object.defineProperty(te.gain,"defaultValue",{get:()=>0}),Object.defineProperty(F.gain,"defaultValue",{get:()=>0}),Object.defineProperty(z.gain,"defaultValue",{get:()=>0});const x={get bufferSize(){},get channelCount(){return M.channelCount},set channelCount(D){if(D>2)throw a();K.channelCount=D,M.channelCount=D},get channelCountMode(){return M.channelCountMode},set channelCountMode(D){if(D==="max")throw a();K.channelCountMode=D,M.channelCountMode=D},get channelInterpretation(){return M.channelInterpretation},set channelInterpretation(D){K.channelInterpretation=D,M.channelInterpretation=D},get coneInnerAngle(){return M.coneInnerAngle},set coneInnerAngle(D){M.coneInnerAngle=D},get coneOuterAngle(){return M.coneOuterAngle},set coneOuterAngle(D){M.coneOuterAngle=D},get coneOuterGain(){return M.coneOuterGain},set coneOuterGain(D){if(D<0||D>1)throw e();M.coneOuterGain=D},get context(){return M.context},get distanceModel(){return M.distanceModel},set distanceModel(D){M.distanceModel=D},get inputs(){return[K]},get maxDistance(){return M.maxDistance},set maxDistance(D){if(D<0)throw new RangeError;M.maxDistance=D},get numberOfInputs(){return M.numberOfInputs},get numberOfOutputs(){return M.numberOfOutputs},get orientationX(){return L.gain},get orientationY(){return j.gain},get orientationZ(){return q.gain},get panningModel(){return M.panningModel},set panningModel(D){M.panningModel=D},get positionX(){return te.gain},get positionY(){return F.gain},get positionZ(){return z.gain},get refDistance(){return M.refDistance},set refDistance(D){if(D<0)throw new RangeError;M.refDistance=D},get rolloffFactor(){return M.rolloffFactor},set rolloffFactor(D){if(D<0)throw new RangeError;M.rolloffFactor=D},addEventListener(...D){return K.addEventListener(D[0],D[1],D[2])},dispatchEvent(...D){return K.dispatchEvent(D[0])},removeEventListener(...D){return K.removeEventListener(D[0],D[1],D[2])}};d!==x.coneInnerAngle&&(x.coneInnerAngle=d),m!==x.coneOuterAngle&&(x.coneOuterAngle=m),y!==x.coneOuterGain&&(x.coneOuterGain=y),h!==x.distanceModel&&(x.distanceModel=h),p!==x.maxDistance&&(x.maxDistance=p),f!==x.orientationX.value&&(x.orientationX.value=f),v!==x.orientationY.value&&(x.orientationY.value=v),_!==x.orientationZ.value&&(x.orientationZ.value=_),O!==x.panningModel&&(x.panningModel=O),k!==x.positionX.value&&(x.positionX.value=k),g!==x.positionY.value&&(x.positionY.value=g),b!==x.positionZ.value&&(x.positionZ.value=b),N!==x.refDistance&&(x.refDistance=N),S!==x.rolloffFactor&&(x.rolloffFactor=S),(de[0]!==1||de[1]!==0||de[2]!==0)&&M.setOrientation(...de),(U[0]!==0||U[1]!==0||U[2]!==0)&&M.setPosition(...U);const R=()=>{K.connect(M),r(K,ne,0,0),ne.connect(L).connect($,0,0),ne.connect(j).connect($,0,1),ne.connect(q).connect($,0,2),ne.connect(te).connect($,0,3),ne.connect(F).connect($,0,4),ne.connect(z).connect($,0,5),$.connect(Q).connect(u.destination)},V=()=>{K.disconnect(M),o(K,ne,0,0),ne.disconnect(L),L.disconnect($),ne.disconnect(j),j.disconnect($),ne.disconnect(q),q.disconnect($),ne.disconnect(te),te.disconnect($),ne.disconnect(F),F.disconnect($),ne.disconnect(z),z.disconnect($),$.disconnect(Q),Q.disconnect(u.destination)};return l(interceptConnections(x,M),R,V)},createNativePeriodicWaveFactory=r=>(e,{disableNormalization:t,imag:n,real:s})=>{const i=n instanceof Float32Array?n:new Float32Array(n),a=s instanceof Float32Array?s:new Float32Array(s),o=e.createPeriodicWave(a,i,{disableNormalization:t});if(Array.from(n).length<2)throw r();return o},createNativeScriptProcessorNode=(r,e,t,n)=>r.createScriptProcessor(e,t,n),createNativeStereoPannerNodeFactory=(r,e)=>(t,n)=>{const s=n.channelCountMode;if(s==="clamped-max")throw e();if(t.createStereoPanner===void 0)return r(t,n);const i=t.createStereoPanner();return assignNativeAudioNodeOptions(i,n),assignNativeAudioNodeAudioParamValue(i,n,"pan"),Object.defineProperty(i,"channelCountMode",{get:()=>s,set:a=>{if(a!==s)throw e()}}),i},createNativeStereoPannerNodeFakerFactory=(r,e,t,n,s,i)=>{const o=new Float32Array([1,1]),c=Math.PI/2,l={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},u={...l,oversample:"none"},d=(h,p,f,v)=>{const _=new Float32Array(16385),O=new Float32Array(16385);for(let T=0;T<16385;T+=1){const M=T/16384*c;_[T]=Math.cos(M),O[T]=Math.sin(M)}const k=t(h,{...l,gain:0}),g=n(h,{...u,curve:_}),b=n(h,{...u,curve:o}),N=t(h,{...l,gain:0}),S=n(h,{...u,curve:O});return{connectGraph(){p.connect(k),p.connect(b.inputs===void 0?b:b.inputs[0]),p.connect(N),b.connect(f),f.connect(g.inputs===void 0?g:g.inputs[0]),f.connect(S.inputs===void 0?S:S.inputs[0]),g.connect(k.gain),S.connect(N.gain),k.connect(v,0,0),N.connect(v,0,1)},disconnectGraph(){p.disconnect(k),p.disconnect(b.inputs===void 0?b:b.inputs[0]),p.disconnect(N),b.disconnect(f),f.disconnect(g.inputs===void 0?g:g.inputs[0]),f.disconnect(S.inputs===void 0?S:S.inputs[0]),g.disconnect(k.gain),S.disconnect(N.gain),k.disconnect(v,0,0),N.disconnect(v,0,1)}}},m=(h,p,f,v)=>{const _=new Float32Array(16385),O=new Float32Array(16385),k=new Float32Array(16385),g=new Float32Array(16385),b=Math.floor(16385/2);for(let te=0;te<16385;te+=1)if(te>b){const F=(te-b)/(16384-b)*c;_[te]=Math.cos(F),O[te]=Math.sin(F),k[te]=0,g[te]=1}else{const F=te/(16384-b)*c;_[te]=1,O[te]=0,k[te]=Math.cos(F),g[te]=Math.sin(F)}const N=e(h,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),S=t(h,{...l,gain:0}),T=n(h,{...u,curve:_}),M=t(h,{...l,gain:0}),P=n(h,{...u,curve:O}),$=n(h,{...u,curve:o}),K=t(h,{...l,gain:0}),L=n(h,{...u,curve:k}),j=t(h,{...l,gain:0}),q=n(h,{...u,curve:g});return{connectGraph(){p.connect(N),p.connect($.inputs===void 0?$:$.inputs[0]),N.connect(S,0),N.connect(M,0),N.connect(K,1),N.connect(j,1),$.connect(f),f.connect(T.inputs===void 0?T:T.inputs[0]),f.connect(P.inputs===void 0?P:P.inputs[0]),f.connect(L.inputs===void 0?L:L.inputs[0]),f.connect(q.inputs===void 0?q:q.inputs[0]),T.connect(S.gain),P.connect(M.gain),L.connect(K.gain),q.connect(j.gain),S.connect(v,0,0),K.connect(v,0,0),M.connect(v,0,1),j.connect(v,0,1)},disconnectGraph(){p.disconnect(N),p.disconnect($.inputs===void 0?$:$.inputs[0]),N.disconnect(S,0),N.disconnect(M,0),N.disconnect(K,1),N.disconnect(j,1),$.disconnect(f),f.disconnect(T.inputs===void 0?T:T.inputs[0]),f.disconnect(P.inputs===void 0?P:P.inputs[0]),f.disconnect(L.inputs===void 0?L:L.inputs[0]),f.disconnect(q.inputs===void 0?q:q.inputs[0]),T.disconnect(S.gain),P.disconnect(M.gain),L.disconnect(K.gain),q.disconnect(j.gain),S.disconnect(v,0,0),K.disconnect(v,0,0),M.disconnect(v,0,1),j.disconnect(v,0,1)}}},y=(h,p,f,v,_)=>{if(p===1)return d(h,f,v,_);if(p===2)return m(h,f,v,_);throw s()};return(h,{channelCount:p,channelCountMode:f,pan:v,..._})=>{if(f==="max")throw s();const O=r(h,{..._,channelCount:1,channelCountMode:f,numberOfInputs:2}),k=t(h,{..._,channelCount:p,channelCountMode:f,gain:1}),g=t(h,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:v});let{connectGraph:b,disconnectGraph:N}=y(h,p,k,g,O);Object.defineProperty(g.gain,"defaultValue",{get:()=>0}),Object.defineProperty(g.gain,"maxValue",{get:()=>1}),Object.defineProperty(g.gain,"minValue",{get:()=>-1});const S={get bufferSize(){},get channelCount(){return k.channelCount},set channelCount($){k.channelCount!==$&&(T&&N(),{connectGraph:b,disconnectGraph:N}=y(h,$,k,g,O),T&&b()),k.channelCount=$},get channelCountMode(){return k.channelCountMode},set channelCountMode($){if($==="clamped-max"||$==="max")throw s();k.channelCountMode=$},get channelInterpretation(){return k.channelInterpretation},set channelInterpretation($){k.channelInterpretation=$},get context(){return k.context},get inputs(){return[k]},get numberOfInputs(){return k.numberOfInputs},get numberOfOutputs(){return k.numberOfOutputs},get pan(){return g.gain},addEventListener(...$){return k.addEventListener($[0],$[1],$[2])},dispatchEvent(...$){return k.dispatchEvent($[0])},removeEventListener(...$){return k.removeEventListener($[0],$[1],$[2])}};let T=!1;const M=()=>{b(),T=!0},P=()=>{N(),T=!1};return i(interceptConnections(S,O),M,P)}},createNativeWaveShaperNodeFactory=(r,e,t,n,s,i,a)=>(o,c)=>{const l=o.createWaveShaper();if(i!==null&&i.name==="webkitAudioContext"&&o.createGain().gain.automationRate===void 0)return t(o,c);assignNativeAudioNodeOptions(l,c);const u=c.curve===null||c.curve instanceof Float32Array?c.curve:new Float32Array(c.curve);if(u!==null&&u.length<2)throw e();assignNativeAudioNodeOption(l,{curve:u},"curve"),assignNativeAudioNodeOption(l,c,"oversample");let d=null,m=!1;return a(l,"curve",p=>()=>p.call(l),p=>f=>(p.call(l,f),m&&(n(f)&&d===null?d=r(o,l):!n(f)&&d!==null&&(d(),d=null)),f)),s(l,()=>{m=!0,n(l.curve)&&(d=r(o,l))},()=>{m=!1,d!==null&&(d(),d=null)})},createNativeWaveShaperNodeFakerFactory=(r,e,t,n,s)=>(i,{curve:a,oversample:o,...c})=>{const l=i.createWaveShaper(),u=i.createWaveShaper();assignNativeAudioNodeOptions(l,c),assignNativeAudioNodeOptions(u,c);const d=t(i,{...c,gain:1}),m=t(i,{...c,gain:-1}),y=t(i,{...c,gain:1}),h=t(i,{...c,gain:-1});let p=null,f=!1,v=null;const _={get bufferSize(){},get channelCount(){return l.channelCount},set channelCount(g){d.channelCount=g,m.channelCount=g,l.channelCount=g,y.channelCount=g,u.channelCount=g,h.channelCount=g},get channelCountMode(){return l.channelCountMode},set channelCountMode(g){d.channelCountMode=g,m.channelCountMode=g,l.channelCountMode=g,y.channelCountMode=g,u.channelCountMode=g,h.channelCountMode=g},get channelInterpretation(){return l.channelInterpretation},set channelInterpretation(g){d.channelInterpretation=g,m.channelInterpretation=g,l.channelInterpretation=g,y.channelInterpretation=g,u.channelInterpretation=g,h.channelInterpretation=g},get context(){return l.context},get curve(){return v},set curve(g){if(g!==null&&g.length<2)throw e();if(g===null)l.curve=g,u.curve=g;else{const b=g.length,N=new Float32Array(b+2-b%2),S=new Float32Array(b+2-b%2);N[0]=g[0],S[0]=-g[b-1];const T=Math.ceil((b+1)/2),M=(b+1)/2-1;for(let P=1;P<T;P+=1){const $=P/T*M,K=Math.floor($),L=Math.ceil($);N[P]=K===L?g[K]:(1-($-K))*g[K]+(1-(L-$))*g[L],S[P]=K===L?-g[b-1-K]:-((1-($-K))*g[b-1-K])-(1-(L-$))*g[b-1-L]}N[T]=b%2===1?g[T-1]:(g[T-2]+g[T-1])/2,l.curve=N,u.curve=S}v=g,f&&(n(v)&&p===null?p=r(i,d):p!==null&&(p(),p=null))},get inputs(){return[d]},get numberOfInputs(){return l.numberOfInputs},get numberOfOutputs(){return l.numberOfOutputs},get oversample(){return l.oversample},set oversample(g){l.oversample=g,u.oversample=g},addEventListener(...g){return d.addEventListener(g[0],g[1],g[2])},dispatchEvent(...g){return d.dispatchEvent(g[0])},removeEventListener(...g){return d.removeEventListener(g[0],g[1],g[2])}};a!==null&&(_.curve=a instanceof Float32Array?a:new Float32Array(a)),o!==_.oversample&&(_.oversample=o);const O=()=>{d.connect(l).connect(y),d.connect(m).connect(u).connect(h).connect(y),f=!0,n(v)&&(p=r(i,d))},k=()=>{d.disconnect(l),l.disconnect(y),d.disconnect(m),m.disconnect(u),u.disconnect(h),h.disconnect(y),f=!1,p!==null&&(p(),p=null)};return s(interceptConnections(_,y),O,k)},createNotSupportedError=()=>new DOMException("","NotSupportedError"),DEFAULT_OPTIONS$5={numberOfChannels:1},createOfflineAudioContextConstructor=(r,e,t,n,s)=>class extends r{constructor(a,o,c){let l;if(typeof a=="number"&&o!==void 0&&c!==void 0)l={length:o,numberOfChannels:a,sampleRate:c};else if(typeof a=="object")l=a;else throw new Error("The given parameters are not valid.");const{length:u,numberOfChannels:d,sampleRate:m}={...DEFAULT_OPTIONS$5,...l},y=n(d,u,m);e(testPromiseSupport,()=>testPromiseSupport(y))||y.addEventListener("statechange",(()=>{let h=0;const p=f=>{this._state==="running"&&(h>0?(y.removeEventListener("statechange",p),f.stopImmediatePropagation(),this._waitForThePromiseToSettle(f)):h+=1)};return p})()),super(y,d),this._length=u,this._nativeOfflineAudioContext=y,this._state=null}get length(){return this._nativeOfflineAudioContext.length===void 0?this._length:this._nativeOfflineAudioContext.length}get state(){return this._state===null?this._nativeOfflineAudioContext.state:this._state}startRendering(){return this._state==="running"?Promise.reject(t()):(this._state="running",s(this.destination,this._nativeOfflineAudioContext).finally(()=>{this._state=null,deactivateAudioGraph(this)}))}_waitForThePromiseToSettle(a){this._state===null?this._nativeOfflineAudioContext.dispatchEvent(a):setTimeout(()=>this._waitForThePromiseToSettle(a))}},DEFAULT_OPTIONS$4={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},createOscillatorNodeConstructor=(r,e,t,n,s,i,a)=>class extends r{constructor(c,l){const u=s(c),d={...DEFAULT_OPTIONS$4,...l},m=t(u,d),y=i(u),h=y?n():null,p=c.sampleRate/2;super(c,!1,m,h),this._detune=e(this,y,m.detune,153600,-153600),this._frequency=e(this,y,m.frequency,p,-p),this._nativeOscillatorNode=m,this._onended=null,this._oscillatorNodeRenderer=h,this._oscillatorNodeRenderer!==null&&d.periodicWave!==void 0&&(this._oscillatorNodeRenderer.periodicWave=d.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(c){const l=typeof c=="function"?a(this,c):null;this._nativeOscillatorNode.onended=l;const u=this._nativeOscillatorNode.onended;this._onended=u!==null&&u===l?c:u}get type(){return this._nativeOscillatorNode.type}set type(c){this._nativeOscillatorNode.type=c,this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(c){this._nativeOscillatorNode.setPeriodicWave(c),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=c)}start(c=0){if(this._nativeOscillatorNode.start(c),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.start=c),this.context.state!=="closed"){setInternalStateToActive(this);const l=()=>{this._nativeOscillatorNode.removeEventListener("ended",l),isActiveAudioNode(this)&&setInternalStateToPassive(this)};this._nativeOscillatorNode.addEventListener("ended",l)}}stop(c=0){this._nativeOscillatorNode.stop(c),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.stop=c)}},createOscillatorNodeRendererFactory=(r,e,t,n,s)=>()=>{const i=new WeakMap;let a=null,o=null,c=null;const l=async(u,d)=>{let m=t(u);const y=isOwnedByContext(m,d);if(!y){const h={channelCount:m.channelCount,channelCountMode:m.channelCountMode,channelInterpretation:m.channelInterpretation,detune:m.detune.value,frequency:m.frequency.value,periodicWave:a===null?void 0:a,type:m.type};m=e(d,h),o!==null&&m.start(o),c!==null&&m.stop(c)}return i.set(d,m),y?(await r(d,u.detune,m.detune),await r(d,u.frequency,m.frequency)):(await n(d,u.detune,m.detune),await n(d,u.frequency,m.frequency)),await s(u,d,m),m};return{set periodicWave(u){a=u},set start(u){o=u},set stop(u){c=u},render(u,d){const m=i.get(d);return m!==void 0?Promise.resolve(m):l(u,d)}}},DEFAULT_OPTIONS$3={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},createPannerNodeConstructor=(r,e,t,n,s,i,a)=>class extends r{constructor(c,l){const u=s(c),d={...DEFAULT_OPTIONS$3,...l},m=t(u,d),y=i(u),h=y?n():null;super(c,!1,m,h),this._nativePannerNode=m,this._orientationX=e(this,y,m.orientationX,MOST_POSITIVE_SINGLE_FLOAT,MOST_NEGATIVE_SINGLE_FLOAT),this._orientationY=e(this,y,m.orientationY,MOST_POSITIVE_SINGLE_FLOAT,MOST_NEGATIVE_SINGLE_FLOAT),this._orientationZ=e(this,y,m.orientationZ,MOST_POSITIVE_SINGLE_FLOAT,MOST_NEGATIVE_SINGLE_FLOAT),this._positionX=e(this,y,m.positionX,MOST_POSITIVE_SINGLE_FLOAT,MOST_NEGATIVE_SINGLE_FLOAT),this._positionY=e(this,y,m.positionY,MOST_POSITIVE_SINGLE_FLOAT,MOST_NEGATIVE_SINGLE_FLOAT),this._positionZ=e(this,y,m.positionZ,MOST_POSITIVE_SINGLE_FLOAT,MOST_NEGATIVE_SINGLE_FLOAT),a(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(c){this._nativePannerNode.coneInnerAngle=c}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(c){this._nativePannerNode.coneOuterAngle=c}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(c){this._nativePannerNode.coneOuterGain=c}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(c){this._nativePannerNode.distanceModel=c}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(c){this._nativePannerNode.maxDistance=c}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(c){this._nativePannerNode.panningModel=c}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(c){this._nativePannerNode.refDistance=c}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(c){this._nativePannerNode.rolloffFactor=c}},createPannerNodeRendererFactory=(r,e,t,n,s,i,a,o,c,l)=>()=>{const u=new WeakMap;let d=null;const m=async(y,h)=>{let p=null,f=i(y);const v={channelCount:f.channelCount,channelCountMode:f.channelCountMode,channelInterpretation:f.channelInterpretation},_={...v,coneInnerAngle:f.coneInnerAngle,coneOuterAngle:f.coneOuterAngle,coneOuterGain:f.coneOuterGain,distanceModel:f.distanceModel,maxDistance:f.maxDistance,panningModel:f.panningModel,refDistance:f.refDistance,rolloffFactor:f.rolloffFactor},O=isOwnedByContext(f,h);if("bufferSize"in f)p=n(h,{...v,gain:1});else if(!O){const k={..._,orientationX:f.orientationX.value,orientationY:f.orientationY.value,orientationZ:f.orientationZ.value,positionX:f.positionX.value,positionY:f.positionY.value,positionZ:f.positionZ.value};f=s(h,k)}if(u.set(h,p===null?f:p),p!==null){if(d===null){if(a===null)throw new Error("Missing the native OfflineAudioContext constructor.");const P=new a(6,y.context.length,h.sampleRate),$=e(P,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});$.connect(P.destination),d=(async()=>{const K=await Promise.all([y.orientationX,y.orientationY,y.orientationZ,y.positionX,y.positionY,y.positionZ].map(async(L,j)=>{const q=t(P,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:j===0?1:0});return await o(P,L,q.offset),q}));for(let L=0;L<6;L+=1)K[L].connect($,0,L),K[L].start(0);return l(P)})()}const k=await d,g=n(h,{...v,gain:1});await c(y,h,g);const b=[];for(let P=0;P<k.numberOfChannels;P+=1)b.push(k.getChannelData(P));let N=[b[0][0],b[1][0],b[2][0]],S=[b[3][0],b[4][0],b[5][0]],T=n(h,{...v,gain:1}),M=s(h,{..._,orientationX:N[0],orientationY:N[1],orientationZ:N[2],positionX:S[0],positionY:S[1],positionZ:S[2]});g.connect(T).connect(M.inputs[0]),M.connect(p);for(let P=128;P<k.length;P+=128){const $=[b[0][P],b[1][P],b[2][P]],K=[b[3][P],b[4][P],b[5][P]];if($.some((L,j)=>L!==N[j])||K.some((L,j)=>L!==S[j])){N=$,S=K;const L=P/h.sampleRate;T.gain.setValueAtTime(0,L),T=n(h,{...v,gain:0}),M=s(h,{..._,orientationX:N[0],orientationY:N[1],orientationZ:N[2],positionX:S[0],positionY:S[1],positionZ:S[2]}),T.gain.setValueAtTime(1,L),g.connect(T).connect(M.inputs[0]),M.connect(p)}}return p}return O?(await r(h,y.orientationX,f.orientationX),await r(h,y.orientationY,f.orientationY),await r(h,y.orientationZ,f.orientationZ),await r(h,y.positionX,f.positionX),await r(h,y.positionY,f.positionY),await r(h,y.positionZ,f.positionZ)):(await o(h,y.orientationX,f.orientationX),await o(h,y.orientationY,f.orientationY),await o(h,y.orientationZ,f.orientationZ),await o(h,y.positionX,f.positionX),await o(h,y.positionY,f.positionY),await o(h,y.positionZ,f.positionZ)),isNativeAudioNodeFaker(f)?await c(y,h,f.inputs[0]):await c(y,h,f),f};return{render(y,h){const p=u.get(h);return p!==void 0?Promise.resolve(p):m(y,h)}}},DEFAULT_OPTIONS$2={disableNormalization:!1},createPeriodicWaveConstructor=(r,e,t,n)=>class fr{constructor(i,a){const o=e(i),c=n({...DEFAULT_OPTIONS$2,...a}),l=r(o,c);return t.add(l),l}static[Symbol.hasInstance](i){return i!==null&&typeof i=="object"&&Object.getPrototypeOf(i)===fr.prototype||t.has(i)}},createRenderAutomation=(r,e)=>(t,n,s)=>(r(n).replay(s),e(n,t,s)),createRenderInputsOfAudioNode=(r,e,t)=>async(n,s,i)=>{const a=r(n);await Promise.all(a.activeInputs.map((o,c)=>Array.from(o).map(async([l,u])=>{const m=await e(l).render(l,s),y=n.context.destination;!t(l)&&(n!==y||!t(n))&&m.connect(i,u,c)})).reduce((o,c)=>[...o,...c],[]))},createRenderInputsOfAudioParam=(r,e,t)=>async(n,s,i)=>{const a=e(n);await Promise.all(Array.from(a.activeInputs).map(async([o,c])=>{const u=await r(o).render(o,s);t(o)||u.connect(i,c)}))},createRenderNativeOfflineAudioContext=(r,e,t,n)=>s=>r(testPromiseSupport,()=>testPromiseSupport(s))?Promise.resolve(r(n,n)).then(i=>{if(!i){const a=t(s,512,0,1);s.oncomplete=()=>{a.onaudioprocess=null,a.disconnect()},a.onaudioprocess=()=>s.currentTime,a.connect(s.destination)}return s.startRendering()}):new Promise(i=>{const a=e(s,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});s.oncomplete=o=>{a.disconnect(),i(o.renderedBuffer)},a.connect(s.destination),s.startRendering()}),createSetActiveAudioWorkletNodeInputs=r=>(e,t)=>{r.set(e,t)},createSetAudioNodeTailTime=r=>(e,t)=>r.set(e,t),createStartRendering=(r,e,t,n,s,i,a,o)=>(c,l)=>t(c).render(c,l).then(()=>Promise.all(Array.from(n(l)).map(u=>t(u).render(u,l)))).then(()=>s(l)).then(u=>(typeof u.copyFromChannel!="function"?(a(u),wrapAudioBufferGetChannelDataMethod(u)):e(i,()=>i(u))||o(u),r.add(u),u)),DEFAULT_OPTIONS$1={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},createStereoPannerNodeConstructor=(r,e,t,n,s,i)=>class extends r{constructor(o,c){const l=s(o),u={...DEFAULT_OPTIONS$1,...c},d=t(l,u),m=i(l),y=m?n():null;super(o,!1,d,y),this._pan=e(this,m,d.pan)}get pan(){return this._pan}},createStereoPannerNodeRendererFactory=(r,e,t,n,s)=>()=>{const i=new WeakMap,a=async(o,c)=>{let l=t(o);const u=isOwnedByContext(l,c);if(!u){const d={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,pan:l.pan.value};l=e(c,d)}return i.set(c,l),u?await r(c,o.pan,l.pan):await n(c,o.pan,l.pan),isNativeAudioNodeFaker(l)?await s(o,c,l.inputs[0]):await s(o,c,l),l};return{render(o,c){const l=i.get(c);return l!==void 0?Promise.resolve(l):a(o,c)}}},createTestAudioBufferConstructorSupport=r=>()=>{if(r===null)return!1;try{new r({length:1,sampleRate:44100})}catch{return!1}return!0},createTestAudioWorkletProcessorPostMessageSupport=(r,e)=>async()=>{if(r===null)return!0;if(e===null)return!1;const t=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),n=new e(1,128,44100),s=URL.createObjectURL(t);let i=!1,a=!1;try{await n.audioWorklet.addModule(s);const o=new r(n,"a",{numberOfOutputs:0}),c=n.createOscillator();o.port.onmessage=()=>i=!0,o.onprocessorerror=()=>a=!0,c.connect(o),c.start(0),await n.startRendering()}catch{}finally{URL.revokeObjectURL(s)}return i&&!a},createTestOfflineAudioContextCurrentTimeSupport=(r,e)=>()=>{if(e===null)return Promise.resolve(!1);const t=new e(1,1,44100),n=r(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(s=>{t.oncomplete=()=>{n.disconnect(),s(t.currentTime!==0)},t.startRendering()})},createUnknownError=()=>new DOMException("","UnknownError"),DEFAULT_OPTIONS={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},createWaveShaperNodeConstructor=(r,e,t,n,s,i,a)=>class extends r{constructor(c,l){const u=s(c),d={...DEFAULT_OPTIONS,...l},m=t(u,d),h=i(u)?n():null;super(c,!0,m,h),this._isCurveNullified=!1,this._nativeWaveShaperNode=m,a(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(c){if(c===null)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(c.length<2)throw e();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=c}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(c){this._nativeWaveShaperNode.oversample=c}},createWaveShaperNodeRendererFactory=(r,e,t)=>()=>{const n=new WeakMap,s=async(i,a)=>{let o=e(i);if(!isOwnedByContext(o,a)){const l={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,curve:o.curve,oversample:o.oversample};o=r(a,l)}return n.set(a,o),isNativeAudioNodeFaker(o)?await t(i,a,o.inputs[0]):await t(i,a,o),o};return{render(i,a){const o=n.get(a);return o!==void 0?Promise.resolve(o):s(i,a)}}},createWindow=()=>typeof window>"u"?null:window,createWrapAudioBufferCopyChannelMethods=(r,e)=>t=>{t.copyFromChannel=(n,s,i=0)=>{const a=r(i),o=r(s);if(o>=t.numberOfChannels)throw e();const c=t.length,l=t.getChannelData(o),u=n.length;for(let d=a<0?-a:0;d+a<c&&d<u;d+=1)n[d]=l[d+a]},t.copyToChannel=(n,s,i=0)=>{const a=r(i),o=r(s);if(o>=t.numberOfChannels)throw e();const c=t.length,l=t.getChannelData(o),u=n.length;for(let d=a<0?-a:0;d+a<c&&d<u;d+=1)l[d+a]=n[d]}},createWrapAudioBufferCopyChannelMethodsOutOfBounds=r=>e=>{e.copyFromChannel=(t=>(n,s,i=0)=>{const a=r(i),o=r(s);if(a<e.length)return t.call(e,n,o,a)})(e.copyFromChannel),e.copyToChannel=(t=>(n,s,i=0)=>{const a=r(i),o=r(s);if(a<e.length)return t.call(e,n,o,a)})(e.copyToChannel)},createWrapAudioBufferSourceNodeStopMethodNullifiedBuffer=r=>(e,t)=>{const n=t.createBuffer(1,1,44100);e.buffer===null&&(e.buffer=n),r(e,"buffer",s=>()=>{const i=s.call(e);return i===n?null:i},s=>i=>s.call(e,i===null?n:i))},createWrapChannelMergerNode=(r,e)=>(t,n)=>{n.channelCount=1,n.channelCountMode="explicit",Object.defineProperty(n,"channelCount",{get:()=>1,set:()=>{throw r()}}),Object.defineProperty(n,"channelCountMode",{get:()=>"explicit",set:()=>{throw r()}});const s=t.createBufferSource();e(n,()=>{const o=n.numberOfInputs;for(let c=0;c<o;c+=1)s.connect(n,0,c)},()=>s.disconnect(n))},getFirstSample=(r,e,t)=>r.copyFromChannel===void 0?r.getChannelData(t)[0]:(r.copyFromChannel(e,t),e[0]),isDCCurve=r=>{if(r===null)return!1;const e=r.length;return e%2!==0?r[Math.floor(e/2)]!==0:r[e/2-1]+r[e/2]!==0},overwriteAccessors=(r,e,t,n)=>{let s=r;for(;!s.hasOwnProperty(e);)s=Object.getPrototypeOf(s);const{get:i,set:a}=Object.getOwnPropertyDescriptor(s,e);Object.defineProperty(r,e,{get:t(i),set:n(a)})},sanitizeAudioWorkletNodeOptions=r=>({...r,outputChannelCount:r.outputChannelCount!==void 0?r.outputChannelCount:r.numberOfInputs===1&&r.numberOfOutputs===1?[r.channelCount]:Array.from({length:r.numberOfOutputs},()=>1)}),sanitizeChannelSplitterOptions=r=>({...r,channelCount:r.numberOfOutputs}),sanitizePeriodicWaveOptions=r=>{const{imag:e,real:t}=r;return e===void 0?t===void 0?{...r,imag:[0,0],real:[0,0]}:{...r,imag:Array.from(t,()=>0),real:t}:t===void 0?{...r,imag:e,real:Array.from(e,()=>0)}:{...r,imag:e,real:t}},setValueAtTimeUntilPossible=(r,e,t)=>{try{r.setValueAtTime(e,t)}catch(n){if(n.code!==9)throw n;setValueAtTimeUntilPossible(r,e,t+1e-7)}},testAudioBufferSourceNodeStartMethodConsecutiveCallsSupport=r=>{const e=r.createBufferSource();e.start();try{e.start()}catch{return!0}return!1},testAudioBufferSourceNodeStartMethodOffsetClampingSupport=r=>{const e=r.createBufferSource(),t=r.createBuffer(1,1,44100);e.buffer=t;try{e.start(0,1)}catch{return!1}return!0},testAudioBufferSourceNodeStopMethodNullifiedBufferSupport=r=>{const e=r.createBufferSource();e.start();try{e.stop()}catch{return!1}return!0},testAudioScheduledSourceNodeStartMethodNegativeParametersSupport=r=>{const e=r.createOscillator();try{e.start(-1)}catch(t){return t instanceof RangeError}return!1},testAudioScheduledSourceNodeStopMethodConsecutiveCallsSupport=r=>{const e=r.createBuffer(1,1,44100),t=r.createBufferSource();t.buffer=e,t.start(),t.stop();try{return t.stop(),!0}catch{return!1}},testAudioScheduledSourceNodeStopMethodNegativeParametersSupport=r=>{const e=r.createOscillator();try{e.stop(-1)}catch(t){return t instanceof RangeError}return!1},testAudioWorkletNodeOptionsClonability=r=>{const{port1:e,port2:t}=new MessageChannel;try{e.postMessage(r)}finally{e.close(),t.close()}},wrapAudioBufferSourceNodeStartMethodOffsetClamping=r=>{r.start=(e=>(t=0,n=0,s)=>{const i=r.buffer,a=i===null?n:Math.min(i.duration,n);i!==null&&a>i.duration-.5/r.context.sampleRate?e.call(r,t,0,0):e.call(r,t,a,s)})(r.start)},wrapAudioScheduledSourceNodeStopMethodConsecutiveCalls=(r,e)=>{const t=e.createGain();r.connect(t);const n=(s=>()=>{s.call(r,t),r.removeEventListener("ended",n)})(r.disconnect);r.addEventListener("ended",n),interceptConnections(r,t),r.stop=(s=>{let i=!1;return(a=0)=>{if(i)try{s.call(r,a)}catch{t.gain.setValueAtTime(0,a)}else s.call(r,a),i=!0}})(r.stop)},wrapEventListener=(r,e)=>t=>{const n={value:r};return Object.defineProperties(t,{currentTarget:n,target:n}),typeof e=="function"?e.call(r,t):e.handleEvent.call(r,t)},addActiveInputConnectionToAudioNode=createAddActiveInputConnectionToAudioNode(insertElementInSet),addPassiveInputConnectionToAudioNode=createAddPassiveInputConnectionToAudioNode(insertElementInSet),deleteActiveInputConnectionToAudioNode=createDeleteActiveInputConnectionToAudioNode(pickElementFromSet),audioNodeTailTimeStore=new WeakMap,getAudioNodeTailTime=createGetAudioNodeTailTime(audioNodeTailTimeStore),cacheTestResult=createCacheTestResult(new Map,new WeakMap),window$1=createWindow(),createNativeAnalyserNode=createNativeAnalyserNodeFactory(cacheTestResult,createIndexSizeError),getAudioNodeRenderer=createGetAudioNodeRenderer(getAudioNodeConnections),renderInputsOfAudioNode=createRenderInputsOfAudioNode(getAudioNodeConnections,getAudioNodeRenderer,isPartOfACycle),createAnalyserNodeRenderer=createAnalyserNodeRendererFactory(createNativeAnalyserNode,getNativeAudioNode,renderInputsOfAudioNode),getNativeContext=createGetNativeContext(CONTEXT_STORE),nativeOfflineAudioContextConstructor=createNativeOfflineAudioContextConstructor(window$1),isNativeOfflineAudioContext=createIsNativeOfflineAudioContext(nativeOfflineAudioContextConstructor),audioParamAudioNodeStore=new WeakMap,eventTargetConstructor=createEventTargetConstructor(wrapEventListener),nativeAudioContextConstructor=createNativeAudioContextConstructor(window$1),isNativeAudioContext=createIsNativeAudioContext(nativeAudioContextConstructor),isNativeAudioNode=createIsNativeAudioNode(window$1),isNativeAudioParam=createIsNativeAudioParam(window$1),nativeAudioWorkletNodeConstructor=createNativeAudioWorkletNodeConstructor(window$1),audioNodeConstructor=createAudioNodeConstructor(createAddAudioNodeConnections(AUDIO_NODE_CONNECTIONS_STORE),createAddConnectionToAudioNode(addActiveInputConnectionToAudioNode,addPassiveInputConnectionToAudioNode,connectNativeAudioNodeToNativeAudioNode,deleteActiveInputConnectionToAudioNode,disconnectNativeAudioNodeFromNativeAudioNode,getAudioNodeConnections,getAudioNodeTailTime,getEventListenersOfAudioNode,getNativeAudioNode,insertElementInSet,isActiveAudioNode,isPartOfACycle,isPassiveAudioNode),cacheTestResult,createIncrementCycleCounterFactory(CYCLE_COUNTERS,disconnectNativeAudioNodeFromNativeAudioNode,getAudioNodeConnections,getNativeAudioNode,getNativeAudioParam,isActiveAudioNode),createIndexSizeError,createInvalidAccessError,createNotSupportedError,createDecrementCycleCounter(connectNativeAudioNodeToNativeAudioNode,CYCLE_COUNTERS,getAudioNodeConnections,getNativeAudioNode,getNativeAudioParam,getNativeContext,isActiveAudioNode,isNativeOfflineAudioContext),createDetectCycles(audioParamAudioNodeStore,getAudioNodeConnections,getValueForKey),eventTargetConstructor,getNativeContext,isNativeAudioContext,isNativeAudioNode,isNativeAudioParam,isNativeOfflineAudioContext,nativeAudioWorkletNodeConstructor),analyserNodeConstructor=createAnalyserNodeConstructor(audioNodeConstructor,createAnalyserNodeRenderer,createIndexSizeError,createNativeAnalyserNode,getNativeContext,isNativeOfflineAudioContext),audioBufferStore=new WeakSet,nativeAudioBufferConstructor=createNativeAudioBufferConstructor(window$1),convertNumberToUnsignedLong=createConvertNumberToUnsignedLong(new Uint32Array(1)),wrapAudioBufferCopyChannelMethods=createWrapAudioBufferCopyChannelMethods(convertNumberToUnsignedLong,createIndexSizeError),wrapAudioBufferCopyChannelMethodsOutOfBounds=createWrapAudioBufferCopyChannelMethodsOutOfBounds(convertNumberToUnsignedLong),audioBufferConstructor=createAudioBufferConstructor(audioBufferStore,cacheTestResult,createNotSupportedError,nativeAudioBufferConstructor,nativeOfflineAudioContextConstructor,createTestAudioBufferConstructorSupport(nativeAudioBufferConstructor),wrapAudioBufferCopyChannelMethods,wrapAudioBufferCopyChannelMethodsOutOfBounds),addSilentConnection=createAddSilentConnection(createNativeGainNode),renderInputsOfAudioParam=createRenderInputsOfAudioParam(getAudioNodeRenderer,getAudioParamConnections,isPartOfACycle),connectAudioParam=createConnectAudioParam(renderInputsOfAudioParam),createNativeAudioBufferSourceNode=createNativeAudioBufferSourceNodeFactory(addSilentConnection,cacheTestResult,testAudioBufferSourceNodeStartMethodConsecutiveCallsSupport,testAudioBufferSourceNodeStartMethodOffsetClampingSupport,testAudioBufferSourceNodeStopMethodNullifiedBufferSupport,testAudioScheduledSourceNodeStartMethodNegativeParametersSupport,testAudioScheduledSourceNodeStopMethodConsecutiveCallsSupport,testAudioScheduledSourceNodeStopMethodNegativeParametersSupport,wrapAudioBufferSourceNodeStartMethodOffsetClamping,createWrapAudioBufferSourceNodeStopMethodNullifiedBuffer(overwriteAccessors),wrapAudioScheduledSourceNodeStopMethodConsecutiveCalls),renderAutomation=createRenderAutomation(createGetAudioParamRenderer(getAudioParamConnections),renderInputsOfAudioParam),createAudioBufferSourceNodeRenderer=createAudioBufferSourceNodeRendererFactory(connectAudioParam,createNativeAudioBufferSourceNode,getNativeAudioNode,renderAutomation,renderInputsOfAudioNode),createAudioParam=createAudioParamFactory(createAddAudioParamConnections(AUDIO_PARAM_CONNECTIONS_STORE),audioParamAudioNodeStore,AUDIO_PARAM_STORE,createAudioParamRenderer,createCancelAndHoldAutomationEvent,createCancelScheduledValuesAutomationEvent,createExponentialRampToValueAutomationEvent,createLinearRampToValueAutomationEvent,createSetTargetAutomationEvent,createSetValueAutomationEvent,createSetValueCurveAutomationEvent,nativeAudioContextConstructor,setValueAtTimeUntilPossible),audioBufferSourceNodeConstructor=createAudioBufferSourceNodeConstructor(audioNodeConstructor,createAudioBufferSourceNodeRenderer,createAudioParam,createInvalidStateError,createNativeAudioBufferSourceNode,getNativeContext,isNativeOfflineAudioContext,wrapEventListener),audioDestinationNodeConstructor=createAudioDestinationNodeConstructor(audioNodeConstructor,createAudioDestinationNodeRenderer,createIndexSizeError,createInvalidStateError,createNativeAudioDestinationNodeFactory(createNativeGainNode,overwriteAccessors),getNativeContext,isNativeOfflineAudioContext,renderInputsOfAudioNode),createBiquadFilterNodeRenderer=createBiquadFilterNodeRendererFactory(connectAudioParam,createNativeBiquadFilterNode,getNativeAudioNode,renderAutomation,renderInputsOfAudioNode),setAudioNodeTailTime=createSetAudioNodeTailTime(audioNodeTailTimeStore),biquadFilterNodeConstructor=createBiquadFilterNodeConstructor(audioNodeConstructor,createAudioParam,createBiquadFilterNodeRenderer,createInvalidAccessError,createNativeBiquadFilterNode,getNativeContext,isNativeOfflineAudioContext,setAudioNodeTailTime),monitorConnections=createMonitorConnections(insertElementInSet,isNativeAudioNode),wrapChannelMergerNode=createWrapChannelMergerNode(createInvalidStateError,monitorConnections),createNativeChannelMergerNode=createNativeChannelMergerNodeFactory(nativeAudioContextConstructor,wrapChannelMergerNode),createChannelMergerNodeRenderer=createChannelMergerNodeRendererFactory(createNativeChannelMergerNode,getNativeAudioNode,renderInputsOfAudioNode),channelMergerNodeConstructor=createChannelMergerNodeConstructor(audioNodeConstructor,createChannelMergerNodeRenderer,createNativeChannelMergerNode,getNativeContext,isNativeOfflineAudioContext),createChannelSplitterNodeRenderer=createChannelSplitterNodeRendererFactory(createNativeChannelSplitterNode,getNativeAudioNode,renderInputsOfAudioNode),channelSplitterNodeConstructor=createChannelSplitterNodeConstructor(audioNodeConstructor,createChannelSplitterNodeRenderer,createNativeChannelSplitterNode,getNativeContext,isNativeOfflineAudioContext,sanitizeChannelSplitterOptions),createNativeConstantSourceNodeFaker=createNativeConstantSourceNodeFakerFactory(addSilentConnection,createNativeAudioBufferSourceNode,createNativeGainNode,monitorConnections),createNativeConstantSourceNode=createNativeConstantSourceNodeFactory(addSilentConnection,cacheTestResult,createNativeConstantSourceNodeFaker,testAudioScheduledSourceNodeStartMethodNegativeParametersSupport,testAudioScheduledSourceNodeStopMethodNegativeParametersSupport),createConstantSourceNodeRenderer=createConstantSourceNodeRendererFactory(connectAudioParam,createNativeConstantSourceNode,getNativeAudioNode,renderAutomation,renderInputsOfAudioNode),constantSourceNodeConstructor=createConstantSourceNodeConstructor(audioNodeConstructor,createAudioParam,createConstantSourceNodeRenderer,createNativeConstantSourceNode,getNativeContext,isNativeOfflineAudioContext,wrapEventListener),createNativeConvolverNode=createNativeConvolverNodeFactory(createNotSupportedError,overwriteAccessors),createConvolverNodeRenderer=createConvolverNodeRendererFactory(createNativeConvolverNode,getNativeAudioNode,renderInputsOfAudioNode),convolverNodeConstructor=createConvolverNodeConstructor(audioNodeConstructor,createConvolverNodeRenderer,createNativeConvolverNode,getNativeContext,isNativeOfflineAudioContext,setAudioNodeTailTime),createDelayNodeRenderer=createDelayNodeRendererFactory(connectAudioParam,createNativeDelayNode,getNativeAudioNode,renderAutomation,renderInputsOfAudioNode),delayNodeConstructor=createDelayNodeConstructor(audioNodeConstructor,createAudioParam,createDelayNodeRenderer,createNativeDelayNode,getNativeContext,isNativeOfflineAudioContext,setAudioNodeTailTime),createNativeDynamicsCompressorNode=createNativeDynamicsCompressorNodeFactory(createNotSupportedError),createDynamicsCompressorNodeRenderer=createDynamicsCompressorNodeRendererFactory(connectAudioParam,createNativeDynamicsCompressorNode,getNativeAudioNode,renderAutomation,renderInputsOfAudioNode),dynamicsCompressorNodeConstructor=createDynamicsCompressorNodeConstructor(audioNodeConstructor,createAudioParam,createDynamicsCompressorNodeRenderer,createNativeDynamicsCompressorNode,createNotSupportedError,getNativeContext,isNativeOfflineAudioContext,setAudioNodeTailTime),createGainNodeRenderer=createGainNodeRendererFactory(connectAudioParam,createNativeGainNode,getNativeAudioNode,renderAutomation,renderInputsOfAudioNode),gainNodeConstructor=createGainNodeConstructor(audioNodeConstructor,createAudioParam,createGainNodeRenderer,createNativeGainNode,getNativeContext,isNativeOfflineAudioContext),createNativeIIRFilterNodeFaker=createNativeIIRFilterNodeFakerFactory(createInvalidAccessError,createInvalidStateError,createNativeScriptProcessorNode,createNotSupportedError),renderNativeOfflineAudioContext=createRenderNativeOfflineAudioContext(cacheTestResult,createNativeGainNode,createNativeScriptProcessorNode,createTestOfflineAudioContextCurrentTimeSupport(createNativeGainNode,nativeOfflineAudioContextConstructor)),createIIRFilterNodeRenderer=createIIRFilterNodeRendererFactory(createNativeAudioBufferSourceNode,getNativeAudioNode,nativeOfflineAudioContextConstructor,renderInputsOfAudioNode,renderNativeOfflineAudioContext),createNativeIIRFilterNode=createNativeIIRFilterNodeFactory(createNativeIIRFilterNodeFaker),iIRFilterNodeConstructor=createIIRFilterNodeConstructor(audioNodeConstructor,createNativeIIRFilterNode,createIIRFilterNodeRenderer,getNativeContext,isNativeOfflineAudioContext,setAudioNodeTailTime),createAudioListener=createAudioListenerFactory(createAudioParam,createNativeChannelMergerNode,createNativeConstantSourceNode,createNativeScriptProcessorNode,createNotSupportedError,getFirstSample,isNativeOfflineAudioContext,overwriteAccessors),unrenderedAudioWorkletNodeStore=new WeakMap,minimalBaseAudioContextConstructor=createMinimalBaseAudioContextConstructor(audioDestinationNodeConstructor,createAudioListener,eventTargetConstructor,isNativeOfflineAudioContext,unrenderedAudioWorkletNodeStore,wrapEventListener),createNativeOscillatorNode=createNativeOscillatorNodeFactory(addSilentConnection,cacheTestResult,testAudioScheduledSourceNodeStartMethodNegativeParametersSupport,testAudioScheduledSourceNodeStopMethodConsecutiveCallsSupport,testAudioScheduledSourceNodeStopMethodNegativeParametersSupport,wrapAudioScheduledSourceNodeStopMethodConsecutiveCalls),createOscillatorNodeRenderer=createOscillatorNodeRendererFactory(connectAudioParam,createNativeOscillatorNode,getNativeAudioNode,renderAutomation,renderInputsOfAudioNode),oscillatorNodeConstructor=createOscillatorNodeConstructor(audioNodeConstructor,createAudioParam,createNativeOscillatorNode,createOscillatorNodeRenderer,getNativeContext,isNativeOfflineAudioContext,wrapEventListener),createConnectedNativeAudioBufferSourceNode=createConnectedNativeAudioBufferSourceNodeFactory(createNativeAudioBufferSourceNode),createNativeWaveShaperNodeFaker=createNativeWaveShaperNodeFakerFactory(createConnectedNativeAudioBufferSourceNode,createInvalidStateError,createNativeGainNode,isDCCurve,monitorConnections),createNativeWaveShaperNode=createNativeWaveShaperNodeFactory(createConnectedNativeAudioBufferSourceNode,createInvalidStateError,createNativeWaveShaperNodeFaker,isDCCurve,monitorConnections,nativeAudioContextConstructor,overwriteAccessors),createNativePannerNodeFaker=createNativePannerNodeFakerFactory(connectNativeAudioNodeToNativeAudioNode,createInvalidStateError,createNativeChannelMergerNode,createNativeGainNode,createNativeScriptProcessorNode,createNativeWaveShaperNode,createNotSupportedError,disconnectNativeAudioNodeFromNativeAudioNode,getFirstSample,monitorConnections),createNativePannerNode=createNativePannerNodeFactory(createNativePannerNodeFaker),createPannerNodeRenderer=createPannerNodeRendererFactory(connectAudioParam,createNativeChannelMergerNode,createNativeConstantSourceNode,createNativeGainNode,createNativePannerNode,getNativeAudioNode,nativeOfflineAudioContextConstructor,renderAutomation,renderInputsOfAudioNode,renderNativeOfflineAudioContext),pannerNodeConstructor=createPannerNodeConstructor(audioNodeConstructor,createAudioParam,createNativePannerNode,createPannerNodeRenderer,getNativeContext,isNativeOfflineAudioContext,setAudioNodeTailTime),createNativePeriodicWave=createNativePeriodicWaveFactory(createIndexSizeError),periodicWaveConstructor=createPeriodicWaveConstructor(createNativePeriodicWave,getNativeContext,new WeakSet,sanitizePeriodicWaveOptions),nativeStereoPannerNodeFakerFactory=createNativeStereoPannerNodeFakerFactory(createNativeChannelMergerNode,createNativeChannelSplitterNode,createNativeGainNode,createNativeWaveShaperNode,createNotSupportedError,monitorConnections),createNativeStereoPannerNode=createNativeStereoPannerNodeFactory(nativeStereoPannerNodeFakerFactory,createNotSupportedError),createStereoPannerNodeRenderer=createStereoPannerNodeRendererFactory(connectAudioParam,createNativeStereoPannerNode,getNativeAudioNode,renderAutomation,renderInputsOfAudioNode),stereoPannerNodeConstructor=createStereoPannerNodeConstructor(audioNodeConstructor,createAudioParam,createNativeStereoPannerNode,createStereoPannerNodeRenderer,getNativeContext,isNativeOfflineAudioContext),createWaveShaperNodeRenderer=createWaveShaperNodeRendererFactory(createNativeWaveShaperNode,getNativeAudioNode,renderInputsOfAudioNode),waveShaperNodeConstructor=createWaveShaperNodeConstructor(audioNodeConstructor,createInvalidStateError,createNativeWaveShaperNode,createWaveShaperNodeRenderer,getNativeContext,isNativeOfflineAudioContext,setAudioNodeTailTime),isSecureContext=createIsSecureContext(window$1),exposeCurrentFrameAndCurrentTime=createExposeCurrentFrameAndCurrentTime(window$1),backupOfflineAudioContextStore=new WeakMap,getOrCreateBackupOfflineAudioContext=createGetOrCreateBackupOfflineAudioContext(backupOfflineAudioContextStore,nativeOfflineAudioContextConstructor),addAudioWorkletModule=isSecureContext?createAddAudioWorkletModule(cacheTestResult,createNotSupportedError,createEvaluateSource(window$1),exposeCurrentFrameAndCurrentTime,createFetchSource(createAbortError),getNativeContext,getOrCreateBackupOfflineAudioContext,isNativeOfflineAudioContext,nativeAudioWorkletNodeConstructor,new WeakMap,new WeakMap,createTestAudioWorkletProcessorPostMessageSupport(nativeAudioWorkletNodeConstructor,nativeOfflineAudioContextConstructor),window$1):void 0,isNativeContext=createIsNativeContext(isNativeAudioContext,isNativeOfflineAudioContext),decodeAudioData=createDecodeAudioData(audioBufferStore,cacheTestResult,createDataCloneError,createEncodingError,new WeakSet,getNativeContext,isNativeContext,testAudioBufferCopyChannelMethodsOutOfBoundsSupport,testPromiseSupport,wrapAudioBufferCopyChannelMethods,wrapAudioBufferCopyChannelMethodsOutOfBounds),baseAudioContextConstructor=createBaseAudioContextConstructor(addAudioWorkletModule,analyserNodeConstructor,audioBufferConstructor,audioBufferSourceNodeConstructor,biquadFilterNodeConstructor,channelMergerNodeConstructor,channelSplitterNodeConstructor,constantSourceNodeConstructor,convolverNodeConstructor,decodeAudioData,delayNodeConstructor,dynamicsCompressorNodeConstructor,gainNodeConstructor,iIRFilterNodeConstructor,minimalBaseAudioContextConstructor,oscillatorNodeConstructor,pannerNodeConstructor,periodicWaveConstructor,stereoPannerNodeConstructor,waveShaperNodeConstructor),mediaElementAudioSourceNodeConstructor=createMediaElementAudioSourceNodeConstructor(audioNodeConstructor,createNativeMediaElementAudioSourceNode,getNativeContext,isNativeOfflineAudioContext),mediaStreamAudioDestinationNodeConstructor=createMediaStreamAudioDestinationNodeConstructor(audioNodeConstructor,createNativeMediaStreamAudioDestinationNode,getNativeContext,isNativeOfflineAudioContext),mediaStreamAudioSourceNodeConstructor=createMediaStreamAudioSourceNodeConstructor(audioNodeConstructor,createNativeMediaStreamAudioSourceNode,getNativeContext,isNativeOfflineAudioContext),createNativeMediaStreamTrackAudioSourceNode=createNativeMediaStreamTrackAudioSourceNodeFactory(createInvalidStateError,isNativeOfflineAudioContext),mediaStreamTrackAudioSourceNodeConstructor=createMediaStreamTrackAudioSourceNodeConstructor(audioNodeConstructor,createNativeMediaStreamTrackAudioSourceNode,getNativeContext),audioContextConstructor=createAudioContextConstructor(baseAudioContextConstructor,createInvalidStateError,createNotSupportedError,createUnknownError,mediaElementAudioSourceNodeConstructor,mediaStreamAudioDestinationNodeConstructor,mediaStreamAudioSourceNodeConstructor,mediaStreamTrackAudioSourceNodeConstructor,nativeAudioContextConstructor),getUnrenderedAudioWorkletNodes=createGetUnrenderedAudioWorkletNodes(unrenderedAudioWorkletNodeStore),addUnrenderedAudioWorkletNode=createAddUnrenderedAudioWorkletNode(getUnrenderedAudioWorkletNodes),connectMultipleOutputs=createConnectMultipleOutputs(createIndexSizeError),deleteUnrenderedAudioWorkletNode=createDeleteUnrenderedAudioWorkletNode(getUnrenderedAudioWorkletNodes),disconnectMultipleOutputs=createDisconnectMultipleOutputs(createIndexSizeError),activeAudioWorkletNodeInputsStore=new WeakMap,getActiveAudioWorkletNodeInputs=createGetActiveAudioWorkletNodeInputs(activeAudioWorkletNodeInputsStore,getValueForKey),createNativeAudioWorkletNodeFaker=createNativeAudioWorkletNodeFakerFactory(connectMultipleOutputs,createIndexSizeError,createInvalidStateError,createNativeChannelMergerNode,createNativeChannelSplitterNode,createNativeConstantSourceNode,createNativeGainNode,createNativeScriptProcessorNode,createNotSupportedError,disconnectMultipleOutputs,exposeCurrentFrameAndCurrentTime,getActiveAudioWorkletNodeInputs,monitorConnections),createNativeAudioWorkletNode=createNativeAudioWorkletNodeFactory(createInvalidStateError,createNativeAudioWorkletNodeFaker,createNativeGainNode,createNotSupportedError,monitorConnections),createAudioWorkletNodeRenderer=createAudioWorkletNodeRendererFactory(connectAudioParam,connectMultipleOutputs,createNativeAudioBufferSourceNode,createNativeChannelMergerNode,createNativeChannelSplitterNode,createNativeConstantSourceNode,createNativeGainNode,deleteUnrenderedAudioWorkletNode,disconnectMultipleOutputs,exposeCurrentFrameAndCurrentTime,getNativeAudioNode,nativeAudioWorkletNodeConstructor,nativeOfflineAudioContextConstructor,renderAutomation,renderInputsOfAudioNode,renderNativeOfflineAudioContext),getBackupOfflineAudioContext=createGetBackupOfflineAudioContext(backupOfflineAudioContextStore),setActiveAudioWorkletNodeInputs=createSetActiveAudioWorkletNodeInputs(activeAudioWorkletNodeInputsStore),audioWorkletNodeConstructor=isSecureContext?createAudioWorkletNodeConstructor(addUnrenderedAudioWorkletNode,audioNodeConstructor,createAudioParam,createAudioWorkletNodeRenderer,createNativeAudioWorkletNode,getAudioNodeConnections,getBackupOfflineAudioContext,getNativeContext,isNativeOfflineAudioContext,nativeAudioWorkletNodeConstructor,sanitizeAudioWorkletNodeOptions,setActiveAudioWorkletNodeInputs,testAudioWorkletNodeOptionsClonability,wrapEventListener):void 0,createNativeOfflineAudioContext=createCreateNativeOfflineAudioContext(createNotSupportedError,nativeOfflineAudioContextConstructor),startRendering=createStartRendering(audioBufferStore,cacheTestResult,getAudioNodeRenderer,getUnrenderedAudioWorkletNodes,renderNativeOfflineAudioContext,testAudioBufferCopyChannelMethodsOutOfBoundsSupport,wrapAudioBufferCopyChannelMethods,wrapAudioBufferCopyChannelMethodsOutOfBounds),offlineAudioContextConstructor=createOfflineAudioContextConstructor(baseAudioContextConstructor,cacheTestResult,createInvalidStateError,createNativeOfflineAudioContext,startRendering),isAnyAudioContext=createIsAnyAudioContext(CONTEXT_STORE,isNativeAudioContext),isAnyAudioNode=createIsAnyAudioNode(AUDIO_NODE_STORE,isNativeAudioNode),isAnyAudioParam=createIsAnyAudioParam(AUDIO_PARAM_STORE,isNativeAudioParam),isAnyOfflineAudioContext=createIsAnyOfflineAudioContext(CONTEXT_STORE,isNativeOfflineAudioContext);function assert(r,e){if(!r)throw new Error(e)}function assertRange(r,e,t=1/0){if(!(e<=r&&r<=t))throw new RangeError(`Value must be within [${e}, ${t}], got: ${r}`)}function assertContextRunning(r){!r.isOffline&&r.state!=="running"&&warn('The AudioContext is "suspended". Invoke Tone.start() from a user action to start the audio.')}let defaultLogger=console;function log(...r){defaultLogger.log(...r)}function warn(...r){defaultLogger.warn(...r)}function isUndef(r){return typeof r>"u"}function isDefined(r){return!isUndef(r)}function isFunction(r){return typeof r=="function"}function isNumber(r){return typeof r=="number"}function isObject(r){return Object.prototype.toString.call(r)==="[object Object]"&&r.constructor===Object}function isBoolean(r){return typeof r=="boolean"}function isArray(r){return Array.isArray(r)}function isString$1(r){return typeof r=="string"}function isNote(r){return isString$1(r)&&/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i.test(r)}function createAudioContext(r){return new audioContextConstructor(r)}function createOfflineAudioContext(r,e,t){return new offlineAudioContextConstructor(r,e,t)}const theWindow=typeof self=="object"?self:null,hasAudioContext=theWindow&&(theWindow.hasOwnProperty("AudioContext")||theWindow.hasOwnProperty("webkitAudioContext"));function createAudioWorkletNode(r,e,t){return assert(isDefined(audioWorkletNodeConstructor),"This node only works in a secure context (https or localhost)"),new audioWorkletNodeConstructor(r,e,t)}class Ticker{constructor(e,t,n){this._callback=e,this._type=t,this._updateInterval=n,this._createClock()}_createWorker(){const e=new Blob([`
			// the initial timeout time
			let timeoutTime =  ${(this._updateInterval*1e3).toFixed(1)};
			// onmessage callback
			self.onmessage = function(msg){
				timeoutTime = parseInt(msg.data);
			};
			// the tick function which posts a message
			// and schedules a new tick
			function tick(){
				setTimeout(tick, timeoutTime);
				self.postMessage('tick');
			}
			// call tick initially
			tick();
			`],{type:"text/javascript"}),t=URL.createObjectURL(e),n=new Worker(t);n.onmessage=this._callback.bind(this),this._worker=n}_createTimeout(){this._timeout=setTimeout(()=>{this._createTimeout(),this._callback()},this._updateInterval*1e3)}_createClock(){if(this._type==="worker")try{this._createWorker()}catch{this._type="timeout",this._createClock()}else this._type==="timeout"&&this._createTimeout()}_disposeClock(){this._timeout&&(clearTimeout(this._timeout),this._timeout=0),this._worker&&(this._worker.terminate(),this._worker.onmessage=null)}get updateInterval(){return this._updateInterval}set updateInterval(e){this._updateInterval=Math.max(e,128/44100),this._type==="worker"&&this._worker.postMessage(Math.max(e*1e3,1))}get type(){return this._type}set type(e){this._disposeClock(),this._type=e,this._createClock()}dispose(){this._disposeClock()}}function isAudioParam(r){return isAnyAudioParam(r)}function isAudioNode(r){return isAnyAudioNode(r)}function isOfflineAudioContext(r){return isAnyOfflineAudioContext(r)}function isAudioContext(r){return isAnyAudioContext(r)}function isAudioBuffer(r){return r instanceof AudioBuffer}function noCopy(r,e){return r==="value"||isAudioParam(e)||isAudioNode(e)||isAudioBuffer(e)}function deepMerge(r,...e){if(!e.length)return r;const t=e.shift();if(isObject(r)&&isObject(t))for(const n in t)noCopy(n,t[n])?r[n]=t[n]:isObject(t[n])?(r[n]||Object.assign(r,{[n]:{}}),deepMerge(r[n],t[n])):Object.assign(r,{[n]:t[n]});return deepMerge(r,...e)}function deepEquals(r,e){return r.length===e.length&&r.every((t,n)=>e[n]===t)}function optionsFromArguments(r,e,t=[],n){const s={},i=Array.from(e);if(isObject(i[0])&&n&&!Reflect.has(i[0],n)&&(Object.keys(i[0]).some(o=>Reflect.has(r,o))||(deepMerge(s,{[n]:i[0]}),t.splice(t.indexOf(n),1),i.shift())),i.length===1&&isObject(i[0]))deepMerge(s,i[0]);else for(let a=0;a<t.length;a++)isDefined(i[a])&&(s[t[a]]=i[a]);return deepMerge(r,s)}function getDefaultsFromInstance(r){return r.constructor.getDefaults()}function defaultArg(r,e){return isUndef(r)?e:r}function omitFromObject(r,e){return e.forEach(t=>{Reflect.has(r,t)&&delete r[t]}),r}/**
 * Tone.js
 * @author Yotam Mann
 * @license http://opensource.org/licenses/MIT MIT License
 * @copyright 2014-2019 Yotam Mann
 */class Tone{constructor(){this.debug=!1,this._wasDisposed=!1}static getDefaults(){return{}}log(...e){(this.debug||theWindow&&this.toString()===theWindow.TONE_DEBUG_CLASS)&&log(this,...e)}dispose(){return this._wasDisposed=!0,this}get disposed(){return this._wasDisposed}toString(){return this.name}}Tone.version=version;const EPSILON=1e-6;function GT(r,e){return r>e+EPSILON}function GTE(r,e){return GT(r,e)||EQ(r,e)}function LT(r,e){return r+EPSILON<e}function EQ(r,e){return Math.abs(r-e)<EPSILON}function clamp(r,e,t){return Math.max(Math.min(r,t),e)}class Timeline extends Tone{constructor(){super(),this.name="Timeline",this._timeline=[];const e=optionsFromArguments(Timeline.getDefaults(),arguments,["memory"]);this.memory=e.memory,this.increasing=e.increasing}static getDefaults(){return{memory:1/0,increasing:!1}}get length(){return this._timeline.length}add(e){if(assert(Reflect.has(e,"time"),"Timeline: events must have a time attribute"),e.time=e.time.valueOf(),this.increasing&&this.length){const t=this._timeline[this.length-1];assert(GTE(e.time,t.time),"The time must be greater than or equal to the last scheduled time"),this._timeline.push(e)}else{const t=this._search(e.time);this._timeline.splice(t+1,0,e)}if(this.length>this.memory){const t=this.length-this.memory;this._timeline.splice(0,t)}return this}remove(e){const t=this._timeline.indexOf(e);return t!==-1&&this._timeline.splice(t,1),this}get(e,t="time"){const n=this._search(e,t);return n!==-1?this._timeline[n]:null}peek(){return this._timeline[0]}shift(){return this._timeline.shift()}getAfter(e,t="time"){const n=this._search(e,t);return n+1<this._timeline.length?this._timeline[n+1]:null}getBefore(e){const t=this._timeline.length;if(t>0&&this._timeline[t-1].time<e)return this._timeline[t-1];const n=this._search(e);return n-1>=0?this._timeline[n-1]:null}cancel(e){if(this._timeline.length>1){let t=this._search(e);if(t>=0)if(EQ(this._timeline[t].time,e)){for(let n=t;n>=0&&EQ(this._timeline[n].time,e);n--)t=n;this._timeline=this._timeline.slice(0,t)}else this._timeline=this._timeline.slice(0,t+1);else this._timeline=[]}else this._timeline.length===1&&GTE(this._timeline[0].time,e)&&(this._timeline=[]);return this}cancelBefore(e){const t=this._search(e);return t>=0&&(this._timeline=this._timeline.slice(t+1)),this}previousEvent(e){const t=this._timeline.indexOf(e);return t>0?this._timeline[t-1]:null}_search(e,t="time"){if(this._timeline.length===0)return-1;let n=0;const s=this._timeline.length;let i=s;if(s>0&&this._timeline[s-1][t]<=e)return s-1;for(;n<i;){let a=Math.floor(n+(i-n)/2);const o=this._timeline[a],c=this._timeline[a+1];if(EQ(o[t],e)){for(let l=a;l<this._timeline.length;l++){const u=this._timeline[l];if(EQ(u[t],e))a=l;else break}return a}else{if(LT(o[t],e)&&GT(c[t],e))return a;GT(o[t],e)?i=a:n=a+1}}return-1}_iterate(e,t=0,n=this._timeline.length-1){this._timeline.slice(t,n+1).forEach(e)}forEach(e){return this._iterate(e),this}forEachBefore(e,t){const n=this._search(e);return n!==-1&&this._iterate(t,0,n),this}forEachAfter(e,t){const n=this._search(e);return this._iterate(t,n+1),this}forEachBetween(e,t,n){let s=this._search(e),i=this._search(t);return s!==-1&&i!==-1?(this._timeline[s].time!==e&&(s+=1),this._timeline[i].time===t&&(i-=1),this._iterate(n,s,i)):s===-1&&this._iterate(n,0,i),this}forEachFrom(e,t){let n=this._search(e);for(;n>=0&&this._timeline[n].time>=e;)n--;return this._iterate(t,n+1),this}forEachAtTime(e,t){const n=this._search(e);if(n!==-1&&EQ(this._timeline[n].time,e)){let s=n;for(let i=n;i>=0&&EQ(this._timeline[i].time,e);i--)s=i;this._iterate(i=>{t(i)},s,n)}return this}dispose(){return super.dispose(),this._timeline=[],this}}const notifyNewContext=[];function onContextInit(r){notifyNewContext.push(r)}function initializeContext(r){notifyNewContext.forEach(e=>e(r))}const notifyCloseContext=[];function onContextClose(r){notifyCloseContext.push(r)}function closeContext(r){notifyCloseContext.forEach(e=>e(r))}class Emitter extends Tone{constructor(){super(...arguments),this.name="Emitter"}on(e,t){return e.split(/\W+/).forEach(s=>{isUndef(this._events)&&(this._events={}),this._events.hasOwnProperty(s)||(this._events[s]=[]),this._events[s].push(t)}),this}once(e,t){const n=(...s)=>{t(...s),this.off(e,n)};return this.on(e,n),this}off(e,t){return e.split(/\W+/).forEach(s=>{if(isUndef(this._events)&&(this._events={}),this._events.hasOwnProperty(e))if(isUndef(t))this._events[e]=[];else{const i=this._events[e];for(let a=i.length-1;a>=0;a--)i[a]===t&&i.splice(a,1)}}),this}emit(e,...t){if(this._events&&this._events.hasOwnProperty(e)){const n=this._events[e].slice(0);for(let s=0,i=n.length;s<i;s++)n[s].apply(this,t)}return this}static mixin(e){["on","once","off","emit"].forEach(t=>{const n=Object.getOwnPropertyDescriptor(Emitter.prototype,t);Object.defineProperty(e.prototype,t,n)})}dispose(){return super.dispose(),this._events=void 0,this}}class BaseContext extends Emitter{constructor(){super(...arguments),this.isOffline=!1}toJSON(){return{}}}class Context extends BaseContext{constructor(){super(),this.name="Context",this._constants=new Map,this._timeouts=new Timeline,this._timeoutIds=0,this._initialized=!1,this.isOffline=!1,this._workletModules=new Map;const e=optionsFromArguments(Context.getDefaults(),arguments,["context"]);e.context?this._context=e.context:this._context=createAudioContext({latencyHint:e.latencyHint}),this._ticker=new Ticker(this.emit.bind(this,"tick"),e.clockSource,e.updateInterval),this.on("tick",this._timeoutLoop.bind(this)),this._context.onstatechange=()=>{this.emit("statechange",this.state)},this._setLatencyHint(e.latencyHint),this.lookAhead=e.lookAhead}static getDefaults(){return{clockSource:"worker",latencyHint:"interactive",lookAhead:.1,updateInterval:.05}}initialize(){return this._initialized||(initializeContext(this),this._initialized=!0),this}createAnalyser(){return this._context.createAnalyser()}createOscillator(){return this._context.createOscillator()}createBufferSource(){return this._context.createBufferSource()}createBiquadFilter(){return this._context.createBiquadFilter()}createBuffer(e,t,n){return this._context.createBuffer(e,t,n)}createChannelMerger(e){return this._context.createChannelMerger(e)}createChannelSplitter(e){return this._context.createChannelSplitter(e)}createConstantSource(){return this._context.createConstantSource()}createConvolver(){return this._context.createConvolver()}createDelay(e){return this._context.createDelay(e)}createDynamicsCompressor(){return this._context.createDynamicsCompressor()}createGain(){return this._context.createGain()}createIIRFilter(e,t){return this._context.createIIRFilter(e,t)}createPanner(){return this._context.createPanner()}createPeriodicWave(e,t,n){return this._context.createPeriodicWave(e,t,n)}createStereoPanner(){return this._context.createStereoPanner()}createWaveShaper(){return this._context.createWaveShaper()}createMediaStreamSource(e){return assert(isAudioContext(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamSource(e)}createMediaElementSource(e){return assert(isAudioContext(this._context),"Not available if OfflineAudioContext"),this._context.createMediaElementSource(e)}createMediaStreamDestination(){return assert(isAudioContext(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamDestination()}decodeAudioData(e){return this._context.decodeAudioData(e)}get currentTime(){return this._context.currentTime}get state(){return this._context.state}get sampleRate(){return this._context.sampleRate}get listener(){return this.initialize(),this._listener}set listener(e){assert(!this._initialized,"The listener cannot be set after initialization."),this._listener=e}get transport(){return this.initialize(),this._transport}set transport(e){assert(!this._initialized,"The transport cannot be set after initialization."),this._transport=e}get draw(){return this.initialize(),this._draw}set draw(e){assert(!this._initialized,"Draw cannot be set after initialization."),this._draw=e}get destination(){return this.initialize(),this._destination}set destination(e){assert(!this._initialized,"The destination cannot be set after initialization."),this._destination=e}createAudioWorkletNode(e,t){return createAudioWorkletNode(this.rawContext,e,t)}addAudioWorkletModule(e,t){return __awaiter(this,void 0,void 0,function*(){assert(isDefined(this.rawContext.audioWorklet),"AudioWorkletNode is only available in a secure context (https or localhost)"),this._workletModules.has(t)||this._workletModules.set(t,this.rawContext.audioWorklet.addModule(e)),yield this._workletModules.get(t)})}workletsAreReady(){return __awaiter(this,void 0,void 0,function*(){const e=[];this._workletModules.forEach(t=>e.push(t)),yield Promise.all(e)})}get updateInterval(){return this._ticker.updateInterval}set updateInterval(e){this._ticker.updateInterval=e}get clockSource(){return this._ticker.type}set clockSource(e){this._ticker.type=e}get latencyHint(){return this._latencyHint}_setLatencyHint(e){let t=0;if(this._latencyHint=e,isString$1(e))switch(e){case"interactive":t=.1;break;case"playback":t=.5;break;case"balanced":t=.25;break}this.lookAhead=t,this.updateInterval=t/2}get rawContext(){return this._context}now(){return this._context.currentTime+this.lookAhead}immediate(){return this._context.currentTime}resume(){return isAudioContext(this._context)?this._context.resume():Promise.resolve()}close(){return __awaiter(this,void 0,void 0,function*(){isAudioContext(this._context)&&(yield this._context.close()),this._initialized&&closeContext(this)})}getConstant(e){if(this._constants.has(e))return this._constants.get(e);{const t=this._context.createBuffer(1,128,this._context.sampleRate),n=t.getChannelData(0);for(let i=0;i<n.length;i++)n[i]=e;const s=this._context.createBufferSource();return s.channelCount=1,s.channelCountMode="explicit",s.buffer=t,s.loop=!0,s.start(0),this._constants.set(e,s),s}}dispose(){return super.dispose(),this._ticker.dispose(),this._timeouts.dispose(),Object.keys(this._constants).map(e=>this._constants[e].disconnect()),this}_timeoutLoop(){const e=this.now();let t=this._timeouts.peek();for(;this._timeouts.length&&t&&t.time<=e;)t.callback(),this._timeouts.shift(),t=this._timeouts.peek()}setTimeout(e,t){this._timeoutIds++;const n=this.now();return this._timeouts.add({callback:e,id:this._timeoutIds,time:n+t}),this._timeoutIds}clearTimeout(e){return this._timeouts.forEach(t=>{t.id===e&&this._timeouts.remove(t)}),this}clearInterval(e){return this.clearTimeout(e)}setInterval(e,t){const n=++this._timeoutIds,s=()=>{const i=this.now();this._timeouts.add({callback:()=>{e(),s()},id:n,time:i+t})};return s(),n}}class DummyContext extends BaseContext{constructor(){super(...arguments),this.lookAhead=0,this.latencyHint=0,this.isOffline=!1}createAnalyser(){return{}}createOscillator(){return{}}createBufferSource(){return{}}createBiquadFilter(){return{}}createBuffer(e,t,n){return{}}createChannelMerger(e){return{}}createChannelSplitter(e){return{}}createConstantSource(){return{}}createConvolver(){return{}}createDelay(e){return{}}createDynamicsCompressor(){return{}}createGain(){return{}}createIIRFilter(e,t){return{}}createPanner(){return{}}createPeriodicWave(e,t,n){return{}}createStereoPanner(){return{}}createWaveShaper(){return{}}createMediaStreamSource(e){return{}}createMediaElementSource(e){return{}}createMediaStreamDestination(){return{}}decodeAudioData(e){return Promise.resolve({})}createAudioWorkletNode(e,t){return{}}get rawContext(){return{}}addAudioWorkletModule(e,t){return __awaiter(this,void 0,void 0,function*(){return Promise.resolve()})}resume(){return Promise.resolve()}setTimeout(e,t){return 0}clearTimeout(e){return this}setInterval(e,t){return 0}clearInterval(e){return this}getConstant(e){return{}}get currentTime(){return 0}get state(){return{}}get sampleRate(){return 0}get listener(){return{}}get transport(){return{}}get draw(){return{}}set draw(e){}get destination(){return{}}set destination(e){}now(){return 0}immediate(){return 0}}function readOnly(r,e){isArray(e)?e.forEach(t=>readOnly(r,t)):Object.defineProperty(r,e,{enumerable:!0,writable:!1})}function writable(r,e){isArray(e)?e.forEach(t=>writable(r,t)):Object.defineProperty(r,e,{writable:!0})}const noOp=()=>{};class ToneAudioBuffer extends Tone{constructor(){super(),this.name="ToneAudioBuffer",this.onload=noOp;const e=optionsFromArguments(ToneAudioBuffer.getDefaults(),arguments,["url","onload","onerror"]);this.reverse=e.reverse,this.onload=e.onload,e.url&&isAudioBuffer(e.url)||e.url instanceof ToneAudioBuffer?this.set(e.url):isString$1(e.url)&&this.load(e.url).catch(e.onerror)}static getDefaults(){return{onerror:noOp,onload:noOp,reverse:!1}}get sampleRate(){return this._buffer?this._buffer.sampleRate:getContext().sampleRate}set(e){return e instanceof ToneAudioBuffer?e.loaded?this._buffer=e.get():e.onload=()=>{this.set(e),this.onload(this)}:this._buffer=e,this._reversed&&this._reverse(),this}get(){return this._buffer}load(e){return __awaiter(this,void 0,void 0,function*(){const t=ToneAudioBuffer.load(e).then(n=>{this.set(n),this.onload(this)});ToneAudioBuffer.downloads.push(t);try{yield t}finally{const n=ToneAudioBuffer.downloads.indexOf(t);ToneAudioBuffer.downloads.splice(n,1)}return this})}dispose(){return super.dispose(),this._buffer=void 0,this}fromArray(e){const t=isArray(e)&&e[0].length>0,n=t?e.length:1,s=t?e[0].length:e.length,i=getContext(),a=i.createBuffer(n,s,i.sampleRate),o=!t&&n===1?[e]:e;for(let c=0;c<n;c++)a.copyToChannel(o[c],c);return this._buffer=a,this}toMono(e){if(isNumber(e))this.fromArray(this.toArray(e));else{let t=new Float32Array(this.length);const n=this.numberOfChannels;for(let s=0;s<n;s++){const i=this.toArray(s);for(let a=0;a<i.length;a++)t[a]+=i[a]}t=t.map(s=>s/n),this.fromArray(t)}return this}toArray(e){if(isNumber(e))return this.getChannelData(e);if(this.numberOfChannels===1)return this.toArray(0);{const t=[];for(let n=0;n<this.numberOfChannels;n++)t[n]=this.getChannelData(n);return t}}getChannelData(e){return this._buffer?this._buffer.getChannelData(e):new Float32Array(0)}slice(e,t=this.duration){const n=Math.floor(e*this.sampleRate),s=Math.floor(t*this.sampleRate);assert(n<s,"The start time must be less than the end time");const i=s-n,a=getContext().createBuffer(this.numberOfChannels,i,this.sampleRate);for(let o=0;o<this.numberOfChannels;o++)a.copyToChannel(this.getChannelData(o).subarray(n,s),o);return new ToneAudioBuffer(a)}_reverse(){if(this.loaded)for(let e=0;e<this.numberOfChannels;e++)this.getChannelData(e).reverse();return this}get loaded(){return this.length>0}get duration(){return this._buffer?this._buffer.duration:0}get length(){return this._buffer?this._buffer.length:0}get numberOfChannels(){return this._buffer?this._buffer.numberOfChannels:0}get reverse(){return this._reversed}set reverse(e){this._reversed!==e&&(this._reversed=e,this._reverse())}static fromArray(e){return new ToneAudioBuffer().fromArray(e)}static fromUrl(e){return __awaiter(this,void 0,void 0,function*(){return yield new ToneAudioBuffer().load(e)})}static load(e){return __awaiter(this,void 0,void 0,function*(){const t=e.match(/\[([^\]\[]+\|.+)\]$/);if(t){const o=t[1].split("|");let c=o[0];for(const l of o)if(ToneAudioBuffer.supportsType(l)){c=l;break}e=e.replace(t[0],c)}const n=ToneAudioBuffer.baseUrl===""||ToneAudioBuffer.baseUrl.endsWith("/")?ToneAudioBuffer.baseUrl:ToneAudioBuffer.baseUrl+"/",s=yield fetch(n+e);if(!s.ok)throw new Error(`could not load url: ${e}`);const i=yield s.arrayBuffer();return yield getContext().decodeAudioData(i)})}static supportsType(e){const t=e.split("."),n=t[t.length-1];return document.createElement("audio").canPlayType("audio/"+n)!==""}static loaded(){return __awaiter(this,void 0,void 0,function*(){for(yield Promise.resolve();ToneAudioBuffer.downloads.length;)yield ToneAudioBuffer.downloads[0]})}}ToneAudioBuffer.baseUrl="";ToneAudioBuffer.downloads=[];class OfflineContext extends Context{constructor(){super({clockSource:"offline",context:isOfflineAudioContext(arguments[0])?arguments[0]:createOfflineAudioContext(arguments[0],arguments[1]*arguments[2],arguments[2]),lookAhead:0,updateInterval:isOfflineAudioContext(arguments[0])?128/arguments[0].sampleRate:128/arguments[2]}),this.name="OfflineContext",this._currentTime=0,this.isOffline=!0,this._duration=isOfflineAudioContext(arguments[0])?arguments[0].length/arguments[0].sampleRate:arguments[1]}now(){return this._currentTime}get currentTime(){return this._currentTime}_renderClock(e){return __awaiter(this,void 0,void 0,function*(){let t=0;for(;this._duration-this._currentTime>=0;){this.emit("tick"),this._currentTime+=128/this.sampleRate,t++;const n=Math.floor(this.sampleRate/128);e&&t%n===0&&(yield new Promise(s=>setTimeout(s,1)))}})}render(e=!0){return __awaiter(this,void 0,void 0,function*(){yield this.workletsAreReady(),yield this._renderClock(e);const t=yield this._context.startRendering();return new ToneAudioBuffer(t)})}close(){return Promise.resolve()}}const dummyContext=new DummyContext;let globalContext=dummyContext;function getContext(){return globalContext===dummyContext&&hasAudioContext&&setContext(new Context),globalContext}function setContext(r){isAudioContext(r)?globalContext=new Context(r):isOfflineAudioContext(r)?globalContext=new OfflineContext(r):globalContext=r}function start(){return globalContext.resume()}if(theWindow&&!theWindow.TONE_SILENCE_LOGGING){const e=` * Tone.js v${version} * `;console.log(`%c${e}`,"background: #000; color: #fff")}function dbToGain(r){return Math.pow(10,r/20)}function gainToDb(r){return 20*(Math.log(r)/Math.LN10)}function intervalToFrequencyRatio(r){return Math.pow(2,r/12)}let A4=440;function getA4(){return A4}function setA4(r){A4=r}function ftom(r){return Math.round(ftomf(r))}function ftomf(r){return 69+12*Math.log2(r/A4)}function mtof(r){return A4*Math.pow(2,(r-69)/12)}class TimeBaseClass extends Tone{constructor(e,t,n){super(),this.defaultUnits="s",this._val=t,this._units=n,this.context=e,this._expressions=this._getExpressions()}_getExpressions(){return{hz:{method:e=>this._frequencyToUnits(parseFloat(e)),regexp:/^(\d+(?:\.\d+)?)hz$/i},i:{method:e=>this._ticksToUnits(parseInt(e,10)),regexp:/^(\d+)i$/i},m:{method:e=>this._beatsToUnits(parseInt(e,10)*this._getTimeSignature()),regexp:/^(\d+)m$/i},n:{method:(e,t)=>{const n=parseInt(e,10),s=t==="."?1.5:1;return n===1?this._beatsToUnits(this._getTimeSignature())*s:this._beatsToUnits(4/n)*s},regexp:/^(\d+)n(\.?)$/i},number:{method:e=>this._expressions[this.defaultUnits].method.call(this,e),regexp:/^(\d+(?:\.\d+)?)$/},s:{method:e=>this._secondsToUnits(parseFloat(e)),regexp:/^(\d+(?:\.\d+)?)s$/},samples:{method:e=>parseInt(e,10)/this.context.sampleRate,regexp:/^(\d+)samples$/},t:{method:e=>{const t=parseInt(e,10);return this._beatsToUnits(8/(Math.floor(t)*3))},regexp:/^(\d+)t$/i},tr:{method:(e,t,n)=>{let s=0;return e&&e!=="0"&&(s+=this._beatsToUnits(this._getTimeSignature()*parseFloat(e))),t&&t!=="0"&&(s+=this._beatsToUnits(parseFloat(t))),n&&n!=="0"&&(s+=this._beatsToUnits(parseFloat(n)/4)),s},regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?$/}}}valueOf(){if(this._val instanceof TimeBaseClass&&this.fromType(this._val),isUndef(this._val))return this._noArg();if(isString$1(this._val)&&isUndef(this._units)){for(const e in this._expressions)if(this._expressions[e].regexp.test(this._val.trim())){this._units=e;break}}else if(isObject(this._val)){let e=0;for(const t in this._val)if(isDefined(this._val[t])){const n=this._val[t],s=new this.constructor(this.context,t).valueOf()*n;e+=s}return e}if(isDefined(this._units)){const e=this._expressions[this._units],t=this._val.toString().trim().match(e.regexp);return t?e.method.apply(this,t.slice(1)):e.method.call(this,this._val)}else return isString$1(this._val)?parseFloat(this._val):this._val}_frequencyToUnits(e){return 1/e}_beatsToUnits(e){return 60/this._getBpm()*e}_secondsToUnits(e){return e}_ticksToUnits(e){return e*this._beatsToUnits(1)/this._getPPQ()}_noArg(){return this._now()}_getBpm(){return this.context.transport.bpm.value}_getTimeSignature(){return this.context.transport.timeSignature}_getPPQ(){return this.context.transport.PPQ}fromType(e){switch(this._units=void 0,this.defaultUnits){case"s":this._val=e.toSeconds();break;case"i":this._val=e.toTicks();break;case"hz":this._val=e.toFrequency();break;case"midi":this._val=e.toMidi();break}return this}toFrequency(){return 1/this.toSeconds()}toSamples(){return this.toSeconds()*this.context.sampleRate}toMilliseconds(){return this.toSeconds()*1e3}}class TimeClass extends TimeBaseClass{constructor(){super(...arguments),this.name="TimeClass"}_getExpressions(){return Object.assign(super._getExpressions(),{now:{method:e=>this._now()+new this.constructor(this.context,e).valueOf(),regexp:/^\+(.+)/},quantize:{method:e=>{const t=new TimeClass(this.context,e).valueOf();return this._secondsToUnits(this.context.transport.nextSubdivision(t))},regexp:/^@(.+)/}})}quantize(e,t=1){const n=new this.constructor(this.context,e).valueOf(),s=this.valueOf(),o=Math.round(s/n)*n-s;return s+o*t}toNotation(){const e=this.toSeconds(),t=["1m"];for(let i=1;i<9;i++){const a=Math.pow(2,i);t.push(a+"n."),t.push(a+"n"),t.push(a+"t")}t.push("0");let n=t[0],s=new TimeClass(this.context,t[0]).toSeconds();return t.forEach(i=>{const a=new TimeClass(this.context,i).toSeconds();Math.abs(a-e)<Math.abs(s-e)&&(n=i,s=a)}),n}toBarsBeatsSixteenths(){const e=this._beatsToUnits(1);let t=this.valueOf()/e;t=parseFloat(t.toFixed(4));const n=Math.floor(t/this._getTimeSignature());let s=t%1*4;t=Math.floor(t)%this._getTimeSignature();const i=s.toString();return i.length>3&&(s=parseFloat(parseFloat(i).toFixed(3))),[n,t,s].join(":")}toTicks(){const e=this._beatsToUnits(1),t=this.valueOf()/e;return Math.round(t*this._getPPQ())}toSeconds(){return this.valueOf()}toMidi(){return ftom(this.toFrequency())}_now(){return this.context.now()}}class FrequencyClass extends TimeClass{constructor(){super(...arguments),this.name="Frequency",this.defaultUnits="hz"}static get A4(){return getA4()}static set A4(e){setA4(e)}_getExpressions(){return Object.assign({},super._getExpressions(),{midi:{regexp:/^(\d+(?:\.\d+)?midi)/,method(e){return this.defaultUnits==="midi"?e:FrequencyClass.mtof(e)}},note:{regexp:/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,method(e,t){const s=noteToScaleIndex[e.toLowerCase()]+(parseInt(t,10)+1)*12;return this.defaultUnits==="midi"?s:FrequencyClass.mtof(s)}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method(e,t,n){let s=1;return e&&e!=="0"&&(s*=this._beatsToUnits(this._getTimeSignature()*parseFloat(e))),t&&t!=="0"&&(s*=this._beatsToUnits(parseFloat(t))),n&&n!=="0"&&(s*=this._beatsToUnits(parseFloat(n)/4)),s}}})}transpose(e){return new FrequencyClass(this.context,this.valueOf()*intervalToFrequencyRatio(e))}harmonize(e){return e.map(t=>this.transpose(t))}toMidi(){return ftom(this.valueOf())}toNote(){const e=this.toFrequency(),t=Math.log2(e/FrequencyClass.A4);let n=Math.round(12*t)+57;const s=Math.floor(n/12);return s<0&&(n+=-12*s),scaleIndexToNote[n%12]+s.toString()}toSeconds(){return 1/super.toSeconds()}toTicks(){const e=this._beatsToUnits(1),t=this.valueOf()/e;return Math.floor(t*this._getPPQ())}_noArg(){return 0}_frequencyToUnits(e){return e}_ticksToUnits(e){return 1/(e*60/(this._getBpm()*this._getPPQ()))}_beatsToUnits(e){return 1/super._beatsToUnits(e)}_secondsToUnits(e){return 1/e}static mtof(e){return mtof(e)}static ftom(e){return ftom(e)}}const noteToScaleIndex={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13},scaleIndexToNote=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];class TransportTimeClass extends TimeClass{constructor(){super(...arguments),this.name="TransportTime"}_now(){return this.context.transport.seconds}}class ToneWithContext extends Tone{constructor(){super();const e=optionsFromArguments(ToneWithContext.getDefaults(),arguments,["context"]);this.defaultContext?this.context=this.defaultContext:this.context=e.context}static getDefaults(){return{context:getContext()}}now(){return this.context.currentTime+this.context.lookAhead}immediate(){return this.context.currentTime}get sampleTime(){return 1/this.context.sampleRate}get blockTime(){return 128/this.context.sampleRate}toSeconds(e){return new TimeClass(this.context,e).toSeconds()}toFrequency(e){return new FrequencyClass(this.context,e).toFrequency()}toTicks(e){return new TransportTimeClass(this.context,e).toTicks()}_getPartialProperties(e){const t=this.get();return Object.keys(t).forEach(n=>{isUndef(e[n])&&delete t[n]}),t}get(){const e=getDefaultsFromInstance(this);return Object.keys(e).forEach(t=>{if(Reflect.has(this,t)){const n=this[t];isDefined(n)&&isDefined(n.value)&&isDefined(n.setValueAtTime)?e[t]=n.value:n instanceof ToneWithContext?e[t]=n._getPartialProperties(e[t]):isArray(n)||isNumber(n)||isString$1(n)||isBoolean(n)?e[t]=n:delete e[t]}}),e}set(e){return Object.keys(e).forEach(t=>{Reflect.has(this,t)&&isDefined(this[t])&&(this[t]&&isDefined(this[t].value)&&isDefined(this[t].setValueAtTime)?this[t].value!==e[t]&&(this[t].value=e[t]):this[t]instanceof ToneWithContext?this[t].set(e[t]):this[t]=e[t])}),this}}class StateTimeline extends Timeline{constructor(e="stopped"){super(),this.name="StateTimeline",this._initial=e,this.setStateAtTime(this._initial,0)}getValueAtTime(e){const t=this.get(e);return t!==null?t.state:this._initial}setStateAtTime(e,t,n){return assertRange(t,0),this.add(Object.assign({},n,{state:e,time:t})),this}getLastState(e,t){const n=this._search(t);for(let s=n;s>=0;s--){const i=this._timeline[s];if(i.state===e)return i}}getNextState(e,t){const n=this._search(t);if(n!==-1)for(let s=n;s<this._timeline.length;s++){const i=this._timeline[s];if(i.state===e)return i}}}class Param extends ToneWithContext{constructor(){super(optionsFromArguments(Param.getDefaults(),arguments,["param","units","convert"])),this.name="Param",this.overridden=!1,this._minOutput=1e-7;const e=optionsFromArguments(Param.getDefaults(),arguments,["param","units","convert"]);for(assert(isDefined(e.param)&&(isAudioParam(e.param)||e.param instanceof Param),"param must be an AudioParam");!isAudioParam(e.param);)e.param=e.param._param;this._swappable=isDefined(e.swappable)?e.swappable:!1,this._swappable?(this.input=this.context.createGain(),this._param=e.param,this.input.connect(this._param)):this._param=this.input=e.param,this._events=new Timeline(1e3),this._initialValue=this._param.defaultValue,this.units=e.units,this.convert=e.convert,this._minValue=e.minValue,this._maxValue=e.maxValue,isDefined(e.value)&&e.value!==this._toType(this._initialValue)&&this.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(ToneWithContext.getDefaults(),{convert:!0,units:"number"})}get value(){const e=this.now();return this.getValueAtTime(e)}set value(e){this.cancelScheduledValues(this.now()),this.setValueAtTime(e,this.now())}get minValue(){return isDefined(this._minValue)?this._minValue:this.units==="time"||this.units==="frequency"||this.units==="normalRange"||this.units==="positive"||this.units==="transportTime"||this.units==="ticks"||this.units==="bpm"||this.units==="hertz"||this.units==="samples"?0:this.units==="audioRange"?-1:this.units==="decibels"?-1/0:this._param.minValue}get maxValue(){return isDefined(this._maxValue)?this._maxValue:this.units==="normalRange"||this.units==="audioRange"?1:this._param.maxValue}_is(e,t){return this.units===t}_assertRange(e){return isDefined(this.maxValue)&&isDefined(this.minValue)&&assertRange(e,this._fromType(this.minValue),this._fromType(this.maxValue)),e}_fromType(e){return this.convert&&!this.overridden?this._is(e,"time")?this.toSeconds(e):this._is(e,"decibels")?dbToGain(e):this._is(e,"frequency")?this.toFrequency(e):e:this.overridden?0:e}_toType(e){return this.convert&&this.units==="decibels"?gainToDb(e):e}setValueAtTime(e,t){const n=this.toSeconds(t),s=this._fromType(e);return assert(isFinite(s)&&isFinite(n),`Invalid argument(s) to setValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._assertRange(s),this.log(this.units,"setValueAtTime",e,n),this._events.add({time:n,type:"setValueAtTime",value:s}),this._param.setValueAtTime(s,n),this}getValueAtTime(e){const t=Math.max(this.toSeconds(e),0),n=this._events.getAfter(t),s=this._events.get(t);let i=this._initialValue;if(s===null)i=this._initialValue;else if(s.type==="setTargetAtTime"&&(n===null||n.type==="setValueAtTime")){const a=this._events.getBefore(s.time);let o;a===null?o=this._initialValue:o=a.value,s.type==="setTargetAtTime"&&(i=this._exponentialApproach(s.time,o,s.value,s.constant,t))}else if(n===null)i=s.value;else if(n.type==="linearRampToValueAtTime"||n.type==="exponentialRampToValueAtTime"){let a=s.value;if(s.type==="setTargetAtTime"){const o=this._events.getBefore(s.time);o===null?a=this._initialValue:a=o.value}n.type==="linearRampToValueAtTime"?i=this._linearInterpolate(s.time,a,n.time,n.value,t):i=this._exponentialInterpolate(s.time,a,n.time,n.value,t)}else i=s.value;return this._toType(i)}setRampPoint(e){e=this.toSeconds(e);let t=this.getValueAtTime(e);return this.cancelAndHoldAtTime(e),this._fromType(t)===0&&(t=this._toType(this._minOutput)),this.setValueAtTime(t,e),this}linearRampToValueAtTime(e,t){const n=this._fromType(e),s=this.toSeconds(t);return assert(isFinite(n)&&isFinite(s),`Invalid argument(s) to linearRampToValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._assertRange(n),this._events.add({time:s,type:"linearRampToValueAtTime",value:n}),this.log(this.units,"linearRampToValueAtTime",e,s),this._param.linearRampToValueAtTime(n,s),this}exponentialRampToValueAtTime(e,t){let n=this._fromType(e);n=EQ(n,0)?this._minOutput:n,this._assertRange(n);const s=this.toSeconds(t);return assert(isFinite(n)&&isFinite(s),`Invalid argument(s) to exponentialRampToValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._events.add({time:s,type:"exponentialRampToValueAtTime",value:n}),this.log(this.units,"exponentialRampToValueAtTime",e,s),this._param.exponentialRampToValueAtTime(n,s),this}exponentialRampTo(e,t,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialRampToValueAtTime(e,n+this.toSeconds(t)),this}linearRampTo(e,t,n){return n=this.toSeconds(n),this.setRampPoint(n),this.linearRampToValueAtTime(e,n+this.toSeconds(t)),this}targetRampTo(e,t,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialApproachValueAtTime(e,n,t),this}exponentialApproachValueAtTime(e,t,n){t=this.toSeconds(t),n=this.toSeconds(n);const s=Math.log(n+1)/Math.log(200);return this.setTargetAtTime(e,t,s),this.cancelAndHoldAtTime(t+n*.9),this.linearRampToValueAtTime(e,t+n),this}setTargetAtTime(e,t,n){const s=this._fromType(e);assert(isFinite(n)&&n>0,"timeConstant must be a number greater than 0");const i=this.toSeconds(t);return this._assertRange(s),assert(isFinite(s)&&isFinite(i),`Invalid argument(s) to setTargetAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._events.add({constant:n,time:i,type:"setTargetAtTime",value:s}),this.log(this.units,"setTargetAtTime",e,i,n),this._param.setTargetAtTime(s,i,n),this}setValueCurveAtTime(e,t,n,s=1){n=this.toSeconds(n),t=this.toSeconds(t);const i=this._fromType(e[0])*s;this.setValueAtTime(this._toType(i),t);const a=n/(e.length-1);for(let o=1;o<e.length;o++){const c=this._fromType(e[o])*s;this.linearRampToValueAtTime(this._toType(c),t+o*a)}return this}cancelScheduledValues(e){const t=this.toSeconds(e);return assert(isFinite(t),`Invalid argument to cancelScheduledValues: ${JSON.stringify(e)}`),this._events.cancel(t),this._param.cancelScheduledValues(t),this.log(this.units,"cancelScheduledValues",t),this}cancelAndHoldAtTime(e){const t=this.toSeconds(e),n=this._fromType(this.getValueAtTime(t));assert(isFinite(t),`Invalid argument to cancelAndHoldAtTime: ${JSON.stringify(e)}`),this.log(this.units,"cancelAndHoldAtTime",t,"value="+n);const s=this._events.get(t),i=this._events.getAfter(t);return s&&EQ(s.time,t)?i?(this._param.cancelScheduledValues(i.time),this._events.cancel(i.time)):(this._param.cancelAndHoldAtTime(t),this._events.cancel(t+this.sampleTime)):i&&(this._param.cancelScheduledValues(i.time),this._events.cancel(i.time),i.type==="linearRampToValueAtTime"?this.linearRampToValueAtTime(this._toType(n),t):i.type==="exponentialRampToValueAtTime"&&this.exponentialRampToValueAtTime(this._toType(n),t)),this._events.add({time:t,type:"setValueAtTime",value:n}),this._param.setValueAtTime(n,t),this}rampTo(e,t=.1,n){return this.units==="frequency"||this.units==="bpm"||this.units==="decibels"?this.exponentialRampTo(e,t,n):this.linearRampTo(e,t,n),this}apply(e){const t=this.context.currentTime;e.setValueAtTime(this.getValueAtTime(t),t);const n=this._events.get(t);if(n&&n.type==="setTargetAtTime"){const s=this._events.getAfter(n.time),i=s?s.time:t+2,a=(i-t)/10;for(let o=t;o<i;o+=a)e.linearRampToValueAtTime(this.getValueAtTime(o),o)}return this._events.forEachAfter(this.context.currentTime,s=>{s.type==="cancelScheduledValues"?e.cancelScheduledValues(s.time):s.type==="setTargetAtTime"?e.setTargetAtTime(s.value,s.time,s.constant):e[s.type](s.value,s.time)}),this}setParam(e){assert(this._swappable,"The Param must be assigned as 'swappable' in the constructor");const t=this.input;return t.disconnect(this._param),this.apply(e),this._param=e,t.connect(this._param),this}dispose(){return super.dispose(),this._events.dispose(),this}get defaultValue(){return this._toType(this._param.defaultValue)}_exponentialApproach(e,t,n,s,i){return n+(t-n)*Math.exp(-(i-e)/s)}_linearInterpolate(e,t,n,s,i){return t+(s-t)*((i-e)/(n-e))}_exponentialInterpolate(e,t,n,s,i){return t*Math.pow(s/t,(i-e)/(n-e))}}class ToneAudioNode extends ToneWithContext{constructor(){super(...arguments),this.name="ToneAudioNode",this._internalChannels=[]}get numberOfInputs(){return isDefined(this.input)?isAudioParam(this.input)||this.input instanceof Param?1:this.input.numberOfInputs:0}get numberOfOutputs(){return isDefined(this.output)?this.output.numberOfOutputs:0}_isAudioNode(e){return isDefined(e)&&(e instanceof ToneAudioNode||isAudioNode(e))}_getInternalNodes(){const e=this._internalChannels.slice(0);return this._isAudioNode(this.input)&&e.push(this.input),this._isAudioNode(this.output)&&this.input!==this.output&&e.push(this.output),e}_setChannelProperties(e){this._getInternalNodes().forEach(n=>{n.channelCount=e.channelCount,n.channelCountMode=e.channelCountMode,n.channelInterpretation=e.channelInterpretation})}_getChannelProperties(){const e=this._getInternalNodes();assert(e.length>0,"ToneAudioNode does not have any internal nodes");const t=e[0];return{channelCount:t.channelCount,channelCountMode:t.channelCountMode,channelInterpretation:t.channelInterpretation}}get channelCount(){return this._getChannelProperties().channelCount}set channelCount(e){const t=this._getChannelProperties();this._setChannelProperties(Object.assign(t,{channelCount:e}))}get channelCountMode(){return this._getChannelProperties().channelCountMode}set channelCountMode(e){const t=this._getChannelProperties();this._setChannelProperties(Object.assign(t,{channelCountMode:e}))}get channelInterpretation(){return this._getChannelProperties().channelInterpretation}set channelInterpretation(e){const t=this._getChannelProperties();this._setChannelProperties(Object.assign(t,{channelInterpretation:e}))}connect(e,t=0,n=0){return connect(this,e,t,n),this}toDestination(){return this.connect(this.context.destination),this}toMaster(){return warn("toMaster() has been renamed toDestination()"),this.toDestination()}disconnect(e,t=0,n=0){return disconnect(this,e,t,n),this}chain(...e){return connectSeries(this,...e),this}fan(...e){return e.forEach(t=>this.connect(t)),this}dispose(){return super.dispose(),isDefined(this.input)&&(this.input instanceof ToneAudioNode?this.input.dispose():isAudioNode(this.input)&&this.input.disconnect()),isDefined(this.output)&&(this.output instanceof ToneAudioNode?this.output.dispose():isAudioNode(this.output)&&this.output.disconnect()),this._internalChannels=[],this}}function connectSeries(...r){const e=r.shift();r.reduce((t,n)=>(t instanceof ToneAudioNode?t.connect(n):isAudioNode(t)&&connect(t,n),n),e)}function connect(r,e,t=0,n=0){for(assert(isDefined(r),"Cannot connect from undefined node"),assert(isDefined(e),"Cannot connect to undefined node"),(e instanceof ToneAudioNode||isAudioNode(e))&&assert(e.numberOfInputs>0,"Cannot connect to node with no inputs"),assert(r.numberOfOutputs>0,"Cannot connect from node with no outputs");e instanceof ToneAudioNode||e instanceof Param;)isDefined(e.input)&&(e=e.input);for(;r instanceof ToneAudioNode;)isDefined(r.output)&&(r=r.output);isAudioParam(e)?r.connect(e,t):r.connect(e,t,n)}function disconnect(r,e,t=0,n=0){if(isDefined(e))for(;e instanceof ToneAudioNode;)e=e.input;for(;!isAudioNode(r);)isDefined(r.output)&&(r=r.output);isAudioParam(e)?r.disconnect(e,t):isAudioNode(e)?r.disconnect(e,t,n):r.disconnect()}class Gain extends ToneAudioNode{constructor(){super(optionsFromArguments(Gain.getDefaults(),arguments,["gain","units"])),this.name="Gain",this._gainNode=this.context.createGain(),this.input=this._gainNode,this.output=this._gainNode;const e=optionsFromArguments(Gain.getDefaults(),arguments,["gain","units"]);this.gain=new Param({context:this.context,convert:e.convert,param:this._gainNode.gain,units:e.units,value:e.gain,minValue:e.minValue,maxValue:e.maxValue}),readOnly(this,"gain")}static getDefaults(){return Object.assign(ToneAudioNode.getDefaults(),{convert:!0,gain:1,units:"gain"})}dispose(){return super.dispose(),this._gainNode.disconnect(),this.gain.dispose(),this}}class OneShotSource extends ToneAudioNode{constructor(e){super(e),this.onended=noOp,this._startTime=-1,this._stopTime=-1,this._timeout=-1,this.output=new Gain({context:this.context,gain:0}),this._gainNode=this.output,this.getStateAtTime=function(t){const n=this.toSeconds(t);return this._startTime!==-1&&n>=this._startTime&&(this._stopTime===-1||n<=this._stopTime)?"started":"stopped"},this._fadeIn=e.fadeIn,this._fadeOut=e.fadeOut,this._curve=e.curve,this.onended=e.onended}static getDefaults(){return Object.assign(ToneAudioNode.getDefaults(),{curve:"linear",fadeIn:0,fadeOut:0,onended:noOp})}_startGain(e,t=1){assert(this._startTime===-1,"Source cannot be started more than once");const n=this.toSeconds(this._fadeIn);return this._startTime=e+n,this._startTime=Math.max(this._startTime,this.context.currentTime),n>0?(this._gainNode.gain.setValueAtTime(0,e),this._curve==="linear"?this._gainNode.gain.linearRampToValueAtTime(t,e+n):this._gainNode.gain.exponentialApproachValueAtTime(t,e,n)):this._gainNode.gain.setValueAtTime(t,e),this}stop(e){return this.log("stop",e),this._stopGain(this.toSeconds(e)),this}_stopGain(e){assert(this._startTime!==-1,"'start' must be called before 'stop'"),this.cancelStop();const t=this.toSeconds(this._fadeOut);return this._stopTime=this.toSeconds(e)+t,this._stopTime=Math.max(this._stopTime,this.context.currentTime),t>0?this._curve==="linear"?this._gainNode.gain.linearRampTo(0,t,e):this._gainNode.gain.targetRampTo(0,t,e):(this._gainNode.gain.cancelAndHoldAtTime(e),this._gainNode.gain.setValueAtTime(0,e)),this.context.clearTimeout(this._timeout),this._timeout=this.context.setTimeout(()=>{const n=this._curve==="exponential"?t*2:0;this._stopSource(this.now()+n),this._onended()},this._stopTime-this.context.currentTime),this}_onended(){if(this.onended!==noOp&&(this.onended(this),this.onended=noOp,!this.context.isOffline)){const e=()=>this.dispose();typeof window.requestIdleCallback<"u"?window.requestIdleCallback(e):setTimeout(e,1e3)}}get state(){return this.getStateAtTime(this.now())}cancelStop(){return this.log("cancelStop"),assert(this._startTime!==-1,"Source is not started"),this._gainNode.gain.cancelScheduledValues(this._startTime+this.sampleTime),this.context.clearTimeout(this._timeout),this._stopTime=-1,this}dispose(){return super.dispose(),this._gainNode.disconnect(),this}}class ToneConstantSource extends OneShotSource{constructor(){super(optionsFromArguments(ToneConstantSource.getDefaults(),arguments,["offset"])),this.name="ToneConstantSource",this._source=this.context.createConstantSource();const e=optionsFromArguments(ToneConstantSource.getDefaults(),arguments,["offset"]);connect(this._source,this._gainNode),this.offset=new Param({context:this.context,convert:e.convert,param:this._source.offset,units:e.units,value:e.offset,minValue:e.minValue,maxValue:e.maxValue})}static getDefaults(){return Object.assign(OneShotSource.getDefaults(),{convert:!0,offset:1,units:"number"})}start(e){const t=this.toSeconds(e);return this.log("start",t),this._startGain(t),this._source.start(t),this}_stopSource(e){this._source.stop(e)}dispose(){return super.dispose(),this.state==="started"&&this.stop(),this._source.disconnect(),this.offset.dispose(),this}}class Signal extends ToneAudioNode{constructor(){super(optionsFromArguments(Signal.getDefaults(),arguments,["value","units"])),this.name="Signal",this.override=!0;const e=optionsFromArguments(Signal.getDefaults(),arguments,["value","units"]);this.output=this._constantSource=new ToneConstantSource({context:this.context,convert:e.convert,offset:e.value,units:e.units,minValue:e.minValue,maxValue:e.maxValue}),this._constantSource.start(0),this.input=this._param=this._constantSource.offset}static getDefaults(){return Object.assign(ToneAudioNode.getDefaults(),{convert:!0,units:"number",value:0})}connect(e,t=0,n=0){return connectSignal(this,e,t,n),this}dispose(){return super.dispose(),this._param.dispose(),this._constantSource.dispose(),this}setValueAtTime(e,t){return this._param.setValueAtTime(e,t),this}getValueAtTime(e){return this._param.getValueAtTime(e)}setRampPoint(e){return this._param.setRampPoint(e),this}linearRampToValueAtTime(e,t){return this._param.linearRampToValueAtTime(e,t),this}exponentialRampToValueAtTime(e,t){return this._param.exponentialRampToValueAtTime(e,t),this}exponentialRampTo(e,t,n){return this._param.exponentialRampTo(e,t,n),this}linearRampTo(e,t,n){return this._param.linearRampTo(e,t,n),this}targetRampTo(e,t,n){return this._param.targetRampTo(e,t,n),this}exponentialApproachValueAtTime(e,t,n){return this._param.exponentialApproachValueAtTime(e,t,n),this}setTargetAtTime(e,t,n){return this._param.setTargetAtTime(e,t,n),this}setValueCurveAtTime(e,t,n,s){return this._param.setValueCurveAtTime(e,t,n,s),this}cancelScheduledValues(e){return this._param.cancelScheduledValues(e),this}cancelAndHoldAtTime(e){return this._param.cancelAndHoldAtTime(e),this}rampTo(e,t,n){return this._param.rampTo(e,t,n),this}get value(){return this._param.value}set value(e){this._param.value=e}get convert(){return this._param.convert}set convert(e){this._param.convert=e}get units(){return this._param.units}get overridden(){return this._param.overridden}set overridden(e){this._param.overridden=e}get maxValue(){return this._param.maxValue}get minValue(){return this._param.minValue}apply(e){return this._param.apply(e),this}}function connectSignal(r,e,t,n){(e instanceof Param||isAudioParam(e)||e instanceof Signal&&e.override)&&(e.cancelScheduledValues(0),e.setValueAtTime(0,0),e instanceof Signal&&(e.overridden=!0)),connect(r,e,t,n)}class TickParam extends Param{constructor(){super(optionsFromArguments(TickParam.getDefaults(),arguments,["value"])),this.name="TickParam",this._events=new Timeline(1/0),this._multiplier=1;const e=optionsFromArguments(TickParam.getDefaults(),arguments,["value"]);this._multiplier=e.multiplier,this._events.cancel(0),this._events.add({ticks:0,time:0,type:"setValueAtTime",value:this._fromType(e.value)}),this.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(Param.getDefaults(),{multiplier:1,units:"hertz",value:1})}setTargetAtTime(e,t,n){t=this.toSeconds(t),this.setRampPoint(t);const s=this._fromType(e),i=this._events.get(t),a=Math.round(Math.max(1/n,1));for(let o=0;o<=a;o++){const c=n*o+t,l=this._exponentialApproach(i.time,i.value,s,n,c);this.linearRampToValueAtTime(this._toType(l),c)}return this}setValueAtTime(e,t){const n=this.toSeconds(t);super.setValueAtTime(e,t);const s=this._events.get(n),i=this._events.previousEvent(s),a=this._getTicksUntilEvent(i,n);return s.ticks=Math.max(a,0),this}linearRampToValueAtTime(e,t){const n=this.toSeconds(t);super.linearRampToValueAtTime(e,t);const s=this._events.get(n),i=this._events.previousEvent(s),a=this._getTicksUntilEvent(i,n);return s.ticks=Math.max(a,0),this}exponentialRampToValueAtTime(e,t){t=this.toSeconds(t);const n=this._fromType(e),s=this._events.get(t),i=Math.round(Math.max((t-s.time)*10,1)),a=(t-s.time)/i;for(let o=0;o<=i;o++){const c=a*o+s.time,l=this._exponentialInterpolate(s.time,s.value,t,n,c);this.linearRampToValueAtTime(this._toType(l),c)}return this}_getTicksUntilEvent(e,t){if(e===null)e={ticks:0,time:0,type:"setValueAtTime",value:0};else if(isUndef(e.ticks)){const a=this._events.previousEvent(e);e.ticks=this._getTicksUntilEvent(a,e.time)}const n=this._fromType(this.getValueAtTime(e.time));let s=this._fromType(this.getValueAtTime(t));const i=this._events.get(t);return i&&i.time===t&&i.type==="setValueAtTime"&&(s=this._fromType(this.getValueAtTime(t-this.sampleTime))),.5*(t-e.time)*(n+s)+e.ticks}getTicksAtTime(e){const t=this.toSeconds(e),n=this._events.get(t);return Math.max(this._getTicksUntilEvent(n,t),0)}getDurationOfTicks(e,t){const n=this.toSeconds(t),s=this.getTicksAtTime(t);return this.getTimeOfTick(s+e)-n}getTimeOfTick(e){const t=this._events.get(e,"ticks"),n=this._events.getAfter(e,"ticks");if(t&&t.ticks===e)return t.time;if(t&&n&&n.type==="linearRampToValueAtTime"&&t.value!==n.value){const s=this._fromType(this.getValueAtTime(t.time)),a=(this._fromType(this.getValueAtTime(n.time))-s)/(n.time-t.time),o=Math.sqrt(Math.pow(s,2)-2*a*(t.ticks-e)),c=(-s+o)/a,l=(-s-o)/a;return(c>0?c:l)+t.time}else return t?t.value===0?1/0:t.time+(e-t.ticks)/t.value:e/this._initialValue}ticksToTime(e,t){return this.getDurationOfTicks(e,t)}timeToTicks(e,t){const n=this.toSeconds(t),s=this.toSeconds(e),i=this.getTicksAtTime(n);return this.getTicksAtTime(n+s)-i}_fromType(e){return this.units==="bpm"&&this.multiplier?1/(60/e/this.multiplier):super._fromType(e)}_toType(e){return this.units==="bpm"&&this.multiplier?e/this.multiplier*60:super._toType(e)}get multiplier(){return this._multiplier}set multiplier(e){const t=this.value;this._multiplier=e,this.cancelScheduledValues(0),this.setValueAtTime(t,0)}}class TickSignal extends Signal{constructor(){super(optionsFromArguments(TickSignal.getDefaults(),arguments,["value"])),this.name="TickSignal";const e=optionsFromArguments(TickSignal.getDefaults(),arguments,["value"]);this.input=this._param=new TickParam({context:this.context,convert:e.convert,multiplier:e.multiplier,param:this._constantSource.offset,units:e.units,value:e.value})}static getDefaults(){return Object.assign(Signal.getDefaults(),{multiplier:1,units:"hertz",value:1})}ticksToTime(e,t){return this._param.ticksToTime(e,t)}timeToTicks(e,t){return this._param.timeToTicks(e,t)}getTimeOfTick(e){return this._param.getTimeOfTick(e)}getDurationOfTicks(e,t){return this._param.getDurationOfTicks(e,t)}getTicksAtTime(e){return this._param.getTicksAtTime(e)}get multiplier(){return this._param.multiplier}set multiplier(e){this._param.multiplier=e}dispose(){return super.dispose(),this._param.dispose(),this}}class TickSource extends ToneWithContext{constructor(){super(optionsFromArguments(TickSource.getDefaults(),arguments,["frequency"])),this.name="TickSource",this._state=new StateTimeline,this._tickOffset=new Timeline;const e=optionsFromArguments(TickSource.getDefaults(),arguments,["frequency"]);this.frequency=new TickSignal({context:this.context,units:e.units,value:e.frequency}),readOnly(this,"frequency"),this._state.setStateAtTime("stopped",0),this.setTicksAtTime(0,0)}static getDefaults(){return Object.assign({frequency:1,units:"hertz"},ToneWithContext.getDefaults())}get state(){return this.getStateAtTime(this.now())}start(e,t){const n=this.toSeconds(e);return this._state.getValueAtTime(n)!=="started"&&(this._state.setStateAtTime("started",n),isDefined(t)&&this.setTicksAtTime(t,n)),this}stop(e){const t=this.toSeconds(e);if(this._state.getValueAtTime(t)==="stopped"){const n=this._state.get(t);n&&n.time>0&&(this._tickOffset.cancel(n.time),this._state.cancel(n.time))}return this._state.cancel(t),this._state.setStateAtTime("stopped",t),this.setTicksAtTime(0,t),this}pause(e){const t=this.toSeconds(e);return this._state.getValueAtTime(t)==="started"&&this._state.setStateAtTime("paused",t),this}cancel(e){return e=this.toSeconds(e),this._state.cancel(e),this._tickOffset.cancel(e),this}getTicksAtTime(e){const t=this.toSeconds(e),n=this._state.getLastState("stopped",t),s={state:"paused",time:t};this._state.add(s);let i=n,a=0;return this._state.forEachBetween(n.time,t+this.sampleTime,o=>{let c=i.time;const l=this._tickOffset.get(o.time);l&&l.time>=i.time&&(a=l.ticks,c=l.time),i.state==="started"&&o.state!=="started"&&(a+=this.frequency.getTicksAtTime(o.time)-this.frequency.getTicksAtTime(c)),i=o}),this._state.remove(s),a}get ticks(){return this.getTicksAtTime(this.now())}set ticks(e){this.setTicksAtTime(e,this.now())}get seconds(){return this.getSecondsAtTime(this.now())}set seconds(e){const t=this.now(),n=this.frequency.timeToTicks(e,t);this.setTicksAtTime(n,t)}getSecondsAtTime(e){e=this.toSeconds(e);const t=this._state.getLastState("stopped",e),n={state:"paused",time:e};this._state.add(n);let s=t,i=0;return this._state.forEachBetween(t.time,e+this.sampleTime,a=>{let o=s.time;const c=this._tickOffset.get(a.time);c&&c.time>=s.time&&(i=c.seconds,o=c.time),s.state==="started"&&a.state!=="started"&&(i+=a.time-o),s=a}),this._state.remove(n),i}setTicksAtTime(e,t){return t=this.toSeconds(t),this._tickOffset.cancel(t),this._tickOffset.add({seconds:this.frequency.getDurationOfTicks(e,t),ticks:e,time:t}),this}getStateAtTime(e){return e=this.toSeconds(e),this._state.getValueAtTime(e)}getTimeOfTick(e,t=this.now()){const n=this._tickOffset.get(t),s=this._state.get(t),i=Math.max(n.time,s.time),a=this.frequency.getTicksAtTime(i)+e-n.ticks;return this.frequency.getTimeOfTick(a)}forEachTickBetween(e,t,n){let s=this._state.get(e);this._state.forEachBetween(e,t,a=>{s&&s.state==="started"&&a.state!=="started"&&this.forEachTickBetween(Math.max(s.time,e),a.time-this.sampleTime,n),s=a});let i=null;if(s&&s.state==="started"){const a=Math.max(s.time,e),o=this.frequency.getTicksAtTime(a),c=this.frequency.getTicksAtTime(s.time),l=o-c;let u=Math.ceil(l)-l;u=EQ(u,1)?0:u;let d=this.frequency.getTimeOfTick(o+u);for(;d<t;){try{n(d,Math.round(this.getTicksAtTime(d)))}catch(m){i=m;break}d+=this.frequency.getDurationOfTicks(1,d)}}if(i)throw i;return this}dispose(){return super.dispose(),this._state.dispose(),this._tickOffset.dispose(),this.frequency.dispose(),this}}class Clock extends ToneWithContext{constructor(){super(optionsFromArguments(Clock.getDefaults(),arguments,["callback","frequency"])),this.name="Clock",this.callback=noOp,this._lastUpdate=0,this._state=new StateTimeline("stopped"),this._boundLoop=this._loop.bind(this);const e=optionsFromArguments(Clock.getDefaults(),arguments,["callback","frequency"]);this.callback=e.callback,this._tickSource=new TickSource({context:this.context,frequency:e.frequency,units:e.units}),this._lastUpdate=0,this.frequency=this._tickSource.frequency,readOnly(this,"frequency"),this._state.setStateAtTime("stopped",0),this.context.on("tick",this._boundLoop)}static getDefaults(){return Object.assign(ToneWithContext.getDefaults(),{callback:noOp,frequency:1,units:"hertz"})}get state(){return this._state.getValueAtTime(this.now())}start(e,t){assertContextRunning(this.context);const n=this.toSeconds(e);return this.log("start",n),this._state.getValueAtTime(n)!=="started"&&(this._state.setStateAtTime("started",n),this._tickSource.start(n,t),n<this._lastUpdate&&this.emit("start",n,t)),this}stop(e){const t=this.toSeconds(e);return this.log("stop",t),this._state.cancel(t),this._state.setStateAtTime("stopped",t),this._tickSource.stop(t),t<this._lastUpdate&&this.emit("stop",t),this}pause(e){const t=this.toSeconds(e);return this._state.getValueAtTime(t)==="started"&&(this._state.setStateAtTime("paused",t),this._tickSource.pause(t),t<this._lastUpdate&&this.emit("pause",t)),this}get ticks(){return Math.ceil(this.getTicksAtTime(this.now()))}set ticks(e){this._tickSource.ticks=e}get seconds(){return this._tickSource.seconds}set seconds(e){this._tickSource.seconds=e}getSecondsAtTime(e){return this._tickSource.getSecondsAtTime(e)}setTicksAtTime(e,t){return this._tickSource.setTicksAtTime(e,t),this}getTimeOfTick(e,t=this.now()){return this._tickSource.getTimeOfTick(e,t)}getTicksAtTime(e){return this._tickSource.getTicksAtTime(e)}nextTickTime(e,t){const n=this.toSeconds(t),s=this.getTicksAtTime(n);return this._tickSource.getTimeOfTick(s+e,n)}_loop(){const e=this._lastUpdate,t=this.now();this._lastUpdate=t,this.log("loop",e,t),e!==t&&(this._state.forEachBetween(e,t,n=>{switch(n.state){case"started":const s=this._tickSource.getTicksAtTime(n.time);this.emit("start",n.time,s);break;case"stopped":n.time!==0&&this.emit("stop",n.time);break;case"paused":this.emit("pause",n.time);break}}),this._tickSource.forEachTickBetween(e,t,(n,s)=>{this.callback(n,s)}))}getStateAtTime(e){const t=this.toSeconds(e);return this._state.getValueAtTime(t)}dispose(){return super.dispose(),this.context.off("tick",this._boundLoop),this._tickSource.dispose(),this._state.dispose(),this}}Emitter.mixin(Clock);class ToneAudioBuffers extends Tone{constructor(){super(),this.name="ToneAudioBuffers",this._buffers=new Map,this._loadingCount=0;const e=optionsFromArguments(ToneAudioBuffers.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");this.baseUrl=e.baseUrl,Object.keys(e.urls).forEach(t=>{this._loadingCount++;const n=e.urls[t];this.add(t,n,this._bufferLoaded.bind(this,e.onload),e.onerror)})}static getDefaults(){return{baseUrl:"",onerror:noOp,onload:noOp,urls:{}}}has(e){return this._buffers.has(e.toString())}get(e){return assert(this.has(e),`ToneAudioBuffers has no buffer named: ${e}`),this._buffers.get(e.toString())}_bufferLoaded(e){this._loadingCount--,this._loadingCount===0&&e&&e()}get loaded(){return Array.from(this._buffers).every(([e,t])=>t.loaded)}add(e,t,n=noOp,s=noOp){return isString$1(t)?this._buffers.set(e.toString(),new ToneAudioBuffer(this.baseUrl+t,n,s)):this._buffers.set(e.toString(),new ToneAudioBuffer(t,n,s)),this}dispose(){return super.dispose(),this._buffers.forEach(e=>e.dispose()),this._buffers.clear(),this}}class TicksClass extends TransportTimeClass{constructor(){super(...arguments),this.name="Ticks",this.defaultUnits="i"}_now(){return this.context.transport.ticks}_beatsToUnits(e){return this._getPPQ()*e}_secondsToUnits(e){return Math.floor(e/(60/this._getBpm())*this._getPPQ())}_ticksToUnits(e){return e}toTicks(){return this.valueOf()}toSeconds(){return this.valueOf()/this._getPPQ()*(60/this._getBpm())}}class Draw extends ToneWithContext{constructor(){super(...arguments),this.name="Draw",this.expiration=.25,this.anticipation=.008,this._events=new Timeline,this._boundDrawLoop=this._drawLoop.bind(this),this._animationFrame=-1}schedule(e,t){return this._events.add({callback:e,time:this.toSeconds(t)}),this._events.length===1&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop)),this}cancel(e){return this._events.cancel(this.toSeconds(e)),this}_drawLoop(){const e=this.context.currentTime;for(;this._events.length&&this._events.peek().time-this.anticipation<=e;){const t=this._events.shift();t&&e-t.time<=this.expiration&&t.callback()}this._events.length>0&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop))}dispose(){return super.dispose(),this._events.dispose(),cancelAnimationFrame(this._animationFrame),this}}onContextInit(r=>{r.draw=new Draw({context:r})});onContextClose(r=>{r.draw.dispose()});class IntervalTimeline extends Tone{constructor(){super(...arguments),this.name="IntervalTimeline",this._root=null,this._length=0}add(e){assert(isDefined(e.time),"Events must have a time property"),assert(isDefined(e.duration),"Events must have a duration parameter"),e.time=e.time.valueOf();let t=new IntervalNode(e.time,e.time+e.duration,e);for(this._root===null?this._root=t:this._root.insert(t),this._length++;t!==null;)t.updateHeight(),t.updateMax(),this._rebalance(t),t=t.parent;return this}remove(e){if(this._root!==null){const t=[];this._root.search(e.time,t);for(const n of t)if(n.event===e){this._removeNode(n),this._length--;break}}return this}get length(){return this._length}cancel(e){return this.forEachFrom(e,t=>this.remove(t)),this}_setRoot(e){this._root=e,this._root!==null&&(this._root.parent=null)}_replaceNodeInParent(e,t){e.parent!==null?(e.isLeftChild()?e.parent.left=t:e.parent.right=t,this._rebalance(e.parent)):this._setRoot(t)}_removeNode(e){if(e.left===null&&e.right===null)this._replaceNodeInParent(e,null);else if(e.right===null)this._replaceNodeInParent(e,e.left);else if(e.left===null)this._replaceNodeInParent(e,e.right);else{const t=e.getBalance();let n,s=null;if(t>0)if(e.left.right===null)n=e.left,n.right=e.right,s=n;else{for(n=e.left.right;n.right!==null;)n=n.right;n.parent&&(n.parent.right=n.left,s=n.parent,n.left=e.left,n.right=e.right)}else if(e.right.left===null)n=e.right,n.left=e.left,s=n;else{for(n=e.right.left;n.left!==null;)n=n.left;n.parent&&(n.parent.left=n.right,s=n.parent,n.left=e.left,n.right=e.right)}e.parent!==null?e.isLeftChild()?e.parent.left=n:e.parent.right=n:this._setRoot(n),s&&this._rebalance(s)}e.dispose()}_rotateLeft(e){const t=e.parent,n=e.isLeftChild(),s=e.right;s&&(e.right=s.left,s.left=e),t!==null?n?t.left=s:t.right=s:this._setRoot(s)}_rotateRight(e){const t=e.parent,n=e.isLeftChild(),s=e.left;s&&(e.left=s.right,s.right=e),t!==null?n?t.left=s:t.right=s:this._setRoot(s)}_rebalance(e){const t=e.getBalance();t>1&&e.left?e.left.getBalance()<0?this._rotateLeft(e.left):this._rotateRight(e):t<-1&&e.right&&(e.right.getBalance()>0?this._rotateRight(e.right):this._rotateLeft(e))}get(e){if(this._root!==null){const t=[];if(this._root.search(e,t),t.length>0){let n=t[0];for(let s=1;s<t.length;s++)t[s].low>n.low&&(n=t[s]);return n.event}}return null}forEach(e){if(this._root!==null){const t=[];this._root.traverse(n=>t.push(n)),t.forEach(n=>{n.event&&e(n.event)})}return this}forEachAtTime(e,t){if(this._root!==null){const n=[];this._root.search(e,n),n.forEach(s=>{s.event&&t(s.event)})}return this}forEachFrom(e,t){if(this._root!==null){const n=[];this._root.searchAfter(e,n),n.forEach(s=>{s.event&&t(s.event)})}return this}dispose(){return super.dispose(),this._root!==null&&this._root.traverse(e=>e.dispose()),this._root=null,this}}class IntervalNode{constructor(e,t,n){this._left=null,this._right=null,this.parent=null,this.height=0,this.event=n,this.low=e,this.high=t,this.max=this.high}insert(e){e.low<=this.low?this.left===null?this.left=e:this.left.insert(e):this.right===null?this.right=e:this.right.insert(e)}search(e,t){e>this.max||(this.left!==null&&this.left.search(e,t),this.low<=e&&this.high>e&&t.push(this),!(this.low>e)&&this.right!==null&&this.right.search(e,t))}searchAfter(e,t){this.low>=e&&(t.push(this),this.left!==null&&this.left.searchAfter(e,t)),this.right!==null&&this.right.searchAfter(e,t)}traverse(e){e(this),this.left!==null&&this.left.traverse(e),this.right!==null&&this.right.traverse(e)}updateHeight(){this.left!==null&&this.right!==null?this.height=Math.max(this.left.height,this.right.height)+1:this.right!==null?this.height=this.right.height+1:this.left!==null?this.height=this.left.height+1:this.height=0}updateMax(){this.max=this.high,this.left!==null&&(this.max=Math.max(this.max,this.left.max)),this.right!==null&&(this.max=Math.max(this.max,this.right.max))}getBalance(){let e=0;return this.left!==null&&this.right!==null?e=this.left.height-this.right.height:this.left!==null?e=this.left.height+1:this.right!==null&&(e=-(this.right.height+1)),e}isLeftChild(){return this.parent!==null&&this.parent.left===this}get left(){return this._left}set left(e){this._left=e,e!==null&&(e.parent=this),this.updateHeight(),this.updateMax()}get right(){return this._right}set right(e){this._right=e,e!==null&&(e.parent=this),this.updateHeight(),this.updateMax()}dispose(){this.parent=null,this._left=null,this._right=null,this.event=null}}class Volume extends ToneAudioNode{constructor(){super(optionsFromArguments(Volume.getDefaults(),arguments,["volume"])),this.name="Volume";const e=optionsFromArguments(Volume.getDefaults(),arguments,["volume"]);this.input=this.output=new Gain({context:this.context,gain:e.volume,units:"decibels"}),this.volume=this.output.gain,readOnly(this,"volume"),this._unmutedVolume=e.volume,this.mute=e.mute}static getDefaults(){return Object.assign(ToneAudioNode.getDefaults(),{mute:!1,volume:0})}get mute(){return this.volume.value===-1/0}set mute(e){!this.mute&&e?(this._unmutedVolume=this.volume.value,this.volume.value=-1/0):this.mute&&!e&&(this.volume.value=this._unmutedVolume)}dispose(){return super.dispose(),this.input.dispose(),this.volume.dispose(),this}}class Destination extends ToneAudioNode{constructor(){super(optionsFromArguments(Destination.getDefaults(),arguments)),this.name="Destination",this.input=new Volume({context:this.context}),this.output=new Gain({context:this.context}),this.volume=this.input.volume;const e=optionsFromArguments(Destination.getDefaults(),arguments);connectSeries(this.input,this.output,this.context.rawContext.destination),this.mute=e.mute,this._internalChannels=[this.input,this.context.rawContext.destination,this.output]}static getDefaults(){return Object.assign(ToneAudioNode.getDefaults(),{mute:!1,volume:0})}get mute(){return this.input.mute}set mute(e){this.input.mute=e}chain(...e){return this.input.disconnect(),e.unshift(this.input),e.push(this.output),connectSeries(...e),this}get maxChannelCount(){return this.context.rawContext.destination.maxChannelCount}dispose(){return super.dispose(),this.volume.dispose(),this}}onContextInit(r=>{r.destination=new Destination({context:r})});onContextClose(r=>{r.destination.dispose()});class TimelineValue extends Tone{constructor(e){super(),this.name="TimelineValue",this._timeline=new Timeline({memory:10}),this._initialValue=e}set(e,t){return this._timeline.add({value:e,time:t}),this}get(e){const t=this._timeline.get(e);return t?t.value:this._initialValue}}class TransportEvent{constructor(e,t){this.id=TransportEvent._eventId++;const n=Object.assign(TransportEvent.getDefaults(),t);this.transport=e,this.callback=n.callback,this._once=n.once,this.time=n.time}static getDefaults(){return{callback:noOp,once:!1,time:0}}invoke(e){this.callback&&(this.callback(e),this._once&&this.transport.clear(this.id))}dispose(){return this.callback=void 0,this}}TransportEvent._eventId=0;class TransportRepeatEvent extends TransportEvent{constructor(e,t){super(e,t),this._currentId=-1,this._nextId=-1,this._nextTick=this.time,this._boundRestart=this._restart.bind(this);const n=Object.assign(TransportRepeatEvent.getDefaults(),t);this.duration=new TicksClass(e.context,n.duration).valueOf(),this._interval=new TicksClass(e.context,n.interval).valueOf(),this._nextTick=n.time,this.transport.on("start",this._boundRestart),this.transport.on("loopStart",this._boundRestart),this.context=this.transport.context,this._restart()}static getDefaults(){return Object.assign({},TransportEvent.getDefaults(),{duration:1/0,interval:1,once:!1})}invoke(e){this._createEvents(e),super.invoke(e)}_createEvents(e){const t=this.transport.getTicksAtTime(e);t>=this.time&&t>=this._nextTick&&this._nextTick+this._interval<this.time+this.duration&&(this._nextTick+=this._interval,this._currentId=this._nextId,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new TicksClass(this.context,this._nextTick).toSeconds()))}_restart(e){this.transport.clear(this._currentId),this.transport.clear(this._nextId),this._nextTick=this.time;const t=this.transport.getTicksAtTime(e);t>this.time&&(this._nextTick=this.time+Math.ceil((t-this.time)/this._interval)*this._interval),this._currentId=this.transport.scheduleOnce(this.invoke.bind(this),new TicksClass(this.context,this._nextTick).toSeconds()),this._nextTick+=this._interval,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new TicksClass(this.context,this._nextTick).toSeconds())}dispose(){return super.dispose(),this.transport.clear(this._currentId),this.transport.clear(this._nextId),this.transport.off("start",this._boundRestart),this.transport.off("loopStart",this._boundRestart),this}}class Transport extends ToneWithContext{constructor(){super(optionsFromArguments(Transport.getDefaults(),arguments)),this.name="Transport",this._loop=new TimelineValue(!1),this._loopStart=0,this._loopEnd=0,this._scheduledEvents={},this._timeline=new Timeline,this._repeatedEvents=new IntervalTimeline,this._syncedSignals=[],this._swingAmount=0;const e=optionsFromArguments(Transport.getDefaults(),arguments);this._ppq=e.ppq,this._clock=new Clock({callback:this._processTick.bind(this),context:this.context,frequency:0,units:"bpm"}),this._bindClockEvents(),this.bpm=this._clock.frequency,this._clock.frequency.multiplier=e.ppq,this.bpm.setValueAtTime(e.bpm,0),readOnly(this,"bpm"),this._timeSignature=e.timeSignature,this._swingTicks=e.ppq/2}static getDefaults(){return Object.assign(ToneWithContext.getDefaults(),{bpm:120,loopEnd:"4m",loopStart:0,ppq:192,swing:0,swingSubdivision:"8n",timeSignature:4})}_processTick(e,t){if(this._loop.get(e)&&t>=this._loopEnd&&(this.emit("loopEnd",e),this._clock.setTicksAtTime(this._loopStart,e),t=this._loopStart,this.emit("loopStart",e,this._clock.getSecondsAtTime(e)),this.emit("loop",e)),this._swingAmount>0&&t%this._ppq!==0&&t%(this._swingTicks*2)!==0){const n=t%(this._swingTicks*2)/(this._swingTicks*2),s=Math.sin(n*Math.PI)*this._swingAmount;e+=new TicksClass(this.context,this._swingTicks*2/3).toSeconds()*s}this._timeline.forEachAtTime(t,n=>n.invoke(e))}schedule(e,t){const n=new TransportEvent(this,{callback:e,time:new TransportTimeClass(this.context,t).toTicks()});return this._addEvent(n,this._timeline)}scheduleRepeat(e,t,n,s=1/0){const i=new TransportRepeatEvent(this,{callback:e,duration:new TimeClass(this.context,s).toTicks(),interval:new TimeClass(this.context,t).toTicks(),time:new TransportTimeClass(this.context,n).toTicks()});return this._addEvent(i,this._repeatedEvents)}scheduleOnce(e,t){const n=new TransportEvent(this,{callback:e,once:!0,time:new TransportTimeClass(this.context,t).toTicks()});return this._addEvent(n,this._timeline)}clear(e){if(this._scheduledEvents.hasOwnProperty(e)){const t=this._scheduledEvents[e.toString()];t.timeline.remove(t.event),t.event.dispose(),delete this._scheduledEvents[e.toString()]}return this}_addEvent(e,t){return this._scheduledEvents[e.id.toString()]={event:e,timeline:t},t.add(e),e.id}cancel(e=0){const t=this.toTicks(e);return this._timeline.forEachFrom(t,n=>this.clear(n.id)),this._repeatedEvents.forEachFrom(t,n=>this.clear(n.id)),this}_bindClockEvents(){this._clock.on("start",(e,t)=>{t=new TicksClass(this.context,t).toSeconds(),this.emit("start",e,t)}),this._clock.on("stop",e=>{this.emit("stop",e)}),this._clock.on("pause",e=>{this.emit("pause",e)})}get state(){return this._clock.getStateAtTime(this.now())}start(e,t){let n;return isDefined(t)&&(n=this.toTicks(t)),this._clock.start(e,n),this}stop(e){return this._clock.stop(e),this}pause(e){return this._clock.pause(e),this}toggle(e){return e=this.toSeconds(e),this._clock.getStateAtTime(e)!=="started"?this.start(e):this.stop(e),this}get timeSignature(){return this._timeSignature}set timeSignature(e){isArray(e)&&(e=e[0]/e[1]*4),this._timeSignature=e}get loopStart(){return new TimeClass(this.context,this._loopStart,"i").toSeconds()}set loopStart(e){this._loopStart=this.toTicks(e)}get loopEnd(){return new TimeClass(this.context,this._loopEnd,"i").toSeconds()}set loopEnd(e){this._loopEnd=this.toTicks(e)}get loop(){return this._loop.get(this.now())}set loop(e){this._loop.set(e,this.now())}setLoopPoints(e,t){return this.loopStart=e,this.loopEnd=t,this}get swing(){return this._swingAmount}set swing(e){this._swingAmount=e}get swingSubdivision(){return new TicksClass(this.context,this._swingTicks).toNotation()}set swingSubdivision(e){this._swingTicks=this.toTicks(e)}get position(){const e=this.now(),t=this._clock.getTicksAtTime(e);return new TicksClass(this.context,t).toBarsBeatsSixteenths()}set position(e){const t=this.toTicks(e);this.ticks=t}get seconds(){return this._clock.seconds}set seconds(e){const t=this.now(),n=this._clock.frequency.timeToTicks(e,t);this.ticks=n}get progress(){if(this.loop){const e=this.now();return(this._clock.getTicksAtTime(e)-this._loopStart)/(this._loopEnd-this._loopStart)}else return 0}get ticks(){return this._clock.ticks}set ticks(e){if(this._clock.ticks!==e){const t=this.now();if(this.state==="started"){const n=this._clock.getTicksAtTime(t),s=this._clock.frequency.getDurationOfTicks(Math.ceil(n)-n,t),i=t+s;this.emit("stop",i),this._clock.setTicksAtTime(e,i),this.emit("start",i,this._clock.getSecondsAtTime(i))}else this._clock.setTicksAtTime(e,t)}}getTicksAtTime(e){return Math.round(this._clock.getTicksAtTime(e))}getSecondsAtTime(e){return this._clock.getSecondsAtTime(e)}get PPQ(){return this._clock.frequency.multiplier}set PPQ(e){this._clock.frequency.multiplier=e}nextSubdivision(e){if(e=this.toTicks(e),this.state!=="started")return 0;{const t=this.now(),n=this.getTicksAtTime(t),s=e-n%e;return this._clock.nextTickTime(s,t)}}syncSignal(e,t){if(!t){const s=this.now();if(e.getValueAtTime(s)!==0){const a=1/(60/this.bpm.getValueAtTime(s)/this.PPQ);t=e.getValueAtTime(s)/a}else t=0}const n=new Gain(t);return this.bpm.connect(n),n.connect(e._param),this._syncedSignals.push({initial:e.value,ratio:n,signal:e}),e.value=0,this}unsyncSignal(e){for(let t=this._syncedSignals.length-1;t>=0;t--){const n=this._syncedSignals[t];n.signal===e&&(n.ratio.dispose(),n.signal.value=n.initial,this._syncedSignals.splice(t,1))}return this}dispose(){return super.dispose(),this._clock.dispose(),writable(this,"bpm"),this._timeline.dispose(),this._repeatedEvents.dispose(),this}}Emitter.mixin(Transport);onContextInit(r=>{r.transport=new Transport({context:r})});onContextClose(r=>{r.transport.dispose()});class Source extends ToneAudioNode{constructor(e){super(e),this.input=void 0,this._state=new StateTimeline("stopped"),this._synced=!1,this._scheduled=[],this._syncedStart=noOp,this._syncedStop=noOp,this._state.memory=100,this._state.increasing=!0,this._volume=this.output=new Volume({context:this.context,mute:e.mute,volume:e.volume}),this.volume=this._volume.volume,readOnly(this,"volume"),this.onstop=e.onstop}static getDefaults(){return Object.assign(ToneAudioNode.getDefaults(),{mute:!1,onstop:noOp,volume:0})}get state(){return this._synced?this.context.transport.state==="started"?this._state.getValueAtTime(this.context.transport.seconds):"stopped":this._state.getValueAtTime(this.now())}get mute(){return this._volume.mute}set mute(e){this._volume.mute=e}_clampToCurrentTime(e){return this._synced?e:Math.max(e,this.context.currentTime)}start(e,t,n){let s=isUndef(e)&&this._synced?this.context.transport.seconds:this.toSeconds(e);if(s=this._clampToCurrentTime(s),!this._synced&&this._state.getValueAtTime(s)==="started")assert(GT(s,this._state.get(s).time),"Start time must be strictly greater than previous start time"),this._state.cancel(s),this._state.setStateAtTime("started",s),this.log("restart",s),this.restart(s,t,n);else if(this.log("start",s),this._state.setStateAtTime("started",s),this._synced){const i=this._state.get(s);i&&(i.offset=this.toSeconds(defaultArg(t,0)),i.duration=n?this.toSeconds(n):void 0);const a=this.context.transport.schedule(o=>{this._start(o,t,n)},s);this._scheduled.push(a),this.context.transport.state==="started"&&this.context.transport.getSecondsAtTime(this.immediate())>s&&this._syncedStart(this.now(),this.context.transport.seconds)}else assertContextRunning(this.context),this._start(s,t,n);return this}stop(e){let t=isUndef(e)&&this._synced?this.context.transport.seconds:this.toSeconds(e);if(t=this._clampToCurrentTime(t),this._state.getValueAtTime(t)==="started"||isDefined(this._state.getNextState("started",t))){if(this.log("stop",t),!this._synced)this._stop(t);else{const n=this.context.transport.schedule(this._stop.bind(this),t);this._scheduled.push(n)}this._state.cancel(t),this._state.setStateAtTime("stopped",t)}return this}restart(e,t,n){return e=this.toSeconds(e),this._state.getValueAtTime(e)==="started"&&(this._state.cancel(e),this._restart(e,t,n)),this}sync(){return this._synced||(this._synced=!0,this._syncedStart=(e,t)=>{if(t>0){const n=this._state.get(t);if(n&&n.state==="started"&&n.time!==t){const s=t-this.toSeconds(n.time);let i;n.duration&&(i=this.toSeconds(n.duration)-s),this._start(e,this.toSeconds(n.offset)+s,i)}}},this._syncedStop=e=>{const t=this.context.transport.getSecondsAtTime(Math.max(e-this.sampleTime,0));this._state.getValueAtTime(t)==="started"&&this._stop(e)},this.context.transport.on("start",this._syncedStart),this.context.transport.on("loopStart",this._syncedStart),this.context.transport.on("stop",this._syncedStop),this.context.transport.on("pause",this._syncedStop),this.context.transport.on("loopEnd",this._syncedStop)),this}unsync(){return this._synced&&(this.context.transport.off("stop",this._syncedStop),this.context.transport.off("pause",this._syncedStop),this.context.transport.off("loopEnd",this._syncedStop),this.context.transport.off("start",this._syncedStart),this.context.transport.off("loopStart",this._syncedStart)),this._synced=!1,this._scheduled.forEach(e=>this.context.transport.clear(e)),this._scheduled=[],this._state.cancel(0),this._stop(0),this}dispose(){return super.dispose(),this.onstop=noOp,this.unsync(),this._volume.dispose(),this._state.dispose(),this}}class ToneBufferSource extends OneShotSource{constructor(){super(optionsFromArguments(ToneBufferSource.getDefaults(),arguments,["url","onload"])),this.name="ToneBufferSource",this._source=this.context.createBufferSource(),this._internalChannels=[this._source],this._sourceStarted=!1,this._sourceStopped=!1;const e=optionsFromArguments(ToneBufferSource.getDefaults(),arguments,["url","onload"]);connect(this._source,this._gainNode),this._source.onended=()=>this._stopSource(),this.playbackRate=new Param({context:this.context,param:this._source.playbackRate,units:"positive",value:e.playbackRate}),this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this._buffer=new ToneAudioBuffer(e.url,e.onload,e.onerror),this._internalChannels.push(this._source)}static getDefaults(){return Object.assign(OneShotSource.getDefaults(),{url:new ToneAudioBuffer,loop:!1,loopEnd:0,loopStart:0,onload:noOp,onerror:noOp,playbackRate:1})}get fadeIn(){return this._fadeIn}set fadeIn(e){this._fadeIn=e}get fadeOut(){return this._fadeOut}set fadeOut(e){this._fadeOut=e}get curve(){return this._curve}set curve(e){this._curve=e}start(e,t,n,s=1){assert(this.buffer.loaded,"buffer is either not set or not loaded");const i=this.toSeconds(e);this._startGain(i,s),this.loop?t=defaultArg(t,this.loopStart):t=defaultArg(t,0);let a=Math.max(this.toSeconds(t),0);if(this.loop){const o=this.toSeconds(this.loopEnd)||this.buffer.duration,c=this.toSeconds(this.loopStart),l=o-c;GTE(a,o)&&(a=(a-c)%l+c),EQ(a,this.buffer.duration)&&(a=0)}if(this._source.buffer=this.buffer.get(),this._source.loopEnd=this.toSeconds(this.loopEnd)||this.buffer.duration,LT(a,this.buffer.duration)&&(this._sourceStarted=!0,this._source.start(i,a)),isDefined(n)){let o=this.toSeconds(n);o=Math.max(o,0),this.stop(i+o)}return this}_stopSource(e){!this._sourceStopped&&this._sourceStarted&&(this._sourceStopped=!0,this._source.stop(this.toSeconds(e)),this._onended())}get loopStart(){return this._source.loopStart}set loopStart(e){this._source.loopStart=this.toSeconds(e)}get loopEnd(){return this._source.loopEnd}set loopEnd(e){this._source.loopEnd=this.toSeconds(e)}get buffer(){return this._buffer}set buffer(e){this._buffer.set(e)}get loop(){return this._source.loop}set loop(e){this._source.loop=e,this._sourceStarted&&this.cancelStop()}dispose(){return super.dispose(),this._source.onended=null,this._source.disconnect(),this._buffer.dispose(),this.playbackRate.dispose(),this}}function generateWaveform(r,e){return __awaiter(this,void 0,void 0,function*(){const t=e/r.context.sampleRate,n=new OfflineContext(1,t,r.context.sampleRate);return new r.constructor(Object.assign(r.get(),{frequency:2/t,detune:0,context:n})).toDestination().start(0),(yield n.render()).getChannelData(0)})}class ToneOscillatorNode extends OneShotSource{constructor(){super(optionsFromArguments(ToneOscillatorNode.getDefaults(),arguments,["frequency","type"])),this.name="ToneOscillatorNode",this._oscillator=this.context.createOscillator(),this._internalChannels=[this._oscillator];const e=optionsFromArguments(ToneOscillatorNode.getDefaults(),arguments,["frequency","type"]);connect(this._oscillator,this._gainNode),this.type=e.type,this.frequency=new Param({context:this.context,param:this._oscillator.frequency,units:"frequency",value:e.frequency}),this.detune=new Param({context:this.context,param:this._oscillator.detune,units:"cents",value:e.detune}),readOnly(this,["frequency","detune"])}static getDefaults(){return Object.assign(OneShotSource.getDefaults(),{detune:0,frequency:440,type:"sine"})}start(e){const t=this.toSeconds(e);return this.log("start",t),this._startGain(t),this._oscillator.start(t),this}_stopSource(e){this._oscillator.stop(e)}setPeriodicWave(e){return this._oscillator.setPeriodicWave(e),this}get type(){return this._oscillator.type}set type(e){this._oscillator.type=e}dispose(){return super.dispose(),this.state==="started"&&this.stop(),this._oscillator.disconnect(),this.frequency.dispose(),this.detune.dispose(),this}}class Oscillator extends Source{constructor(){super(optionsFromArguments(Oscillator.getDefaults(),arguments,["frequency","type"])),this.name="Oscillator",this._oscillator=null;const e=optionsFromArguments(Oscillator.getDefaults(),arguments,["frequency","type"]);this.frequency=new Signal({context:this.context,units:"frequency",value:e.frequency}),readOnly(this,"frequency"),this.detune=new Signal({context:this.context,units:"cents",value:e.detune}),readOnly(this,"detune"),this._partials=e.partials,this._partialCount=e.partialCount,this._type=e.type,e.partialCount&&e.type!=="custom"&&(this._type=this.baseType+e.partialCount.toString()),this.phase=e.phase}static getDefaults(){return Object.assign(Source.getDefaults(),{detune:0,frequency:440,partialCount:0,partials:[],phase:0,type:"sine"})}_start(e){const t=this.toSeconds(e),n=new ToneOscillatorNode({context:this.context,onended:()=>this.onstop(this)});this._oscillator=n,this._wave?this._oscillator.setPeriodicWave(this._wave):this._oscillator.type=this._type,this._oscillator.connect(this.output),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.start(t)}_stop(e){const t=this.toSeconds(e);this._oscillator&&this._oscillator.stop(t)}_restart(e){const t=this.toSeconds(e);return this.log("restart",t),this._oscillator&&this._oscillator.cancelStop(),this._state.cancel(t),this}syncFrequency(){return this.context.transport.syncSignal(this.frequency),this}unsyncFrequency(){return this.context.transport.unsyncSignal(this.frequency),this}_getCachedPeriodicWave(){if(this._type==="custom")return Oscillator._periodicWaveCache.find(t=>t.phase===this._phase&&deepEquals(t.partials,this._partials));{const e=Oscillator._periodicWaveCache.find(t=>t.type===this._type&&t.phase===this._phase);return this._partialCount=e?e.partialCount:this._partialCount,e}}get type(){return this._type}set type(e){this._type=e;const t=["sine","square","sawtooth","triangle"].indexOf(e)!==-1;if(this._phase===0&&t)this._wave=void 0,this._partialCount=0,this._oscillator!==null&&(this._oscillator.type=e);else{const n=this._getCachedPeriodicWave();if(isDefined(n)){const{partials:s,wave:i}=n;this._wave=i,this._partials=s,this._oscillator!==null&&this._oscillator.setPeriodicWave(this._wave)}else{const[s,i]=this._getRealImaginary(e,this._phase),a=this.context.createPeriodicWave(s,i);this._wave=a,this._oscillator!==null&&this._oscillator.setPeriodicWave(this._wave),Oscillator._periodicWaveCache.push({imag:i,partialCount:this._partialCount,partials:this._partials,phase:this._phase,real:s,type:this._type,wave:this._wave}),Oscillator._periodicWaveCache.length>100&&Oscillator._periodicWaveCache.shift()}}}get baseType(){return this._type.replace(this.partialCount.toString(),"")}set baseType(e){this.partialCount&&this._type!=="custom"&&e!=="custom"?this.type=e+this.partialCount:this.type=e}get partialCount(){return this._partialCount}set partialCount(e){assertRange(e,0);let t=this._type;const n=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(this._type);if(n&&(t=n[1]),this._type!=="custom")e===0?this.type=t:this.type=t+e.toString();else{const s=new Float32Array(e);this._partials.forEach((i,a)=>s[a]=i),this._partials=Array.from(s),this.type=this._type}}_getRealImaginary(e,t){let s=2048;const i=new Float32Array(s),a=new Float32Array(s);let o=1;if(e==="custom"){if(o=this._partials.length+1,this._partialCount=this._partials.length,s=o,this._partials.length===0)return[i,a]}else{const c=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(e);c?(o=parseInt(c[2],10)+1,this._partialCount=parseInt(c[2],10),e=c[1],o=Math.max(o,2),s=o):this._partialCount=0,this._partials=[]}for(let c=1;c<s;++c){const l=2/(c*Math.PI);let u;switch(e){case"sine":u=c<=o?1:0,this._partials[c-1]=u;break;case"square":u=c&1?2*l:0,this._partials[c-1]=u;break;case"sawtooth":u=l*(c&1?1:-1),this._partials[c-1]=u;break;case"triangle":c&1?u=2*(l*l)*(c-1>>1&1?-1:1):u=0,this._partials[c-1]=u;break;case"custom":u=this._partials[c-1];break;default:throw new TypeError("Oscillator: invalid type: "+e)}u!==0?(i[c]=-u*Math.sin(t*c),a[c]=u*Math.cos(t*c)):(i[c]=0,a[c]=0)}return[i,a]}_inverseFFT(e,t,n){let s=0;const i=e.length;for(let a=0;a<i;a++)s+=e[a]*Math.cos(a*n)+t[a]*Math.sin(a*n);return s}getInitialValue(){const[e,t]=this._getRealImaginary(this._type,0);let n=0;const s=Math.PI*2,i=32;for(let a=0;a<i;a++)n=Math.max(this._inverseFFT(e,t,a/i*s),n);return clamp(-this._inverseFFT(e,t,this._phase)/n,-1,1)}get partials(){return this._partials.slice(0,this.partialCount)}set partials(e){this._partials=e,this._partialCount=this._partials.length,e.length&&(this.type="custom")}get phase(){return this._phase*(180/Math.PI)}set phase(e){this._phase=e*Math.PI/180,this.type=this._type}asArray(e=1024){return __awaiter(this,void 0,void 0,function*(){return generateWaveform(this,e)})}dispose(){return super.dispose(),this._oscillator!==null&&this._oscillator.dispose(),this._wave=void 0,this.frequency.dispose(),this.detune.dispose(),this}}Oscillator._periodicWaveCache=[];class SignalOperator extends ToneAudioNode{constructor(){super(Object.assign(optionsFromArguments(SignalOperator.getDefaults(),arguments,["context"])))}connect(e,t=0,n=0){return connectSignal(this,e,t,n),this}}class WaveShaper extends SignalOperator{constructor(){super(Object.assign(optionsFromArguments(WaveShaper.getDefaults(),arguments,["mapping","length"]))),this.name="WaveShaper",this._shaper=this.context.createWaveShaper(),this.input=this._shaper,this.output=this._shaper;const e=optionsFromArguments(WaveShaper.getDefaults(),arguments,["mapping","length"]);isArray(e.mapping)||e.mapping instanceof Float32Array?this.curve=Float32Array.from(e.mapping):isFunction(e.mapping)&&this.setMap(e.mapping,e.length)}static getDefaults(){return Object.assign(Signal.getDefaults(),{length:1024})}setMap(e,t=1024){const n=new Float32Array(t);for(let s=0,i=t;s<i;s++){const a=s/(i-1)*2-1;n[s]=e(a,s)}return this.curve=n,this}get curve(){return this._shaper.curve}set curve(e){this._shaper.curve=e}get oversample(){return this._shaper.oversample}set oversample(e){const t=["none","2x","4x"].some(n=>n.includes(e));assert(t,"oversampling must be either 'none', '2x', or '4x'"),this._shaper.oversample=e}dispose(){return super.dispose(),this._shaper.disconnect(),this}}class AudioToGain extends SignalOperator{constructor(){super(...arguments),this.name="AudioToGain",this._norm=new WaveShaper({context:this.context,mapping:e=>(e+1)/2}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class Multiply extends Signal{constructor(){super(Object.assign(optionsFromArguments(Multiply.getDefaults(),arguments,["value"]))),this.name="Multiply",this.override=!1;const e=optionsFromArguments(Multiply.getDefaults(),arguments,["value"]);this._mult=this.input=this.output=new Gain({context:this.context,minValue:e.minValue,maxValue:e.maxValue}),this.factor=this._param=this._mult.gain,this.factor.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(Signal.getDefaults(),{value:0})}dispose(){return super.dispose(),this._mult.dispose(),this}}class AMOscillator extends Source{constructor(){super(optionsFromArguments(AMOscillator.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="AMOscillator",this._modulationScale=new AudioToGain({context:this.context}),this._modulationNode=new Gain({context:this.context});const e=optionsFromArguments(AMOscillator.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new Oscillator({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase,type:e.type}),this.frequency=this._carrier.frequency,this.detune=this._carrier.detune,this._modulator=new Oscillator({context:this.context,phase:e.phase,type:e.modulationType}),this.harmonicity=new Multiply({context:this.context,units:"positive",value:e.harmonicity}),this.frequency.chain(this.harmonicity,this._modulator.frequency),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output),readOnly(this,["frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(Oscillator.getDefaults(),{harmonicity:1,modulationType:"square"})}_start(e){this._modulator.start(e),this._carrier.start(e)}_stop(e){this._modulator.stop(e),this._carrier.stop(e)}_restart(e){this._modulator.restart(e),this._carrier.restart(e)}get type(){return this._carrier.type}set type(e){this._carrier.type=e}get baseType(){return this._carrier.baseType}set baseType(e){this._carrier.baseType=e}get partialCount(){return this._carrier.partialCount}set partialCount(e){this._carrier.partialCount=e}get modulationType(){return this._modulator.type}set modulationType(e){this._modulator.type=e}get phase(){return this._carrier.phase}set phase(e){this._carrier.phase=e,this._modulator.phase=e}get partials(){return this._carrier.partials}set partials(e){this._carrier.partials=e}asArray(e=1024){return __awaiter(this,void 0,void 0,function*(){return generateWaveform(this,e)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this._modulationScale.dispose(),this}}class FMOscillator extends Source{constructor(){super(optionsFromArguments(FMOscillator.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="FMOscillator",this._modulationNode=new Gain({context:this.context,gain:0});const e=optionsFromArguments(FMOscillator.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new Oscillator({context:this.context,detune:e.detune,frequency:0,onstop:()=>this.onstop(this),phase:e.phase,type:e.type}),this.detune=this._carrier.detune,this.frequency=new Signal({context:this.context,units:"frequency",value:e.frequency}),this._modulator=new Oscillator({context:this.context,phase:e.phase,type:e.modulationType}),this.harmonicity=new Multiply({context:this.context,units:"positive",value:e.harmonicity}),this.modulationIndex=new Multiply({context:this.context,units:"positive",value:e.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output),this.detune.connect(this._modulator.detune),readOnly(this,["modulationIndex","frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(Oscillator.getDefaults(),{harmonicity:1,modulationIndex:2,modulationType:"square"})}_start(e){this._modulator.start(e),this._carrier.start(e)}_stop(e){this._modulator.stop(e),this._carrier.stop(e)}_restart(e){return this._modulator.restart(e),this._carrier.restart(e),this}get type(){return this._carrier.type}set type(e){this._carrier.type=e}get baseType(){return this._carrier.baseType}set baseType(e){this._carrier.baseType=e}get partialCount(){return this._carrier.partialCount}set partialCount(e){this._carrier.partialCount=e}get modulationType(){return this._modulator.type}set modulationType(e){this._modulator.type=e}get phase(){return this._carrier.phase}set phase(e){this._carrier.phase=e,this._modulator.phase=e}get partials(){return this._carrier.partials}set partials(e){this._carrier.partials=e}asArray(e=1024){return __awaiter(this,void 0,void 0,function*(){return generateWaveform(this,e)})}dispose(){return super.dispose(),this.frequency.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this.modulationIndex.dispose(),this}}class PulseOscillator extends Source{constructor(){super(optionsFromArguments(PulseOscillator.getDefaults(),arguments,["frequency","width"])),this.name="PulseOscillator",this._widthGate=new Gain({context:this.context,gain:0}),this._thresh=new WaveShaper({context:this.context,mapping:t=>t<=0?-1:1});const e=optionsFromArguments(PulseOscillator.getDefaults(),arguments,["frequency","width"]);this.width=new Signal({context:this.context,units:"audioRange",value:e.width}),this._triangle=new Oscillator({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase,type:"triangle"}),this.frequency=this._triangle.frequency,this.detune=this._triangle.detune,this._triangle.chain(this._thresh,this.output),this.width.chain(this._widthGate,this._thresh),readOnly(this,["width","frequency","detune"])}static getDefaults(){return Object.assign(Source.getDefaults(),{detune:0,frequency:440,phase:0,type:"pulse",width:.2})}_start(e){e=this.toSeconds(e),this._triangle.start(e),this._widthGate.gain.setValueAtTime(1,e)}_stop(e){e=this.toSeconds(e),this._triangle.stop(e),this._widthGate.gain.cancelScheduledValues(e),this._widthGate.gain.setValueAtTime(0,e)}_restart(e){this._triangle.restart(e),this._widthGate.gain.cancelScheduledValues(e),this._widthGate.gain.setValueAtTime(1,e)}get phase(){return this._triangle.phase}set phase(e){this._triangle.phase=e}get type(){return"pulse"}get baseType(){return"pulse"}get partials(){return[]}get partialCount(){return 0}set carrierType(e){this._triangle.type=e}asArray(e=1024){return __awaiter(this,void 0,void 0,function*(){return generateWaveform(this,e)})}dispose(){return super.dispose(),this._triangle.dispose(),this.width.dispose(),this._widthGate.dispose(),this._thresh.dispose(),this}}class FatOscillator extends Source{constructor(){super(optionsFromArguments(FatOscillator.getDefaults(),arguments,["frequency","type","spread"])),this.name="FatOscillator",this._oscillators=[];const e=optionsFromArguments(FatOscillator.getDefaults(),arguments,["frequency","type","spread"]);this.frequency=new Signal({context:this.context,units:"frequency",value:e.frequency}),this.detune=new Signal({context:this.context,units:"cents",value:e.detune}),this._spread=e.spread,this._type=e.type,this._phase=e.phase,this._partials=e.partials,this._partialCount=e.partialCount,this.count=e.count,readOnly(this,["frequency","detune"])}static getDefaults(){return Object.assign(Oscillator.getDefaults(),{count:3,spread:20,type:"sawtooth"})}_start(e){e=this.toSeconds(e),this._forEach(t=>t.start(e))}_stop(e){e=this.toSeconds(e),this._forEach(t=>t.stop(e))}_restart(e){this._forEach(t=>t.restart(e))}_forEach(e){for(let t=0;t<this._oscillators.length;t++)e(this._oscillators[t],t)}get type(){return this._type}set type(e){this._type=e,this._forEach(t=>t.type=e)}get spread(){return this._spread}set spread(e){if(this._spread=e,this._oscillators.length>1){const t=-e/2,n=e/(this._oscillators.length-1);this._forEach((s,i)=>s.detune.value=t+n*i)}}get count(){return this._oscillators.length}set count(e){if(assertRange(e,1),this._oscillators.length!==e){this._forEach(t=>t.dispose()),this._oscillators=[];for(let t=0;t<e;t++){const n=new Oscillator({context:this.context,volume:-6-e*1.1,type:this._type,phase:this._phase+t/e*360,partialCount:this._partialCount,onstop:t===0?()=>this.onstop(this):noOp});this.type==="custom"&&(n.partials=this._partials),this.frequency.connect(n.frequency),this.detune.connect(n.detune),n.detune.overridden=!1,n.connect(this.output),this._oscillators[t]=n}this.spread=this._spread,this.state==="started"&&this._forEach(t=>t.start())}}get phase(){return this._phase}set phase(e){this._phase=e,this._forEach((t,n)=>t.phase=this._phase+n/this.count*360)}get baseType(){return this._oscillators[0].baseType}set baseType(e){this._forEach(t=>t.baseType=e),this._type=this._oscillators[0].type}get partials(){return this._oscillators[0].partials}set partials(e){this._partials=e,this._partialCount=this._partials.length,e.length&&(this._type="custom",this._forEach(t=>t.partials=e))}get partialCount(){return this._oscillators[0].partialCount}set partialCount(e){this._partialCount=e,this._forEach(t=>t.partialCount=e),this._type=this._oscillators[0].type}asArray(e=1024){return __awaiter(this,void 0,void 0,function*(){return generateWaveform(this,e)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this._forEach(e=>e.dispose()),this}}class PWMOscillator extends Source{constructor(){super(optionsFromArguments(PWMOscillator.getDefaults(),arguments,["frequency","modulationFrequency"])),this.name="PWMOscillator",this.sourceType="pwm",this._scale=new Multiply({context:this.context,value:2});const e=optionsFromArguments(PWMOscillator.getDefaults(),arguments,["frequency","modulationFrequency"]);this._pulse=new PulseOscillator({context:this.context,frequency:e.modulationFrequency}),this._pulse.carrierType="sine",this.modulationFrequency=this._pulse.frequency,this._modulator=new Oscillator({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase}),this.frequency=this._modulator.frequency,this.detune=this._modulator.detune,this._modulator.chain(this._scale,this._pulse.width),this._pulse.connect(this.output),readOnly(this,["modulationFrequency","frequency","detune"])}static getDefaults(){return Object.assign(Source.getDefaults(),{detune:0,frequency:440,modulationFrequency:.4,phase:0,type:"pwm"})}_start(e){e=this.toSeconds(e),this._modulator.start(e),this._pulse.start(e)}_stop(e){e=this.toSeconds(e),this._modulator.stop(e),this._pulse.stop(e)}_restart(e){this._modulator.restart(e),this._pulse.restart(e)}get type(){return"pwm"}get baseType(){return"pwm"}get partials(){return[]}get partialCount(){return 0}get phase(){return this._modulator.phase}set phase(e){this._modulator.phase=e}asArray(e=1024){return __awaiter(this,void 0,void 0,function*(){return generateWaveform(this,e)})}dispose(){return super.dispose(),this._pulse.dispose(),this._scale.dispose(),this._modulator.dispose(),this}}const OmniOscillatorSourceMap={am:AMOscillator,fat:FatOscillator,fm:FMOscillator,oscillator:Oscillator,pulse:PulseOscillator,pwm:PWMOscillator};class OmniOscillator extends Source{constructor(){super(optionsFromArguments(OmniOscillator.getDefaults(),arguments,["frequency","type"])),this.name="OmniOscillator";const e=optionsFromArguments(OmniOscillator.getDefaults(),arguments,["frequency","type"]);this.frequency=new Signal({context:this.context,units:"frequency",value:e.frequency}),this.detune=new Signal({context:this.context,units:"cents",value:e.detune}),readOnly(this,["frequency","detune"]),this.set(e)}static getDefaults(){return Object.assign(Oscillator.getDefaults(),FMOscillator.getDefaults(),AMOscillator.getDefaults(),FatOscillator.getDefaults(),PulseOscillator.getDefaults(),PWMOscillator.getDefaults())}_start(e){this._oscillator.start(e)}_stop(e){this._oscillator.stop(e)}_restart(e){return this._oscillator.restart(e),this}get type(){let e="";return["am","fm","fat"].some(t=>this._sourceType===t)&&(e=this._sourceType),e+this._oscillator.type}set type(e){e.substr(0,2)==="fm"?(this._createNewOscillator("fm"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(2)):e.substr(0,2)==="am"?(this._createNewOscillator("am"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(2)):e.substr(0,3)==="fat"?(this._createNewOscillator("fat"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(3)):e==="pwm"?(this._createNewOscillator("pwm"),this._oscillator=this._oscillator):e==="pulse"?this._createNewOscillator("pulse"):(this._createNewOscillator("oscillator"),this._oscillator=this._oscillator,this._oscillator.type=e)}get partials(){return this._oscillator.partials}set partials(e){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&(this._oscillator.partials=e)}get partialCount(){return this._oscillator.partialCount}set partialCount(e){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&(this._oscillator.partialCount=e)}set(e){return Reflect.has(e,"type")&&e.type&&(this.type=e.type),super.set(e),this}_createNewOscillator(e){if(e!==this._sourceType){this._sourceType=e;const t=OmniOscillatorSourceMap[e],n=this.now();if(this._oscillator){const s=this._oscillator;s.stop(n),this.context.setTimeout(()=>s.dispose(),this.blockTime)}this._oscillator=new t({context:this.context}),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.connect(this.output),this._oscillator.onstop=()=>this.onstop(this),this.state==="started"&&this._oscillator.start(n)}}get phase(){return this._oscillator.phase}set phase(e){this._oscillator.phase=e}get sourceType(){return this._sourceType}set sourceType(e){let t="sine";this._oscillator.type!=="pwm"&&this._oscillator.type!=="pulse"&&(t=this._oscillator.type),e==="fm"?this.type="fm"+t:e==="am"?this.type="am"+t:e==="fat"?this.type="fat"+t:e==="oscillator"?this.type=t:e==="pulse"?this.type="pulse":e==="pwm"&&(this.type="pwm")}_getOscType(e,t){return e instanceof OmniOscillatorSourceMap[t]}get baseType(){return this._oscillator.baseType}set baseType(e){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&e!=="pulse"&&e!=="pwm"&&(this._oscillator.baseType=e)}get width(){if(this._getOscType(this._oscillator,"pulse"))return this._oscillator.width}get count(){if(this._getOscType(this._oscillator,"fat"))return this._oscillator.count}set count(e){this._getOscType(this._oscillator,"fat")&&isNumber(e)&&(this._oscillator.count=e)}get spread(){if(this._getOscType(this._oscillator,"fat"))return this._oscillator.spread}set spread(e){this._getOscType(this._oscillator,"fat")&&isNumber(e)&&(this._oscillator.spread=e)}get modulationType(){if(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))return this._oscillator.modulationType}set modulationType(e){(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))&&isString$1(e)&&(this._oscillator.modulationType=e)}get modulationIndex(){if(this._getOscType(this._oscillator,"fm"))return this._oscillator.modulationIndex}get harmonicity(){if(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))return this._oscillator.harmonicity}get modulationFrequency(){if(this._getOscType(this._oscillator,"pwm"))return this._oscillator.modulationFrequency}asArray(e=1024){return __awaiter(this,void 0,void 0,function*(){return generateWaveform(this,e)})}dispose(){return super.dispose(),this.detune.dispose(),this.frequency.dispose(),this._oscillator.dispose(),this}}function range(r,e=1/0){const t=new WeakMap;return function(n,s){Reflect.defineProperty(n,s,{configurable:!0,enumerable:!0,get:function(){return t.get(this)},set:function(i){assertRange(i,r,e),t.set(this,i)}})}}function timeRange(r,e=1/0){const t=new WeakMap;return function(n,s){Reflect.defineProperty(n,s,{configurable:!0,enumerable:!0,get:function(){return t.get(this)},set:function(i){assertRange(this.toSeconds(i),r,e),t.set(this,i)}})}}class Player extends Source{constructor(){super(optionsFromArguments(Player.getDefaults(),arguments,["url","onload"])),this.name="Player",this._activeSources=new Set;const e=optionsFromArguments(Player.getDefaults(),arguments,["url","onload"]);this._buffer=new ToneAudioBuffer({onload:this._onload.bind(this,e.onload),onerror:e.onerror,reverse:e.reverse,url:e.url}),this.autostart=e.autostart,this._loop=e.loop,this._loopStart=e.loopStart,this._loopEnd=e.loopEnd,this._playbackRate=e.playbackRate,this.fadeIn=e.fadeIn,this.fadeOut=e.fadeOut}static getDefaults(){return Object.assign(Source.getDefaults(),{autostart:!1,fadeIn:0,fadeOut:0,loop:!1,loopEnd:0,loopStart:0,onload:noOp,onerror:noOp,playbackRate:1,reverse:!1})}load(e){return __awaiter(this,void 0,void 0,function*(){return yield this._buffer.load(e),this._onload(),this})}_onload(e=noOp){e(),this.autostart&&this.start()}_onSourceEnd(e){this.onstop(this),this._activeSources.delete(e),this._activeSources.size===0&&!this._synced&&this._state.getValueAtTime(this.now())==="started"&&(this._state.cancel(this.now()),this._state.setStateAtTime("stopped",this.now()))}start(e,t,n){return super.start(e,t,n),this}_start(e,t,n){this._loop?t=defaultArg(t,this._loopStart):t=defaultArg(t,0);const s=this.toSeconds(t),i=n;n=defaultArg(n,Math.max(this._buffer.duration-s,0));let a=this.toSeconds(n);a=a/this._playbackRate,e=this.toSeconds(e);const o=new ToneBufferSource({url:this._buffer,context:this.context,fadeIn:this.fadeIn,fadeOut:this.fadeOut,loop:this._loop,loopEnd:this._loopEnd,loopStart:this._loopStart,onended:this._onSourceEnd.bind(this),playbackRate:this._playbackRate}).connect(this.output);!this._loop&&!this._synced&&(this._state.cancel(e+a),this._state.setStateAtTime("stopped",e+a,{implicitEnd:!0})),this._activeSources.add(o),this._loop&&isUndef(i)?o.start(e,s):o.start(e,s,a-this.toSeconds(this.fadeOut))}_stop(e){const t=this.toSeconds(e);this._activeSources.forEach(n=>n.stop(t))}restart(e,t,n){return super.restart(e,t,n),this}_restart(e,t,n){this._stop(e),this._start(e,t,n)}seek(e,t){const n=this.toSeconds(t);if(this._state.getValueAtTime(n)==="started"){const s=this.toSeconds(e);this._stop(n),this._start(n,s)}return this}setLoopPoints(e,t){return this.loopStart=e,this.loopEnd=t,this}get loopStart(){return this._loopStart}set loopStart(e){this._loopStart=e,this.buffer.loaded&&assertRange(this.toSeconds(e),0,this.buffer.duration),this._activeSources.forEach(t=>{t.loopStart=e})}get loopEnd(){return this._loopEnd}set loopEnd(e){this._loopEnd=e,this.buffer.loaded&&assertRange(this.toSeconds(e),0,this.buffer.duration),this._activeSources.forEach(t=>{t.loopEnd=e})}get buffer(){return this._buffer}set buffer(e){this._buffer.set(e)}get loop(){return this._loop}set loop(e){if(this._loop!==e&&(this._loop=e,this._activeSources.forEach(t=>{t.loop=e}),e)){const t=this._state.getNextState("stopped",this.now());t&&this._state.cancel(t.time)}}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e;const t=this.now(),n=this._state.getNextState("stopped",t);n&&n.implicitEnd&&(this._state.cancel(n.time),this._activeSources.forEach(s=>s.cancelStop())),this._activeSources.forEach(s=>{s.playbackRate.setValueAtTime(e,t)})}get reverse(){return this._buffer.reverse}set reverse(e){this._buffer.reverse=e}get loaded(){return this._buffer.loaded}dispose(){return super.dispose(),this._activeSources.forEach(e=>e.dispose()),this._activeSources.clear(),this._buffer.dispose(),this}}__decorate([timeRange(0)],Player.prototype,"fadeIn",void 0);__decorate([timeRange(0)],Player.prototype,"fadeOut",void 0);class Envelope extends ToneAudioNode{constructor(){super(optionsFromArguments(Envelope.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="Envelope",this._sig=new Signal({context:this.context,value:0}),this.output=this._sig,this.input=void 0;const e=optionsFromArguments(Envelope.getDefaults(),arguments,["attack","decay","sustain","release"]);this.attack=e.attack,this.decay=e.decay,this.sustain=e.sustain,this.release=e.release,this.attackCurve=e.attackCurve,this.releaseCurve=e.releaseCurve,this.decayCurve=e.decayCurve}static getDefaults(){return Object.assign(ToneAudioNode.getDefaults(),{attack:.01,attackCurve:"linear",decay:.1,decayCurve:"exponential",release:1,releaseCurve:"exponential",sustain:.5})}get value(){return this.getValueAtTime(this.now())}_getCurve(e,t){if(isString$1(e))return e;{let n;for(n in EnvelopeCurves)if(EnvelopeCurves[n][t]===e)return n;return e}}_setCurve(e,t,n){if(isString$1(n)&&Reflect.has(EnvelopeCurves,n)){const s=EnvelopeCurves[n];isObject(s)?e!=="_decayCurve"&&(this[e]=s[t]):this[e]=s}else if(isArray(n)&&e!=="_decayCurve")this[e]=n;else throw new Error("Envelope: invalid curve: "+n)}get attackCurve(){return this._getCurve(this._attackCurve,"In")}set attackCurve(e){this._setCurve("_attackCurve","In",e)}get releaseCurve(){return this._getCurve(this._releaseCurve,"Out")}set releaseCurve(e){this._setCurve("_releaseCurve","Out",e)}get decayCurve(){return this._decayCurve}set decayCurve(e){assert(["linear","exponential"].some(t=>t===e),`Invalid envelope curve: ${e}`),this._decayCurve=e}triggerAttack(e,t=1){this.log("triggerAttack",e,t),e=this.toSeconds(e);let s=this.toSeconds(this.attack);const i=this.toSeconds(this.decay),a=this.getValueAtTime(e);if(a>0){const o=1/s;s=(1-a)/o}if(s<this.sampleTime)this._sig.cancelScheduledValues(e),this._sig.setValueAtTime(t,e);else if(this._attackCurve==="linear")this._sig.linearRampTo(t,s,e);else if(this._attackCurve==="exponential")this._sig.targetRampTo(t,s,e);else{this._sig.cancelAndHoldAtTime(e);let o=this._attackCurve;for(let c=1;c<o.length;c++)if(o[c-1]<=a&&a<=o[c]){o=this._attackCurve.slice(c),o[0]=a;break}this._sig.setValueCurveAtTime(o,e,s,t)}if(i&&this.sustain<1){const o=t*this.sustain,c=e+s;this.log("decay",c),this._decayCurve==="linear"?this._sig.linearRampToValueAtTime(o,i+c):this._sig.exponentialApproachValueAtTime(o,c,i)}return this}triggerRelease(e){this.log("triggerRelease",e),e=this.toSeconds(e);const t=this.getValueAtTime(e);if(t>0){const n=this.toSeconds(this.release);n<this.sampleTime?this._sig.setValueAtTime(0,e):this._releaseCurve==="linear"?this._sig.linearRampTo(0,n,e):this._releaseCurve==="exponential"?this._sig.targetRampTo(0,n,e):(assert(isArray(this._releaseCurve),"releaseCurve must be either 'linear', 'exponential' or an array"),this._sig.cancelAndHoldAtTime(e),this._sig.setValueCurveAtTime(this._releaseCurve,e,n,t))}return this}getValueAtTime(e){return this._sig.getValueAtTime(e)}triggerAttackRelease(e,t,n=1){return t=this.toSeconds(t),this.triggerAttack(t,n),this.triggerRelease(t+this.toSeconds(e)),this}cancel(e){return this._sig.cancelScheduledValues(this.toSeconds(e)),this}connect(e,t=0,n=0){return connectSignal(this,e,t,n),this}asArray(e=1024){return __awaiter(this,void 0,void 0,function*(){const t=e/this.context.sampleRate,n=new OfflineContext(1,t,this.context.sampleRate),s=this.toSeconds(this.attack)+this.toSeconds(this.decay),i=s+this.toSeconds(this.release),a=i*.1,o=i+a,c=new this.constructor(Object.assign(this.get(),{attack:t*this.toSeconds(this.attack)/o,decay:t*this.toSeconds(this.decay)/o,release:t*this.toSeconds(this.release)/o,context:n}));return c._sig.toDestination(),c.triggerAttackRelease(t*(s+a)/o,0),(yield n.render()).getChannelData(0)})}dispose(){return super.dispose(),this._sig.dispose(),this}}__decorate([timeRange(0)],Envelope.prototype,"attack",void 0);__decorate([timeRange(0)],Envelope.prototype,"decay",void 0);__decorate([range(0,1)],Envelope.prototype,"sustain",void 0);__decorate([timeRange(0)],Envelope.prototype,"release",void 0);const EnvelopeCurves=(()=>{let e,t;const n=[];for(e=0;e<128;e++)n[e]=Math.sin(e/(128-1)*(Math.PI/2));const s=[],i=6.4;for(e=0;e<128-1;e++){t=e/(128-1);const m=Math.sin(t*(Math.PI*2)*i-Math.PI/2)+1;s[e]=m/10+t*.83}s[128-1]=1;const a=[],o=5;for(e=0;e<128;e++)a[e]=Math.ceil(e/(128-1)*o)/o;const c=[];for(e=0;e<128;e++)t=e/(128-1),c[e]=.5*(1-Math.cos(Math.PI*t));const l=[];for(e=0;e<128;e++){t=e/(128-1);const m=Math.pow(t,3)*4+.2,y=Math.cos(m*Math.PI*2*t);l[e]=Math.abs(y*(1-t))}function u(m){const y=new Array(m.length);for(let h=0;h<m.length;h++)y[h]=1-m[h];return y}function d(m){return m.slice(0).reverse()}return{bounce:{In:u(l),Out:l},cosine:{In:n,Out:d(n)},exponential:"exponential",linear:"linear",ripple:{In:s,Out:u(s)},sine:{In:c,Out:u(c)},step:{In:a,Out:u(a)}}})();class Instrument extends ToneAudioNode{constructor(){super(optionsFromArguments(Instrument.getDefaults(),arguments)),this._scheduledEvents=[],this._synced=!1,this._original_triggerAttack=this.triggerAttack,this._original_triggerRelease=this.triggerRelease;const e=optionsFromArguments(Instrument.getDefaults(),arguments);this._volume=this.output=new Volume({context:this.context,volume:e.volume}),this.volume=this._volume.volume,readOnly(this,"volume")}static getDefaults(){return Object.assign(ToneAudioNode.getDefaults(),{volume:0})}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",0)),this}_syncState(){let e=!1;return this._synced||(this._synced=!0,e=!0),e}_syncMethod(e,t){const n=this["_original_"+e]=this[e];this[e]=(...s)=>{const i=s[t],a=this.context.transport.schedule(o=>{s[t]=o,n.apply(this,s)},i);this._scheduledEvents.push(a)}}unsync(){return this._scheduledEvents.forEach(e=>this.context.transport.clear(e)),this._scheduledEvents=[],this._synced&&(this._synced=!1,this.triggerAttack=this._original_triggerAttack,this.triggerRelease=this._original_triggerRelease),this}triggerAttackRelease(e,t,n,s){const i=this.toSeconds(n),a=this.toSeconds(t);return this.triggerAttack(e,i,s),this.triggerRelease(i+a),this}dispose(){return super.dispose(),this._volume.dispose(),this.unsync(),this._scheduledEvents=[],this}}class Monophonic extends Instrument{constructor(){super(optionsFromArguments(Monophonic.getDefaults(),arguments));const e=optionsFromArguments(Monophonic.getDefaults(),arguments);this.portamento=e.portamento,this.onsilence=e.onsilence}static getDefaults(){return Object.assign(Instrument.getDefaults(),{detune:0,onsilence:noOp,portamento:0})}triggerAttack(e,t,n=1){this.log("triggerAttack",e,t,n);const s=this.toSeconds(t);return this._triggerEnvelopeAttack(s,n),this.setNote(e,s),this}triggerRelease(e){this.log("triggerRelease",e);const t=this.toSeconds(e);return this._triggerEnvelopeRelease(t),this}setNote(e,t){const n=this.toSeconds(t),s=e instanceof FrequencyClass?e.toFrequency():e;if(this.portamento>0&&this.getLevelAtTime(n)>.05){const i=this.toSeconds(this.portamento);this.frequency.exponentialRampTo(s,i,n)}else this.frequency.setValueAtTime(s,n);return this}}__decorate([timeRange(0)],Monophonic.prototype,"portamento",void 0);class AmplitudeEnvelope extends Envelope{constructor(){super(optionsFromArguments(AmplitudeEnvelope.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="AmplitudeEnvelope",this._gainNode=new Gain({context:this.context,gain:0}),this.output=this._gainNode,this.input=this._gainNode,this._sig.connect(this._gainNode.gain),this.output=this._gainNode,this.input=this._gainNode}dispose(){return super.dispose(),this._gainNode.dispose(),this}}class Synth extends Monophonic{constructor(){super(optionsFromArguments(Synth.getDefaults(),arguments)),this.name="Synth";const e=optionsFromArguments(Synth.getDefaults(),arguments);this.oscillator=new OmniOscillator(Object.assign({context:this.context,detune:e.detune,onstop:()=>this.onsilence(this)},e.oscillator)),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.envelope=new AmplitudeEnvelope(Object.assign({context:this.context},e.envelope)),this.oscillator.chain(this.envelope,this.output),readOnly(this,["oscillator","frequency","detune","envelope"])}static getDefaults(){return Object.assign(Monophonic.getDefaults(),{envelope:Object.assign(omitFromObject(Envelope.getDefaults(),Object.keys(ToneAudioNode.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.3}),oscillator:Object.assign(omitFromObject(OmniOscillator.getDefaults(),[...Object.keys(Source.getDefaults()),"frequency","detune"]),{type:"triangle"})})}_triggerEnvelopeAttack(e,t){if(this.envelope.triggerAttack(e,t),this.oscillator.start(e),this.envelope.sustain===0){const n=this.toSeconds(this.envelope.attack),s=this.toSeconds(this.envelope.decay);this.oscillator.stop(e+n+s)}}_triggerEnvelopeRelease(e){this.envelope.triggerRelease(e),this.oscillator.stop(e+this.toSeconds(this.envelope.release))}getLevelAtTime(e){return e=this.toSeconds(e),this.envelope.getValueAtTime(e)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this}}class MembraneSynth extends Synth{constructor(){super(optionsFromArguments(MembraneSynth.getDefaults(),arguments)),this.name="MembraneSynth",this.portamento=0;const e=optionsFromArguments(MembraneSynth.getDefaults(),arguments);this.pitchDecay=e.pitchDecay,this.octaves=e.octaves,readOnly(this,["oscillator","envelope"])}static getDefaults(){return deepMerge(Monophonic.getDefaults(),Synth.getDefaults(),{envelope:{attack:.001,attackCurve:"exponential",decay:.4,release:1.4,sustain:.01},octaves:10,oscillator:{type:"sine"},pitchDecay:.05})}setNote(e,t){const n=this.toSeconds(t),s=this.toFrequency(e instanceof FrequencyClass?e.toFrequency():e),i=s*this.octaves;return this.oscillator.frequency.setValueAtTime(i,n),this.oscillator.frequency.exponentialRampToValueAtTime(s,n+this.toSeconds(this.pitchDecay)),this}dispose(){return super.dispose(),this}}__decorate([range(0)],MembraneSynth.prototype,"octaves",void 0);__decorate([timeRange(0)],MembraneSynth.prototype,"pitchDecay",void 0);const workletContext=new Set;function addToWorklet(r){workletContext.add(r)}function registerProcessor(r,e){const t=`registerProcessor("${r}", ${e})`;workletContext.add(t)}const toneAudioWorkletProcessor=`
	/**
	 * The base AudioWorkletProcessor for use in Tone.js. Works with the [[ToneAudioWorklet]]. 
	 */
	class ToneAudioWorkletProcessor extends AudioWorkletProcessor {

		constructor(options) {
			
			super(options);
			/**
			 * If the processor was disposed or not. Keep alive until it's disposed.
			 */
			this.disposed = false;
		   	/** 
			 * The number of samples in the processing block
			 */
			this.blockSize = 128;
			/**
			 * the sample rate
			 */
			this.sampleRate = sampleRate;

			this.port.onmessage = (event) => {
				// when it receives a dispose 
				if (event.data === "dispose") {
					this.disposed = true;
				}
			};
		}
	}
`;addToWorklet(toneAudioWorkletProcessor);const singleIOProcess=`
	/**
	 * Abstract class for a single input/output processor. 
	 * has a 'generate' function which processes one sample at a time
	 */
	class SingleIOProcessor extends ToneAudioWorkletProcessor {

		constructor(options) {
			super(Object.assign(options, {
				numberOfInputs: 1,
				numberOfOutputs: 1
			}));
			/**
			 * Holds the name of the parameter and a single value of that
			 * parameter at the current sample
			 * @type { [name: string]: number }
			 */
			this.params = {}
		}

		/**
		 * Generate an output sample from the input sample and parameters
		 * @abstract
		 * @param input number
		 * @param channel number
		 * @param parameters { [name: string]: number }
		 * @returns number
		 */
		generate(){}

		/**
		 * Update the private params object with the 
		 * values of the parameters at the given index
		 * @param parameters { [name: string]: Float32Array },
		 * @param index number
		 */
		updateParams(parameters, index) {
			for (const paramName in parameters) {
				const param = parameters[paramName];
				if (param.length > 1) {
					this.params[paramName] = parameters[paramName][index];
				} else {
					this.params[paramName] = parameters[paramName][0];
				}
			}
		}

		/**
		 * Process a single frame of the audio
		 * @param inputs Float32Array[][]
		 * @param outputs Float32Array[][]
		 */
		process(inputs, outputs, parameters) {
			const input = inputs[0];
			const output = outputs[0];
			// get the parameter values
			const channelCount = Math.max(input && input.length || 0, output.length);
			for (let sample = 0; sample < this.blockSize; sample++) {
				this.updateParams(parameters, sample);
				for (let channel = 0; channel < channelCount; channel++) {
					const inputSample = input && input.length ? input[channel][sample] : 0;
					output[channel][sample] = this.generate(inputSample, channel, this.params);
				}
			}
			return !this.disposed;
		}
	};
`;addToWorklet(singleIOProcess);const delayLine=`
	/**
	 * A multichannel buffer for use within an AudioWorkletProcessor as a delay line
	 */
	class DelayLine {
		
		constructor(size, channels) {
			this.buffer = [];
			this.writeHead = []
			this.size = size;

			// create the empty channels
			for (let i = 0; i < channels; i++) {
				this.buffer[i] = new Float32Array(this.size);
				this.writeHead[i] = 0;
			}
		}

		/**
		 * Push a value onto the end
		 * @param channel number
		 * @param value number
		 */
		push(channel, value) {
			this.writeHead[channel] += 1;
			if (this.writeHead[channel] > this.size) {
				this.writeHead[channel] = 0;
			}
			this.buffer[channel][this.writeHead[channel]] = value;
		}

		/**
		 * Get the recorded value of the channel given the delay
		 * @param channel number
		 * @param delay number delay samples
		 */
		get(channel, delay) {
			let readHead = this.writeHead[channel] - Math.floor(delay);
			if (readHead < 0) {
				readHead += this.size;
			}
			return this.buffer[channel][readHead];
		}
	}
`;addToWorklet(delayLine);const workletName$1="feedback-comb-filter",feedbackCombFilter=`
	class FeedbackCombFilterWorklet extends SingleIOProcessor {

		constructor(options) {
			super(options);
			this.delayLine = new DelayLine(this.sampleRate, options.channelCount || 2);
		}

		static get parameterDescriptors() {
			return [{
				name: "delayTime",
				defaultValue: 0.1,
				minValue: 0,
				maxValue: 1,
				automationRate: "k-rate"
			}, {
				name: "feedback",
				defaultValue: 0.5,
				minValue: 0,
				maxValue: 0.9999,
				automationRate: "k-rate"
			}];
		}

		generate(input, channel, parameters) {
			const delayedSample = this.delayLine.get(channel, parameters.delayTime * this.sampleRate);
			this.delayLine.push(channel, input + delayedSample * parameters.feedback);
			return delayedSample;
		}
	}
`;registerProcessor(workletName$1,feedbackCombFilter);class Sampler extends Instrument{constructor(){super(optionsFromArguments(Sampler.getDefaults(),arguments,["urls","onload","baseUrl"],"urls")),this.name="Sampler",this._activeSources=new Map;const e=optionsFromArguments(Sampler.getDefaults(),arguments,["urls","onload","baseUrl"],"urls"),t={};Object.keys(e.urls).forEach(n=>{const s=parseInt(n,10);if(assert(isNote(n)||isNumber(s)&&isFinite(s),`url key is neither a note or midi pitch: ${n}`),isNote(n)){const i=new FrequencyClass(this.context,n).toMidi();t[i]=e.urls[n]}else isNumber(s)&&isFinite(s)&&(t[s]=e.urls[s])}),this._buffers=new ToneAudioBuffers({urls:t,onload:e.onload,baseUrl:e.baseUrl,onerror:e.onerror}),this.attack=e.attack,this.release=e.release,this.curve=e.curve,this._buffers.loaded&&Promise.resolve().then(e.onload)}static getDefaults(){return Object.assign(Instrument.getDefaults(),{attack:0,baseUrl:"",curve:"exponential",onload:noOp,onerror:noOp,release:.1,urls:{}})}_findClosest(e){let n=0;for(;n<96;){if(this._buffers.has(e+n))return-n;if(this._buffers.has(e-n))return n;n++}throw new Error(`No available buffers for note: ${e}`)}triggerAttack(e,t,n=1){return this.log("triggerAttack",e,t,n),Array.isArray(e)||(e=[e]),e.forEach(s=>{const i=ftomf(new FrequencyClass(this.context,s).toFrequency()),a=Math.round(i),o=i-a,c=this._findClosest(a),l=a-c,u=this._buffers.get(l),d=intervalToFrequencyRatio(c+o),m=new ToneBufferSource({url:u,context:this.context,curve:this.curve,fadeIn:this.attack,fadeOut:this.release,playbackRate:d}).connect(this.output);m.start(t,0,u.duration/d,n),isArray(this._activeSources.get(a))||this._activeSources.set(a,[]),this._activeSources.get(a).push(m),m.onended=()=>{if(this._activeSources&&this._activeSources.has(a)){const y=this._activeSources.get(a),h=y.indexOf(m);h!==-1&&y.splice(h,1)}}}),this}triggerRelease(e,t){return this.log("triggerRelease",e,t),Array.isArray(e)||(e=[e]),e.forEach(n=>{const s=new FrequencyClass(this.context,n).toMidi();if(this._activeSources.has(s)&&this._activeSources.get(s).length){const i=this._activeSources.get(s);t=this.toSeconds(t),i.forEach(a=>{a.stop(t)}),this._activeSources.set(s,[])}}),this}releaseAll(e){const t=this.toSeconds(e);return this._activeSources.forEach(n=>{for(;n.length;)n.shift().stop(t)}),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}triggerAttackRelease(e,t,n,s=1){const i=this.toSeconds(n);return this.triggerAttack(e,i,s),isArray(t)?(assert(isArray(e),"notes must be an array when duration is array"),e.forEach((a,o)=>{const c=t[Math.min(o,t.length-1)];this.triggerRelease(a,i+this.toSeconds(c))})):this.triggerRelease(e,i+this.toSeconds(t)),this}add(e,t,n){if(assert(isNote(e)||isFinite(e),`note must be a pitch or midi: ${e}`),isNote(e)){const s=new FrequencyClass(this.context,e).toMidi();this._buffers.add(s,t,n)}else this._buffers.add(e,t,n);return this}get loaded(){return this._buffers.loaded}dispose(){return super.dispose(),this._buffers.dispose(),this._activeSources.forEach(e=>{e.forEach(t=>t.dispose())}),this._activeSources.clear(),this}}__decorate([timeRange(0)],Sampler.prototype,"attack",void 0);__decorate([timeRange(0)],Sampler.prototype,"release",void 0);class Panner extends ToneAudioNode{constructor(){super(Object.assign(optionsFromArguments(Panner.getDefaults(),arguments,["pan"]))),this.name="Panner",this._panner=this.context.createStereoPanner(),this.input=this._panner,this.output=this._panner;const e=optionsFromArguments(Panner.getDefaults(),arguments,["pan"]);this.pan=new Param({context:this.context,param:this._panner.pan,value:e.pan,minValue:-1,maxValue:1}),this._panner.channelCount=e.channelCount,this._panner.channelCountMode="explicit",readOnly(this,"pan")}static getDefaults(){return Object.assign(ToneAudioNode.getDefaults(),{pan:0,channelCount:1})}dispose(){return super.dispose(),this._panner.disconnect(),this.pan.dispose(),this}}const workletName="bit-crusher",bitCrusherWorklet=`
	class BitCrusherWorklet extends SingleIOProcessor {

		static get parameterDescriptors() {
			return [{
				name: "bits",
				defaultValue: 12,
				minValue: 1,
				maxValue: 16,
				automationRate: 'k-rate'
			}];
		}

		generate(input, _channel, parameters) {
			const step = Math.pow(0.5, parameters.bits - 1);
			const val = step * Math.floor(input / step + 0.5);
			return val;
		}
	}
`;registerProcessor(workletName,bitCrusherWorklet);class Solo extends ToneAudioNode{constructor(){super(optionsFromArguments(Solo.getDefaults(),arguments,["solo"])),this.name="Solo";const e=optionsFromArguments(Solo.getDefaults(),arguments,["solo"]);this.input=this.output=new Gain({context:this.context}),Solo._allSolos.has(this.context)||Solo._allSolos.set(this.context,new Set),Solo._allSolos.get(this.context).add(this),this.solo=e.solo}static getDefaults(){return Object.assign(ToneAudioNode.getDefaults(),{solo:!1})}get solo(){return this._isSoloed()}set solo(e){e?this._addSolo():this._removeSolo(),Solo._allSolos.get(this.context).forEach(t=>t._updateSolo())}get muted(){return this.input.gain.value===0}_addSolo(){Solo._soloed.has(this.context)||Solo._soloed.set(this.context,new Set),Solo._soloed.get(this.context).add(this)}_removeSolo(){Solo._soloed.has(this.context)&&Solo._soloed.get(this.context).delete(this)}_isSoloed(){return Solo._soloed.has(this.context)&&Solo._soloed.get(this.context).has(this)}_noSolos(){return!Solo._soloed.has(this.context)||Solo._soloed.has(this.context)&&Solo._soloed.get(this.context).size===0}_updateSolo(){this._isSoloed()?this.input.gain.value=1:this._noSolos()?this.input.gain.value=1:this.input.gain.value=0}dispose(){return super.dispose(),Solo._allSolos.get(this.context).delete(this),this._removeSolo(),this}}Solo._allSolos=new Map;Solo._soloed=new Map;class PanVol extends ToneAudioNode{constructor(){super(optionsFromArguments(PanVol.getDefaults(),arguments,["pan","volume"])),this.name="PanVol";const e=optionsFromArguments(PanVol.getDefaults(),arguments,["pan","volume"]);this._panner=this.input=new Panner({context:this.context,pan:e.pan,channelCount:e.channelCount}),this.pan=this._panner.pan,this._volume=this.output=new Volume({context:this.context,volume:e.volume}),this.volume=this._volume.volume,this._panner.connect(this._volume),this.mute=e.mute,readOnly(this,["pan","volume"])}static getDefaults(){return Object.assign(ToneAudioNode.getDefaults(),{mute:!1,pan:0,volume:0,channelCount:1})}get mute(){return this._volume.mute}set mute(e){this._volume.mute=e}dispose(){return super.dispose(),this._panner.dispose(),this.pan.dispose(),this._volume.dispose(),this.volume.dispose(),this}}class Channel extends ToneAudioNode{constructor(){super(optionsFromArguments(Channel.getDefaults(),arguments,["volume","pan"])),this.name="Channel";const e=optionsFromArguments(Channel.getDefaults(),arguments,["volume","pan"]);this._solo=this.input=new Solo({solo:e.solo,context:this.context}),this._panVol=this.output=new PanVol({context:this.context,pan:e.pan,volume:e.volume,mute:e.mute,channelCount:e.channelCount}),this.pan=this._panVol.pan,this.volume=this._panVol.volume,this._solo.connect(this._panVol),readOnly(this,["pan","volume"])}static getDefaults(){return Object.assign(ToneAudioNode.getDefaults(),{pan:0,volume:0,mute:!1,solo:!1,channelCount:1})}get solo(){return this._solo.solo}set solo(e){this._solo.solo=e}get muted(){return this._solo.muted||this.mute}get mute(){return this._panVol.mute}set mute(e){this._panVol.mute=e}_getBus(e){return Channel.buses.has(e)||Channel.buses.set(e,new Gain({context:this.context})),Channel.buses.get(e)}send(e,t=0){const n=this._getBus(e),s=new Gain({context:this.context,units:"decibels",gain:t});return this.connect(s),s.connect(n),s}receive(e){return this._getBus(e).connect(this),this}dispose(){return super.dispose(),this._panVol.dispose(),this.pan.dispose(),this.volume.dispose(),this._solo.dispose(),this}}Channel.buses=new Map;class Listener extends ToneAudioNode{constructor(){super(...arguments),this.name="Listener",this.positionX=new Param({context:this.context,param:this.context.rawContext.listener.positionX}),this.positionY=new Param({context:this.context,param:this.context.rawContext.listener.positionY}),this.positionZ=new Param({context:this.context,param:this.context.rawContext.listener.positionZ}),this.forwardX=new Param({context:this.context,param:this.context.rawContext.listener.forwardX}),this.forwardY=new Param({context:this.context,param:this.context.rawContext.listener.forwardY}),this.forwardZ=new Param({context:this.context,param:this.context.rawContext.listener.forwardZ}),this.upX=new Param({context:this.context,param:this.context.rawContext.listener.upX}),this.upY=new Param({context:this.context,param:this.context.rawContext.listener.upY}),this.upZ=new Param({context:this.context,param:this.context.rawContext.listener.upZ})}static getDefaults(){return Object.assign(ToneAudioNode.getDefaults(),{positionX:0,positionY:0,positionZ:0,forwardX:0,forwardY:0,forwardZ:-1,upX:0,upY:1,upZ:0})}dispose(){return super.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this.forwardX.dispose(),this.forwardY.dispose(),this.forwardZ.dispose(),this.upX.dispose(),this.upY.dispose(),this.upZ.dispose(),this}}onContextInit(r=>{r.listener=new Listener({context:r})});onContextClose(r=>{r.listener.dispose()});getContext().transport;getContext().destination;getContext().destination;getContext().listener;getContext().draw;const context=getContext();function loaded(){return ToneAudioBuffer.loaded()}const notes_to_load=["A2","C3","A3","C4","A4","C5"],bass_note_icons={F2:"/assets/note_icons/F2.svg",G2:"/assets/note_icons/G2.svg",A2:"/assets/note_icons/A2.svg",B2:"/assets/note_icons/B2.svg",C3:"/assets/note_icons/C3.svg",D3:"/assets/note_icons/D3.svg",E3:"/assets/note_icons/E3.svg",F3:"/assets/note_icons/F3.svg",G3:"/assets/note_icons/G3.svg",A3:"/assets/note_icons/A3.svg",B3:"/assets/note_icons/B3.svg",C4:"/assets/note_icons/C4.svg"},treble_note_icons={A3:"/assets/note_icons/treble/A3.svg",B3:"/assets/note_icons/treble/B3.svg",C4:"/assets/note_icons/treble/C4.svg",D4:"/assets/note_icons/treble/D4.svg",E4:"/assets/note_icons/treble/E4.svg",F4:"/assets/note_icons/treble/F4.svg",G4:"/assets/note_icons/treble/G4.svg",A4:"/assets/note_icons/treble/A4.svg",B4:"/assets/note_icons/treble/B4.svg",C5:"/assets/note_icons/treble/C5.svg",D5:"/assets/note_icons/treble/D5.svg",E5:"/assets/note_icons/treble/E5.svg",F5:"/assets/note_icons/treble/F5.svg",G5:"/assets/note_icons/treble/G5.svg",A5:"/assets/note_icons/treble/A5.svg",B5:"/assets/note_icons/treble/B5.svg",C6:"/assets/note_icons/treble/C6.svg"},notes_loaded=Object.fromEntries(notes_to_load.map(r=>[r,!1])),sampler=new Sampler().toDestination();context.lookAhead=.05;for(const r of notes_to_load)fetch(`/acchymns-pr-PR_kwDOHpETuc5zAJ8i/assets/notes/${r}.mp3`).then(async e=>{const t=URL.createObjectURL(await e.blob());sampler.add(r,t),notes_loaded[r]=!0});const interval=useLocalStorage("ACCOptions.playbackInterval",.25),duration=useLocalStorage("ACCOptions.playbackDuration",2.5),staggered=useLocalStorage("ACCOptions.staggered",!0),isPlaying=ref(!1),timeouts=[],player={async play(r){if(isPlaying.value)return;if(isPlaying.value=!0,await start(),!Object.values(notes_loaded).every(n=>n)){console.log("Not all notes have been loaded!");return}if(!sampler.loaded){console.log("Sampler hasn't loaded!");return}console.log("attempting to start notes"),console.log(...unref(r)),await loaded();let e,t=0;if(staggered.value){for(const[n,s]of unref(r).entries()){const i=setTimeout(()=>{sampler.triggerAttack(s)},interval.value*n*1e3);timeouts.push(i),t++}e=duration.value+interval.value*unref(r).length}else sampler.triggerAttack(unref(r)),e=duration.value;timeouts[t]=setTimeout(()=>{sampler.releaseAll(),isPlaying.value=!1},e*1e3)},stop(){for(const r of timeouts)clearTimeout(r);sampler.releaseAll(),isPlaying.value=!1}};function useNotes(){return{player,isPlaying}}let pause_path="M 152.218 81.663 C 150.413 82.553, 147.938 84.680, 146.718 86.390 L 144.500 89.500 144.500 256 C 144.500 420.939, 144.519 422.525, 146.500 425.182 C 147.600 426.658, 150.171 428.814, 152.212 429.975 C 155.792 432.010, 156.970 432.075, 185.212 431.793 C 214.393 431.501, 214.512 431.491, 217.712 429.090 C 219.479 427.765, 221.616 425.222, 222.462 423.439 C 223.827 420.563, 224 401.681, 224 255.937 L 224 91.676 221.534 87.468 C 220.096 85.013, 217.637 82.581, 215.633 81.630 C 212.705 80.241, 208.014 80.003, 183.849 80.023 C 159.785 80.042, 155.004 80.290, 152.218 81.663 M 296.218 81.663 C 294.413 82.553, 291.938 84.680, 290.718 86.390 L 288.500 89.500 288.500 256 C 288.500 420.939, 288.519 422.525, 290.500 425.182 C 291.600 426.658, 294.171 428.814, 296.212 429.975 C 299.792 432.010, 300.970 432.075, 329.212 431.793 C 358.393 431.501, 358.512 431.491, 361.712 429.090 C 363.479 427.765, 365.616 425.222, 366.462 423.439 C 367.827 420.563, 368 401.681, 368 255.937 L 368 91.676 365.534 87.468 C 364.096 85.013, 361.637 82.581, 359.633 81.630 C 356.705 80.241, 352.014 80.003, 327.849 80.023 C 303.785 80.042, 299.004 80.290, 296.218 81.663",play_path="M 119.920 74.343 C 116.852 75.605, 112.720 77.875, 110.738 79.386 C 108.756 80.898, 105.951 83.686, 104.505 85.582 C 103.059 87.478, 100.666 91.610, 99.188 94.765 L 96.500 100.500 96.500 256 L 96.500 411.500 99.674 418.201 C 101.426 421.899, 104.923 426.976, 107.478 429.531 C 110.024 432.077, 114.670 435.352, 117.804 436.809 C 122.104 438.810, 125.487 439.549, 131.609 439.826 C 138.461 440.137, 140.630 439.816, 145.609 437.755 C 148.849 436.413, 207.525 401.759, 276 360.745 C 344.475 319.731, 402.390 284.548, 404.700 282.561 C 407.227 280.387, 410.216 276.275, 412.200 272.244 C 415.234 266.082, 415.500 264.774, 415.500 256 C 415.500 247.226, 415.234 245.918, 412.200 239.756 C 410.228 235.748, 407.212 231.593, 404.700 229.421 C 402.390 227.423, 343.800 191.866, 274.500 150.404 C 205.200 108.943, 146.507 74.341, 144.072 73.510 C 141.636 72.680, 136.461 72.011, 132.572 72.024 C 127.527 72.041, 123.901 72.705, 119.920 74.343";function sleep(r){return new Promise((e,t)=>{setTimeout(()=>{e(!0)},r)})}async function animate(r,e){for(let t=0;t<=1;t+=.1)await sleep(10),r(e(t))}var lib={},interpolate$2={},interpolatePath$1={},renderPath$1={},constants={};Object.defineProperty(constants,"__esModule",{value:!0});constants._=void 0;constants.SPACE=" ";constants.FILL="fill";constants.NONE="none";constants.DRAW_LINE_VERTICAL="V";constants.DRAW_LINE_HORIZONTAL="H";constants.DRAW_LINE="L";constants.CLOSE_PATH="Z";constants.MOVE_CURSOR="M";constants.DRAW_CURVE_CUBIC_BEZIER="C";constants.DRAW_CURVE_SMOOTH="S";constants.DRAW_CURVE_QUADRATIC="Q";constants.DRAW_CURVE_QUADRATIC_CONTINUATION="T";constants.DRAW_ARC="A";var inspect={};Object.defineProperty(inspect,"__esModule",{value:!0});function isString(r){return typeof r=="string"}inspect.isString=isString;var math={};(function(r){Object.defineProperty(r,"__esModule",{value:!0});var e=Math;r.abs=e.abs,r.min=e.min,r.max=e.max,r.floor=e.floor,r.round=e.round,r.sqrt=e.sqrt,r.pow=e.pow,r.cos=e.cos,r.asin=e.asin,r.sin=e.sin,r.tan=e.tan,r.PI=e.PI,r.QUADRATIC_RATIO=2/3,r.EPSILON=r.pow(2,-52)})(math);Object.defineProperty(renderPath$1,"__esModule",{value:!0});var constants_1$8=constants,inspect_1=inspect,math_1$8=math;function renderPath(r,e){if(e===void 0&&(e=math_1$8.round),inspect_1.isString(r))return r;for(var t=[],n=0;n<r.length;n++){var s=r[n];t.push(constants_1$8.MOVE_CURSOR,e(s[0]),e(s[1]),constants_1$8.DRAW_CURVE_CUBIC_BEZIER);for(var i=void 0,a=2;a<s.length;a+=6){var o=e(s[a]),c=e(s[a+1]),l=e(s[a+2]),u=e(s[a+3]),d=e(s[a+4]),m=e(s[a+5]),y=o==d&&l==d&&c==m&&u==m;(!y||i!=(i=""+o+c+l+u+d+m))&&t.push(o,c,l,u,d,m)}}return t.join(constants_1$8.SPACE)}renderPath$1.renderPath=renderPath;var errors={};Object.defineProperty(errors,"__esModule",{value:!0});var constants_1$7=constants;function raiseError(){throw new Error(Array.prototype.join.call(arguments,constants_1$7.SPACE))}errors.raiseError=raiseError;var normalizePaths$1={},fillSegments$1={},createNumberArray$1={},browser={};Object.defineProperty(browser,"__esModule",{value:!0});var userAgent=typeof window<"u"&&window.navigator.userAgent;browser.isEdge=/(MSIE |Trident\/|Edge\/)/i.test(userAgent);Object.defineProperty(createNumberArray$1,"__esModule",{value:!0});var browser_1=browser,arrayConstructor=browser_1.isEdge?Array:Float32Array;function createNumberArray(r){return new arrayConstructor(r)}createNumberArray$1.createNumberArray=createNumberArray;var computeAbsoluteOrigin$1={};Object.defineProperty(computeAbsoluteOrigin$1,"__esModule",{value:!0});var math_1$7=math;function computeDimensions(r){for(var e=r[0],t=r[1],n=t,s=e,i=2;i<r.length;i+=6){var a=r[i+4],o=r[i+5];e=math_1$7.min(e,a),s=math_1$7.max(s,a),t=math_1$7.min(t,o),n=math_1$7.max(n,o)}return{x:e,w:s-e,y:t,h:n-t}}function computeAbsoluteOrigin(r,e,t){var n=computeDimensions(t);return{x:n.x+n.w*r,y:n.y+n.h*e}}computeAbsoluteOrigin$1.computeAbsoluteOrigin=computeAbsoluteOrigin;Object.defineProperty(fillSegments$1,"__esModule",{value:!0});var createNumberArray_1$3=createNumberArray$1,computeAbsoluteOrigin_1$1=computeAbsoluteOrigin$1;function fillSegments(r,e,t){var n=r.length,s=e.length;if(n<s)return fillSegments(e,r,t);e.length=n;for(var i=s;i<n;i++){var a=r[i],o=t.x,c=t.y;if(!t.absolute){var l=computeAbsoluteOrigin_1$1.computeAbsoluteOrigin(o,c,a);o=l.x,c=l.y}for(var u=createNumberArray_1$3.createNumberArray(a.length),d=0;d<a.length;d+=2)u[d]=o,u[d+1]=c;e[i]=u}}fillSegments$1.fillSegments=fillSegments;var normalizePoints$1={},rotatePoints$1={};Object.defineProperty(rotatePoints$1,"__esModule",{value:!0});var createNumberArray_1$2=createNumberArray$1;function rotatePoints(r,e){var t=r.length,n=t-e,s=createNumberArray_1$2.createNumberArray(e),i;for(i=0;i<e;i++)s[i]=r[i];for(i=e;i<t;i++)r[i-e]=r[i];for(i=0;i<e;i++)r[n+i]=s[i]}rotatePoints$1.rotatePoints=rotatePoints;var distance$1={};Object.defineProperty(distance$1,"__esModule",{value:!0});var math_1$6=math;function distance(r,e,t,n){return math_1$6.sqrt((r-t)*(r-t)+(e-n)*(e-n))}distance$1.distance=distance;Object.defineProperty(normalizePoints$1,"__esModule",{value:!0});var rotatePoints_1=rotatePoints$1,constants_1$6=constants,distance_1$1=distance$1,computeAbsoluteOrigin_1=computeAbsoluteOrigin$1;function normalizePoints(r,e,t,n){var s=n.length;if(!(n[s-2]!==n[0]||n[s-1]!==n[1])){if(!r){var i=computeAbsoluteOrigin_1.computeAbsoluteOrigin(e,t,n);e=i.x,t=i.y}var a=n.slice(2);s=a.length;for(var o,c,l=0;l<s;l+=6){var u=distance_1$1.distance(e,e,a[l],a[l+1]);(c===constants_1$6._||u<c)&&(c=u,o=l)}rotatePoints_1.rotatePoints(a,o),n[0]=a[s-2],n[1]=a[s-1];for(var l=0;l<a.length;l++)n[l+2]=a[l]}}normalizePoints$1.normalizePoints=normalizePoints;var fillPoints$1={};Object.defineProperty(fillPoints$1,"__esModule",{value:!0});var math_1$5=math,createNumberArray_1$1=createNumberArray$1;function fillPoints(r,e){for(var t=r[0].length,n=0;n<t;n++){var s=r[0][n],i=r[1][n],a=math_1$5.max(s.length+e,i.length+e);r[0][n]=fillSubpath(s,a),r[1][n]=fillSubpath(i,a)}}fillPoints$1.fillPoints=fillPoints;function fillSubpath(r,e){var t=e-r.length,n=Math.ceil(e/r.length),s=createNumberArray_1$1.createNumberArray(e);s[0]=r[0],s[1]=r[1];for(var i=1,a=1;a<e-1;){s[++a]=r[++i],s[++a]=r[++i],s[++a]=r[++i],s[++a]=r[++i];var o=s[++a]=r[++i],c=s[++a]=r[++i];if(t)for(var l=0;l<n&&t;l++)s[a+5]=s[a+3]=s[a+1]=o,s[a+6]=s[a+4]=s[a+2]=c,a+=6,t-=6}return s}fillPoints$1.fillSubpath=fillSubpath;var getSortedSegments$1={},perimeterPoints$1={};Object.defineProperty(perimeterPoints$1,"__esModule",{value:!0});var math_1$4=math,distance_1=distance$1;function perimeterPoints(r){for(var e=r.length,t=r[e-2],n=r[e-1],s=0,i=0;i<e;i+=6)s+=distance_1.distance(r[i],r[i+1],t,n),t=r[i],n=r[i+1];return math_1$4.floor(s)}perimeterPoints$1.perimeterPoints=perimeterPoints;Object.defineProperty(getSortedSegments$1,"__esModule",{value:!0});var perimeterPoints_1=perimeterPoints$1;function getSortedSegments(r){return r.map(function(e){return{points:e,perimeter:perimeterPoints_1.perimeterPoints(e)}}).sort(function(e,t){return t.perimeter-e.perimeter}).map(function(e){return e.points})}getSortedSegments$1.getSortedSegments=getSortedSegments;Object.defineProperty(normalizePaths$1,"__esModule",{value:!0});var fillSegments_1=fillSegments$1,normalizePoints_1=normalizePoints$1,fillPoints_1=fillPoints$1,constants_1$5=constants,errors_1$3=errors,getSortedSegments_1=getSortedSegments$1;function normalizePaths(r,e,t){t.optimize===constants_1$5.FILL&&(r=getSortedSegments_1.getSortedSegments(r),e=getSortedSegments_1.getSortedSegments(e)),r.length!==e.length&&(t.optimize===constants_1$5.FILL?fillSegments_1.fillSegments(r,e,t.origin):errors_1$3.raiseError("optimize:none requires equal lengths"));var n=Array(2);if(n[0]=r,n[1]=e,t.optimize===constants_1$5.FILL){for(var s=t.origin,i=s.x,a=s.y,o=s.absolute,c=0;c<r.length;c++)normalizePoints_1.normalizePoints(o,i,a,n[0][c]),normalizePoints_1.normalizePoints(o,i,a,n[1][c]);fillPoints_1.fillPoints(n,t.addPoints*6)}return n}normalizePaths$1.normalizePaths=normalizePaths;var objects={};Object.defineProperty(objects,"__esModule",{value:!0});function fillObject(r,e){for(var t in e)r.hasOwnProperty(t)||(r[t]=e[t]);return r}objects.fillObject=fillObject;Object.defineProperty(interpolatePath$1,"__esModule",{value:!0});var renderPath_1=renderPath$1,math_1$3=math,errors_1$2=errors,normalizePaths_1=normalizePaths$1,objects_1=objects,createNumberArray_1=createNumberArray$1,constants_1$4=constants,defaultOptions={addPoints:0,optimize:constants_1$4.FILL,origin:{x:0,y:0},precision:0};function interpolatePath(r,e){e=objects_1.fillObject(e,defaultOptions),(!r||r.length<2)&&errors_1$2.raiseError("invalid arguments");for(var t=r.length-1,n=Array(t),s=0;s<t;s++)n[s]=getPathInterpolator(r[s],r[s+1],e);var i=e.precision?function(a){return a.toFixed(e.precision)}:constants_1$4._;return function(a){var o=t*a,c=math_1$3.min(math_1$3.floor(o),t-1);return renderPath_1.renderPath(n[c]((o-c)/(c+1)),i)}}interpolatePath$1.interpolatePath=interpolatePath;function getPathInterpolator(r,e,t){var n=normalizePaths_1.normalizePaths(r.getData(),e.getData(),t),s=n[0].length;return function(i){if(math_1$3.abs(i-0)<math_1$3.EPSILON)return r.getStringData();if(math_1$3.abs(i-1)<math_1$3.EPSILON)return e.getStringData();for(var a=Array(s),o=0;o<s;o++)a[o]=mixPoints(n[0][o],n[1][o],i);return a}}function mixPoints(r,e,t){for(var n=r.length,s=createNumberArray_1.createNumberArray(n),i=0;i<n;i++)s[i]=r[i]+(e[i]-r[i])*t;return s}interpolatePath$1.mixPoints=mixPoints;var path={},getPath={},parsePoints$1={},coalesce$1={};Object.defineProperty(coalesce$1,"__esModule",{value:!0});var constants_1$3=constants;function coalesce(r,e){return r===constants_1$3._?e:r}coalesce$1.coalesce=coalesce;var arcToCurve$1={};Object.defineProperty(arcToCurve$1,"__esModule",{value:!0});var math_1$2=math,_120=math_1$2.PI*120/180,PI2=math_1$2.PI*2;function arcToCurve(r,e,t,n,s,i,a,o,c,l,u,d,m){if(t<=0||n<=0)return[r,e,o,c,o,c];var y=math_1$2.PI/180*(+s||0),h=math_1$2.cos(y),p=math_1$2.sin(y),f=!!l;if(!f){var v=r,_=o;r=v*h-e*-p,e=v*-p+e*h,o=_*h-c*-p,c=_*-p+c*h;var O=(r-o)/2,k=(e-c)/2,g=O*O/(t*t)+k*k/(n*n);g>1&&(g=math_1$2.sqrt(g),t=g*t,n=g*n);var b=(i===a?-1:1)*math_1$2.sqrt(math_1$2.abs((t*t*n*n-t*t*k*k-n*n*O*O)/(t*t*k*k+n*n*O*O)));d=b*t*k/n+(r+o)/2,m=b*-n*O/t+(e+c)/2,l=math_1$2.asin((e-m)/n),u=math_1$2.asin((c-m)/n),r<d&&(l=math_1$2.PI-l),o<d&&(u=math_1$2.PI-u),l<0&&(l+=PI2),u<0&&(u+=PI2),a&&l>u&&(l-=PI2),!a&&u>l&&(u-=PI2)}var N;if(math_1$2.abs(u-l)>_120){var S=u,T=o,M=c;u=l+_120*(a&&u>l?1:-1),o=d+t*math_1$2.cos(u),c=m+n*math_1$2.sin(u),N=arcToCurve(o,c,t,n,s,0,a,T,M,u,S,d,m)}else N=[];var P=4/3*math_1$2.tan((u-l)/4);if(N.splice(0,0,2*r-(r+P*t*math_1$2.sin(l)),2*e-(e-P*n*math_1$2.cos(l)),o+P*t*math_1$2.sin(u),c-P*n*math_1$2.cos(u),o,c),!f)for(var $=0,K=N.length;$<K;$+=2){var L=N[$],j=N[$+1];N[$]=L*h-j*p,N[$+1]=L*p+j*h}return N}arcToCurve$1.arcToCurve=arcToCurve;Object.defineProperty(parsePoints$1,"__esModule",{value:!0});var constants_1$2=constants,coalesce_1=coalesce$1,errors_1$1=errors,math_1$1=math,arcToCurve_1=arcToCurve$1,argLengths={M:2,H:1,V:1,L:2,Z:0,C:6,S:4,Q:4,T:2,A:7};function addCurve(r,e,t,n,s,i,a){var o=r.x,c=r.y;r.x=coalesce_1.coalesce(i,o),r.y=coalesce_1.coalesce(a,c),r.current.push(coalesce_1.coalesce(e,o),t=coalesce_1.coalesce(t,c),n=coalesce_1.coalesce(n,o),s=coalesce_1.coalesce(s,c),r.x,r.y),r.lc=r.c}function convertToAbsolute(r){var e=r.c,t=r.t,n=r.x,s=r.y;if(e===constants_1$2.DRAW_LINE_VERTICAL)t[0]+=s;else if(e===constants_1$2.DRAW_LINE_HORIZONTAL)t[0]+=n;else if(e===constants_1$2.DRAW_ARC)t[5]+=n,t[6]+=s;else for(var i=0;i<t.length;i+=2)t[i]+=n,t[i+1]+=s}function parseSegments(r){return r.replace(/[\^\s]*([mhvlzcsqta]|\-?\d*\.?\d+)[,\$\s]*/gi," $1").replace(/([mhvlzcsqta])/gi," $1").trim().split("  ").map(parseSegment)}function parseSegment(r){return r.split(constants_1$2.SPACE).map(parseCommand)}function parseCommand(r,e){return e===0?r:+r}function parsePoints(r){for(var e={x:0,y:0,segments:[]},t=parseSegments(r),n=0;n<t.length;n++){var s=t[n],i=s[0],a=i.toUpperCase(),o=a!==constants_1$2.CLOSE_PATH&&a!==i;e.c=a;var c=argLengths[a],l=s,u=1;do{e.t=l.length===1?l:l.slice(u,u+c),o&&convertToAbsolute(e);var d=e.t,m=e.x,y=e.y,h=void 0,p=void 0,f=void 0,v=void 0,_=void 0,O=void 0;if(a===constants_1$2.MOVE_CURSOR)e.segments.push(e.current=[e.x=d[0],e.y=d[1]]);else if(a===constants_1$2.DRAW_LINE_HORIZONTAL)addCurve(e,constants_1$2._,constants_1$2._,constants_1$2._,constants_1$2._,d[0],constants_1$2._);else if(a===constants_1$2.DRAW_LINE_VERTICAL)addCurve(e,constants_1$2._,constants_1$2._,constants_1$2._,constants_1$2._,constants_1$2._,d[0]);else if(a===constants_1$2.DRAW_LINE)addCurve(e,constants_1$2._,constants_1$2._,constants_1$2._,constants_1$2._,d[0],d[1]);else if(a===constants_1$2.CLOSE_PATH)addCurve(e,constants_1$2._,constants_1$2._,constants_1$2._,constants_1$2._,e.current[0],e.current[1]);else if(a===constants_1$2.DRAW_CURVE_CUBIC_BEZIER)addCurve(e,d[0],d[1],d[2],d[3],d[4],d[5]),e.cx=d[2],e.cy=d[3];else if(a===constants_1$2.DRAW_CURVE_SMOOTH){var k=e.lc!==constants_1$2.DRAW_CURVE_SMOOTH&&e.lc!==constants_1$2.DRAW_CURVE_CUBIC_BEZIER;h=k?constants_1$2._:m*2-e.cx,p=k?constants_1$2._:y*2-e.cy,addCurve(e,h,p,d[0],d[1],d[2],d[3]),e.cx=d[0],e.cy=d[1]}else if(a===constants_1$2.DRAW_CURVE_QUADRATIC){var g=d[0],b=d[1];f=d[2],v=d[3],addCurve(e,m+(g-m)*math_1$1.QUADRATIC_RATIO,y+(b-y)*math_1$1.QUADRATIC_RATIO,f+(g-f)*math_1$1.QUADRATIC_RATIO,v+(b-v)*math_1$1.QUADRATIC_RATIO,f,v),e.cx=g,e.cy=b}else if(a===constants_1$2.DRAW_CURVE_QUADRATIC_CONTINUATION)f=d[0],v=d[1],e.lc===constants_1$2.DRAW_CURVE_QUADRATIC||e.lc===constants_1$2.DRAW_CURVE_QUADRATIC_CONTINUATION?(h=m+(m*2-e.cx-m)*math_1$1.QUADRATIC_RATIO,p=y+(y*2-e.cy-y)*math_1$1.QUADRATIC_RATIO,_=f+(m*2-e.cx-f)*math_1$1.QUADRATIC_RATIO,O=v+(y*2-e.cy-v)*math_1$1.QUADRATIC_RATIO):(h=_=m,p=O=y),addCurve(e,h,p,_,O,f,v),e.cx=_,e.cy=O;else if(a===constants_1$2.DRAW_ARC)for(var N=arcToCurve_1.arcToCurve(m,y,d[0],d[1],d[2],d[3],d[4],d[5],d[6]),S=0;S<N.length;S+=6)addCurve(e,N[S],N[S+1],N[S+2],N[S+3],N[S+4],N[S+5]);else errors_1$1.raiseError(e.c," is not supported");u+=c}while(u<l.length)}return e.segments}parsePoints$1.parsePoints=parsePoints;Object.defineProperty(getPath,"__esModule",{value:!0});var errors_1=errors,parsePoints_1=parsePoints$1,constants_1$1=constants,selectorRegex=/^([#|\.]|path)/i;function convertToPathData(r){if(Array.isArray(r))return{data:r,stringData:constants_1$1._};var e;if(typeof r=="string"&&selectorRegex.test(r)?r=document.querySelector(r):e=r,typeof r=="string")return{data:parsePoints_1.parsePoints(r),stringData:e};var t=r;return t.tagName.toUpperCase()==="PATH"?(e=t.getAttribute("d"),{data:parsePoints_1.parsePoints(e),stringData:e}):errors_1.raiseError("Unsupported element ",t.tagName)}getPath.convertToPathData=convertToPathData;Object.defineProperty(path,"__esModule",{value:!0});var getPath_1=getPath,math_1=math,constants_1=constants,Path=function(){function r(e){var t=getPath_1.convertToPathData(e),n=t.data,s=t.stringData;this.data=n,this.stringData=s}return r.prototype.getData=function(){return this.data},r.prototype.getStringData=function(){return this.stringData||(this.stringData=this.render())},r.prototype.render=function(e){e===void 0&&(e=math_1.round);for(var t=this.data,n=[],s=0;s<t.length;s++){var i=t[s];n.push(constants_1.MOVE_CURSOR,e(i[0]),e(i[1]),constants_1.DRAW_CURVE_CUBIC_BEZIER);for(var a=void 0,o=2;o<i.length;o+=6){var c=e(i[o]),l=e(i[o+1]),u=e(i[o+2]),d=e(i[o+3]),m=e(i[o+4]),y=e(i[o+5]),h=c==m&&u==m&&l==y&&d==y;(!h||a!=(a=""+c+l+u+d+m+y))&&n.push(c,l,u,d,m,y)}}return n.join(constants_1.SPACE)},r}();path.Path=Path;Object.defineProperty(interpolate$2,"__esModule",{value:!0});var interpolatePath_1=interpolatePath$1,path_1$1=path;function interpolate$1(r,e){return interpolatePath_1.interpolatePath(r.map(function(t){return new path_1$1.Path(t)}),e||{})}interpolate$2.interpolate=interpolate$1;Object.defineProperty(lib,"__esModule",{value:!0});var interpolate_1=interpolate$2,interpolate=lib.interpolate=interpolate_1.interpolate,path_1=path;lib.Path=path_1.Path;const ScreenOrientation=registerPlugin("ScreenOrientation",{web:()=>__vitePreload(()=>import("./web-6a8e137b.js"),["assets/web-6a8e137b.js","assets/index-e0bdf4b5.js","assets/index-5e9f6ed8.css"]).then(r=>new r.ScreenOrientationWeb)}),_hoisted_1={class:"title"},_hoisted_2={class:"title--left"},_hoisted_3={class:"title--center"},_hoisted_4={class:"title--right"},_hoisted_5=createBaseVNode("img",{class:"ionicon",src:_imports_0$1},null,-1),_hoisted_6=[_hoisted_5],_hoisted_7=createBaseVNode("img",{class:"ionicon",src:_imports_3},null,-1),_hoisted_8=[_hoisted_7],_hoisted_9=createBaseVNode("div",{class:"media-panel-blur"},null,-1),_hoisted_10=createBaseVNode("div",{class:"handle-bar"},null,-1),_hoisted_11=[_hoisted_10],_hoisted_12={class:"timestamp-left"},_hoisted_13={class:"progress-bar"},_hoisted_14=["value","onInput"],_hoisted_15={class:"timestamp-right"},_hoisted_16=["d"],_hoisted_17=createBaseVNode("p",{class:"media-type-title"},"Piano",-1),_hoisted_18=[_hoisted_17],_hoisted_19=createBaseVNode("p",{class:"media-type-title"},"Starting Notes",-1),_hoisted_20=[_hoisted_19],_hoisted_21={key:2,class:"media-controls"},_hoisted_22=["d"],_hoisted_23={class:"timestamp"},_hoisted_24={class:"progress-bar-large"},_hoisted_25=["value","onInput"],_hoisted_26={class:"timestamp"},_hoisted_27={key:3,class:"starting-notes-container"},_hoisted_28={class:"note-container"},_hoisted_29=createBaseVNode("img",{class:"ionicon starting-note-icon-all",src:_imports_2},null,-1),_hoisted_30=[_hoisted_29],_hoisted_31=createBaseVNode("p",{class:"note-name"},"All",-1),_hoisted_32=["onClick"],_hoisted_33={class:"note-button"},_hoisted_34=["src"],_hoisted_35={class:"note-name"},_hoisted_36={class:"broadcast-button"},_hoisted_37=createBaseVNode("h1",null,"Broadcast",-1),_hoisted_38={class:"close-button"},_hoisted_39=createBaseVNode("br",null,null,-1),_hoisted_40=createBaseVNode("h3",null,"Verses",-1),_hoisted_41=createBaseVNode("br",null,null,-1),_hoisted_42={class:"verse-list"},_hoisted_43=["onClick"],_sfc_main=defineComponent({__name:"SongDisplayView",props:{book:{},number:{}},setup(r){const e=r,t=useRouter(),{player:n,isPlaying:s}=useNotes(),i=ref([]),a=ref(0);var o=Capacitor.getPlatform()!=="web";const c=ref(),l=useCapacitorPreferences("bookmarks",[]),u=useCapacitorPreferences("broadcasting_auth_token","");let d=ref(""),m=ref(!1),y=ref(!1),h=ref([]);ref("");const p=computed(()=>l.value.findIndex(Re=>Re.book==e.book&&Re.number==e.number)!=-1),f=ref(!1),v=ref(!1),_=()=>window.innerHeight,O=()=>window.innerWidth,k=computed(()=>({book:e.book,number:e.number}));async function g(){if(!p.value)l.value.push(e),await Toast.show({text:`#${e.number} added to Bookmarks`});else{const Re=l.value.findIndex(Ce=>Ce.book==e.book&&Ce.number==e.number);l.value.splice(Re,1),await Toast.show({text:`#${e.number} removed from Bookmarks`})}}class b{constructor(){rt(this,"start");rt(this,"previous");rt(this,"height");rt(this,"visible");rt(this,"elastic");this.start=0,this.previous=0,this.visible=!1,this.elastic=!1,this.height=screen.orientation.type.includes("landscape")?.8:.4}dragFallOff(Ce){var Ie=(Math.log(Ce+.368)+1)/4;return Ie}dragStart(Ce,Ie){Ce.preventDefault(),this.previous=this.height,this.start=1-Ie/window.innerHeight}drag(Ce,Ie){Ce.preventDefault(),v.value?this.height=1-Ie/window.innerHeight-this.start+this.previous:this.height=this.dragFallOff(1-Ie/window.innerHeight-this.start)+this.previous,(this.height<(v.value?.2:.1)||isNaN(this.height))&&(z.value&&!Q.value||(this.height=v.value?.2:.1)),(this.height<=.01||isNaN(this.height))&&(this.height=.005)}dragEnd(Ce){Ce.preventDefault(),this.height>(v.value?.4:.2)?this.height=v.value?.8:.4:z.value&&Q.value==!1?(this.height=.005,setTimeout(()=>{this.visible=!1},250)):this.height=v.value?.2:.1,this.elastic=!0,setTimeout(()=>{this.elastic=!1},250)}}let N=ref(new b),S=ref(),T=ref(!1),M;function P(Re){Re.addEventListener("loadedmetadata",()=>{console.log("Audio Loaded!"),T.value=!0,de.value=(Re==null?void 0:Re.duration)||0,xe(null,!1)}),Re.addEventListener("error",()=>{console.error("Error loading audio"),T.value=!1,xe(null,!0)}),Re.addEventListener("play",()=>{}),Re.addEventListener("pause",()=>{})}let $,K=ref(0),L=ref(0);const j=ref(null),q=O()/4;useSwipe(j,{onSwipeStart(Re){$=Re.changedTouches[0]},onSwipe(Re){if(j.value.getZoom()>1)return;let Ie=Re.changedTouches[0].clientX,ge=$.clientX,Ze=Math.abs(Ie-ge),Ke=Ie-ge>0?1:-1;K.value=Ke==1?Math.max(Ze/q,0):0,L.value=Ke==-1?Math.max(Ze/q,0):0},onSwipeEnd(Re){if(K.value=0,L.value=0,j.value.getZoom()>1)return;let Ie=Re.changedTouches[0].clientX,ge=$.clientX;if(Math.abs(Ie-ge)<q)return;(Ie-ge>0?-1:1)==1?Be(1):Be(-1)}}),onMounted(async()=>{const Re=await getSongMetaData(e.book),Ce=await getAllBookMetaData();if(c.value=Ce[e.book],Re!=null){const ge=Re[e.number];i.value=((ge==null?void 0:ge.notes)??[]).reverse(),a.value=Object.keys(Re).length,f.value=(await Network.getStatus()).connected,f.value?(S.value=new Audio(`https://acchymnsmedia.s3.us-east-2.amazonaws.com/${e.book}/${e.number}.mp3`),S.value.preload="metadata",P(S.value)):(T.value=!1,S.value=new Audio),xe(null,!0),Network.addListener("networkStatusChange",async Ze=>{var Ke;f.value=Ze.connected,f.value?(S.value=new Audio(`https://acchymnsmedia.s3.us-east-2.amazonaws.com/${e.book}/${e.number}.mp3`),S.value.preload="metadata",P(S.value),(Ke=S.value)==null||Ke.load()):(T.value=!1,S.value=new Audio,xe(null,!0))})}M=(await ScreenOrientation.orientation()).type,(await ScreenOrientation.orientation()).type=="portrait-primary"?v.value=!1:(await ScreenOrientation.orientation()).type.includes("landscape")&&(v.value=!0),ScreenOrientation.addListener("screenOrientationChange",async()=>{M!=(await ScreenOrientation.orientation()).type&&((await ScreenOrientation.orientation()).type=="portrait-primary"?(v.value=!1,M=(await ScreenOrientation.orientation()).type,z.value?N.value.height=v.value?.8:.4:N.value.height=v.value?.2:.1):(await ScreenOrientation.orientation()).type.includes("landscape")&&(v.value=!0,M=(await ScreenOrientation.orientation()).type,z.value?N.value.height=v.value?.8:.4:N.value.height=v.value?.2:.1))});let Ie=await validate_token(u.value);m.value=Ie.status==200,d.value=Ie.data.church_id}),onUnmounted(()=>{var Re;n.stop(),(Re=S.value)==null||Re.pause(),S.value=void 0});let te=ref(!0),F=ref({x:0,y:0}),z=ref(!1),Q=ref(!1),ne=ref(0),de=ref(0),U=-1,w=ref(!1),x=ref(),R=ref(),V=ref(),D=ref();function Y(){y.value=!0;let Re=D.value;Re==null||Re.style.setProperty("opacity","0")}function W(){y.value=!1;let Re=D.value;Re==null||Re.style.setProperty("opacity","1")}async function ee(Re){var Ce,Ie;d.value!=null&&(await set(request_client(),d.value,e.number,((Ce=c.value)==null?void 0:Ce.name.medium)||e.book,h.value,((Ie=c.value)==null?void 0:Ie.primaryColor)||"#000000"),Re.target.parentElement,y.value=!1)}const me=async()=>{var ge;if(ne.value=((ge=S.value)==null?void 0:ge.currentTime)||0,S.value==null)return;let Re=x.value,Ce=R.value,Ie=S.value.currentTime/S.value.duration*100;Re&&(Re.style.background=`linear-gradient(to right, var(--color) 0%, var(--color) ${Ie}%, var(--slider-base) ${Ie}%, var(--slider-base) 100%)`),Ce&&(Ce.style.background=`linear-gradient(to right, var(--color) 0%, var(--color) ${Ie}%, var(--slider-base) ${Ie}%, var(--slider-base) 100%)`),S.value.ended&&w.value==!1&&(We(),Q.value=!1,clearInterval(U))};async function he(){Q.value&&Pe(),n.stop(),n.play(i)}async function Ae(Re){Q.value&&Pe(),n.stop(),n.play([Re])}async function ie(){N.value.visible=!N.value.visible,N.value.height=v.value?.8:.4}async function ye(){var Re;N.value.visible=!1,N.value.height=v.value?.8:.4,(Re=S.value)==null||Re.pause(),We(),Q.value=!1}function xe(Re,Ce){Re&&Re.preventDefault(),z.value=Ce,s.value=!N.value.visible}let Ve=ref(play_path);function We(){let Re=Q.value?[pause_path,play_path]:[play_path,pause_path],Ce=interpolate(Re,{addPoints:0,origin:{x:0,y:0},optimize:"fill",precision:0});animate(Ie=>{Ve.value=Ie},Ce)}async function Pe(){var Re,Ce;We(),Q.value?((Ce=S.value)==null||Ce.pause(),clearInterval(U)):((Re=S.value)==null||Re.play(),me(),U=setInterval(()=>{me()},1e3,0)),Q.value=!Q.value}function He(Re){var Ce,Ie,ge;w.value=!1,Q.value&&((Ce=S.value)!=null&&Ce.paused)&&!((Ie=S.value)!=null&&Ie.ended)&&((ge=S.value)==null||ge.play())}function Me(Re){w.value=!0;let Ce=S.value;Ce!=null&&(Ce.currentTime=Ce.duration*Re/100,me())}function be(Re){let Ce=Math.floor(Re/60),Ie=Math.floor(Re%60);return`${Ce}:${Ie<10?"0":""}${Ie}`}function fe(Re){te.value=!te.value}function Ee(){if(T.value==!1){N.value.height=.005,N.value.elastic=!0,setTimeout(()=>{N.value.elastic=!1,N.value.visible=!1},250);return}N.value.height=v.value?.2:.1,N.value.elastic=!0,setTimeout(()=>{N.value.elastic=!1},250)}async function Be(Re){const Ce=await getSongMetaData(e.book);let Ie="0";if(Ce==null){console.error("Error loading song metadata. Cannot traverse song.");return}else{let ge=Object.keys(Ce).sort((Ke,qe)=>Ke.localeCompare(qe,"en",{numeric:!0})),Ze=ge.findIndex(Ke=>Ke==e.number);if(Ze==-1){console.error("Error finding song in metadata. Cannot traverse song.");return}if(Ze+Re<0||Ze+Re>=ge.length){console.error("Cannot traverse song. Out of bounds.");return}Ie=ge[Ze+Re]}await t.replace(window.history.state.back),await t.replace(`/display/${e.book}/${Ie}`)}function Ge(Re){let Ce=Re.replace("#","").replace("b","");return i.value.indexOf(Re)>1||!Object.keys(bass_note_icons).includes(Ce)?treble_note_icons[Ce]:bass_note_icons[Ce]}return(Re,Ce)=>{var Ie;return openBlock(),createElementBlock(Fragment,null,[createBaseVNode("div",{class:normalizeClass(["menu",{"menu-hidden":!unref(te)}])},[createBaseVNode("div",_hoisted_1,[createBaseVNode("div",_hoisted_2,[createBaseVNode("img",{onClick:Ce[0]||(Ce[0]=ge=>unref(t).back()),class:"ionicon",src:_imports_0$1})]),createBaseVNode("div",_hoisted_3,[createBaseVNode("h1",null,"#"+toDisplayString(e.number),1)]),createBaseVNode("div",_hoisted_4,[i.value.length!=0?(openBlock(),createElementBlock(Fragment,{key:0},[unref(N).visible?(openBlock(),createElementBlock("img",{key:1,class:"ionicon",onClick:Ce[2]||(Ce[2]=ge=>ie()),src:_imports_2})):(openBlock(),createElementBlock("img",{key:0,onClick:Ce[1]||(Ce[1]=ge=>ie()),class:"ionicon",src:_imports_1}))],64)):createCommentVNode("",!0),p.value?(openBlock(),createElementBlock("img",{key:1,onClick:Ce[3]||(Ce[3]=ge=>g()),class:"ionicon",src:_imports_2$1})):(openBlock(),createElementBlock("img",{key:2,onClick:Ce[4]||(Ce[4]=ge=>g()),class:"ionicon",src:_imports_2$2}))])])],2),unref(N).height<.7||!unref(N).visible?(openBlock(),createElementBlock("div",{key:0,ref_key:"page_buttons",ref:V,class:"page-buttons",style:normalizeStyle({transform:"translateY("+(unref(N).visible?-unref(N).height*_()+"px":"0")+")"})},[createBaseVNode("div",{class:normalizeClass(["page-button",{"arrow-hidden-left":!unref(te)||Number(e.number)==1}])},[createBaseVNode("img",{onClick:Ce[5]||(Ce[5]=ge=>Be(-1)),class:"ionicon",src:_imports_0$1})],2),createBaseVNode("div",{class:normalizeClass(["page-button",{"arrow-hidden-right":!unref(te)||Number(e.number)==a.value}])},[createBaseVNode("img",{onClick:Ce[6]||(Ce[6]=ge=>Be(1)),class:"ionicon",src:_imports_3})],2)],4)):createCommentVNode("",!0),unref(K)>0&&Number(e.number)>1?(openBlock(),createElementBlock("div",{key:1,class:"flip-indicator flip-indicator-left",style:normalizeStyle({opacity:unref(K)})},_hoisted_6,4)):createCommentVNode("",!0),unref(L)>0&&Number(e.number)<a.value?(openBlock(),createElementBlock("div",{key:2,class:"flip-indicator flip-indicator-right",style:normalizeStyle({opacity:unref(L)})},_hoisted_8,4)):createCommentVNode("",!0),createBaseVNode("div",{class:normalizeClass(["media-panel-content",{"hidden-panel":!unref(N).visible||!unref(te),elastic:unref(N).elastic}]),style:normalizeStyle("height:"+unref(N).height*100+"%")},[_hoisted_9,unref(o)?(openBlock(),createElementBlock("div",{key:0,class:"handle-bar-container",onTouchstart:Ce[7]||(Ce[7]=ge=>unref(N).dragStart(ge,ge.touches[0].pageY)),onTouchmove:Ce[8]||(Ce[8]=ge=>unref(N).drag(ge,ge.touches[0].pageY)),onTouchend:Ce[9]||(Ce[9]=ge=>unref(N).dragEnd(ge))},_hoisted_11,32)):createCommentVNode("",!0),createBaseVNode("div",{class:"close-button",style:normalizeStyle({opacity:unref(N).height<(v.value?.3:.15)?"0":"1"})},[createBaseVNode("img",{onClick:Ce[10]||(Ce[10]=ge=>ye()),class:"ionicon",src:_imports_5})],4),unref(N).height<=(v.value?.3:.15)&&unref(N).visible&&unref(T)?(openBlock(),createElementBlock("div",{key:1,class:"mini-playback-container",style:normalizeStyle({opacity:unref(N).height<=(v.value?.2:.1)?"1":"0"})},[createBaseVNode("p",_hoisted_12,toDisplayString(be(unref(ne))),1),createBaseVNode("div",_hoisted_13,[createBaseVNode("input",{type:"range",ref_key:"mini_timeline",ref:R,class:"media-timeline",value:unref(ne)/unref(de)*100,onInput:ge=>Me(Number(ge.target.value)),onChange:Ce[11]||(Ce[11]=ge=>He()),style:normalizeStyle({background:`linear-gradient(to right, var(--color) 0%, var(--color) ${unref(ne)/unref(de)*100}%, var(--slider-base) ${unref(ne)/unref(de)*100}%, var(--slider-base) 100%)`})},null,44,_hoisted_14)]),createBaseVNode("p",_hoisted_15,toDisplayString(be(unref(de))),1),(openBlock(),createElementBlock("svg",{onClick:Ce[12]||(Ce[12]=ge=>Pe()),class:"mini-play-button",viewBox:"0 0 512 512"},[createBaseVNode("path",{id:"svg_content",class:"play-button-path",d:unref(Ve)},null,8,_hoisted_16)]))],4)):createCommentVNode("",!0),createBaseVNode("div",{class:"media-type",style:normalizeStyle({opacity:unref(N).height<(v.value?.4:.2)?"0":"1"})},[unref(T)&&f.value?(openBlock(),createElementBlock("div",{key:0,class:normalizeClass(unref(z)?"media-type-indicator":"media-type-indicator-active"),onClick:Ce[13]||(Ce[13]=ge=>xe(ge,!1))},_hoisted_18,2)):createCommentVNode("",!0),createBaseVNode("div",{class:normalizeClass(unref(z)?"media-type-indicator-active":"media-type-indicator"),onClick:Ce[14]||(Ce[14]=ge=>xe(ge,!0))},_hoisted_20,2)],4),!unref(z)&&unref(N).visible?(openBlock(),createElementBlock("div",_hoisted_21,[createBaseVNode("div",{class:"playback-container",style:normalizeStyle({opacity:unref(N).height<(v.value?.5:.25)?"0":"1"})},[(openBlock(),createElementBlock("svg",{onClick:Ce[15]||(Ce[15]=ge=>Pe()),class:"play-button",viewBox:"0 0 512 512"},[createBaseVNode("path",{id:"svg_content",class:"play-button-path",d:unref(Ve)},null,8,_hoisted_22)]))],4),createBaseVNode("div",{class:"timeline",style:normalizeStyle({opacity:unref(N).height<(v.value?.8:.4)?"0":"1"})},[createBaseVNode("p",_hoisted_23,toDisplayString(be(unref(ne))),1),createBaseVNode("div",_hoisted_24,[createBaseVNode("input",{type:"range",ref_key:"large_timeline",ref:x,class:"media-timeline",value:unref(ne)/unref(de)*100,onInput:ge=>Me(Number(ge.target.value)),onChange:Ce[16]||(Ce[16]=ge=>He()),style:normalizeStyle({background:`linear-gradient(to right, var(--color) 0%, var(--color) ${unref(ne)/unref(de)*100}%, var(--slider-base) ${unref(ne)/unref(de)*100}%, var(--slider-base) 100%)`})},null,44,_hoisted_25)]),createBaseVNode("p",_hoisted_26,toDisplayString(be(unref(de))),1)],4)])):createCommentVNode("",!0),unref(z)?(openBlock(),createElementBlock("div",_hoisted_27,[createBaseVNode("div",_hoisted_28,[createBaseVNode("div",{class:"note-button",onClick:Ce[17]||(Ce[17]=ge=>he())},_hoisted_30),_hoisted_31]),(openBlock(!0),createElementBlock(Fragment,null,renderList(i.value,ge=>(openBlock(),createElementBlock("div",{key:ge,class:"note-container",onClick:Ze=>Ae(ge)},[createBaseVNode("div",_hoisted_33,[createBaseVNode("img",{class:"ionicon starting-note-icon",src:Ge(ge)},null,8,_hoisted_34)]),createBaseVNode("p",_hoisted_35,toDisplayString(ge),1)],8,_hoisted_32))),128))])):createCommentVNode("",!0)],6),unref(m)?(openBlock(),createElementBlock("div",{key:3,class:normalizeClass(["broadcast-button-container",{"arrow-hidden-right":!unref(te)}]),ref_key:"broadcast_button",ref:D},[createBaseVNode("div",_hoisted_36,[createBaseVNode("img",{onClick:Ce[18]||(Ce[18]=ge=>Y()),class:"ionicon",src:_imports_7})])],2)):createCommentVNode("",!0),unref(m)&&unref(y)?(openBlock(),createElementBlock("div",{key:4,class:"broadcast-container",onTouchmove:Ce[22]||(Ce[22]=ge=>ge.preventDefault())},[_hoisted_37,createBaseVNode("div",_hoisted_38,[createBaseVNode("img",{onClick:Ce[19]||(Ce[19]=ge=>W()),class:"ionicon",src:_imports_5})]),createBaseVNode("h3",null,toDisplayString(((Ie=c.value)==null?void 0:Ie.name.medium)||e.book)+" - #"+toDisplayString(e.number),1),_hoisted_39,_hoisted_40,createBaseVNode("a",{class:normalizeClass(["verse",{"verse-selected":unref(h)[0]==-2}]),onClick:Ce[20]||(Ce[20]=ge=>{isRef(h)?h.value=[]:h=[],unref(h).push(-2)})}," All ",2),_hoisted_41,createBaseVNode("div",_hoisted_42,[(openBlock(),createElementBlock(Fragment,null,renderList(12,ge=>createBaseVNode("a",{key:ge,class:normalizeClass(["verse",{"verse-selected":unref(h).includes(ge)}]),onClick:Ze=>{unref(h)[0]==-2&&(isRef(h)?h.value=[]:h=[]),unref(h).includes(ge)?unref(h).splice(unref(h).indexOf(ge),1):unref(h).push(ge)}},toDisplayString(ge),11,_hoisted_43)),64))]),createBaseVNode("button",{class:"send-button",onClick:Ce[21]||(Ce[21]=ge=>ee(ge))},"Send")],32)):createCommentVNode("",!0),createBaseVNode("div",{class:"w-100",style:{height:"100vh"},onMousedown:Ce[23]||(Ce[23]=ge=>isRef(F)?F.value={x:ge.screenX,y:ge.screenY}:F={x:ge.screenX,y:ge.screenY}),onMouseup:Ce[24]||(Ce[24]=ge=>{Math.abs(unref(F).x-ge.screenX)<5&&Math.abs(unref(F).y-ge.screenY)<5&&fe()}),onTouchstart:Ce[25]||(Ce[25]=ge=>isRef(F)?F.value={x:ge.touches[0].screenX,y:ge.touches[0].screenY}:F={x:ge.touches[0].screenX,y:ge.touches[0].screenY}),onTouchend:Ce[26]||(Ce[26]=ge=>{Math.abs(unref(F).x-ge.changedTouches[0].screenX)<5&&Math.abs(unref(F).y-ge.changedTouches[0].screenY)<5&&fe()}),onTouchmove:Ce[27]||(Ce[27]=ge=>{Ee()})},[createVNode(SongContainer,{book:k.value.book,number:k.value.number,ref_key:"song_container",ref:j},null,8,["book","number"])],32)],64)}}}),SongDisplayView_vue_vue_type_style_index_0_lang="";export{_sfc_main as default};
